<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 154</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:12px;font-family:Times;color:#0860a8;}
	.ft08{font-size:8px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft012{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft013{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page154-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a154.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-10&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROCEDURE CALLS, INTERRUPTS, AND EXCEPTIONS</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft013">The processor responds to&#160;interrupts&#160;and exceptions&#160;in&#160;essentially the&#160;same way.&#160;When an&#160;interrupt or&#160;exception&#160;<br/>is signaled, the&#160;processor halts&#160;execution&#160;of&#160;the&#160;current program or task and switches&#160;to a handler procedure&#160;that&#160;<br/>has been written specifically to&#160;handle the&#160;interrupt&#160;or&#160;exception condition.&#160;The processor accesses the&#160;handler&#160;<br/>procedure through an&#160;entry&#160;in the&#160;interrupt descriptor&#160;table (IDT). When&#160;the handler has completed&#160;handling&#160;the&#160;<br/>interrupt or&#160;exception, program control&#160;is returned to&#160;the&#160;interrupted program&#160;or&#160;task.<br/>The&#160;operating&#160;system,&#160;executive,&#160;and/or device&#160;drivers&#160;normally&#160;handle interrupts and&#160;exceptions independently&#160;<br/>from&#160;application programs or&#160;tasks.&#160;Application programs&#160;can, however,&#160;access the&#160;interrupt&#160;and exception&#160;<br/>handlers incorporated in an operating system or executive through assembly-language calls. The remainder of this&#160;<br/>section gives&#160;a brief overview&#160;of&#160;the processor‚Äôs&#160;interrupt and&#160;exception handling&#160;mechanism. See&#160;<a href="˛ˇ">Chapter 6,&#160;<br/>‚ÄúInterrupt and Exception Handling,‚Äù in the&#160;<i>Intel¬Æ 64 and IA-32 Architectures Software&#160;Developer‚Äôs Manual, Volume&#160;<br/>3A</i></a>, for a&#160;description of this&#160;mechanism.<br/>The&#160;IA-32 Architecture&#160;defines&#160;18 predefined&#160;interrupts&#160;and exceptions&#160;and 224&#160;user&#160;defined interrupts, which are&#160;<br/>associated&#160;with&#160;entries in&#160;the IDT.&#160;Each interrupt&#160;and&#160;exception&#160;in the&#160;IDT&#160;is identified with&#160;a&#160;number,&#160;called&#160;a&#160;<br/><b>vector</b>.<a href="o_7281d5ea06a5b67a-154.html">&#160;Table 6-1 lists the inte</a>rrupts and&#160;exceptions&#160;with entries in the IDT and their respective&#160;vectors.&#160;Vectors 0&#160;<br/>through&#160;8,&#160;10&#160;through 14,&#160;and&#160;16&#160;through&#160;19&#160;are&#160;the&#160;predefined interrupts and&#160;exceptions;&#160;vectors 32&#160;through 255&#160;<br/>are for software-defined interrupts,&#160;which are for either&#160;<b>software&#160;interrupts</b>&#160;or&#160;<b>maskable hardware&#160;inter-<br/>rupts</b>.<br/>Note&#160;that&#160;the processor defines several additional interrupts&#160;that do not point&#160;to entries in the IDT;&#160;the&#160;most&#160;<br/>notable of these interrupts is&#160;the SMI interrupt.&#160;S<a href="˛ˇ">ee Chapter 6,&#160;‚ÄúInterrupt&#160;and Exception Handling,‚Äù in&#160;</a>the&#160;<a href="˛ˇ"><i>Intel¬Æ&#160;<br/>64 and&#160;IA-32 Architectures Software&#160;Developer‚Äôs Manual, Volume&#160;3A,</i></a>&#160;for more&#160;information about&#160;the interrupts&#160;<br/>and exceptions.<br/>When&#160;the processor detects&#160;an interrupt&#160;or exception,&#160;it does&#160;one&#160;of&#160;the following things:</p>
<p style="position:absolute;top:499px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:499px;left:93px;white-space:nowrap" class="ft02">Executes&#160;an implicit&#160;call to&#160;a handler procedure.</p>
<p style="position:absolute;top:521px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:522px;left:93px;white-space:nowrap" class="ft02">Executes&#160;an implicit&#160;call to&#160;a handler task.</p>
<p style="position:absolute;top:572px;left:68px;white-space:nowrap" class="ft06">6.4.1&#160;</p>
<p style="position:absolute;top:572px;left:148px;white-space:nowrap" class="ft06">Call and Return Operation for Interrupt&#160;or Exception Handling Procedures</p>
<p style="position:absolute;top:603px;left:68px;white-space:nowrap" class="ft09">A call&#160;to an&#160;interrupt or&#160;exception handler&#160;procedure is&#160;similar to&#160;a&#160;procedure call&#160;to another&#160;protection level&#160;(see&#160;<br/><a href="o_7281d5ea06a5b67a-151.html">Section&#160;6.3.6,&#160;‚ÄúCALL&#160;and RET&#160;Operation Between Privilege&#160;Levels‚Äù). Here, the&#160;</a>vector&#160;references&#160;one of two kinds&#160;<br/>of&#160;gates&#160;in the IDT:&#160;an&#160;<b>interrupt gate&#160;</b>or a&#160;<b>trap gate</b>. Interrupt&#160;and trap gates are similar&#160;to call gates in&#160;that&#160;they&#160;<br/>provide&#160;the following information:</p>
<p style="position:absolute;top:674px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:675px;left:93px;white-space:nowrap" class="ft02">Access rights&#160;information</p>
<p style="position:absolute;top:697px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:697px;left:93px;white-space:nowrap" class="ft02">The&#160;segment selector for the&#160;code&#160;segment&#160;that contains the&#160;handler&#160;procedure</p>
<p style="position:absolute;top:719px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:720px;left:93px;white-space:nowrap" class="ft02">An&#160;offset into the&#160;code segment&#160;to the&#160;first instruction of the&#160;handler&#160;procedure</p>
<p style="position:absolute;top:744px;left:68px;white-space:nowrap" class="ft09">The difference between an interrupt gate and&#160;a trap gate&#160;is&#160;as&#160;follows.&#160;If an interrupt or&#160;exception&#160;handler&#160;is called&#160;<br/>through an interrupt gate,&#160;the processor clears the&#160;interrupt&#160;enable&#160;(IF) flag&#160;in the&#160;EFLAGS&#160;register&#160;to prevent&#160;<br/>subsequent&#160;interrupts from&#160;interfering&#160;with the&#160;execution of&#160;the handler.&#160;When&#160;a handler&#160;is called&#160;through&#160;a trap&#160;<br/>gate, the state&#160;of the&#160;IF flag&#160;is not&#160;changed.</p>
<p style="position:absolute;top:835px;left:327px;white-space:nowrap" class="ft07">Table 6-1. &#160;Exceptions and&#160;Interrupts</p>
<p style="position:absolute;top:856px;left:85px;white-space:nowrap" class="ft02">Vector</p>
<p style="position:absolute;top:856px;left:149px;white-space:nowrap" class="ft02">Mnemonic</p>
<p style="position:absolute;top:856px;left:321px;white-space:nowrap" class="ft02">Description</p>
<p style="position:absolute;top:856px;left:644px;white-space:nowrap" class="ft02">Source</p>
<p style="position:absolute;top:879px;left:99px;white-space:nowrap" class="ft02">&#160;0</p>
<p style="position:absolute;top:879px;left:146px;white-space:nowrap" class="ft02">#DE</p>
<p style="position:absolute;top:879px;left:223px;white-space:nowrap" class="ft02">Divide Error</p>
<p style="position:absolute;top:879px;left:497px;white-space:nowrap" class="ft02">DIV and&#160;IDIV instructions.</p>
<p style="position:absolute;top:901px;left:99px;white-space:nowrap" class="ft02">&#160;1</p>
<p style="position:absolute;top:901px;left:146px;white-space:nowrap" class="ft02">#DB</p>
<p style="position:absolute;top:901px;left:223px;white-space:nowrap" class="ft02">Debug</p>
<p style="position:absolute;top:901px;left:497px;white-space:nowrap" class="ft02">Any&#160;code&#160;or&#160;data reference.</p>
<p style="position:absolute;top:924px;left:99px;white-space:nowrap" class="ft02">&#160;2</p>
<p style="position:absolute;top:924px;left:223px;white-space:nowrap" class="ft02">NMI Interrupt</p>
<p style="position:absolute;top:924px;left:497px;white-space:nowrap" class="ft02">Non-maskable external interrupt.</p>
<p style="position:absolute;top:946px;left:99px;white-space:nowrap" class="ft02">&#160;</p>
<p style="position:absolute;top:946px;left:103px;white-space:nowrap" class="ft02">3</p>
<p style="position:absolute;top:946px;left:146px;white-space:nowrap" class="ft02">#BP</p>
<p style="position:absolute;top:946px;left:223px;white-space:nowrap" class="ft02">Breakpoint</p>
<p style="position:absolute;top:946px;left:497px;white-space:nowrap" class="ft02">INT&#160;&#160;3&#160;&#160;instruction.</p>
<p style="position:absolute;top:969px;left:99px;white-space:nowrap" class="ft02">&#160;</p>
<p style="position:absolute;top:969px;left:103px;white-space:nowrap" class="ft02">4</p>
<p style="position:absolute;top:969px;left:146px;white-space:nowrap" class="ft02">#OF</p>
<p style="position:absolute;top:969px;left:223px;white-space:nowrap" class="ft02">Overflow</p>
<p style="position:absolute;top:969px;left:497px;white-space:nowrap" class="ft02">INTO&#160;&#160;instruction.</p>
<p style="position:absolute;top:991px;left:99px;white-space:nowrap" class="ft02">&#160;5</p>
<p style="position:absolute;top:991px;left:146px;white-space:nowrap" class="ft02">#BR</p>
<p style="position:absolute;top:991px;left:223px;white-space:nowrap" class="ft02">BOUND Range&#160;Exceeded</p>
<p style="position:absolute;top:991px;left:497px;white-space:nowrap" class="ft02">BOUND instruction.</p>
<p style="position:absolute;top:1014px;left:99px;white-space:nowrap" class="ft02">&#160;6</p>
<p style="position:absolute;top:1014px;left:146px;white-space:nowrap" class="ft02">#UD</p>
<p style="position:absolute;top:1014px;left:223px;white-space:nowrap" class="ft02">Invalid Opcode&#160;(UnDefined&#160;Opcode)</p>
<p style="position:absolute;top:1014px;left:497px;white-space:nowrap" class="ft02">UD2 instruction or&#160;reserved&#160;opcode.</p>
<p style="position:absolute;top:1011px;left:702px;white-space:nowrap" class="ft08">1</p>
<p style="position:absolute;top:1036px;left:99px;white-space:nowrap" class="ft02">&#160;7</p>
<p style="position:absolute;top:1036px;left:146px;white-space:nowrap" class="ft02">#NM</p>
<p style="position:absolute;top:1036px;left:223px;white-space:nowrap" class="ft02">Device Not Available (No Math&#160;Coprocessor)</p>
<p style="position:absolute;top:1036px;left:497px;white-space:nowrap" class="ft02">Floating-point&#160;or&#160;WAIT/FWAIT&#160;instruction.</p>
</div>
</body>
</html>
