<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 158</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page158-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a158.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-14&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROCEDURE CALLS, INTERRUPTS, AND EXCEPTIONS</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">6.4.5&#160;</p>
<p style="position:absolute;top:98px;left:148px;white-space:nowrap" class="ft02">Handling Floating-Point&#160;Exceptions</p>
<p style="position:absolute;top:129px;left:68px;white-space:nowrap" class="ft06">When operating on individual&#160;or packed floating-point values, the IA-32 architecture&#160;supports a set of six floating-<br/>point exceptions. These&#160;exceptions&#160;can be&#160;generated&#160;during&#160;operations performed by the&#160;x87&#160;FPU instructions or&#160;<br/>by&#160;SSE/SSE2/SSE3&#160;instructions.&#160;When&#160;an&#160;x87 FPU instruction (including the FISTTP instruction in SSE3) generates&#160;<br/>one or&#160;more of these exceptions, it&#160;in&#160;turn&#160;generates floating-point&#160;error exception&#160;(#MF); when&#160;an&#160;<br/>SSE/SSE2/SSE3 instruction generates a&#160;floating-point exception, it&#160;in turn generates SIMD&#160;floating-point excep-<br/>tion (#XM).&#160;<br/>See&#160;the following sections&#160;for&#160;further descriptions of&#160;the&#160;floating-point exceptions, how&#160;they are&#160;generated, and&#160;<br/>how&#160;they&#160;are handled:</p>
<p style="position:absolute;top:274px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:274px;left:93px;white-space:nowrap" class="ft06"><a href="o_7281d5ea06a5b67a-103.html">Section 4.9.1, “Floating-Point Exception&#160;Conditions,”</a>&#160;an<a href="o_7281d5ea06a5b67a-107.html">d Section 4.9.3, “Typical Actions of a&#160;Floating-Point&#160;<br/>Exception Handler”</a></p>
<p style="position:absolute;top:313px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:313px;left:93px;white-space:nowrap" class="ft06"><a href="o_7281d5ea06a5b67a-215.html">Section 8.4, “x87&#160;FPU Floating-Point&#160;Exception Handling,”&#160;</a>an<a href="o_7281d5ea06a5b67a-216.html">d Section 8.5, “x87&#160;FPU Floating-Point&#160;Exception&#160;<br/>Conditions”</a></p>
<p style="position:absolute;top:352px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:352px;left:93px;white-space:nowrap" class="ft03"><a href="o_7281d5ea06a5b67a-267.html">Section 11.5.1, “SIMD&#160;Floating-Point Exceptions”</a></p>
<p style="position:absolute;top:374px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:375px;left:93px;white-space:nowrap" class="ft03">Interrupt Behavior</p>
<p style="position:absolute;top:425px;left:68px;white-space:nowrap" class="ft02">6.4.6&#160;</p>
<p style="position:absolute;top:425px;left:148px;white-space:nowrap" class="ft02">Interrupt&#160;and Exception Behavior in 64-Bit Mode</p>
<p style="position:absolute;top:456px;left:68px;white-space:nowrap" class="ft06">64-bit extensions&#160;expand&#160;the&#160;legacy IA-32&#160;interrupt-processing and exception-processing&#160;mechanism to&#160;allow&#160;<br/>support for 64-bit&#160;operating systems&#160;and applications.&#160;Changes include:</p>
<p style="position:absolute;top:494px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:495px;left:93px;white-space:nowrap" class="ft03">All interrupt&#160;handlers&#160;pointed&#160;to by the&#160;IDT&#160;are&#160;64-bit code (does not&#160;apply to&#160;the SMI&#160;handler).</p>
<p style="position:absolute;top:517px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:517px;left:93px;white-space:nowrap" class="ft03">The&#160;size&#160;of&#160;interrupt-stack pushes&#160;is&#160;fixed at&#160;64&#160;bits. The&#160;processor uses&#160;8-byte,&#160;zero extended&#160;stores.</p>
<p style="position:absolute;top:539px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:540px;left:93px;white-space:nowrap" class="ft06">The&#160;stack pointer (SS:RSP)&#160;is pushed&#160;unconditionally on&#160;interrupts.&#160;In legacy&#160;environments, this&#160;push is&#160;<br/>conditional&#160;and based&#160;on a change&#160;in&#160;current&#160;privilege level&#160;(CPL).</p>
<p style="position:absolute;top:578px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:579px;left:93px;white-space:nowrap" class="ft03">The&#160;new&#160;SS&#160;is&#160;set&#160;to NULL if there is&#160;a change&#160;in CPL.</p>
<p style="position:absolute;top:601px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:601px;left:93px;white-space:nowrap" class="ft03">IRET behavior&#160;changes.</p>
<p style="position:absolute;top:623px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:624px;left:93px;white-space:nowrap" class="ft03">There is&#160;a new interrupt stack-switch&#160;mechanism.</p>
<p style="position:absolute;top:646px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:646px;left:93px;white-space:nowrap" class="ft03">The&#160;alignment of interrupt&#160;stack frame&#160;is different.</p>
<p style="position:absolute;top:702px;left:68px;white-space:nowrap" class="ft05">6.5&#160;</p>
<p style="position:absolute;top:702px;left:147px;white-space:nowrap" class="ft05">PROCEDURE CALLS FOR BLOCK-STRUCTURED LANGUAGES</p>
<p style="position:absolute;top:738px;left:68px;white-space:nowrap" class="ft08">The IA-32 architecture&#160;supports&#160;an alternate method&#160;of&#160;performing procedure&#160;calls with the&#160;ENTER (enter&#160;proce-<br/>dure) and LEAVE (leave&#160;procedure) instructions. These instructions&#160;automatically create and release, respectively,&#160;<br/>stack frames&#160;for&#160;called procedures. The&#160;stack frames&#160;have&#160;predefined&#160;spaces&#160;for local&#160;variables&#160;and the&#160;necessary&#160;<br/>pointers&#160;to allow coherent&#160;returns from&#160;called procedures.&#160;They&#160;also allow scope&#160;rules&#160;to be implemented&#160;so that&#160;<br/>procedures&#160;can access their own local variables and some&#160;number of other variables located in other stack frames.<br/>ENTER&#160;and LEAVE offer two benefits:</p>
<p style="position:absolute;top:850px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:850px;left:93px;white-space:nowrap" class="ft03">They&#160;provide machine-language support&#160;for implementing&#160;block-structured languages, such&#160;as&#160;C&#160;and Pascal.&#160;</p>
<p style="position:absolute;top:872px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:873px;left:93px;white-space:nowrap" class="ft03">They&#160;simplify procedure entry&#160;and exit&#160;in compiler-generated code.</p>
<p style="position:absolute;top:923px;left:68px;white-space:nowrap" class="ft02">6.5.1 ENTER&#160;</p>
<p style="position:absolute;top:923px;left:206px;white-space:nowrap" class="ft02">Instruction</p>
<p style="position:absolute;top:954px;left:68px;white-space:nowrap" class="ft06">The ENTER instruction&#160;creates&#160;a stack frame&#160;compatible with the&#160;scope&#160;rules&#160;typically used in&#160;block-structured&#160;<br/>languages. In&#160;block-structured&#160;languages,&#160;the scope of a&#160;procedure is&#160;the set of&#160;variables to&#160;which it&#160;has access.&#160;<br/>The&#160;rules for scope vary among&#160;languages. They&#160;may be&#160;based&#160;on&#160;the nesting of&#160;procedures, the&#160;division of&#160;the&#160;<br/>program into&#160;separately compiled files,&#160;or some&#160;other modularization scheme.<br/>ENTER has two operands. The&#160;first specifies&#160;the number&#160;of&#160;bytes&#160;to be reserved on&#160;the&#160;stack for dynamic&#160;storage&#160;<br/>for&#160;the procedure being called.&#160;Dynamic storage is&#160;the&#160;memory allocated for variables&#160;created&#160;when&#160;the procedure&#160;<br/>is called, also known&#160;as automatic variables. The second parameter is the lexical nesting level (from 0 to 31)&#160;of the&#160;</p>
</div>
</body>
</html>
