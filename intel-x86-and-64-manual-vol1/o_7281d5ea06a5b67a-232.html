<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 232</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page232-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a232.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">9-8&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROGRAMMING WITH INTEL¬Æ MMX‚Ñ¢&#160;TECHNOLOGY</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">9.4.7 Shift&#160;</p>
<p style="position:absolute;top:98px;left:192px;white-space:nowrap" class="ft02">Instructions</p>
<p style="position:absolute;top:129px;left:68px;white-space:nowrap" class="ft06">The logical shift left, logical shift right&#160;and&#160;arithmetic&#160;shift&#160;right instructions shift each element&#160;by a&#160;specified&#160;<br/>number&#160;of bit positions.<br/>The&#160;PSLLW/PSLLD/PSLLQ (shift packed&#160;data&#160;left logical) instructions and&#160;the&#160;PSRLW/PSRLD/PSRLQ (shift packed&#160;<br/>data right&#160;logical)&#160;instructions perform&#160;a logical left&#160;or right shift of&#160;the&#160;data elements&#160;and fill&#160;the empty high&#160;or low&#160;<br/>order&#160;bit&#160;positions with zeros. These&#160;instructions operate on&#160;packed words,&#160;doublewords, and quadwords.<br/>The PSRAW/PSRAD (shift&#160;packed data right&#160;arithmetic) instructions&#160;perform an arithmetic&#160;right shift, copying the&#160;<br/>sign&#160;bit for each data&#160;element&#160;into empty&#160;bit&#160;positions on&#160;the upper end of each&#160;data&#160;element. This&#160;instruction&#160;<br/>operates on&#160;packed&#160;words&#160;and doublewords.&#160;</p>
<p style="position:absolute;top:310px;left:68px;white-space:nowrap" class="ft02">9.4.8 EMMS&#160;</p>
<p style="position:absolute;top:310px;left:200px;white-space:nowrap" class="ft02">Instruction</p>
<p style="position:absolute;top:340px;left:68px;white-space:nowrap" class="ft06">The EMMS instruction empties&#160;the&#160;MMX state by setting&#160;the&#160;tags&#160;in x87&#160;FPU tag word to&#160;11B, indicating empty&#160;<br/>registers.&#160;This instruction must&#160;be&#160;executed at the&#160;end&#160;of an MMX routine before calling other&#160;routines&#160;that can&#160;<br/>execute floating-point&#160;instructions.&#160;Se<a href="o_7281d5ea06a5b67a-233.html">e Section 9.6.3,&#160;‚ÄúUsing the EMMS Instruction,‚Äù for more&#160;</a>information on the&#160;<br/>use&#160;of this instruction.</p>
<p style="position:absolute;top:445px;left:68px;white-space:nowrap" class="ft04">9.5&#160;</p>
<p style="position:absolute;top:445px;left:147px;white-space:nowrap" class="ft04">COMPATIBILITY WITH X87 FPU ARCHITECTURE</p>
<p style="position:absolute;top:481px;left:68px;white-space:nowrap" class="ft06">The MMX&#160;state&#160;is aliased to&#160;the x87 FPU&#160;state.&#160;No&#160;new&#160;states or&#160;modes&#160;have&#160;been&#160;added to&#160;IA-32&#160;architecture to&#160;<br/>support the&#160;MMX&#160;technology. The same&#160;floating-point instructions&#160;that save&#160;and&#160;restore&#160;the x87&#160;FPU state also&#160;<br/>handle the&#160;MMX&#160;state (for example,&#160;during context&#160;switching).<br/>MMX technology uses the same interface techniques between the&#160;x87 FPU and the operating system&#160;(primarily for&#160;<br/>task switching purposes).&#160;For&#160;more&#160;details,&#160;see<a href="˛ˇ">&#160;Chapter&#160;12, ‚ÄúIntel¬Æ MMX‚Ñ¢ Technology&#160;System Programming,‚Äù</a>&#160;in&#160;<br/>the&#160;<i>Intel¬Æ&#160;64 and IA-32 Architectures&#160;Software&#160;Developer‚Äôs Manual, Volume&#160;3A.</i></p>
<p style="position:absolute;top:622px;left:68px;white-space:nowrap" class="ft02">9.5.1&#160;</p>
<p style="position:absolute;top:622px;left:148px;white-space:nowrap" class="ft02">MMX Instructions and the x87 FPU Tag Word</p>
<p style="position:absolute;top:652px;left:68px;white-space:nowrap" class="ft06">After&#160;each MMX instruction,&#160;the entire x87&#160;FPU tag word&#160;is set to&#160;valid (00B). The&#160;EMMS instruction (empty MMX&#160;<br/>state)&#160;sets&#160;the&#160;entire&#160;x87&#160;FPU tag&#160;word&#160;to&#160;empty (11B).&#160;<br/><a href="˛ˇ">Chapter 12,&#160;‚ÄúIntel¬Æ&#160;MMX‚Ñ¢ Technology System Programming,‚Äù in the&#160;</a><i>Intel¬Æ 64 and&#160;IA-32 Architectures Software&#160;<br/>Developer‚Äôs Manual, Volume&#160;3A,</i>&#160;provides&#160;additional information&#160;about the effects of x87 FPU and MMX instructions&#160;<br/>on the&#160;x87 FPU&#160;tag&#160;word.&#160;For a&#160;description of the&#160;tag&#160;word,&#160;se<a href="o_7281d5ea06a5b67a-198.html">e Section 8.1.7,&#160;‚Äúx87&#160;FPU Tag&#160;Word.‚Äù</a></p>
<p style="position:absolute;top:781px;left:68px;white-space:nowrap" class="ft04">9.6&#160;</p>
<p style="position:absolute;top:781px;left:147px;white-space:nowrap" class="ft04">WRITING APPLICATIONS WITH MMX CODE</p>
<p style="position:absolute;top:817px;left:68px;white-space:nowrap" class="ft03">The following sections&#160;give&#160;guidelines&#160;for&#160;writing&#160;application&#160;code that uses MMX&#160;technology.</p>
<p style="position:absolute;top:868px;left:68px;white-space:nowrap" class="ft02">9.6.1&#160;</p>
<p style="position:absolute;top:868px;left:148px;white-space:nowrap" class="ft02">Checking for MMX Technology Support</p>
<p style="position:absolute;top:898px;left:68px;white-space:nowrap" class="ft08">Before an&#160;application attempts to use the MMX technology,&#160;it&#160;should check that it is present on the processor.&#160;Check&#160;<br/>by&#160;following these steps:<br/>1.&#160;Check that the processor supports the&#160;CPUID instruction by&#160;attempting to execute the CPUID instruction.&#160;If&#160;the&#160;</p>
<p style="position:absolute;top:955px;left:93px;white-space:nowrap" class="ft03">processor does&#160;not support the&#160;CPUID instruction, this will generate&#160;an&#160;invalid-opcode exception&#160;(#UD).</p>
<p style="position:absolute;top:979px;left:68px;white-space:nowrap" class="ft03">2.&#160;Check that the&#160;processor&#160;supports&#160;the MMX technology&#160;</p>
<p style="position:absolute;top:996px;left:93px;white-space:nowrap" class="ft03">(if CPUID.01H:EDX.MMX[bit&#160;23] = 1).</p>
<p style="position:absolute;top:1020px;left:68px;white-space:nowrap" class="ft06">3.&#160;Check that emulation&#160;of&#160;the x87&#160;FPU is&#160;disabled&#160;(if CR0.EM[bit&#160;2] = 0).<br/>If the&#160;processor&#160;attempts&#160;to execute an unsupported MMX instruction or attempts to&#160;execute&#160;an MMX&#160;instruction&#160;<br/>with CR0.EM[bit&#160;2]&#160;set,&#160;this generates&#160;an&#160;invalid-opcode exception (#UD).</p>
</div>
</body>
</html>
