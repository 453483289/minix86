<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 279</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:14px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page279-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a279.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 1&#160;11-25</p>
<p style="position:absolute;top:47px;left:401px;white-space:nowrap" class="ft01">PROGRAMMING&#160;WITH INTEL¬Æ STREAMING SIMD EXTENSIONS 2&#160;(INTEL¬Æ SSE2)</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">11.6.13&#160;&#160;Cacheability Hint&#160;Instructions</p>
<p style="position:absolute;top:129px;left:69px;white-space:nowrap" class="ft07">SSE&#160;and&#160;SSE2&#160;cacheability&#160;control instructions enable the&#160;programmer&#160;to control prefetching, caching, loading and&#160;<br/>storing of data.&#160;When correctly&#160;used, these&#160;instructions improve application performance.&#160;<br/>To&#160;make&#160;efficient&#160;use&#160;of the&#160;processor‚Äôs super-scalar&#160;microarchitecture,&#160;a program needs&#160;to provide&#160;a steady&#160;<br/>stream of data to&#160;the executing program to&#160;avoid&#160;stalling the&#160;processor.&#160;PREFETCH<i>h</i>&#160;instructions minimize the&#160;<br/>latency of data&#160;accesses in performance-critical sections&#160;of&#160;application code&#160;by&#160;allowing data&#160;to be fetched into the&#160;<br/>processor&#160;cache hierarchy in&#160;advance of actual&#160;usage.&#160;<br/>PREFETCH<i>h</i>&#160;instructions do not change&#160;the&#160;user-visible&#160;semantics&#160;of&#160;a program,&#160;although they may affect perfor-<br/>mance.&#160;The operation of&#160;these&#160;instructions&#160;is&#160;implementation-dependent.&#160;Programmers&#160;may need&#160;to&#160;tune code&#160;for&#160;<br/>each IA-32 processor implementation. Excessive&#160;usage of PREFETCH<i>h</i>&#160;instructions&#160;may waste memory bandwidth&#160;<br/>and&#160;reduce performance.&#160;For more detailed information&#160;on&#160;the&#160;use&#160;of&#160;prefetch&#160;hints,&#160;refe<a href="˛ˇ">r to Chapter&#160;7,&#160;‚ÄúOpti-<br/>mizing&#160;Cache Usage,‚Äù, i</a>n&#160;the&#160;<i>Intel¬Æ 64 and&#160;IA-32 Architectures Optimization Reference Manual.<br/></i>The&#160;non-temporal store&#160;instructions (MOVNTI, MOVNTPD,&#160;MOVNTPS,&#160;MOVNTDQ,&#160;MOVNTQ,&#160;MASKMOVQ,&#160;and&#160;<br/>MASKMOVDQU) minimize&#160;cache&#160;pollution when writing non-temporal&#160;data&#160;<a href="o_7281d5ea06a5b67a-248.html">to memory (see Section 10.4.6.1,&#160;<br/>‚ÄúCacheability Control&#160;Instructions‚Äù&#160;and Section 10.4.6.2,&#160;‚ÄúCaching of Temporal&#160;vs. Non-Temporal Data‚Äù).&#160;</a>They&#160;<br/>prevent&#160;non-temporal data from being written&#160;into processor caches&#160;on a&#160;store operation.<br/>Besides reducing cache&#160;pollution,&#160;the use&#160;of weakly-ordered&#160;memory&#160;types&#160;can be important under certain&#160;data&#160;<br/>sharing&#160;relationships, such&#160;as a producer-consumer relationship. The use of weakly ordered&#160;memory&#160;can make the&#160;<br/>assembling&#160;of data&#160;more efficient;&#160;but care&#160;must be taken to ensure that the consumer obtains&#160;the data that&#160;the&#160;<br/>producer&#160;intended.&#160;Some&#160;common usage models that may be&#160;affected&#160;in this&#160;way&#160;by weakly-ordered&#160;stores are:&#160;</p>
<p style="position:absolute;top:478px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:478px;left:95px;white-space:nowrap" class="ft03">Library functions that use weakly&#160;ordered memory to write&#160;results</p>
<p style="position:absolute;top:500px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:501px;left:95px;white-space:nowrap" class="ft03">Compiler-generated&#160;code&#160;that&#160;writes weakly-ordered results</p>
<p style="position:absolute;top:523px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:523px;left:95px;white-space:nowrap" class="ft03">Hand-crafted code</p>
<p style="position:absolute;top:547px;left:69px;white-space:nowrap" class="ft07">The degree to which a&#160;consumer&#160;of&#160;data&#160;knows that&#160;the data is&#160;weakly&#160;ordered can&#160;vary for these cases.&#160;As&#160;a&#160;<br/>result, the SFENCE or&#160;MFENCE instruction should&#160;be&#160;used to&#160;ensure ordering&#160;between routines&#160;that&#160;produce&#160;<br/>weakly-ordered&#160;data and routines that&#160;consume&#160;the data.&#160;SFENCE&#160;and MFENCE&#160;provide a&#160;performance-efficient&#160;<br/>way to&#160;ensure ordering by&#160;guaranteeing that&#160;every store&#160;instruction&#160;that&#160;precedes&#160;SFENCE/MFENCE in&#160;program&#160;<br/>order&#160;is globally visible&#160;before&#160;a store&#160;instruction that&#160;follows the&#160;fence.&#160;</p>
<p style="position:absolute;top:664px;left:69px;white-space:nowrap" class="ft02">11.6.14&#160;&#160;Effect of&#160;Instruction Prefixes on the SSE/SSE2 Instructions</p>
<p style="position:absolute;top:694px;left:69px;white-space:nowrap" class="ft07"><a href="o_7281d5ea06a5b67a-280.html">Table 11-3</a>&#160;describes the&#160;effects of&#160;instruction&#160;prefixes&#160;on&#160;SSE and&#160;SSE2 instructions<a href="o_7281d5ea06a5b67a-280.html">. (Table&#160;11-3 also&#160;</a>applies to&#160;<br/>SIMD integer&#160;and SIMD&#160;floating-point instructions in SSE3.) Unpredictable&#160;behavior can range from prefixes&#160;being&#160;<br/>treated as&#160;a reserved operation on one&#160;generation of IA-32&#160;processors to&#160;generating&#160;an&#160;invalid opcode&#160;exception&#160;<br/>on another generation&#160;of&#160;processors.</p>
<p style="position:absolute;top:777px;left:69px;white-space:nowrap" class="ft011">See also&#160;‚ÄúInstruction Prefix<a href="˛ˇ">es‚Äù in Chapter&#160;2 of the&#160;</a><i>Intel¬Æ 64&#160;and&#160;IA-32&#160;Architectures Software Developer‚Äôs Manual,&#160;<br/>Volume 2A,&#160;</i>for complete&#160;description of&#160;instruction&#160;prefixes.</p>
<p style="position:absolute;top:828px;left:433px;white-space:nowrap" class="ft06">NOTE</p>
<p style="position:absolute;top:853px;left:122px;white-space:nowrap" class="ft07">Some&#160;SSE/SSE2/SSE3 instructions&#160;have&#160;two-byte opcodes that&#160;are&#160;either 2 bytes&#160;or&#160;3&#160;bytes in&#160;<br/>length. Two-byte&#160;opcodes that&#160;are 3 bytes&#160;in&#160;length&#160;consist of: a&#160;mandatory&#160;prefix (F2H, F3H,&#160;or&#160;<br/>66H),&#160;0FH,&#160;and&#160;an opcode&#160;byte.&#160;See&#160;<a href="o_7281d5ea06a5b67a-280.html">Table&#160;11-3.</a></p>
</div>
</body>
</html>
