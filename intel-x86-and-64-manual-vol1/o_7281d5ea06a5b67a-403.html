<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 403</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page403-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a403.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:775px;white-space:nowrap" class="ft00">Vol. 1&#160;18-3</p>
<p style="position:absolute;top:47px;left:748px;white-space:nowrap" class="ft01">INPUT/OUTPUT</p>
<p style="position:absolute;top:97px;left:69px;white-space:nowrap" class="ft02">18.4 I/O&#160;</p>
<p style="position:absolute;top:97px;left:181px;white-space:nowrap" class="ft02">INSTRUCTIONS</p>
<p style="position:absolute;top:133px;left:69px;white-space:nowrap" class="ft08">The processor‚Äôs&#160;I/O&#160;instructions provide access&#160;to I/O&#160;ports&#160;through the&#160;I/O address&#160;space. (These instructions&#160;<br/>cannot&#160;be&#160;used&#160;to access memory-mapped I/O ports.)&#160;There&#160;are&#160;two groups of I/O&#160;instructions:</p>
<p style="position:absolute;top:172px;left:69px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:172px;left:95px;white-space:nowrap" class="ft08">Those that&#160;transfer a&#160;single&#160;item&#160;(byte, word, or&#160;doubleword) between an&#160;I/O port&#160;and a&#160;general-purpose&#160;<br/>register</p>
<p style="position:absolute;top:211px;left:69px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:211px;left:95px;white-space:nowrap" class="ft03">Those that&#160;transfer&#160;strings of items (strings&#160;of&#160;bytes,&#160;words, or&#160;doublewords)&#160;between&#160;an I/O port and&#160;memory</p>
<p style="position:absolute;top:235px;left:69px;white-space:nowrap" class="ft011">The&#160;register&#160;I/O instructions&#160;IN&#160;(input&#160;from I/O&#160;port)&#160;and&#160;OUT (output&#160;to I/O&#160;port) move&#160;data&#160;between&#160;I/O ports&#160;<br/>and the&#160;EAX register (32-bit&#160;I/O),&#160;the AX&#160;register (16-bit&#160;I/O), or the&#160;AL&#160;(8-bit I/O)&#160;register. The address&#160;of&#160;the I/O&#160;<br/>port can&#160;be&#160;given with an immediate value&#160;or&#160;a value&#160;in the&#160;DX&#160;register.&#160;<br/>The string&#160;I/O instructions INS (input&#160;string&#160;from&#160;I/O&#160;port) and OUTS&#160;(output string&#160;to I/O&#160;port) move&#160;data&#160;<br/>between&#160;an&#160;I/O port and&#160;a memory location.&#160;The&#160;address&#160;of&#160;the&#160;I/O port&#160;being&#160;accessed&#160;is given in the&#160;DX&#160;register;&#160;<br/>the source&#160;or destination memory&#160;address is&#160;given&#160;in the&#160;DS:ESI&#160;or ES:EDI&#160;register, respectively.<br/>When used&#160;with the&#160;repeat prefix REP,&#160;the&#160;INS&#160;and&#160;OUTS&#160;instructions&#160;perform string&#160;(or block)&#160;input or output&#160;<br/>operations.&#160;The&#160;repeat prefix REP&#160;modifies the&#160;INS and&#160;OUTS&#160;instructions to&#160;transfer blocks of data between an I/O&#160;<br/>port and memory. Here, the ESI or EDI register is incremented&#160;or decremented (according to the setting of the DF&#160;<br/>flag in&#160;the EFLAGS register) after each byte, word, or doubleword is transferred between&#160;the selected&#160;I/O port and&#160;<br/>memory.<br/>See the references for IN, INS,&#160;OUT,&#160;and OU<a href="˛ˇ">TS in Chapter 3 a</a>n<a href="˛ˇ">d&#160;Chapter 4 of the&#160;</a><i>Intel¬Æ 64 and&#160;IA-32&#160;Architectures&#160;<br/>Software Developer‚Äôs Manual, Volumes&#160;2A&#160;&amp;&#160;2B,</i>&#160;for more information&#160;on these instructions.</p>
<p style="position:absolute;top:511px;left:69px;white-space:nowrap" class="ft02">18.5 PROTECTED-MODE&#160;</p>
<p style="position:absolute;top:511px;left:327px;white-space:nowrap" class="ft02">I/O</p>
<p style="position:absolute;top:547px;left:69px;white-space:nowrap" class="ft08">When the&#160;processor&#160;is running in&#160;protected mode,&#160;the following&#160;protection&#160;mechanisms regulate access to&#160;I/O&#160;<br/>ports:</p>
<p style="position:absolute;top:586px;left:69px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:586px;left:95px;white-space:nowrap" class="ft010">When&#160;accessing&#160;I/O ports&#160;through the&#160;I/O address&#160;space, two protection devices control access:<br/>‚Äî&#160;The&#160;I/O privilege&#160;level (IOPL) field in&#160;the EFLAGS&#160;register<br/>‚Äî&#160;The I/O&#160;permission bit map&#160;of&#160;a task&#160;state segment (TSS)</p>
<p style="position:absolute;top:656px;left:69px;white-space:nowrap" class="ft04">‚Ä¢</p>
<p style="position:absolute;top:657px;left:95px;white-space:nowrap" class="ft08">When accessing memory-mapped I/O&#160;ports,&#160;the normal&#160;segmentation&#160;and paging&#160;protection and the&#160;MTRRs&#160;<br/>(in processors that&#160;support them)&#160;also affect access to&#160;<a href="˛ˇ">I/O ports. See&#160;Chapter 5, ‚ÄúProtection‚Äù&#160;and Chapter 11,&#160;<br/>‚ÄúMemory Cache Control‚Äù&#160;</a>in the&#160;<i>Intel¬Æ&#160;64&#160;and IA-32&#160;Architectures&#160;Software Developer‚Äôs Manual, Volume 3A,</i>&#160;<br/>for&#160;a complete discussion&#160;of memory&#160;protection.&#160;</p>
<p style="position:absolute;top:730px;left:69px;white-space:nowrap" class="ft08">The&#160;following sections describe&#160;the protection mechanisms available&#160;when&#160;accessing I/O&#160;ports in&#160;the&#160;I/O&#160;address&#160;<br/>space&#160;with&#160;the I/O&#160;instructions.</p>
<p style="position:absolute;top:797px;left:69px;white-space:nowrap" class="ft06">18.5.1&#160;</p>
<p style="position:absolute;top:797px;left:149px;white-space:nowrap" class="ft06">I/O Privilege Level</p>
<p style="position:absolute;top:828px;left:69px;white-space:nowrap" class="ft08">In systems where&#160;I/O protection is&#160;used,&#160;the&#160;IOPL&#160;field&#160;in&#160;the EFLAGS&#160;register controls access to&#160;the I/O&#160;address&#160;<br/>space&#160;by restricting use of&#160;selected instructions. This&#160;protection&#160;mechanism permits the operating&#160;system or&#160;exec-<br/>utive to set the privilege level needed to perform I/O.&#160;In&#160;a typical&#160;protection ring model, access to the I/O address&#160;<br/>space&#160;is restricted to&#160;privilege levels&#160;0&#160;and 1. Here, the&#160;kernel&#160;and&#160;the device drivers&#160;are allowed to perform&#160;I/O,&#160;<br/>while&#160;less privileged device drivers&#160;and application programs&#160;are&#160;denied access to the&#160;I/O address&#160;space.&#160;Applica-<br/>tion programs must then&#160;make calls&#160;to the&#160;operating system&#160;to perform&#160;I/O.<br/>The following instructions&#160;can&#160;be executed only if the current privilege level&#160;(CPL)&#160;of the&#160;program&#160;or&#160;task&#160;currently&#160;<br/>executing is&#160;less&#160;than&#160;or equal to&#160;the IOPL: IN, INS,&#160;OUT,&#160;OUTS, CLI&#160;(clear&#160;interrupt-enable&#160;flag), and&#160;STI (set&#160;<br/>interrupt-enable flag). These instructions are&#160;called&#160;<b>I/O sensitive</b>&#160;instructions, because they are sensitive&#160;to the&#160;<br/>IOPL&#160;field.&#160;Any attempt&#160;by a less privileged&#160;program&#160;or task&#160;to&#160;use&#160;an I/O&#160;sensitive&#160;instruction results&#160;in&#160;a general-<br/>protection exception&#160;(#GP)&#160;being signaled. Because&#160;each task has its own&#160;copy&#160;of the&#160;EFLAGS register,&#160;each&#160;task&#160;<br/>can have&#160;a different&#160;IOPL.</p>
</div>
</body>
</html>
