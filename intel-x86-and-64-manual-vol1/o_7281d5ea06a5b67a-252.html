<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 252</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#000000;}
	.ft06{font-size:14px;font-family:Times;color:#0860a8;}
	.ft07{font-size:16px;font-family:Times;color:#0860a8;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page252-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a252.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">10-16&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROGRAMMING WITH INTEL® STREAMING&#160;SIMD&#160;EXTENSIONS&#160;(INTEL® SSE)</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft08">Byte&#160;4 is&#160;used&#160;for&#160;an abridged version of the&#160;x87&#160;FPU&#160;Tag Word&#160;(FTW). The following items&#160;describe its&#160;usage:<br/>—&#160;For&#160;&#160;each&#160;&#160;<i>j</i>, 0&#160;≤&#160;<i>j&#160;</i>≤&#160;7, FXSAVE&#160;saves&#160;a 0&#160;into bit&#160;<i>j</i>&#160;of&#160;byte&#160;4&#160;if&#160;x87&#160;FPU data register ST<i>j</i>&#160;has a&#160;empty&#160;tag;&#160;</p>
<p style="position:absolute;top:141px;left:119px;white-space:nowrap" class="ft03">otherwise, FXSAVE&#160;saves&#160;a 1&#160;into bit&#160;<i>j</i>&#160;of&#160;byte 4.</p>
<p style="position:absolute;top:165px;left:93px;white-space:nowrap" class="ft03">—&#160;For&#160;&#160;each&#160;&#160;<i>j</i>, 0&#160;≤&#160;<i>j&#160;</i>≤&#160;7,&#160;FXRSTOR&#160;establishes the&#160;tag&#160;value&#160;for x87&#160;FPU data register&#160;ST<i>j</i>&#160;as&#160;follows.&#160;If&#160;bit&#160;<i>j</i>&#160;of&#160;</p>
<p style="position:absolute;top:181px;left:119px;white-space:nowrap" class="ft09">byte 4 is 0, the tag for ST<i>j</i>&#160;in the tag&#160;register for that&#160;data register is marked&#160;empty&#160;(11B); otherwise,&#160;the&#160;<br/>x87 FPU&#160;sets&#160;the tag for ST<i>j</i>&#160;based on the&#160;value being&#160;loaded into that&#160;register&#160;(see&#160;below).</p>
<p style="position:absolute;top:220px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:220px;left:93px;white-space:nowrap" class="ft010">Bytes&#160;15:8&#160;are used as&#160;follows:<br/>—&#160;If the&#160;instruction&#160;has no&#160;REX&#160;prefix,&#160;or if REX.W&#160;=&#160;0:</p>
<p style="position:absolute;top:270px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:268px;left:144px;white-space:nowrap" class="ft03">Bytes&#160;11:8&#160;are used&#160;for bits&#160;31:0&#160;of&#160;the x87&#160;FPU&#160;Instruction&#160;Pointer Offset&#160;(FIP).</p>
<p style="position:absolute;top:294px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:292px;left:144px;white-space:nowrap" class="ft03">If&#160;CPUID.(EAX=07H,ECX=0H):EBX[bit 13]&#160;=&#160;0,&#160;bytes 13:12&#160;are used&#160;for x87&#160;FPU&#160;Instruction&#160;Pointer&#160;</p>
<p style="position:absolute;top:309px;left:143px;white-space:nowrap" class="ft03">Selector (FPU&#160;CS).&#160;Otherwise, the processor&#160;deprecates the&#160;FPU CS&#160;value:&#160;FXSAVE&#160;saves it&#160;as 0000H.</p>
<p style="position:absolute;top:334px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:333px;left:144px;white-space:nowrap" class="ft03">Bytes&#160;15:14 are not used.</p>
<p style="position:absolute;top:357px;left:93px;white-space:nowrap" class="ft03">—&#160;If&#160;the instruction has&#160;a REX prefix&#160;with REX.W&#160;=&#160;1,&#160;bytes&#160;15:8 are&#160;used&#160;for the&#160;full&#160;64&#160;bits&#160;of&#160;FIP.</p>
<p style="position:absolute;top:379px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:379px;left:93px;white-space:nowrap" class="ft010">Bytes&#160;23:16&#160;are&#160;used&#160;as follows:<br/>—&#160;If the&#160;instruction&#160;has no&#160;REX&#160;prefix,&#160;or if REX.W&#160;=&#160;0:</p>
<p style="position:absolute;top:429px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:427px;left:144px;white-space:nowrap" class="ft03">Bytes&#160;19:16&#160;are&#160;used&#160;for&#160;bits&#160;31:0&#160;of the&#160;x87 FPU Data Pointer Offset (FDP).</p>
<p style="position:absolute;top:453px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:451px;left:144px;white-space:nowrap" class="ft03">If CPUID.(EAX=07H,ECX=0H):EBX[bit 13]&#160;=&#160;0,&#160;bytes 21:20 are&#160;used&#160;for x87 FPU Data Pointer Selector&#160;</p>
<p style="position:absolute;top:468px;left:143px;white-space:nowrap" class="ft03">(FPU&#160;DS). Otherwise,&#160;the&#160;processor deprecates&#160;the FPU&#160;DS&#160;value: FXSAVE&#160;saves&#160;it as&#160;0000H.</p>
<p style="position:absolute;top:493px;left:119px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:492px;left:144px;white-space:nowrap" class="ft03">Bytes&#160;23:22 are not used.</p>
<p style="position:absolute;top:516px;left:93px;white-space:nowrap" class="ft03">—&#160;If&#160;the instruction has&#160;a REX prefix&#160;with REX.W&#160;=&#160;1,&#160;bytes&#160;23:16&#160;are used&#160;for the&#160;full 64&#160;bits of FDP.</p>
<p style="position:absolute;top:538px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:538px;left:93px;white-space:nowrap" class="ft03">Bytes&#160;31:24&#160;are used&#160;for SSE state (see<a href="o_7281d5ea06a5b67a-252.html">&#160;Section 10.5.1.2</a>).</p>
<p style="position:absolute;top:560px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:561px;left:93px;white-space:nowrap" class="ft09">Bytes&#160;159:32&#160;are used&#160;for the&#160;registers ST0–ST7 (MM0–MM7).&#160;Each of&#160;the&#160;8&#160;registers is&#160;allocated&#160;a 128-bit&#160;<br/>region, with&#160;the&#160;low 80 bits used for the register&#160;and the&#160;upper 48&#160;bits&#160;unused.</p>
<p style="position:absolute;top:622px;left:68px;white-space:nowrap" class="ft06">10.5.1.2 &#160;&#160;SSE State</p>
<p style="position:absolute;top:650px;left:68px;white-space:nowrap" class="ft09"><a href="o_7281d5ea06a5b67a-251.html">Table&#160;10-2 illustr</a>ates how FXSAVE&#160;and FXRSTOR&#160;organize&#160;x87&#160;state&#160;and SSE&#160;state;&#160;the&#160;SSE&#160;state is&#160;listed below,&#160;<br/>along with details&#160;of&#160;its interactions with&#160;FXSAVE and&#160;FXRSTOR:</p>
<p style="position:absolute;top:688px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:689px;left:93px;white-space:nowrap" class="ft03">Bytes&#160;23:0&#160;are&#160;used&#160;for&#160;x87 state&#160;(see<a href="o_7281d5ea06a5b67a-251.html">&#160;Section 10.5.1.1).</a></p>
<p style="position:absolute;top:711px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:712px;left:93px;white-space:nowrap" class="ft09">Bytes&#160;27:24&#160;are used for the&#160;MXCSR register.&#160;FXRSTOR generates a general-protection&#160;fault (#GP) in&#160;response&#160;<br/>to&#160;an&#160;attempt&#160;to set any of&#160;the reserved bits&#160;in the&#160;MXCSR&#160;register.</p>
<p style="position:absolute;top:750px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:751px;left:93px;white-space:nowrap" class="ft03">Bytes&#160;31:28&#160;are&#160;used for&#160;the MXCSR_MASK&#160;value.&#160;FXRSTOR&#160;ignores this&#160;field.</p>
<p style="position:absolute;top:772px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:773px;left:93px;white-space:nowrap" class="ft03">Bytes&#160;159:32&#160;are used&#160;for x87&#160;state.</p>
<p style="position:absolute;top:795px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:796px;left:93px;white-space:nowrap" class="ft03">Bytes&#160;287:160 are used&#160;for the&#160;registers&#160;XMM0–XMM7.&#160;</p>
<p style="position:absolute;top:817px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:818px;left:93px;white-space:nowrap" class="ft09">Bytes&#160;415:288 are used for the&#160;registers XMM8–XMM15.&#160;These&#160;fields&#160;are&#160;used&#160;only&#160;in 64-bit&#160;mode.&#160;Executions&#160;<br/>of FXSAVE&#160;outside 64-bit&#160;mode do not write to these bytes; executions of FXRSTOR outside 64-bit mode do not&#160;<br/>read these bytes&#160;and do not update XMM8–XMM15.</p>
<p style="position:absolute;top:875px;left:68px;white-space:nowrap" class="ft09">If CR4.OSFXSR&#160;=&#160;0,&#160;FXSAVE and FXRSTOR may or may&#160;not&#160;operate&#160;on SSE state;&#160;this behavior is implementation&#160;<br/>dependent. Moreover,&#160;SSE instructions cannot be&#160;used unless&#160;CR4.OSFXSR&#160;=&#160;1.</p>
<p style="position:absolute;top:942px;left:68px;white-space:nowrap" class="ft07">10.5.2&#160;</p>
<p style="position:absolute;top:942px;left:148px;white-space:nowrap" class="ft07">Operation of&#160;FXSAVE</p>
<p style="position:absolute;top:973px;left:68px;white-space:nowrap" class="ft09">The FXSAVE instruction&#160;takes a single memory operand, which is an FXSAVE area. The instruction&#160;stores&#160;x87&#160;state&#160;<br/>and&#160;SSE state to&#160;the FXSAVE&#160;area.&#160;S<a href="o_7281d5ea06a5b67a-251.html">ee Section 10.5.1.1&#160;</a>an<a href="o_7281d5ea06a5b67a-252.html">d&#160;Section 10.5.1.2</a>&#160;for details&#160;regarding&#160;mode-specific&#160;<br/>operation&#160;and operation determined by instruction prefixes.</p>
</div>
</body>
</html>
