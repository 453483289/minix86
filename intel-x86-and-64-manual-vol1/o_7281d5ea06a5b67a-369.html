<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 369</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#0860a8;}
	.ft04{font-size:21px;font-family:Times;color:#0860a8;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page369-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a369.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:775px;white-space:nowrap" class="ft00">Vol. 1&#160;15-5</p>
<p style="position:absolute;top:47px;left:618px;white-space:nowrap" class="ft01">PROGRAMMING WITH INTEL®&#160;AVX-512</p>
<p style="position:absolute;top:463px;left:69px;white-space:nowrap" class="ft010">PREFETCHT1W does&#160;not require&#160;OS&#160;support for XMM/YMM/ZMM/k-reg,&#160;SIMD&#160;FP&#160;exception support.<br/>Procedural Flow of Application Detection of other 512-bit&#160;extensions:<br/>Prior&#160;to using&#160;the Intel AVX-512&#160;Exponential and&#160;Reciprocal&#160;instructions,&#160;the application must identify&#160;that the&#160;<br/>operating system&#160;supports the&#160;XGETBV&#160;instruction&#160;and the ZMM&#160;register state,&#160;in addition to confirming the&#160;<br/>processor’s&#160;support&#160;for&#160;ZMM state management&#160;using XSAVE/XRSTOR and AVX-512&#160;Foundation&#160;instructions.&#160;The&#160;<br/>following simplified sequence&#160;accomplishes both&#160;and&#160;is strongly recommended.<br/>1.&#160;Detect&#160;CPUID.1:ECX.OSXSAVE[bit 27] =&#160;1&#160;(XGETBV&#160;enabled for application use).<br/>2.&#160;Execute XGETBV&#160;and verify that XCR0[7:5] = ‘111b’&#160;(OPMASK&#160;state,&#160;upper 256-bit of ZMM0-ZMM15 and&#160;</p>
<p style="position:absolute;top:622px;left:94px;white-space:nowrap" class="ft08">ZMM16-ZMM31 state are&#160;enabled by&#160;OS) and&#160;that XCR0[2:1] = ‘11b’ (XMM&#160;state&#160;and YMM state are&#160;enabled&#160;<br/>by OS).</p>
<p style="position:absolute;top:663px;left:69px;white-space:nowrap" class="ft010">3.&#160;Verify both&#160;CPUID.0x7.0:EBX.AVX512F[bit 16]&#160;= 1,&#160;and CPUID.0x7.0:EBX.AVX512ER[bit 27]&#160;=&#160;1.<br/>Prior to&#160;using the&#160;Intel&#160;AVX-512 Prefetch instructions,&#160;the application must identify&#160;that the&#160;operating system&#160;<br/>supports the XGETBV instruction&#160;and&#160;the ZMM register state,&#160;in&#160;addition to confirming the processor’s support for&#160;<br/>ZMM state management&#160;using XSAVE/XRSTOR and AVX-512&#160;Foundation instructions. The&#160;following&#160;simplified&#160;<br/>sequence&#160;accomplishes&#160;both&#160;and is&#160;strongly recommended.<br/>1.&#160;Detect&#160;CPUID.1:ECX.OSXSAVE[bit 27] =&#160;1&#160;(XGETBV&#160;enabled for application use).<br/>2.&#160;Execute XGETBV&#160;and verify that XCR0[7:5] = ‘111b’&#160;(OPMASK&#160;state,&#160;upper 256-bit of ZMM0-ZMM15 and&#160;</p>
<p style="position:absolute;top:799px;left:94px;white-space:nowrap" class="ft08">ZMM16-ZMM31 state are&#160;enabled by&#160;OS) and&#160;that XCR0[2:1] = ‘11b’ (XMM&#160;state&#160;and YMM state are&#160;enabled&#160;<br/>by OS).</p>
<p style="position:absolute;top:840px;left:69px;white-space:nowrap" class="ft02">3.&#160;Verify both&#160;CPUID.0x7.0:EBX.AVX512F[bit 16]&#160;= 1,&#160;and CPUID.0x7.0:EBX.AVX512PF[bit 26]&#160;= 1.</p>
<p style="position:absolute;top:895px;left:69px;white-space:nowrap" class="ft03">15.3&#160;</p>
<p style="position:absolute;top:895px;left:148px;white-space:nowrap" class="ft03">DETECTION OF&#160;512-BIT INSTRUCTION GROUPS OF&#160;INTEL</p>
<p style="position:absolute;top:892px;left:673px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:895px;left:682px;white-space:nowrap" class="ft03">&#160;AVX-512&#160;</p>
<p style="position:absolute;top:921px;left:147px;white-space:nowrap" class="ft03">FAMILY</p>
<p style="position:absolute;top:955px;left:69px;white-space:nowrap" class="ft08">In addition to&#160;the Intel&#160;AVX-512 Foundation instructions,&#160;Intel AVX-512&#160;family&#160;provides&#160;several groups of instruc-<br/>tion extensions that can operate in vector lengths of 512/256/128 bits.&#160;Each group&#160;is&#160;enumerated&#160;by a CPUID&#160;leaf&#160;<br/>7 feature&#160;flag and&#160;can be encoded&#160;via&#160;the EVEX.L’L field&#160;to support&#160;operation at&#160;vector&#160;lengths smaller than 512&#160;<br/>bits. These instruction groups are<a href="o_7281d5ea06a5b67a-370.html">&#160;listed in&#160;Table 15-1</a>.</p>
<p style="position:absolute;top:410px;left:190px;white-space:nowrap" class="ft05">Figure&#160;15-3. &#160;Procedural&#160;Flow&#160;for Application&#160;Detection of&#160;512-bit&#160;Instructions</p>
<p style="position:absolute;top:261px;left:341px;white-space:nowrap" class="ft06">Implied HW support&#160;for</p>
<p style="position:absolute;top:344px;left:269px;white-space:nowrap" class="ft00">Check enabled state in</p>
<p style="position:absolute;top:366px;left:265px;white-space:nowrap" class="ft00">XCR0 via XGETBV</p>
<p style="position:absolute;top:348px;left:493px;white-space:nowrap" class="ft00">Check AVX512F&#160;and</p>
<p style="position:absolute;top:361px;left:498px;white-space:nowrap" class="ft00">additional 512-bit&#160;flags</p>
<p style="position:absolute;top:169px;left:260px;white-space:nowrap" class="ft00">Check feature flag</p>
<p style="position:absolute;top:190px;left:260px;white-space:nowrap" class="ft00">CPUID.1H:ECX.OSXSAVE&#160;= 1?&#160;</p>
<p style="position:absolute;top:229px;left:321px;white-space:nowrap" class="ft06">OS provides processor</p>
<p style="position:absolute;top:243px;left:338px;white-space:nowrap" class="ft06">extended state management</p>
<p style="position:absolute;top:361px;left:421px;white-space:nowrap" class="ft00">States</p>
<p style="position:absolute;top:362px;left:647px;white-space:nowrap" class="ft00">ok to use</p>
<p style="position:absolute;top:278px;left:341px;white-space:nowrap" class="ft06">XSAVE, XRSTOR, XGETBV,&#160;XCR0</p>
<p style="position:absolute;top:375px;left:421px;white-space:nowrap" class="ft00">enabled</p>
<p style="position:absolute;top:375px;left:647px;white-space:nowrap" class="ft00">Instructions</p>
<p style="position:absolute;top:260px;left:288px;white-space:nowrap" class="ft06">Yes&#160;</p>
<p style="position:absolute;top:335px;left:413px;white-space:nowrap" class="ft00">YMM,ZMM</p>
<p style="position:absolute;top:322px;left:411px;white-space:nowrap" class="ft00">Opmask,</p>
</div>
</body>
</html>
