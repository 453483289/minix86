<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 285</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:18px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page285-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a285.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:775px;white-space:nowrap" class="ft00">Vol. 1&#160;12-5</p>
<p style="position:absolute;top:47px;left:414px;white-space:nowrap" class="ft01">PROGRAMMING WITH&#160;INTEL®&#160;SSE3,&#160;SSSE3,&#160;INTEL® SSE4 AND INTEL® AESNI</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft08">The&#160;HSUBPD instruction performs&#160;a double-precision&#160;subtraction&#160;on&#160;contiguous data&#160;elements. The first&#160;data&#160;<br/>element of the&#160;result&#160;is obtained by subtracting&#160;the second element of the&#160;first&#160;operand from the&#160;first element&#160;of&#160;<br/>the&#160;first operand;&#160;the second element&#160;by subtracting the second&#160;element of the&#160;second&#160;operand&#160;from the&#160;first&#160;<br/>element of the&#160;second&#160;operand.</p>
<p style="position:absolute;top:172px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:172px;left:95px;white-space:nowrap" class="ft09">HSUBPD&#160;OperandA&#160;OperandB<br/>—&#160;OperandA&#160;(128 bits,&#160;two data elements): 1</p>
<p style="position:absolute;top:203px;left:411px;white-space:nowrap" class="ft04">a</p>
<p style="position:absolute;top:196px;left:417px;white-space:nowrap" class="ft02">, 0</p>
<p style="position:absolute;top:203px;left:435px;white-space:nowrap" class="ft04">a</p>
<p style="position:absolute;top:220px;left:95px;white-space:nowrap" class="ft02">—&#160;OperandB&#160;(128&#160;bits,&#160;two data elements): 1</p>
<p style="position:absolute;top:227px;left:411px;white-space:nowrap" class="ft04">b</p>
<p style="position:absolute;top:220px;left:417px;white-space:nowrap" class="ft02">, 0</p>
<p style="position:absolute;top:227px;left:435px;white-space:nowrap" class="ft04">b</p>
<p style="position:absolute;top:244px;left:95px;white-space:nowrap" class="ft02">—&#160;Result&#160;(Stored in OperandA): 0</p>
<p style="position:absolute;top:251px;left:330px;white-space:nowrap" class="ft04">b</p>
<p style="position:absolute;top:244px;left:336px;white-space:nowrap" class="ft02">-1</p>
<p style="position:absolute;top:251px;left:351px;white-space:nowrap" class="ft04">b</p>
<p style="position:absolute;top:244px;left:358px;white-space:nowrap" class="ft02">, 0</p>
<p style="position:absolute;top:251px;left:375px;white-space:nowrap" class="ft04">a</p>
<p style="position:absolute;top:244px;left:382px;white-space:nowrap" class="ft02">-1</p>
<p style="position:absolute;top:251px;left:396px;white-space:nowrap" class="ft04">a</p>
<p style="position:absolute;top:295px;left:69px;white-space:nowrap" class="ft05">12.3.6&#160;</p>
<p style="position:absolute;top:295px;left:149px;white-space:nowrap" class="ft05">Two Thread Synchronization Instructions</p>
<p style="position:absolute;top:325px;left:69px;white-space:nowrap" class="ft08">The&#160;MONITOR&#160;instruction sets&#160;up an&#160;address range that&#160;is used to&#160;monitor&#160;write-back-stores.&#160;<br/>MWAIT&#160;enables a&#160;logical&#160;processor&#160;to&#160;enter&#160;into an optimized state&#160;while&#160;waiting for a&#160;write-back-store&#160;to the&#160;<br/>address range set up by&#160;MONITOR.&#160;MONITOR and MWAIT&#160;require the use of general purpose registers for its input.&#160;<br/>The registers used by MONITOR&#160;and MWAIT must be initialized&#160;properly;&#160;register&#160;content is&#160;not&#160;modified&#160;by&#160;these&#160;<br/>instructions.</p>
<p style="position:absolute;top:454px;left:69px;white-space:nowrap" class="ft06">12.4&#160;</p>
<p style="position:absolute;top:454px;left:148px;white-space:nowrap" class="ft06">WRITING APPLICATIONS WITH SSE3 EXTENSIONS</p>
<p style="position:absolute;top:490px;left:69px;white-space:nowrap" class="ft08">The&#160;following sections give&#160;guidelines&#160;for writing application programs&#160;and operating-system code that&#160;use SSE3&#160;<br/>instructions.&#160;</p>
<p style="position:absolute;top:557px;left:69px;white-space:nowrap" class="ft05">12.4.1&#160;</p>
<p style="position:absolute;top:557px;left:149px;white-space:nowrap" class="ft05">Guidelines for Using SSE3 Extensions</p>
<p style="position:absolute;top:588px;left:69px;white-space:nowrap" class="ft02">The following&#160;guidelines describe how&#160;to maximize the&#160;benefits&#160;of&#160;using SSE3&#160;extensions:</p>
<p style="position:absolute;top:610px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:610px;left:95px;white-space:nowrap" class="ft09">Check&#160;that&#160;the processor supports SSE3&#160;extensions.<br/>—&#160;Application&#160;may need to&#160;ensure that&#160;the target&#160;operating&#160;system&#160;supports SSE3. (Operating&#160;system&#160;</p>
<p style="position:absolute;top:651px;left:120px;white-space:nowrap" class="ft02">support for the&#160;SSE extensions&#160;implies&#160;sufficient&#160;support for SSE2&#160;extensions&#160;and&#160;SSE3&#160;extensions.)&#160;</p>
<p style="position:absolute;top:673px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:673px;left:95px;white-space:nowrap" class="ft02">Ensure&#160;your&#160;operating system supports MONITOR&#160;and MWAIT.</p>
<p style="position:absolute;top:695px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:696px;left:95px;white-space:nowrap" class="ft010">Employ&#160;the optimization and scheduling techniques&#160;described in the<i>&#160;Intel® 64&#160;and IA-32 Architectures Optimi-<br/>zation Reference Manual&#160;</i><a href="o_7281d5ea06a5b67a-30.html">(see Section 1.4, “Related Literature”).</a></p>
<p style="position:absolute;top:763px;left:69px;white-space:nowrap" class="ft05">12.4.2&#160;</p>
<p style="position:absolute;top:763px;left:149px;white-space:nowrap" class="ft05">Checking for SSE3 Support</p>
<p style="position:absolute;top:793px;left:69px;white-space:nowrap" class="ft08">Before an application&#160;attempts to use the SIMD subset of&#160;SSE3 extensions, the application should follow the steps&#160;<br/>illustrated&#160;<a href="o_7281d5ea06a5b67a-273.html">in Section 11.6.2,&#160;“Checking&#160;for SSE/SSE2&#160;Support.”&#160;</a>Next,&#160;use the&#160;additional step provided below:</p>
<p style="position:absolute;top:832px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:832px;left:95px;white-space:nowrap" class="ft02">Check that the&#160;processor&#160;supports&#160;the SIMD&#160;and&#160;x87 SSE3&#160;extensions (if&#160;CPUID.01H:ECX.SSE3[bit 0]&#160;=&#160;1).&#160;</p>
<p style="position:absolute;top:856px;left:69px;white-space:nowrap" class="ft09">An operating&#160;systems&#160;that provides application support for&#160;SSE, SSE2&#160;also provides sufficient application support&#160;<br/>for&#160;SSE3. To&#160;use FISTTP,&#160;software only needs to&#160;check support for SSE3.<br/>In&#160;the initial&#160;implementation of MONITOR&#160;and MWAIT,&#160;these&#160;two&#160;instructions&#160;are available&#160;to ring 0&#160;and condition-<br/>ally&#160;available at&#160;ring level&#160;greater than&#160;0.&#160;Before&#160;an application attempts to&#160;use the&#160;MONITOR and&#160;MWAIT&#160;instruc-<br/>tions, the&#160;application&#160;should use&#160;the following steps:<br/>1.&#160;Check that the&#160;processor supports MONITOR&#160;and MWAIT.&#160;If CPUID.01H:ECX.MONITOR[bit 3]&#160;=&#160;1,&#160;MONITOR&#160;</p>
<p style="position:absolute;top:970px;left:94px;white-space:nowrap" class="ft02">and&#160;MWAIT are available at ring 0.&#160;</p>
<p style="position:absolute;top:994px;left:69px;white-space:nowrap" class="ft02">2.&#160;Query the&#160;smallest&#160;and largest line&#160;size that&#160;MONITOR uses.&#160;Use&#160;CPUID.05H:EAX.smallest[bits&#160;</p>
<p style="position:absolute;top:1011px;left:94px;white-space:nowrap" class="ft02">15:0];EBX.largest[bits15:0].&#160;Values&#160;are&#160;returned&#160;in bytes&#160;in EAX and&#160;EBX.</p>
<p style="position:absolute;top:1035px;left:69px;white-space:nowrap" class="ft02">3.&#160;Ensure&#160;the memory address&#160;range(s)&#160;that will be&#160;supplied to&#160;MONITOR meets memory&#160;type&#160;requirements.</p>
</div>
</body>
</html>
