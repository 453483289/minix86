<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1975</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:21px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1975-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811975.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:774px;white-space:nowrap" class="ft00">Vol. 2D&#160;6-1</p>
<p style="position:absolute;top:96px;left:714px;white-space:nowrap" class="ft01">CHAPTER 6</p>
<p style="position:absolute;top:120px;left:421px;white-space:nowrap" class="ft01">SAFER MODE EXTENSIONS REFERENCE</p>
<p style="position:absolute;top:196px;left:68px;white-space:nowrap" class="ft02">6.1 OVERVIEW</p>
<p style="position:absolute;top:232px;left:68px;white-space:nowrap" class="ft08">This&#160;chapter&#160;describes&#160;the Safer Mode Extensions (SMX)&#160;for the&#160;Intel 64&#160;and&#160;IA-32&#160;architectures.&#160;Safer Mode&#160;<br/>Extensions (SMX)&#160;provide&#160;a programming interface for system software&#160;to establish a&#160;measured&#160;environment&#160;<br/>within&#160;the platform&#160;to&#160;support&#160;trust&#160;decisions&#160;by end users. The measured&#160;environment includes:</p>
<p style="position:absolute;top:287px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:288px;left:93px;white-space:nowrap" class="ft03">Measured&#160;launch of&#160;a system executive,&#160;referred&#160;to as&#160;a&#160;Measured&#160;Launched Environment (MLE)</p>
<p style="position:absolute;top:285px;left:740px;white-space:nowrap" class="ft05">1</p>
<p style="position:absolute;top:288px;left:747px;white-space:nowrap" class="ft03">. The&#160;system&#160;</p>
<p style="position:absolute;top:304px;left:93px;white-space:nowrap" class="ft03">executive&#160;may&#160;be&#160;based on a&#160;Virtual&#160;Machine&#160;Monitor (VMM), a&#160;measured&#160;VMM&#160;is referred&#160;to as MVMM</p>
<p style="position:absolute;top:302px;left:785px;white-space:nowrap" class="ft05">2</p>
<p style="position:absolute;top:304px;left:791px;white-space:nowrap" class="ft03">.</p>
<p style="position:absolute;top:326px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:327px;left:93px;white-space:nowrap" class="ft03">Mechanisms to&#160;ensure the&#160;above measurement&#160;is protected&#160;and stored in&#160;a secure location in&#160;the platform.</p>
<p style="position:absolute;top:349px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:349px;left:93px;white-space:nowrap" class="ft03">Protection&#160;mechanisms that allow the VMM&#160;to&#160;control attempts to&#160;modify&#160;the VMM.</p>
<p style="position:absolute;top:373px;left:68px;white-space:nowrap" class="ft08">The&#160;measurement&#160;and&#160;protection mechanisms used by a&#160;measured environment are supported&#160;by the capabilities&#160;<br/>of an&#160;Intel</p>
<p style="position:absolute;top:387px;left:137px;white-space:nowrap" class="ft05">®</p>
<p style="position:absolute;top:390px;left:148px;white-space:nowrap" class="ft03">&#160;Trusted Execution Technology&#160;(Intel</p>
<p style="position:absolute;top:387px;left:394px;white-space:nowrap" class="ft05">®</p>
<p style="position:absolute;top:390px;left:404px;white-space:nowrap" class="ft03">&#160;TXT)&#160;platform:&#160;</p>
<p style="position:absolute;top:412px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:412px;left:93px;white-space:nowrap" class="ft03">The SMX are the&#160;processor’s programming interface&#160;in an Intel&#160;TXT&#160;platform.&#160;</p>
<p style="position:absolute;top:434px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:435px;left:93px;white-space:nowrap" class="ft03">The chipset in&#160;an Intel&#160;TXT platform&#160;provides&#160;enforcement&#160;of&#160;the protection mechanisms.</p>
<p style="position:absolute;top:457px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:457px;left:93px;white-space:nowrap" class="ft08">Trusted&#160;Platform Module (TPM)&#160;1.2 in&#160;the platform&#160;provides platform configuration&#160;registers&#160;(PCRs) to&#160;store&#160;<br/>software&#160;measurement&#160;values.</p>
<p style="position:absolute;top:529px;left:68px;white-space:nowrap" class="ft02">6.2 SMX&#160;</p>
<p style="position:absolute;top:529px;left:194px;white-space:nowrap" class="ft02">FUNCTIONALITY</p>
<p style="position:absolute;top:565px;left:68px;white-space:nowrap" class="ft08">SMX functionality&#160;is provided&#160;in an Intel&#160;64&#160;processor&#160;through&#160;the GETSEC&#160;instruction&#160;via&#160;leaf&#160;functions. The&#160;<br/>GETSEC instruction supports multiple&#160;leaf&#160;functions. Leaf functions&#160;are selected&#160;by the&#160;value in&#160;EAX&#160;at the&#160;time&#160;<br/>GETSEC&#160;is executed. Each GETSEC leaf&#160;function&#160;is documented&#160;separately in the&#160;reference pages&#160;with a&#160;unique&#160;<br/>mnemonic (even though&#160;these mnemonics share&#160;the&#160;same&#160;opcode,&#160;0F&#160;37).</p>
<p style="position:absolute;top:665px;left:68px;white-space:nowrap" class="ft06">6.2.1&#160;</p>
<p style="position:absolute;top:665px;left:148px;white-space:nowrap" class="ft06">Detecting and Enabling SMX</p>
<p style="position:absolute;top:696px;left:68px;white-space:nowrap" class="ft08">Software&#160;can detect support for SMX operation using&#160;the CPUID&#160;instruction.&#160;If software&#160;executes&#160;CPUID&#160;with 1&#160;in&#160;<br/>EAX, a value of 1&#160;in bit 6&#160;of&#160;ECX&#160;indicates&#160;support&#160;for&#160;SMX operation (GETSEC is&#160;available), see&#160;CPUID instruction&#160;<br/>for the&#160;layout of feature flags&#160;of&#160;reported by CPUID.01H:ECX.<br/>System&#160;software&#160;enables SMX operation by&#160;setting&#160;CR4.SMXE[Bit 14] = 1&#160;before&#160;attempting to execute&#160;GETSEC.&#160;<br/>Otherwise,&#160;execution of GETSEC&#160;results in&#160;the processor signaling an invalid opcode&#160;exception&#160;(#UD).&#160;<br/>If&#160;the&#160;CPUID&#160;SMX feature&#160;flag&#160;is&#160;clear&#160;(CPUID.01H.ECX[Bit&#160;6] = 0),&#160;attempting&#160;to set&#160;CR4.SMXE[Bit 14] results&#160;in&#160;<br/>a&#160;general protection exception.&#160;<br/>The&#160;IA32_FEATURE_CONTROL MSR (at&#160;address 03AH) provides&#160;feature control&#160;bits that&#160;configure&#160;operation of&#160;<br/>VMX and&#160;SMX.&#160;These&#160;bits are&#160;documented&#160;<a href="o_b5573232dd8f1481-1976.html">in Table&#160;6-1.</a></p>
<p style="position:absolute;top:1017px;left:68px;white-space:nowrap" class="ft010">1.&#160;See&#160;<i>Intel® Trusted&#160;Execution Technology Measured Launched Environment Programming Guide</i>.<br/>2.&#160;An&#160;MVMM&#160;is&#160;sometimes referred&#160;to&#160;as a&#160;measured launched&#160;environment (MLE). See&#160;Intel® Trusted&#160;Execution Technology&#160;Measured&#160;</p>
<p style="position:absolute;top:1054px;left:89px;white-space:nowrap" class="ft03">Launched&#160;Environment Programming&#160;Guide&#160;</p>
</div>
</body>
</html>
