<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1995</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1995-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811995.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">GETSEC[SENTER]—Enter a Measured Environment</p>
<p style="position:absolute;top:47px;left:615px;white-space:nowrap" class="ft01">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:770px;white-space:nowrap" class="ft00">Vol. 2D&#160;6-21</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">GETSEC[SENTER]—Enter a Measured Environment</p>
<p style="position:absolute;top:268px;left:69px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:294px;left:69px;white-space:nowrap" class="ft08">The&#160;GETSEC[SENTER] instruction initiates&#160;the&#160;launch&#160;of&#160;a measured&#160;environment and&#160;places the&#160;initiating&#160;logical&#160;<br/>processor (ILP) into the authenticated code execution mode.&#160;The&#160;SENTER&#160;leaf&#160;of&#160;GETSEC&#160;is&#160;selected&#160;with&#160;EAX&#160;set&#160;<br/>to 4 at execution.&#160;The physical base address of the AC&#160;module to be loaded and authenticated is specified in EBX.&#160;<br/>The&#160;size&#160;of the&#160;module in&#160;bytes is&#160;specified in&#160;ECX.&#160;EDX controls the&#160;level of functionality supported&#160;by&#160;the&#160;<br/>measured environment launch. To&#160;enable the full functionality of the protected environment launch, EDX must be&#160;<br/>initialized to&#160;zero.<br/>The authenticated code base address&#160;and size&#160;parameters&#160;(in&#160;bytes) are&#160;passed to&#160;the GETSEC[SENTER]&#160;instruc-<br/>tion using EBX and&#160;ECX&#160;respectively. The ILP evaluates&#160;the contents of these&#160;registers&#160;according to&#160;the rules for the&#160;<br/>AC module&#160;address in&#160;GETSEC[ENTERACCS]. AC&#160;module execution&#160;follows the&#160;same rules, as&#160;set&#160;by&#160;<br/>GETSEC[ENTERACCS].<br/>The&#160;launching&#160;software must ensure&#160;that the&#160;TPM.ACCESS_0.activeLocality bit is&#160;clear before executing the&#160;<br/>GETSEC[SENTER] instruction.<br/>There&#160;are&#160;restrictions enforced&#160;by the&#160;processor&#160;for execution&#160;of the&#160;GETSEC[SENTER] instruction:&#160;</p>
<p style="position:absolute;top:536px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:537px;left:95px;white-space:nowrap" class="ft06">Execution is&#160;not&#160;allowed unless the&#160;processor&#160;is in protected mode&#160;or IA-32e&#160;mode&#160;with&#160;CPL&#160;=&#160;0 and&#160;<br/>EFLAGS.VM =&#160;0.&#160;</p>
<p style="position:absolute;top:575px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:576px;left:95px;white-space:nowrap" class="ft04">Processor&#160;cache must be available and&#160;not&#160;disabled&#160;using&#160;the CR0.CD&#160;and&#160;NW&#160;bits.&#160;</p>
<p style="position:absolute;top:598px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:598px;left:95px;white-space:nowrap" class="ft06">For&#160;enforcing&#160;consistency of operation with numeric exception&#160;reporting&#160;using Interrupt 16,&#160;CR0.NE must be&#160;<br/>set.&#160;</p>
<p style="position:absolute;top:637px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:637px;left:95px;white-space:nowrap" class="ft06">An&#160;Intel TXT-capable chipset&#160;must be present&#160;as&#160;communicated to&#160;the&#160;processor by sampling of&#160;the&#160;power-on&#160;<br/>configuration&#160;capability field after&#160;reset.&#160;</p>
<p style="position:absolute;top:676px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:676px;left:95px;white-space:nowrap" class="ft06">The&#160;processor&#160;can&#160;not&#160;be in&#160;authenticated code execution mode or&#160;already in&#160;a measured environment (as&#160;<br/>launched by&#160;a&#160;previous&#160;GETSEC[ENTERACCS] or GETSEC[SENTER]&#160;instruction).&#160;</p>
<p style="position:absolute;top:715px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:715px;left:95px;white-space:nowrap" class="ft06">To&#160;avoid potential operability conflicts between modes,&#160;the&#160;processor is&#160;not allowed to execute this instruction&#160;<br/>if&#160;it currently&#160;is in SMM&#160;or VMX&#160;operation.&#160;</p>
<p style="position:absolute;top:754px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:754px;left:95px;white-space:nowrap" class="ft06">To&#160;insure&#160;consistent&#160;handling of SIPI&#160;messages,&#160;the&#160;processor executing the&#160;GETSEC[SENTER] instruction&#160;<br/>must&#160;also be designated the&#160;BSP&#160;(boot-strap processor) as&#160;defined&#160;by&#160;A32_APIC_BASE.BSP&#160;(Bit 8).&#160;</p>
<p style="position:absolute;top:793px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:793px;left:95px;white-space:nowrap" class="ft06">EDX must be initialized to&#160;a setting supportable&#160;by&#160;the&#160;processor.&#160;Unless enumeration&#160;by the&#160;GETSEC[PARAM-<br/>ETERS]&#160;leaf reports otherwise, only a&#160;value&#160;of zero is&#160;supported.</p>
<p style="position:absolute;top:834px;left:69px;white-space:nowrap" class="ft06">Failure&#160;to&#160;abide&#160;by the&#160;above&#160;conditions&#160;results in&#160;the&#160;processor signaling a&#160;general protection&#160;violation.<br/>This instruction leaf starts&#160;the&#160;launch of&#160;a measured&#160;environment by&#160;initiating&#160;a rendezvous sequence&#160;for all&#160;logical&#160;<br/>processors&#160;in the&#160;platform.&#160;The rendezvous sequence&#160;involves the&#160;initiating&#160;logical processor sending&#160;a message&#160;<br/>(by executing GETSEC[SENTER])&#160;and&#160;other responding logical processors (RLPs)&#160;acknowledging the&#160;message,&#160;<br/>thus&#160;synchronizing the RLP(s) with the&#160;ILP.<br/>In response&#160;to a message signaling the completion&#160;of rendezvous,&#160;RLPs&#160;clear the&#160;bootstrap processor indicator flag&#160;<br/>(IA32_APIC_BASE.BSP) and enter&#160;an SENTER&#160;sleep state.&#160;In&#160;this&#160;sleep state,&#160;RLPs enter&#160;an idle processor condi-<br/>tion while waiting to be activated after&#160;a measured environment has&#160;been&#160;established by&#160;the system&#160;executive.&#160;<br/>RLPs&#160;in the SENTER sleep&#160;state can only&#160;be&#160;activated by&#160;the GETSEC&#160;leaf function&#160;WAKEUP in&#160;a measured environ-<br/>ment.<br/>A&#160;successful launch of the&#160;measured&#160;environment results&#160;in&#160;the&#160;initiating logical processor entering&#160;the&#160;authenti-<br/>cated code&#160;execution mode. Prior&#160;to reaching this&#160;point, the&#160;ILP performs the&#160;following&#160;steps internally:&#160;</p>
<p style="position:absolute;top:1060px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:1060px;left:95px;white-space:nowrap" class="ft04">Inhibit processor response to&#160;the external events:&#160;INIT,&#160;A20M, NMI, and SMI.&#160;</p>
<p style="position:absolute;top:137px;left:74px;white-space:nowrap" class="ft04">Opcode</p>
<p style="position:absolute;top:137px;left:183px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:137px;left:310px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:160px;left:74px;white-space:nowrap" class="ft09">0F&#160;37<br/>(EAX=4)</p>
<p style="position:absolute;top:160px;left:183px;white-space:nowrap" class="ft04">GETSEC[SENTER]</p>
<p style="position:absolute;top:160px;left:310px;white-space:nowrap" class="ft010">Launch&#160;a measured&#160;environment.<br/>EBX holds the&#160;SINIT&#160;authenticated code&#160;module&#160;physical base&#160;address.<br/>ECX holds the SINIT authenticated code&#160;module size&#160;(bytes).<br/>EDX controls the level of&#160;functionality&#160;supported&#160;by the measured&#160;environment launch.</p>
</div>
</body>
</html>
