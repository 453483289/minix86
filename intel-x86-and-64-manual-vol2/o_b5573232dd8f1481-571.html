<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 571</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:14px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page571-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481571.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">IMUL—Signed Multiply</p>
<p style="position:absolute;top:47px;left:638px;white-space:nowrap" class="ft01">INSTRUCTION&#160;SET&#160;REFERENCE,&#160;A-L</p>
<p style="position:absolute;top:1103px;left:763px;white-space:nowrap" class="ft00">Vol. 2A&#160;3-443</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft07">When an&#160;immediate&#160;value&#160;is used as&#160;an operand, it&#160;is&#160;sign-extended to&#160;the length of the&#160;destination&#160;operand&#160;<br/>format.<br/>The&#160;CF&#160;and OF&#160;flags are&#160;set when&#160;the signed&#160;integer value of the intermediate product differs&#160;from&#160;the sign&#160;<br/>extended&#160;operand-size-truncated&#160;product,&#160;otherwise&#160;the CF&#160;and&#160;OF&#160;flags are&#160;cleared.<br/>The three forms&#160;of the IMUL instruction&#160;are&#160;similar in that the length of the product is calculated to&#160;twice the length&#160;<br/>of the&#160;operands.&#160;With the one-operand&#160;form,&#160;the product is&#160;stored&#160;exactly in&#160;the&#160;destination. With&#160;the two- and&#160;<br/>three-&#160;operand&#160;forms,&#160;however,&#160;the&#160;result is&#160;truncated&#160;to&#160;the&#160;length&#160;of&#160;the&#160;destination before&#160;it&#160;is stored in the&#160;<br/>destination register. Because&#160;of this&#160;truncation, the CF&#160;or OF&#160;flag should be tested&#160;to ensure that&#160;no significant&#160;bits&#160;<br/>are lost.&#160;<br/>The two-&#160;and&#160;three-operand forms may also be used with&#160;unsigned operands because the lower half&#160;of the product&#160;<br/>is&#160;the&#160;same&#160;regardless&#160;if&#160;the operands&#160;are signed&#160;or&#160;unsigned. The CF&#160;and&#160;OF&#160;flags,&#160;however,&#160;cannot be&#160;used&#160;to&#160;<br/>determine&#160;if the&#160;upper half&#160;of the&#160;result is&#160;non-zero.<br/>In 64-bit&#160;mode,&#160;the instruction’s&#160;default operation size&#160;is&#160;32 bits. Use&#160;of&#160;the&#160;REX.R prefix&#160;permits access to&#160;addi-<br/>tional registers&#160;(R8-R15).&#160;Use of the&#160;REX.W prefix&#160;promotes&#160;operation&#160;to 64 bits.&#160;Use of REX.W&#160;modifies the&#160;three&#160;<br/>forms of the&#160;instruction&#160;as follows.</p>
<p style="position:absolute;top:383px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:384px;left:95px;white-space:nowrap" class="ft07"><b>One-operand&#160;form</b>&#160;—The source&#160;operand (in&#160;a 64-bit general-purpose&#160;register&#160;or memory location) is&#160;<br/>multiplied by the&#160;value in&#160;the&#160;RAX&#160;register and&#160;the&#160;product&#160;is stored in&#160;the RDX:RAX registers.</p>
<p style="position:absolute;top:422px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:423px;left:95px;white-space:nowrap" class="ft07"><b>Two-operand form&#160;</b>—&#160;The source&#160;operand&#160;is promoted to&#160;64&#160;bits&#160;if it&#160;is a&#160;register or&#160;a memory location. The&#160;<br/>destination operand&#160;is promoted to&#160;64&#160;bits.</p>
<p style="position:absolute;top:461px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:462px;left:95px;white-space:nowrap" class="ft07"><b>Three-operand form&#160;</b>—&#160;The&#160;first&#160;source operand&#160;(either&#160;a register or&#160;a memory location) and destination&#160;<br/>operand&#160;are promoted&#160;to&#160;64&#160;bits.&#160;If the&#160;source operand&#160;is&#160;an immediate,&#160;it is&#160;sign extended&#160;to 64 bits.&#160;</p>
<p style="position:absolute;top:512px;left:69px;white-space:nowrap" class="ft05">Operation</p>
<p style="position:absolute;top:543px;left:69px;white-space:nowrap" class="ft02">IF (NumberOfOperands&#160;</p>
<p style="position:absolute;top:541px;left:203px;white-space:nowrap" class="ft06">=&#160;</p>
<p style="position:absolute;top:543px;left:216px;white-space:nowrap" class="ft02">1)</p>
<p style="position:absolute;top:561px;left:89px;white-space:nowrap" class="ft02">THEN&#160;IF (OperandSize&#160;</p>
<p style="position:absolute;top:559px;left:218px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:561px;left:227px;white-space:nowrap" class="ft02">&#160;8)</p>
<p style="position:absolute;top:579px;left:116px;white-space:nowrap" class="ft02">THEN</p>
<p style="position:absolute;top:597px;left:143px;white-space:nowrap" class="ft02">TMP_XP&#160;←&#160;AL&#160;∗&#160;SRC (* Signed&#160;multiplication;&#160;TMP_XP&#160;is&#160;a&#160;signed&#160;integer at&#160;twice the width of the SRC *);&#160;</p>
<p style="position:absolute;top:615px;left:143px;white-space:nowrap" class="ft02">AX&#160;←&#160;TMP_XP[15:0];</p>
<p style="position:absolute;top:633px;left:143px;white-space:nowrap" class="ft02">IF SignExtend(TMP_XP[7:0])&#160;</p>
<p style="position:absolute;top:631px;left:308px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:633px;left:317px;white-space:nowrap" class="ft02">&#160;TMP_XP</p>
<p style="position:absolute;top:651px;left:170px;white-space:nowrap" class="ft02">THEN CF&#160;←&#160;0; OF&#160;←&#160;0;</p>
<p style="position:absolute;top:669px;left:170px;white-space:nowrap" class="ft02">ELSE CF&#160;←&#160;1; OF&#160;←&#160;1; FI;</p>
<p style="position:absolute;top:687px;left:116px;white-space:nowrap" class="ft02">ELSE&#160;IF&#160;OperandSize&#160;</p>
<p style="position:absolute;top:685px;left:236px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:687px;left:245px;white-space:nowrap" class="ft02">&#160;16</p>
<p style="position:absolute;top:705px;left:143px;white-space:nowrap" class="ft02">THEN&#160;</p>
<p style="position:absolute;top:723px;left:170px;white-space:nowrap" class="ft02">TMP_XP&#160;←&#160;AX&#160;∗&#160;SRC (* Signed multiplication;&#160;TMP_XP&#160;is a signed integer at&#160;twice the width of the SRC *)&#160;</p>
<p style="position:absolute;top:741px;left:170px;white-space:nowrap" class="ft02">DX:AX&#160;←&#160;TMP_XP[31:0];</p>
<p style="position:absolute;top:759px;left:170px;white-space:nowrap" class="ft02">IF SignExtend(TMP_XP[15:0])&#160;</p>
<p style="position:absolute;top:757px;left:343px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:759px;left:352px;white-space:nowrap" class="ft02">&#160;TMP_XP</p>
<p style="position:absolute;top:777px;left:197px;white-space:nowrap" class="ft02">THEN CF&#160;←&#160;0; OF&#160;←&#160;0;</p>
<p style="position:absolute;top:795px;left:197px;white-space:nowrap" class="ft02">ELSE CF&#160;←&#160;1; OF&#160;←&#160;1; FI;</p>
<p style="position:absolute;top:813px;left:143px;white-space:nowrap" class="ft02">ELSE IF&#160;OperandSize&#160;</p>
<p style="position:absolute;top:811px;left:263px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:813px;left:272px;white-space:nowrap" class="ft02">&#160;32&#160;</p>
<p style="position:absolute;top:831px;left:170px;white-space:nowrap" class="ft02">THEN&#160;</p>
<p style="position:absolute;top:849px;left:197px;white-space:nowrap" class="ft02">TMP_XP&#160;←&#160;EAX&#160;∗&#160;SRC (* Signed multiplication; TMP_XP is&#160;a signed integer&#160;at twice the width of the SRC*)&#160;</p>
<p style="position:absolute;top:867px;left:197px;white-space:nowrap" class="ft02">EDX:EAX&#160;←&#160;TMP_XP[63:0];</p>
<p style="position:absolute;top:885px;left:197px;white-space:nowrap" class="ft02">IF SignExtend(TMP_XP[31:0])&#160;</p>
<p style="position:absolute;top:883px;left:370px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:885px;left:379px;white-space:nowrap" class="ft02">&#160;TMP_XP</p>
<p style="position:absolute;top:903px;left:224px;white-space:nowrap" class="ft02">THEN CF&#160;←&#160;0; OF&#160;←&#160;0;</p>
<p style="position:absolute;top:921px;left:224px;white-space:nowrap" class="ft02">ELSE CF&#160;←&#160;1;&#160;OF&#160;←&#160;1; FI;</p>
<p style="position:absolute;top:939px;left:170px;white-space:nowrap" class="ft02">ELSE&#160;(* OperandSize&#160;=&#160;64 *)</p>
<p style="position:absolute;top:957px;left:197px;white-space:nowrap" class="ft02">TMP_XP&#160;←&#160;RAX&#160;∗&#160;SRC (* Signed&#160;multiplication; TMP_XP is&#160;a signed&#160;integer at&#160;twice the&#160;width of&#160;the&#160;SRC *)</p>
<p style="position:absolute;top:975px;left:197px;white-space:nowrap" class="ft02">EDX:EAX&#160;←&#160;TMP_XP[127:0];</p>
<p style="position:absolute;top:993px;left:197px;white-space:nowrap" class="ft02">IF SignExtend(TMP_XP[63:0])&#160;</p>
<p style="position:absolute;top:991px;left:370px;white-space:nowrap" class="ft06">=</p>
<p style="position:absolute;top:993px;left:379px;white-space:nowrap" class="ft02">&#160;TMP_XP</p>
<p style="position:absolute;top:1011px;left:224px;white-space:nowrap" class="ft02">THEN CF&#160;←&#160;0; OF&#160;←&#160;0;</p>
<p style="position:absolute;top:1029px;left:224px;white-space:nowrap" class="ft02">ELSE CF&#160;←&#160;1;&#160;OF&#160;←&#160;1; FI;</p>
<p style="position:absolute;top:1047px;left:170px;white-space:nowrap" class="ft02">FI;</p>
</div>
</body>
</html>
