<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 63</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page63-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481063.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:774px;white-space:nowrap" class="ft00">Vol. 2A&#160;2-3</p>
<p style="position:absolute;top:47px;left:706px;white-space:nowrap" class="ft01">INSTRUCTION FORMAT</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">2.1.2 Opcodes</p>
<p style="position:absolute;top:126px;left:69px;white-space:nowrap" class="ft08">A primary opcode&#160;can be 1, 2,&#160;or&#160;3&#160;bytes&#160;in length.&#160;An additional 3-bit opcode field is&#160;sometimes encoded&#160;in the&#160;<br/>ModR/M&#160;byte.&#160;Smaller fields can&#160;be&#160;defined&#160;within&#160;the primary&#160;opcode. Such fields&#160;define&#160;the direction of opera-<br/>tion,&#160;size&#160;of displacements, register&#160;encoding, condition&#160;codes,&#160;or sign extension.&#160;Encoding fields used&#160;by&#160;an&#160;<br/>opcode vary&#160;depending&#160;on the&#160;class of operation.<br/>Two-byte opcode&#160;formats for&#160;general-purpose and SIMD instructions consist&#160;of&#160;one of&#160;the following:&#160;</p>
<p style="position:absolute;top:218px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:219px;left:95px;white-space:nowrap" class="ft03">An&#160;escape&#160;opcode byte&#160;0FH&#160;as the primary&#160;opcode&#160;and&#160;a second opcode byte.</p>
<p style="position:absolute;top:241px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:241px;left:95px;white-space:nowrap" class="ft07">A&#160;mandatory prefix (66H,&#160;F2H,&#160;or F3H), an escape opcode byte, and a second opcode&#160;byte&#160;(same as previous&#160;<br/>bullet).</p>
<p style="position:absolute;top:279px;left:69px;white-space:nowrap" class="ft09">For example,&#160;CVTDQ2PD&#160;consists of the following sequence: F3&#160;0F E6. The&#160;first byte is a mandatory prefix (it is not&#160;<br/>considered as&#160;a repeat&#160;prefix).&#160;<br/>Three-byte opcode formats for general-purpose and&#160;SIMD instructions consist&#160;of&#160;one of the&#160;following:&#160;</p>
<p style="position:absolute;top:338px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:339px;left:95px;white-space:nowrap" class="ft03">An&#160;escape&#160;opcode&#160;byte&#160;0FH as&#160;the&#160;primary&#160;opcode,&#160;plus two additional opcode&#160;bytes.</p>
<p style="position:absolute;top:361px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:361px;left:95px;white-space:nowrap" class="ft07">A mandatory prefix&#160;(66H,&#160;F2H, or&#160;F3H),&#160;an escape opcode&#160;byte,&#160;plus two additional opcode&#160;bytes (same&#160;as&#160;<br/>previous bullet).</p>
<p style="position:absolute;top:399px;left:69px;white-space:nowrap" class="ft08">For&#160;example, PHADDW for XMM&#160;registers consists&#160;of&#160;the following sequence: 66 0F 38 01.&#160;The&#160;first&#160;byte&#160;is the&#160;<br/>mandatory&#160;prefix.<br/>Valid opcode expressions are&#160;defined in&#160;Appendix A&#160;and&#160;Appendix&#160;B.</p>
<p style="position:absolute;top:487px;left:69px;white-space:nowrap" class="ft02">2.1.3&#160;</p>
<p style="position:absolute;top:487px;left:149px;white-space:nowrap" class="ft02">ModR/M and SIB Bytes</p>
<p style="position:absolute;top:514px;left:69px;white-space:nowrap" class="ft07">Many instructions that&#160;refer&#160;to an&#160;operand&#160;in memory have&#160;an addressing-form specifier byte (called the ModR/M&#160;<br/>byte)&#160;following the&#160;primary opcode.&#160;The&#160;ModR/M&#160;byte&#160;contains three fields&#160;of information:</p>
<p style="position:absolute;top:553px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:553px;left:95px;white-space:nowrap" class="ft03">The&#160;<i>mod</i>&#160;field&#160;combines with the r/m&#160;field to form 32&#160;possible values:&#160;eight registers&#160;and&#160;24&#160;addressing modes.</p>
<p style="position:absolute;top:575px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:576px;left:95px;white-space:nowrap" class="ft07">The&#160;<i>reg/opcode</i>&#160;field&#160;specifies either a&#160;register&#160;number&#160;or three more&#160;bits of opcode&#160;information.&#160;The purpose&#160;<br/>of&#160;the reg/opcode field is&#160;specified in&#160;the primary opcode.</p>
<p style="position:absolute;top:614px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:615px;left:95px;white-space:nowrap" class="ft07">The&#160;<i>r/m</i>&#160;field can specify a&#160;register as&#160;an&#160;operand or&#160;it&#160;can be combined&#160;with&#160;the&#160;mod&#160;field&#160;to encode an&#160;<br/>addressing&#160;mode. Sometimes,&#160;certain combinations of&#160;the&#160;<i>mod</i>&#160;field and&#160;the&#160;<i>r/m</i>&#160;field are&#160;used&#160;to express&#160;<br/>opcode information&#160;for some instructions.</p>
<p style="position:absolute;top:669px;left:69px;white-space:nowrap" class="ft07">Certain&#160;encodings of the&#160;ModR/M&#160;byte&#160;require&#160;a second addressing&#160;byte&#160;(the SIB byte).&#160;The&#160;base-plus-index&#160;and&#160;<br/>scale-plus-index forms&#160;of 32-bit addressing require&#160;the&#160;SIB byte. The SIB&#160;byte&#160;includes&#160;the following&#160;fields:</p>
<p style="position:absolute;top:707px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:708px;left:95px;white-space:nowrap" class="ft03">The&#160;<i>scale</i><b>&#160;</b>field specifies&#160;the scale&#160;factor.</p>
<p style="position:absolute;top:730px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:730px;left:95px;white-space:nowrap" class="ft03">The&#160;<i>index</i>&#160;field specifies&#160;the register&#160;number&#160;of the&#160;index register.</p>
<p style="position:absolute;top:752px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:753px;left:95px;white-space:nowrap" class="ft03">The&#160;<i>base</i>&#160;field specifies the&#160;register&#160;number&#160;of&#160;the base register.</p>
<p style="position:absolute;top:774px;left:69px;white-space:nowrap" class="ft03">Se<a href="o_b5573232dd8f1481-64.html">e Section 2.1.5&#160;</a>for&#160;the encodings of the&#160;ModR/M and&#160;SIB&#160;bytes.</p>
<p style="position:absolute;top:824px;left:69px;white-space:nowrap" class="ft02">2.1.4&#160;</p>
<p style="position:absolute;top:824px;left:150px;white-space:nowrap" class="ft02">Displacement and Immediate Bytes</p>
<p style="position:absolute;top:852px;left:69px;white-space:nowrap" class="ft07">Some&#160;addressing forms include&#160;a displacement&#160;immediately&#160;following the&#160;ModR/M byte&#160;(or&#160;the&#160;SIB&#160;byte&#160;if&#160;one is&#160;<br/>present).&#160;If&#160;a displacement&#160;is required, it&#160;can be&#160;1, 2,&#160;or 4&#160;bytes.<br/>If an instruction specifies&#160;an&#160;immediate&#160;operand,&#160;the operand always follows&#160;any displacement&#160;bytes. An&#160;imme-<br/>diate&#160;operand&#160;can be&#160;1,&#160;2 or&#160;4&#160;bytes.</p>
</div>
</body>
</html>
