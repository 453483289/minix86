<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1233</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1233-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811233.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">RET‚ÄîReturn from Procedure</p>
<p style="position:absolute;top:47px;left:635px;white-space:nowrap" class="ft01">INSTRUCTION SET REFERENCE,&#160;M-U</p>
<p style="position:absolute;top:1103px;left:763px;white-space:nowrap" class="ft00">Vol. 2B&#160;4-553</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">RET‚ÄîReturn from Procedure</p>
<p style="position:absolute;top:317px;left:354px;white-space:nowrap" class="ft03">Instruction Operand&#160;Encoding</p>
<p style="position:absolute;top:428px;left:69px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:454px;left:69px;white-space:nowrap" class="ft09">Transfers program control to a return address located on&#160;the top&#160;of the stack.&#160;The address&#160;is&#160;usually&#160;placed&#160;on the&#160;<br/>stack by a&#160;CALL instruction,&#160;and the&#160;return is&#160;made&#160;to&#160;the instruction that&#160;follows&#160;the&#160;CALL instruction.<br/>The optional source operand specifies the number of stack bytes to be released after the return address is popped;&#160;<br/>the default is&#160;none. This&#160;operand can be&#160;used to release&#160;parameters&#160;from the stack that were passed to the called&#160;<br/>procedure and&#160;are no&#160;longer&#160;needed.&#160;It&#160;must&#160;be&#160;used&#160;when&#160;the CALL instruction&#160;used&#160;to switch&#160;to&#160;a new procedure&#160;<br/>uses&#160;a call gate with a&#160;non-zero&#160;word&#160;count&#160;to access the&#160;new&#160;procedure.&#160;Here,&#160;the source&#160;operand for the&#160;RET&#160;<br/>instruction&#160;must specify the&#160;same number&#160;of&#160;bytes as&#160;is&#160;specified in the&#160;word count field of the&#160;call gate.<br/>The&#160;RET&#160;instruction can be&#160;used&#160;to&#160;execute&#160;three&#160;different types of&#160;returns:</p>
<p style="position:absolute;top:607px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:607px;left:95px;white-space:nowrap" class="ft08"><b>Near&#160;return</b>&#160;‚Äî A return to a calling procedure within&#160;the current code&#160;segment (the&#160;segment currently pointed&#160;<br/>to by the&#160;CS register), sometimes&#160;referred&#160;to as&#160;an intrasegment&#160;return.</p>
<p style="position:absolute;top:646px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:646px;left:95px;white-space:nowrap" class="ft08"><b>Far return</b>&#160;‚Äî&#160;A return&#160;to&#160;a calling procedure&#160;located&#160;in a&#160;different segment than&#160;the&#160;current code segment,&#160;<br/>sometimes&#160;referred to as&#160;an intersegment return.</p>
<p style="position:absolute;top:685px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:685px;left:95px;white-space:nowrap" class="ft08"><b>Inter-privilege-level&#160;far&#160;return</b>&#160;‚Äî&#160;A far&#160;return&#160;to a&#160;different privilege level&#160;than&#160;that of the&#160;currently&#160;<br/>executing program or procedure.</p>
<p style="position:absolute;top:726px;left:69px;white-space:nowrap" class="ft08">The inter-privilege-level return&#160;type&#160;can only be&#160;executed&#160;in protected mode.&#160;See the&#160;section&#160;titled&#160;‚ÄúCalling Proce-<br/>dures Using&#160;Call&#160;and RET‚Äù&#160;<a href="˛ˇ">in&#160;Chapter 6 o</a>f&#160;the<a href="˛ˇ">&#160;<i>Intel¬Æ 64 and&#160;IA-32 Architectures Software&#160;Developer‚Äôs&#160;Manual,&#160;<br/>Volume 1</i>,&#160;</a>for&#160;detailed information on near, far,&#160;and inter-privilege-level&#160;returns.<br/>When executing a near return, the processor pops&#160;the&#160;return&#160;instruction&#160;pointer (offset) from&#160;the top of the stack&#160;<br/>into the&#160;EIP register&#160;and begins program execution at&#160;the&#160;new instruction pointer.&#160;The&#160;CS&#160;register&#160;is&#160;unchanged.&#160;<br/>When executing a far return,&#160;the processor&#160;pops the&#160;return&#160;instruction pointer&#160;from&#160;the&#160;top&#160;of&#160;the stack into&#160;the&#160;EIP&#160;<br/>register, then&#160;pops&#160;the segment selector from&#160;the top&#160;of&#160;the&#160;stack into the&#160;CS register.&#160;The processor then&#160;begins&#160;<br/>program&#160;execution in&#160;the new code&#160;segment at&#160;the new&#160;instruction&#160;pointer.<br/>The mechanics of&#160;an&#160;inter-privilege-level&#160;far return are similar&#160;to&#160;an intersegment&#160;return, except&#160;that the&#160;<br/>processor&#160;examines&#160;the privilege levels&#160;and access rights&#160;of the&#160;code&#160;and stack segments being returned&#160;to deter-<br/>mine&#160;if the control transfer is&#160;allowed to be made. The&#160;DS,&#160;ES, FS,&#160;and&#160;GS segment registers are&#160;cleared&#160;by&#160;the RET&#160;<br/>instruction during an&#160;inter-privilege-level&#160;return if they&#160;refer to&#160;segments that are not&#160;allowed to&#160;be&#160;accessed at the&#160;<br/>new&#160;privilege level. Since a&#160;stack switch also&#160;occurs on an&#160;inter-privilege&#160;level return, the&#160;ESP&#160;and SS&#160;registers are&#160;<br/>loaded&#160;from the&#160;stack.&#160;<br/>If parameters are&#160;passed&#160;to the&#160;called&#160;procedure during&#160;an&#160;inter-privilege level&#160;call, the&#160;optional source&#160;operand&#160;<br/>must be used with the RET instruction to release the parameters on&#160;the return. Here,&#160;the parameters are released&#160;<br/>both&#160;from&#160;the called procedure‚Äôs stack&#160;and the&#160;calling&#160;procedure‚Äôs stack&#160;(that is, the&#160;stack being returned to).<br/>In 64-bit&#160;mode,&#160;the default operation size&#160;of&#160;this instruction&#160;is the&#160;stack-address size, i.e.&#160;64 bits.&#160;This applies&#160;to&#160;<br/>near returns, not far&#160;returns;&#160;the&#160;default&#160;operation size&#160;of far returns&#160;is 32 bits.</p>
<p style="position:absolute;top:123px;left:76px;white-space:nowrap" class="ft04">Opcode*</p>
<p style="position:absolute;top:123px;left:222px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:388px;white-space:nowrap" class="ft04">Op/</p>
<p style="position:absolute;top:137px;left:388px;white-space:nowrap" class="ft04">En</p>
<p style="position:absolute;top:123px;left:425px;white-space:nowrap" class="ft04">64-Bit&#160;</p>
<p style="position:absolute;top:137px;left:425px;white-space:nowrap" class="ft04">Mode</p>
<p style="position:absolute;top:123px;left:497px;white-space:nowrap" class="ft04">Compat/</p>
<p style="position:absolute;top:137px;left:497px;white-space:nowrap" class="ft04">Leg Mode</p>
<p style="position:absolute;top:123px;left:567px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:160px;left:76px;white-space:nowrap" class="ft04">C3</p>
<p style="position:absolute;top:160px;left:222px;white-space:nowrap" class="ft04">RET</p>
<p style="position:absolute;top:160px;left:388px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:160px;left:425px;white-space:nowrap" class="ft04">Valid&#160;Valid</p>
<p style="position:absolute;top:160px;left:567px;white-space:nowrap" class="ft04">Near&#160;</p>
<p style="position:absolute;top:160px;left:598px;white-space:nowrap" class="ft04">return&#160;to&#160;calling&#160;procedure.</p>
<p style="position:absolute;top:182px;left:76px;white-space:nowrap" class="ft04">CB</p>
<p style="position:absolute;top:182px;left:222px;white-space:nowrap" class="ft04">RET</p>
<p style="position:absolute;top:182px;left:388px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:182px;left:425px;white-space:nowrap" class="ft04">Valid&#160;</p>
<p style="position:absolute;top:182px;left:497px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:182px;left:567px;white-space:nowrap" class="ft04">Far return to&#160;calling procedure.</p>
<p style="position:absolute;top:205px;left:76px;white-space:nowrap" class="ft04">C2&#160;<i>iw</i></p>
<p style="position:absolute;top:205px;left:222px;white-space:nowrap" class="ft04">RET&#160;<i>imm16</i></p>
<p style="position:absolute;top:205px;left:388px;white-space:nowrap" class="ft04">I</p>
<p style="position:absolute;top:205px;left:425px;white-space:nowrap" class="ft04">Valid&#160;</p>
<p style="position:absolute;top:205px;left:497px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:205px;left:567px;white-space:nowrap" class="ft04">Near return&#160;to&#160;calling&#160;procedure and&#160;pop&#160;</p>
<p style="position:absolute;top:222px;left:567px;white-space:nowrap" class="ft07"><i>imm16</i>&#160;bytes&#160;from stack.</p>
<p style="position:absolute;top:244px;left:76px;white-space:nowrap" class="ft04">CA&#160;<i>iw</i></p>
<p style="position:absolute;top:244px;left:222px;white-space:nowrap" class="ft04">RET&#160;<i>imm16</i></p>
<p style="position:absolute;top:244px;left:388px;white-space:nowrap" class="ft04">I</p>
<p style="position:absolute;top:244px;left:425px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:244px;left:497px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:244px;left:567px;white-space:nowrap" class="ft04">Far&#160;&#160;return&#160;&#160;to&#160;&#160;calling&#160;procedure and pop<i>&#160;imm16</i>&#160;</p>
<p style="position:absolute;top:261px;left:567px;white-space:nowrap" class="ft04">bytes&#160;from&#160;stack.</p>
<p style="position:absolute;top:340px;left:86px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:340px;left:192px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:340px;left:363px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:340px;left:537px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:340px;left:716px;white-space:nowrap" class="ft04">Operand&#160;4</p>
<p style="position:absolute;top:364px;left:95px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:364px;left:213px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:364px;left:384px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:364px;left:558px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:364px;left:737px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:388px;left:102px;white-space:nowrap" class="ft04">I</p>
<p style="position:absolute;top:388px;left:202px;white-space:nowrap" class="ft04">imm16</p>
<p style="position:absolute;top:388px;left:384px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:388px;left:558px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:388px;left:737px;white-space:nowrap" class="ft04">NA</p>
</div>
</body>
</html>
