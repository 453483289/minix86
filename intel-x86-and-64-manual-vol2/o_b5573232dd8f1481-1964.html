<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1964</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
	.ft012{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1964-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811964.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:551px;white-space:nowrap" class="ft00">XSAVEOPT‚ÄîSave Processor Extended States Optimized</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INSTRUCTION SET REFERENCE, V-Z</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">5-578&#160;Vol. 2C</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">XSAVEOPT‚ÄîSave Processor Extended States Optimized</p>
<p style="position:absolute;top:296px;left:353px;white-space:nowrap" class="ft03">Instruction&#160;Operand&#160;Encoding</p>
<p style="position:absolute;top:383px;left:68px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:409px;left:68px;white-space:nowrap" class="ft08">Performs a&#160;full&#160;or partial save&#160;of processor state&#160;components to&#160;the XSAVE&#160;area located at&#160;the&#160;memory address&#160;<br/>specified&#160;by the&#160;destination&#160;operand. The implicit EDX:EAX&#160;register&#160;pair&#160;specifies a&#160;64-bit instruction mask.&#160;The&#160;<br/>specific&#160;state&#160;components saved correspond to&#160;the bits set in the requested-feature&#160;bitmap&#160;(RFBM), which&#160;is the&#160;<br/>logical-AND of EDX:EAX&#160;and XCR0.<br/>The format of the&#160;XSAVE area&#160;is&#160;detaile<a href="˛ˇ">d in&#160;Section&#160;13.4, ‚ÄúXSAVE Area,‚Äù&#160;of&#160;<i>Intel¬Æ 64&#160;and IA-32&#160;Architectures&#160;Soft-<br/>ware&#160;Developer‚Äôs Manual, Volume&#160;1</i></a>.<br/><a href="˛ˇ">Section&#160;13.9, ‚ÄúOperation of XSAVEOPT,‚Äù&#160;of&#160;<i>Intel¬Æ 64&#160;and&#160;IA-32&#160;Architectures Software&#160;Developer‚Äôs&#160;Manual,&#160;<br/>Volume 1</i>&#160;pro</a>vides&#160;a&#160;detailed description&#160;of&#160;the operation&#160;of&#160;the&#160;XSAVEOPT instruction.&#160;The following items&#160;provide&#160;<br/>a high-level&#160;outline:</p>
<p style="position:absolute;top:578px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:579px;left:93px;white-space:nowrap" class="ft08">Execution&#160;of&#160;XSAVEOPT&#160;is&#160;similar&#160;to&#160;that&#160;of&#160;XSAVE.&#160;XSAVEOPT&#160;differs&#160;from&#160;XSAVE&#160;in&#160;that&#160;it&#160;uses&#160;compaction&#160;<br/>and&#160;that&#160;it may&#160;use the init&#160;and modified&#160;optimizations.&#160;The&#160;performance of XSAVEOPT&#160;will&#160;be&#160;equal to or&#160;better&#160;<br/>than&#160;that of XSAVE.</p>
<p style="position:absolute;top:634px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:634px;left:93px;white-space:nowrap" class="ft04">XSAVEOPT saves state component&#160;<i>i</i>&#160;only if&#160;RFBM[<i>i</i>]&#160;=&#160;&#160;1&#160;&#160;and&#160;&#160;XINUSE[<i>i</i>]&#160;=&#160;&#160;1.</p>
<p style="position:absolute;top:632px;left:597px;white-space:nowrap" class="ft07">1</p>
<p style="position:absolute;top:634px;left:604px;white-space:nowrap" class="ft04">&#160;(XINUSE&#160;is a&#160;bitmap by which the&#160;</p>
<p style="position:absolute;top:651px;left:93px;white-space:nowrap" class="ft08">processor tracks&#160;the status&#160;of&#160;various&#160;state&#160;components.&#160;See<a href="˛ˇ">&#160;Section 13.6, ‚ÄúProcessor Tracking of XSAVE-<br/>Managed State.‚Äù) Ev</a>en&#160;if both&#160;bits&#160;are 1,&#160;XSAVEOPT may optimize&#160;and not&#160;save&#160;state component&#160;<i>i</i>&#160;if (1)&#160;state&#160;<br/>component&#160;<i>i</i>&#160;has&#160;not been&#160;modified since&#160;the last execution&#160;of&#160;XRTOR or&#160;XRSTORS; and&#160;(2)&#160;this execution&#160;of&#160;<br/>XSAVES&#160;corresponds to that&#160;last execution&#160;of XRTOR or&#160;XRSTORS as&#160;determined by the&#160;internal&#160;value&#160;<br/>XRSTOR_INFO (see&#160;the Operation section&#160;below).</p>
<p style="position:absolute;top:739px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:739px;left:93px;white-space:nowrap" class="ft08">XSAVEOPT&#160;does&#160;not modify bytes 511:464 of the legacy region of the XSAVE&#160;area (see<a href="˛ˇ">&#160;Section&#160;13.4.1, ‚ÄúLegacy&#160;<br/>Region of&#160;an&#160;XSAVE&#160;Area‚Äù).</a></p>
<p style="position:absolute;top:778px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:778px;left:93px;white-space:nowrap" class="ft08">XSAVEOPT&#160;reads&#160;the XSTATE_BV&#160;field&#160;of&#160;the XSAVE header (see<a href="˛ˇ">&#160;Section 13.4.2,&#160;‚ÄúXSAVE Header‚Äù)&#160;</a>and writes a&#160;<br/>modified value back&#160;to memory as&#160;follows.&#160;If RFBM[<i>i</i>]&#160;=&#160;1,&#160;XSAVEOPT&#160;writes&#160;XSTATE_BV[<i>i</i>]&#160;with the&#160;value of&#160;<br/>XINUSE[<i>i</i>]. If&#160;RFBM[<i>i</i>]&#160;=&#160;0, XSAVEOPT writes XSTATE_BV[<i>i</i>] with the&#160;value that&#160;it read from memory&#160;(it does&#160;<br/>not modify the bit). XSAVEOPT does not write to any part of the XSAVE header other than the XSTATE_BV&#160;field.</p>
<p style="position:absolute;top:850px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:850px;left:93px;white-space:nowrap" class="ft08">XSAVEOPT&#160;always uses&#160;the standard format of the&#160;extended&#160;region of the&#160;XSAVE area&#160;<a href="˛ˇ">(see&#160;Section&#160;13.4.3,&#160;<br/>‚ÄúExtended Region&#160;of&#160;an XSAVE&#160;Area‚Äù)</a>.</p>
<p style="position:absolute;top:891px;left:68px;white-space:nowrap" class="ft08">Use of a&#160;destination&#160;operand not aligned&#160;to 64-byte&#160;boundary&#160;(in either 64-bit&#160;or&#160;32-bit modes) will result&#160;in a&#160;<br/>general-protection&#160;(#GP) exception.&#160;In 64-bit&#160;mode,&#160;the upper 32 bits of RDX and&#160;RAX are ignored.</p>
<p style="position:absolute;top:944px;left:68px;white-space:nowrap" class="ft03">Operation</p>
<p style="position:absolute;top:976px;left:68px;white-space:nowrap" class="ft04">RFBM&#160;‚Üê&#160;XCR0 AND EDX:EAX;&#160;/* bitwise logical AND */</p>
<p style="position:absolute;top:994px;left:68px;white-space:nowrap" class="ft04">OLD_BV&#160;‚Üê&#160;XSTATE_BV&#160;field from XSAVE header;</p>
<p style="position:absolute;top:123px;left:73px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:137px;left:73px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:379px;white-space:nowrap" class="ft04">Op/&#160;</p>
<p style="position:absolute;top:137px;left:379px;white-space:nowrap" class="ft04">En</p>
<p style="position:absolute;top:123px;left:416px;white-space:nowrap" class="ft04">64/32 bit&#160;</p>
<p style="position:absolute;top:137px;left:416px;white-space:nowrap" class="ft04">Mode&#160;</p>
<p style="position:absolute;top:153px;left:416px;white-space:nowrap" class="ft04">Support</p>
<p style="position:absolute;top:123px;left:489px;white-space:nowrap" class="ft04">CPUID&#160;</p>
<p style="position:absolute;top:137px;left:489px;white-space:nowrap" class="ft04">Feature&#160;</p>
<p style="position:absolute;top:153px;left:489px;white-space:nowrap" class="ft04">Flag</p>
<p style="position:absolute;top:123px;left:561px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:175px;left:73px;white-space:nowrap" class="ft011">0F AE&#160;/6<br/>XSAVEOPT&#160;<i>mem</i></p>
<p style="position:absolute;top:175px;left:379px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:175px;left:416px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:175px;left:489px;white-space:nowrap" class="ft04">XSAVEOPT&#160;Save&#160;state components specified by&#160;EDX:EAX&#160;</p>
<p style="position:absolute;top:191px;left:561px;white-space:nowrap" class="ft04">to&#160;<i>mem</i>, optimizing if possible.</p>
<p style="position:absolute;top:218px;left:73px;white-space:nowrap" class="ft012">REX.W +&#160;0F&#160;AE&#160;/6<br/>XSAVEOPT64&#160;<i>mem</i></p>
<p style="position:absolute;top:218px;left:379px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:218px;left:416px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:218px;left:489px;white-space:nowrap" class="ft04">XSAVEOPT&#160;Save&#160;state components specified by&#160;EDX:EAX&#160;</p>
<p style="position:absolute;top:235px;left:561px;white-space:nowrap" class="ft04">to&#160;<i>mem</i>, optimizing if possible.</p>
<p style="position:absolute;top:319px;left:88px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:319px;left:202px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:319px;left:376px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:319px;left:546px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:319px;left:719px;white-space:nowrap" class="ft04">Operand&#160;4</p>
<p style="position:absolute;top:343px;left:101px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:343px;left:189px;white-space:nowrap" class="ft04">ModRM:r/m (w)</p>
<p style="position:absolute;top:343px;left:397px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:343px;left:568px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:343px;left:740px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:1038px;left:68px;white-space:nowrap" class="ft04">1.&#160;There&#160;is&#160;an&#160;exception&#160;made&#160;for MXCSR and MXCSR_MASK, which&#160;belong&#160;to&#160;state component 1 ‚Äî&#160;SSE. XSAVEOPT always saves&#160;</p>
<p style="position:absolute;top:1054px;left:89px;white-space:nowrap" class="ft04">these to memory if&#160;RFBM[1]&#160;=&#160;1 or&#160;RFBM[2]&#160;=&#160;1, regardless of&#160;the value of&#160;XINUSE.</p>
</div>
</body>
</html>
