<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 77</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page77-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce077.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;2-15</p>
<p style="position:absolute;top:47px;left:634px;white-space:nowrap" class="ft01">SYSTEM ARCHITECTURE OVERVIEW</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">WP</p>
<p style="position:absolute;top:100px;left:123px;white-space:nowrap" class="ft06"><b>Write Protect&#160;(bit 16&#160;of&#160;CR0)</b>&#160;‚Äî When&#160;set, inhibits&#160;supervisor-level&#160;procedures from&#160;writing into&#160;read-<br/>only pages;&#160;when clear,&#160;allows&#160;supervisor-level procedures to&#160;write into read-only pages (regardless of the&#160;<br/>U/S bit setting; se<a href="o_fe12b1e2a880e0ce-108.html">e Section 4.1.3&#160;</a><a href="o_fe12b1e2a880e0ce-132.html">and Section 4.6). Th</a>is&#160;flag&#160;facilitates implementation of the&#160;copy-on-<br/>write method&#160;of&#160;creating&#160;a new process (forking) used&#160;by operating&#160;systems such as&#160;UNIX.</p>
<p style="position:absolute;top:174px;left:69px;white-space:nowrap" class="ft02">NE</p>
<p style="position:absolute;top:174px;left:123px;white-space:nowrap" class="ft08"><b>Numeric Error (bit&#160;5&#160;of&#160;CR0)</b>&#160;‚Äî&#160;Enables the&#160;native&#160;(internal) mechanism for reporting x87 FPU&#160;errors&#160;<br/>when set; enables the&#160;PC-style&#160;x87&#160;FPU&#160;error&#160;reporting mechanism when clear.&#160;When&#160;the NE&#160;flag is&#160;clear&#160;<br/>and the IGNNE# input is asserted, x87 FPU errors are&#160;ignored.&#160;When the NE flag is clear and the IGNNE#&#160;<br/>input is deasserted,&#160;an unmasked x87 FPU error causes&#160;the processor to assert the FERR#&#160;pin&#160;to generate&#160;<br/>an external&#160;interrupt and to stop instruction execution&#160;immediately before executing the&#160;next waiting&#160;<br/>floating-point instruction or&#160;WAIT/FWAIT instruction.&#160;<br/>The FERR# pin is intended to&#160;drive&#160;an&#160;input to an external interrupt controller (the FERR# pin emulates the&#160;<br/>ERROR#&#160;pin of the Intel&#160;287 and&#160;Intel&#160;387 DX&#160;math&#160;coprocessors). The NE flag,&#160;IGNNE#&#160;pin,&#160;and FERR#&#160;<br/>pin are&#160;used&#160;with external logic to implement PC-style error reporting. Using FERR#&#160;and IGNNE#&#160;to handle&#160;<br/>floating-point exceptions is deprecated&#160;by modern&#160;operating systems; this non-native approach also limits&#160;<br/>newer processors to&#160;operate&#160;with one logical processor active.<br/>See&#160;<a href="˛ˇ">also: Section 8.7, ‚ÄúHandling x87&#160;FPU&#160;Exceptions in&#160;Software‚Äù</a>&#160;in<a href="˛ˇ">&#160;Chapter 8,&#160;‚ÄúProgramming&#160;with the&#160;x87&#160;<br/>FPU,‚Äù&#160;and Appendix A,&#160;‚ÄúEFLAGS&#160;Cross-Reference,‚Äù in the&#160;<i>Intel¬Æ 64&#160;and IA-32 Architectures Software&#160;<br/>Developer‚Äôs&#160;Manual, Volume&#160;1</i>.</a></p>
<p style="position:absolute;top:427px;left:69px;white-space:nowrap" class="ft02">ET</p>
<p style="position:absolute;top:427px;left:123px;white-space:nowrap" class="ft06"><b>Extension&#160;Type (bit&#160;4 of&#160;CR0)</b>&#160;‚Äî Reserved&#160;in the Pentium 4,&#160;Intel Xeon,&#160;P6 family,&#160;and&#160;Pentium proces-<br/>sors. In&#160;the Pentium 4, Intel Xeon, and&#160;P6&#160;family&#160;processors,&#160;this flag&#160;is hardcoded&#160;to 1.&#160;In&#160;the Intel386&#160;<br/>and Intel486&#160;processors,&#160;this&#160;flag indicates&#160;support&#160;of Intel&#160;387 DX&#160;math coprocessor instructions when&#160;<br/>set.</p>
<p style="position:absolute;top:501px;left:69px;white-space:nowrap" class="ft02">TS</p>
<p style="position:absolute;top:501px;left:123px;white-space:nowrap" class="ft06"><b>Task Switched (bit 3 of&#160;CR0)</b>&#160;‚Äî&#160;Allows the&#160;saving&#160;of the&#160;x87 FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;<br/>context on a task switch to be delayed until an&#160;x87&#160;FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;instruction is&#160;<br/>actually executed by&#160;the new task.&#160;The&#160;processor&#160;sets&#160;this flag on&#160;every task switch&#160;and tests&#160;it when&#160;<br/>executing x87&#160;FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;instructions.</p>
<p style="position:absolute;top:576px;left:120px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:574px;left:146px;white-space:nowrap" class="ft02">If&#160;the TS&#160;flag is&#160;set and&#160;the&#160;EM&#160;flag&#160;(bit 2 of CR0)&#160;is clear,&#160;a&#160;device-not-available exception&#160;(#NM) is&#160;</p>
<p style="position:absolute;top:591px;left:145px;white-space:nowrap" class="ft06">raised&#160;prior to the execution&#160;of&#160;any x87&#160;FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;instruction;&#160;with the&#160;<br/>exception of PAUSE,&#160;PREFETCH<i>h</i>, SFENCE, LFENCE, MFENCE,&#160;MOVNTI, CLFLUSH,&#160;CRC32,&#160;and POPCNT.&#160;<br/>See the&#160;paragraph&#160;below for&#160;the&#160;special case&#160;of the&#160;WAIT/FWAIT instructions.</p>
<p style="position:absolute;top:649px;left:120px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:648px;left:146px;white-space:nowrap" class="ft02">If&#160;the TS flag is set and the MP flag (bit 1 of&#160;CR0)&#160;and EM flag are clear,&#160;an #NM&#160;exception is not&#160;raised&#160;</p>
<p style="position:absolute;top:664px;left:145px;white-space:nowrap" class="ft02">prior&#160;to the&#160;execution of an&#160;x87 FPU&#160;WAIT/FWAIT&#160;instruction.</p>
<p style="position:absolute;top:690px;left:120px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:688px;left:146px;white-space:nowrap" class="ft02">If the&#160;EM&#160;flag&#160;is set,&#160;the&#160;setting&#160;of the&#160;TS&#160;flag&#160;has&#160;no effect&#160;on&#160;the execution of x87&#160;</p>
<p style="position:absolute;top:705px;left:145px;white-space:nowrap" class="ft02">FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;instructions.</p>
<p style="position:absolute;top:729px;left:123px;white-space:nowrap" class="ft06"><a href="o_fe12b1e2a880e0ce-78.html">Table&#160;2-2&#160;</a>shows&#160;the&#160;actions taken when the&#160;processor&#160;encounters an x87&#160;FPU&#160;instruction&#160;based on the&#160;<br/>settings of&#160;the TS, EM, and&#160;MP&#160;flags. Tabl<a href="o_fe12b1e2a880e0ce-449.html">e 12-1 an</a><a href="o_fe12b1e2a880e0ce-457.html">d 13-1&#160;</a>show&#160;the actions taken when the&#160;processor&#160;<br/>encounters&#160;an MMX/SSE/SSE2/SSE3/SSSE3/SSE4 instruction.</p>
<p style="position:absolute;top:795px;left:123px;white-space:nowrap" class="ft06">The processor does not automatically save&#160;the&#160;context of the&#160;x87 FPU, XMM,&#160;and&#160;MXCSR&#160;registers&#160;on a&#160;<br/>task switch.&#160;Instead, it&#160;sets the&#160;TS&#160;flag, which causes&#160;the processor to&#160;raise&#160;an #NM&#160;exception&#160;whenever&#160;<br/>it encounters an&#160;x87 FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4 instruction in the&#160;instruction&#160;stream for the&#160;<br/>new task&#160;(with&#160;the exception of&#160;the instructions listed above).&#160;<br/>The fault handler&#160;for the&#160;#NM&#160;exception&#160;can&#160;then be used to&#160;clear the&#160;TS flag&#160;(with&#160;the CLTS&#160;instruction)&#160;<br/>and save the&#160;context of the&#160;x87&#160;FPU,&#160;XMM,&#160;and MXCSR registers. If the&#160;task&#160;never encounters&#160;an x87&#160;<br/>FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;instruction,&#160;the&#160;x87&#160;FPU/MMX/SSE/SSE2/SSE3/SSSE3/SSE4&#160;<br/>context&#160;is never saved.</p>
</div>
</body>
</html>
