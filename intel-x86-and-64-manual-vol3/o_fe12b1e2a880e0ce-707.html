<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 707</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page707-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce707.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-71</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft07">Two of the TSX performance monitoring ev<a href="o_fe12b1e2a880e0ce-786.html">ents in Table&#160;19-8&#160;</a>also support&#160;using PEBS facility to&#160;capture additional&#160;<br/>information. They&#160;are:</p>
<p style="position:absolute;top:139px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:139px;left:95px;white-space:nowrap" class="ft02">HLE_RETIRED.ABORT ED (encoding C8H&#160;mask&#160;04H),</p>
<p style="position:absolute;top:161px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:162px;left:95px;white-space:nowrap" class="ft02">RTM_RETIRED.ABORTED (encoding C9H mask 04H).</p>
<p style="position:absolute;top:186px;left:69px;white-space:nowrap" class="ft07">A transactional abort (HLE_RETIRED.ABORTED,RTM_RETIRED.ABORTED) can also be programmed&#160;to cause PEBS&#160;<br/>events.&#160;In&#160;this scenario,&#160;a&#160;PEBS event is&#160;processed&#160;following&#160;the abort.<br/>Pending a PEBS record inside of a transactional region will&#160;cause a transactional abort. If a&#160;PEBS record&#160;was pended&#160;<br/>at&#160;the&#160;time of the abort or&#160;on&#160;an overflow of&#160;the TSX PEBS&#160;events listed above, only the&#160;following PEBS&#160;entries&#160;will&#160;<br/>be valid&#160;(enumerated by PEBS entry offset&#160;B8H&#160;bits[33:32]&#160;to indicate an&#160;HLE&#160;abort or&#160;an RTM&#160;abort):</p>
<p style="position:absolute;top:281px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:282px;left:95px;white-space:nowrap" class="ft02">Offset B0H: EventingIP,&#160;</p>
<p style="position:absolute;top:304px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:304px;left:95px;white-space:nowrap" class="ft02">Offset B8H:&#160;TX&#160;Abort&#160;Information</p>
<p style="position:absolute;top:328px;left:69px;white-space:nowrap" class="ft02">These fields are set&#160;for&#160;all&#160;PEBS events.</p>
<p style="position:absolute;top:350px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:351px;left:95px;white-space:nowrap" class="ft07">Offset&#160;08H (RIP/EIP) corresponds to&#160;the instruction&#160;following&#160;the outermost&#160;XACQUIRE in HLE or&#160;the first&#160;<br/>instruction of the&#160;fallback handler&#160;of the&#160;outermost&#160;XBEGIN&#160;instruction in RTM.&#160;This is&#160;useful to&#160;identify the&#160;<br/>aborted transactional region.</p>
<p style="position:absolute;top:408px;left:69px;white-space:nowrap" class="ft08">In&#160;the case of&#160;HLE, an aborted transaction will restart execution deterministically at the&#160;start of&#160;the HLE&#160;region. In&#160;<br/>the case&#160;of RTM,&#160;an&#160;aborted&#160;transaction&#160;will&#160;transfer execution to the&#160;RTM&#160;fallback handler.<br/>The&#160;layout of the&#160;TX Abort Information&#160;field&#160;is given in&#160;<a href="o_fe12b1e2a880e0ce-707.html">Table&#160;18-51.</a></p>
<p style="position:absolute;top:874px;left:69px;white-space:nowrap" class="ft04">18.11.6&#160;&#160;Uncore&#160;Performance Monitoring Facilities in the 4th Generation Intel</p>
<p style="position:absolute;top:873px;left:701px;white-space:nowrap" class="ft01">®</p>
<p style="position:absolute;top:874px;left:714px;white-space:nowrap" class="ft04">&#160;Core</p>
<p style="position:absolute;top:873px;left:755px;white-space:nowrap" class="ft01">™</p>
<p style="position:absolute;top:874px;left:768px;white-space:nowrap" class="ft04">&#160;</p>
<p style="position:absolute;top:895px;left:149px;white-space:nowrap" class="ft04">Processors</p>
<p style="position:absolute;top:925px;left:69px;white-space:nowrap" class="ft02">The uncore sub-system&#160;in the&#160;4th&#160;Generation&#160;Intel</p>
<p style="position:absolute;top:923px;left:411px;white-space:nowrap" class="ft05">®</p>
<p style="position:absolute;top:925px;left:421px;white-space:nowrap" class="ft02">&#160;Core™ processors provides its&#160;own&#160;performance monitoring&#160;</p>
<p style="position:absolute;top:942px;left:69px;white-space:nowrap" class="ft07">facility.&#160;The uncore PMU facility&#160;provides dedicated&#160;MSRs&#160;to select uncore&#160;performance monitoring events&#160;in&#160;a&#160;<br/>similar manner as&#160;those described&#160;in&#160;<a href="o_fe12b1e2a880e0ce-696.html">Section&#160;18.9.6.&#160;<br/></a>The ARB&#160;unit&#160;and each&#160;C-Box provide&#160;local&#160;pairs of event select MSR and&#160;counter register. The&#160;layout of the&#160;event&#160;<br/>select&#160;MSRs in&#160;the&#160;C-Boxes are&#160;identical&#160;<a href="o_fe12b1e2a880e0ce-696.html">as shown in Figure&#160;18-38.<br/></a>At&#160;the&#160;uncore domain level, there is a&#160;master set of control MSRs that&#160;centrally manages all the performance moni-<br/>toring&#160;facility of uncore&#160;<a href="o_fe12b1e2a880e0ce-697.html">units. Figure&#160;18-39 sho</a>ws&#160;the&#160;layout of&#160;the&#160;uncore domain&#160;global&#160;control.&#160;</p>
<p style="position:absolute;top:489px;left:280px;white-space:nowrap" class="ft06">Table&#160;18-51.&#160;&#160;TX&#160;Abort Information Field Definition</p>
<p style="position:absolute;top:514px;left:77px;white-space:nowrap" class="ft02">Bit Name</p>
<p style="position:absolute;top:514px;left:232px;white-space:nowrap" class="ft02">Offset&#160;Description</p>
<p style="position:absolute;top:538px;left:77px;white-space:nowrap" class="ft02">Cycles_Last_TX</p>
<p style="position:absolute;top:538px;left:232px;white-space:nowrap" class="ft02">31:0</p>
<p style="position:absolute;top:538px;left:284px;white-space:nowrap" class="ft02">The number&#160;of&#160;cycles&#160;in&#160;the&#160;last TSX region, regardless of&#160;whether that&#160;region&#160;had aborted or&#160;</p>
<p style="position:absolute;top:555px;left:284px;white-space:nowrap" class="ft02">committed.&#160;</p>
<p style="position:absolute;top:579px;left:77px;white-space:nowrap" class="ft02">HLE_Abort</p>
<p style="position:absolute;top:579px;left:232px;white-space:nowrap" class="ft02">32</p>
<p style="position:absolute;top:579px;left:284px;white-space:nowrap" class="ft02">If set, the&#160;abort information corresponds to&#160;an&#160;aborted HLE execution</p>
<p style="position:absolute;top:603px;left:77px;white-space:nowrap" class="ft02">RTM_Abort</p>
<p style="position:absolute;top:603px;left:232px;white-space:nowrap" class="ft02">33</p>
<p style="position:absolute;top:603px;left:284px;white-space:nowrap" class="ft02">If set,&#160;the abort information&#160;corresponds to&#160;an&#160;aborted RTM execution</p>
<p style="position:absolute;top:627px;left:77px;white-space:nowrap" class="ft02">Instruction_Abort</p>
<p style="position:absolute;top:627px;left:232px;white-space:nowrap" class="ft02">34</p>
<p style="position:absolute;top:627px;left:284px;white-space:nowrap" class="ft02">If set,&#160;the abort was associated with the instruction corresponding to&#160;the eventing IP&#160;(offset&#160;</p>
<p style="position:absolute;top:643px;left:284px;white-space:nowrap" class="ft02">0B0H) within&#160;the&#160;transactional region.</p>
<p style="position:absolute;top:667px;left:77px;white-space:nowrap" class="ft02">Non_Instruction_Abort</p>
<p style="position:absolute;top:667px;left:232px;white-space:nowrap" class="ft02">35</p>
<p style="position:absolute;top:667px;left:284px;white-space:nowrap" class="ft02">If set, the&#160;instruction&#160;corresponding&#160;to&#160;the eventing IP may not necessarily be related to&#160;the&#160;</p>
<p style="position:absolute;top:684px;left:284px;white-space:nowrap" class="ft02">transactional abort.</p>
<p style="position:absolute;top:708px;left:77px;white-space:nowrap" class="ft02">Retry</p>
<p style="position:absolute;top:708px;left:232px;white-space:nowrap" class="ft02">36</p>
<p style="position:absolute;top:708px;left:284px;white-space:nowrap" class="ft02">If set,&#160;retrying the transactional execution may have&#160;succeeded.&#160;</p>
<p style="position:absolute;top:732px;left:77px;white-space:nowrap" class="ft02">Data_Conflict</p>
<p style="position:absolute;top:732px;left:232px;white-space:nowrap" class="ft02">37</p>
<p style="position:absolute;top:732px;left:284px;white-space:nowrap" class="ft02">If set, another logical processor conflicted&#160;with a&#160;memory&#160;address&#160;that&#160;was&#160;part of&#160;the&#160;</p>
<p style="position:absolute;top:748px;left:284px;white-space:nowrap" class="ft02">transactional region that&#160;aborted.&#160;</p>
<p style="position:absolute;top:772px;left:77px;white-space:nowrap" class="ft02">Capacity Writes</p>
<p style="position:absolute;top:772px;left:232px;white-space:nowrap" class="ft02">38</p>
<p style="position:absolute;top:772px;left:284px;white-space:nowrap" class="ft02">If set,&#160;the transactional region&#160;aborted&#160;due&#160;to&#160;exceeding resources&#160;for&#160;transactional writes.</p>
<p style="position:absolute;top:796px;left:77px;white-space:nowrap" class="ft02">Capacity Reads</p>
<p style="position:absolute;top:796px;left:232px;white-space:nowrap" class="ft02">39</p>
<p style="position:absolute;top:796px;left:284px;white-space:nowrap" class="ft02">If set,&#160;the transactional region&#160;aborted&#160;due&#160;to&#160;exceeding resources&#160;for transactional reads.</p>
<p style="position:absolute;top:820px;left:77px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:820px;left:232px;white-space:nowrap" class="ft02">63:40</p>
<p style="position:absolute;top:820px;left:284px;white-space:nowrap" class="ft02">Reserved</p>
</div>
</body>
</html>
