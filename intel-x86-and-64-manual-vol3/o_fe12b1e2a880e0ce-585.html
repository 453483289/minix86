<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 585</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:8px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:18px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page585-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce585.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;17-11</p>
<p style="position:absolute;top:47px;left:425px;white-space:nowrap" class="ft01">DEBUG, BRANCH&#160;PROFILE, TSC, AND RESOURCE MONITORING FEATURES</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">Xeon,&#160;Pentium&#160;M,&#160;Intel</p>
<p style="position:absolute;top:98px;left:223px;white-space:nowrap" class="ft03"><i>®</i></p>
<p style="position:absolute;top:100px;left:234px;white-space:nowrap" class="ft02">&#160;Core™&#160;Solo,&#160;Intel</p>
<p style="position:absolute;top:98px;left:356px;white-space:nowrap" class="ft03"><i>®</i></p>
<p style="position:absolute;top:100px;left:367px;white-space:nowrap" class="ft02">&#160;Core™ Duo,&#160;Intel</p>
<p style="position:absolute;top:98px;left:488px;white-space:nowrap" class="ft03"><i>®</i></p>
<p style="position:absolute;top:100px;left:498px;white-space:nowrap" class="ft02">&#160;Core™2&#160;Duo,&#160;Intel</p>
<p style="position:absolute;top:98px;left:627px;white-space:nowrap" class="ft03"><i>®</i></p>
<p style="position:absolute;top:100px;left:638px;white-space:nowrap" class="ft02">&#160;Core™&#160;i7 and Intel</p>
<p style="position:absolute;top:98px;left:768px;white-space:nowrap" class="ft03"><i>®</i></p>
<p style="position:absolute;top:100px;left:779px;white-space:nowrap" class="ft02">&#160;Atom™&#160;</p>
<p style="position:absolute;top:117px;left:69px;white-space:nowrap" class="ft08">processors&#160;to allow logging of&#160;branch trace messages&#160;in a&#160;branch trace store (BTS)&#160;buffer in memory.&#160;<br/>See the&#160;following sections&#160;for processor specific&#160;implementation&#160;of last&#160;branch, interrupt and exception recording:</p>
<p style="position:absolute;top:165px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-599.html">Section 17.5, “Last Branch,&#160;Interrupt, and&#160;Exception&#160;Recording (Intel®&#160;Core™ 2&#160;Duo&#160;and Intel®&#160;Atom™&#160;</a></p>
<p style="position:absolute;top:181px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-599.html">Processors)”</a></p>
<p style="position:absolute;top:205px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-600.html">Section 17.6, “Last Branch,&#160;Call&#160;Stack, Interrupt,&#160;and&#160;Exception Recording&#160;for Processors based&#160;on&#160;</a></p>
<p style="position:absolute;top:222px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-600.html">Goldmont&#160;Microarchitecture”</a></p>
<p style="position:absolute;top:246px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-601.html">Section 17.7, “Last Branch, Interrupt, and Exception Recording for Processors based on Intel® Microarchi-</a></p>
<p style="position:absolute;top:262px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-601.html">tecture code name&#160;Nehalem”</a></p>
<p style="position:absolute;top:286px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-603.html">Section 17.8, “Last Branch, Interrupt, and Exception Recording for Processors based on Intel® Microarchi-</a></p>
<p style="position:absolute;top:303px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-603.html">tecture code name&#160;Sandy Bridge”</a></p>
<p style="position:absolute;top:327px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-603.html">Section 17.9,&#160;“Last Branch, Call&#160;Stack, Interrupt, and&#160;Exception Recording for Processors&#160;based on&#160;Haswell&#160;</a></p>
<p style="position:absolute;top:343px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-603.html">Microarchitecture”</a></p>
<p style="position:absolute;top:367px;left:94px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-605.html">Section 17.10,&#160;“Last Branch, Call Stack, Interrupt,&#160;and&#160;Exception&#160;Recording for Processors based&#160;on&#160;</a></p>
<p style="position:absolute;top:384px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-605.html">Skylake Microarchitecture”</a></p>
<p style="position:absolute;top:408px;left:95px;white-space:nowrap" class="ft02">—&#160;<a href="o_fe12b1e2a880e0ce-609.html">Section 17.12,&#160;“Last Branch, Interrupt, and&#160;Exception&#160;Recording (Intel®&#160;Core™ Solo and&#160;Intel®&#160;Core™</a></p>
<p style="position:absolute;top:405px;left:819px;white-space:nowrap" class="ft04"><a href="o_fe12b1e2a880e0ce-609.html">&#160;</a></p>
<p style="position:absolute;top:424px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-609.html">Duo Processors)”</a></p>
<p style="position:absolute;top:448px;left:95px;white-space:nowrap" class="ft09">—&#160;<a href="o_fe12b1e2a880e0ce-611.html">Section 17.13,&#160;“Last Branch, Interrupt, and&#160;Exception&#160;Recording (Pentium M Processors)”<br/></a>—&#160;<a href="o_fe12b1e2a880e0ce-612.html">Section 17.14,&#160;“Last Branch, Interrupt, and&#160;Exception&#160;Recording (P6&#160;Family Processors)”</a></p>
<p style="position:absolute;top:496px;left:69px;white-space:nowrap" class="ft010">The&#160;following su<a href="o_fe12b1e2a880e0ce-584.html">bsections of Section 17.4 describe</a>&#160;common&#160;features of profiling&#160;branches.&#160;These&#160;features are&#160;<br/>generally enabled&#160;using&#160;the&#160;IA32_DEBUGCTL&#160;MSR&#160;(older&#160;processor&#160;may have&#160;implemented a&#160;subset&#160;or model-<br/>specific features, see&#160;definitions of&#160;MSR_DEBUGCTLA, MSR_DEBUGCTLB,&#160;MSR_DEBUGCTL).</p>
<p style="position:absolute;top:580px;left:69px;white-space:nowrap" class="ft05">17.4.1 IA32_DEBUGCTL&#160;</p>
<p style="position:absolute;top:580px;left:287px;white-space:nowrap" class="ft05">MSR</p>
<p style="position:absolute;top:610px;left:69px;white-space:nowrap" class="ft08">The<b>&#160;IA32_DEBUGCTL&#160;</b>MSR provides&#160;bit&#160;field&#160;controls&#160;to enable&#160;debug&#160;trace&#160;interrupts,&#160;debug&#160;trace&#160;stores,&#160;trace&#160;<br/>messages&#160;enable, single stepping&#160;on branches,&#160;last branch&#160;record&#160;recording, and&#160;to control freezing of LBR&#160;stack&#160;<br/>or&#160;performance counters&#160;on&#160;a PMI request. IA32_DEBUGCTL MSR&#160;is located at&#160;register&#160;address&#160;01D9H.&#160;<br/>See&#160;<a href="o_fe12b1e2a880e0ce-586.html">Figure&#160;17-3 for the&#160;</a>MSR layout&#160;and the&#160;bullets&#160;below&#160;for&#160;a description of the flags:</p>
<p style="position:absolute;top:689px;left:69px;white-space:nowrap" class="ft07">•</p>
<p style="position:absolute;top:690px;left:95px;white-space:nowrap" class="ft010"><b>LBR (last&#160;branch/interrupt/exception) flag (bit&#160;0)&#160;—&#160;</b>When&#160;set,&#160;the processor records a&#160;running trace&#160;of&#160;<br/>the most recent branches,&#160;interrupts, and/or&#160;exceptions&#160;taken by&#160;the processor (prior&#160;to a&#160;debug exception&#160;<br/>being&#160;generated)&#160;in the&#160;last branch record (LBR)&#160;stack. For more information,&#160;see&#160;th<a href="o_fe12b1e2a880e0ce-599.html">e Section 17.5.1, “LBR&#160;<br/>Stack”</a>&#160;(Intel</p>
<p style="position:absolute;top:737px;left:180px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:739px;left:191px;white-space:nowrap" class="ft02">&#160;Core™2 Duo and Intel</p>
<p style="position:absolute;top:737px;left:343px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:739px;left:354px;white-space:nowrap" class="ft02">&#160;Atom™ Processor Fa<a href="o_fe12b1e2a880e0ce-602.html">mily) and Section&#160;17.7.1, “LBR Stack” (processors&#160;</a></p>
<p style="position:absolute;top:756px;left:95px;white-space:nowrap" class="ft02">based on Intel</p>
<p style="position:absolute;top:753px;left:191px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:756px;left:202px;white-space:nowrap" class="ft02">&#160;Microarchitecture code name&#160;Nehalem).</p>
<p style="position:absolute;top:778px;left:69px;white-space:nowrap" class="ft07">•</p>
<p style="position:absolute;top:778px;left:95px;white-space:nowrap" class="ft010"><b>BTF&#160;(single-step on&#160;branches) flag (bit 1)&#160;—&#160;</b>When set,&#160;the processor treats&#160;the&#160;TF flag in the EFLAGS&#160;<br/>register as&#160;a&#160;“single-step&#160;on branches” flag&#160;rather than&#160;a “single-step&#160;on&#160;instructions” flag.&#160;This mechanism&#160;<br/>allows single-stepping the&#160;processor&#160;on taken&#160;branches.&#160;See<a href="o_fe12b1e2a880e0ce-587.html">&#160;Section 17.4.3,&#160;“Single-Stepping on&#160;Branches,”</a>&#160;<br/>for more&#160;information about&#160;the BTF&#160;flag.</p>
<p style="position:absolute;top:850px;left:69px;white-space:nowrap" class="ft07">•</p>
<p style="position:absolute;top:850px;left:95px;white-space:nowrap" class="ft010"><b>TR&#160;(trace message enable) flag (bit 6)&#160;—&#160;</b>When set,&#160;branch&#160;trace messages&#160;are enabled. When&#160;the&#160;<br/>processor detects a&#160;taken&#160;branch,&#160;interrupt, or exception;&#160;it sends the&#160;branch record out on the&#160;system bus&#160;as&#160;<br/>a&#160;branch trace message&#160;(BTM).&#160;<a href="o_fe12b1e2a880e0ce-587.html">See Section 17.4.4, “Branch Trace&#160;Messages,”&#160;</a>for&#160;more information about the&#160;<br/>TR&#160;flag.</p>
<p style="position:absolute;top:922px;left:69px;white-space:nowrap" class="ft07">•</p>
<p style="position:absolute;top:922px;left:95px;white-space:nowrap" class="ft010"><b>BTS (branch trace store)&#160;flag&#160;(bit&#160;7)&#160;—&#160;</b>When set,&#160;the&#160;flag&#160;enables&#160;BTS&#160;facilities to&#160;log&#160;BTMs to a&#160;memory-<br/>resident BTS buffer that&#160;is part of the&#160;DS save&#160;area.&#160;S<a href="o_fe12b1e2a880e0ce-591.html">ee&#160;Section&#160;17.4.9,&#160;“BTS and&#160;DS&#160;Save&#160;Area.”</a></p>
<p style="position:absolute;top:961px;left:69px;white-space:nowrap" class="ft07">•</p>
<p style="position:absolute;top:961px;left:95px;white-space:nowrap" class="ft010"><b>BTINT (branch&#160;trace interrupt)&#160;flag (bit&#160;8)&#160;—&#160;</b>When set, the BTS facilities generate an interrupt when the&#160;<br/>BTS&#160;buffer is&#160;full.&#160;When&#160;clear,&#160;BTMs&#160;are&#160;logged&#160;to&#160;the&#160;BTS buffer in&#160;a circular&#160;fashion.&#160;<a href="o_fe12b1e2a880e0ce-587.html">See&#160;Section 17.4.5, “Branch&#160;<br/>Trace Store (BTS),” for</a>&#160;a description of this mechanism.</p>
</div>
</body>
</html>
