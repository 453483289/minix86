<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1139</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1139-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1139.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3C&#160;27-21</p>
<p style="position:absolute;top:47px;left:782px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft06">If&#160;the processor supports either the&#160;1-setting of&#160;the&#160;“load IA32_BNDCFGS”&#160;VM-entry&#160;control&#160;or&#160;that of&#160;the&#160;<br/>“clear IA32_BNDCFGS” VM-exit&#160;control, the&#160;contents&#160;of the&#160;IA32_BNDCFGS MSR&#160;are saved&#160;into&#160;the corre-<br/>sponding&#160;field.</p>
<p style="position:absolute;top:155px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:156px;left:95px;white-space:nowrap" class="ft03">The&#160;value of the&#160;SMBASE&#160;field&#160;is undefined&#160;after&#160;all VM&#160;exits except&#160;SMM&#160;VM&#160;exits.&#160;See<a href="o_fe12b1e2a880e0ce-1269.html">&#160;Section 34.15.2</a>.</p>
<p style="position:absolute;top:206px;left:69px;white-space:nowrap" class="ft04">27.3.2&#160;</p>
<p style="position:absolute;top:206px;left:149px;white-space:nowrap" class="ft04">Saving Segment Registers&#160;and Descriptor-Table Registers</p>
<p style="position:absolute;top:237px;left:69px;white-space:nowrap" class="ft06">For each segment&#160;register (CS,&#160;SS,&#160;DS, ES, FS,&#160;GS, LDTR,&#160;or TR),&#160;the&#160;values saved for the base-address, segment-<br/>limit,&#160;and access rights&#160;are&#160;based&#160;on whether the&#160;register was&#160;unusable&#160;(see&#160;<a href="o_fe12b1e2a880e0ce-1050.html">Section&#160;24.4.1) b</a>efore the&#160;VM&#160;exit:</p>
<p style="position:absolute;top:275px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:276px;left:95px;white-space:nowrap" class="ft07">If the&#160;register was&#160;unusable,&#160;the&#160;values&#160;saved&#160;into&#160;the&#160;following fields are undefined:&#160;(1)&#160;base address;&#160;<br/>(2)&#160;segment limit; and (3)&#160;bits&#160;7:0 and&#160;bits&#160;15:12&#160;in&#160;the&#160;access-rights field.&#160;The following exceptions&#160;apply:<br/>—&#160;CS.</p>
<p style="position:absolute;top:342px;left:120px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:340px;left:146px;white-space:nowrap" class="ft03">The base-address&#160;and segment-limit fields are&#160;saved.</p>
<p style="position:absolute;top:366px;left:120px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:364px;left:146px;white-space:nowrap" class="ft03">The&#160;L, D,&#160;and&#160;G bits&#160;are&#160;saved in the&#160;access-rights field.</p>
<p style="position:absolute;top:388px;left:94px;white-space:nowrap" class="ft03">—&#160;SS.</p>
<p style="position:absolute;top:414px;left:120px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:412px;left:146px;white-space:nowrap" class="ft03">DPL&#160;is saved in&#160;the&#160;access-rights field.</p>
<p style="position:absolute;top:438px;left:120px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:436px;left:146px;white-space:nowrap" class="ft06">On&#160;processors that support&#160;Intel&#160;64 architecture, bits&#160;63:32&#160;of the value saved for the&#160;base&#160;address&#160;are&#160;<br/>always zero.</p>
<p style="position:absolute;top:477px;left:95px;white-space:nowrap" class="ft03">—&#160;DS&#160;and&#160;ES. On processors that&#160;support&#160;Intel 64&#160;architecture, bits&#160;63:32&#160;of&#160;the values&#160;saved for the&#160;base&#160;</p>
<p style="position:absolute;top:493px;left:120px;white-space:nowrap" class="ft03">addresses are always zero.</p>
<p style="position:absolute;top:517px;left:95px;white-space:nowrap" class="ft07">—&#160;FS&#160;and GS. The&#160;base-address&#160;field&#160;is saved.<br/>—&#160;LDTR. The&#160;value saved&#160;for&#160;the&#160;base address&#160;is always canonical.</p>
<p style="position:absolute;top:563px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:564px;left:95px;white-space:nowrap" class="ft06">If&#160;the register&#160;was not unusable, the&#160;values saved into&#160;the following&#160;fields&#160;are&#160;those&#160;which&#160;were in the&#160;register&#160;<br/>before&#160;the&#160;VM&#160;exit:&#160;(1)&#160;base&#160;address; (2)&#160;segment limit;&#160;and (3)&#160;bits&#160;7:0 and bits&#160;15:12&#160;in access&#160;rights.</p>
<p style="position:absolute;top:602px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:603px;left:95px;white-space:nowrap" class="ft06">Bits&#160;31:17&#160;and 11:8 in the access-rights&#160;field are always cleared. Bit&#160;16&#160;is set to 1 if and only if the&#160;segment is&#160;<br/>unusable.</p>
<p style="position:absolute;top:643px;left:69px;white-space:nowrap" class="ft03">The&#160;contents of the&#160;GDTR&#160;and IDTR&#160;registers are&#160;saved into&#160;the&#160;corresponding base-address and&#160;limit fields.</p>
<p style="position:absolute;top:694px;left:69px;white-space:nowrap" class="ft04">27.3.3&#160;</p>
<p style="position:absolute;top:694px;left:150px;white-space:nowrap" class="ft04">Saving RIP,&#160;RSP,&#160;and RFLAGS</p>
<p style="position:absolute;top:724px;left:69px;white-space:nowrap" class="ft03">The&#160;contents of the&#160;RIP,&#160;RSP,&#160;and&#160;RFLAGS&#160;registers&#160;are saved&#160;as follows:</p>
<p style="position:absolute;top:746px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:747px;left:95px;white-space:nowrap" class="ft07">The&#160;value saved&#160;in&#160;the RIP field is&#160;determined&#160;by the&#160;nature and&#160;cause&#160;of&#160;the VM&#160;exit:<br/>—&#160;If&#160;the VM&#160;exit occurred&#160;in enclave mode,&#160;the value&#160;saved&#160;is the&#160;AEP&#160;of interrupted&#160;enclave thread&#160;(the&#160;</p>
<p style="position:absolute;top:787px;left:120px;white-space:nowrap" class="ft03">remaining&#160;items&#160;do not&#160;apply).</p>
<p style="position:absolute;top:811px;left:95px;white-space:nowrap" class="ft03">—&#160;If the VM&#160;exit occurs due to by&#160;an&#160;attempt to execute&#160;an instruction&#160;that causes&#160;VM&#160;exits unconditionally or&#160;</p>
<p style="position:absolute;top:828px;left:120px;white-space:nowrap" class="ft06">that&#160;has been configured&#160;to cause&#160;a VM&#160;exit via the&#160;VM-execution&#160;controls, the&#160;value saved references&#160;that&#160;<br/>instruction.</p>
<p style="position:absolute;top:868px;left:95px;white-space:nowrap" class="ft03">—&#160;If the&#160;VM&#160;exit&#160;is caused by an&#160;occurrence of&#160;an&#160;INIT&#160;signal, a&#160;start-up&#160;IPI&#160;(SIPI), or&#160;system-management&#160;</p>
<p style="position:absolute;top:885px;left:120px;white-space:nowrap" class="ft03">interrupt&#160;(SMI),&#160;the value saved&#160;is that&#160;which was&#160;in RIP before the&#160;event&#160;occurred.</p>
<p style="position:absolute;top:909px;left:95px;white-space:nowrap" class="ft03">—&#160;If&#160;the VM&#160;exit occurs&#160;due to&#160;the 1-setting&#160;of either&#160;the&#160;“interrupt-window exiting”&#160;VM-execution control or&#160;</p>
<p style="position:absolute;top:925px;left:120px;white-space:nowrap" class="ft06">the&#160;“NMI-window exiting”&#160;VM-execution&#160;control, the&#160;value&#160;saved&#160;is&#160;that which would be&#160;in the&#160;register had&#160;<br/>the VM&#160;exit&#160;not occurred.</p>
<p style="position:absolute;top:966px;left:95px;white-space:nowrap" class="ft03">—&#160;If&#160;the VM&#160;exit is&#160;due&#160;to an external&#160;interrupt, non-maskable interrupt (NMI), or&#160;hardware&#160;exception (as&#160;</p>
<p style="position:absolute;top:982px;left:120px;white-space:nowrap" class="ft03">defined&#160;<a href="o_fe12b1e2a880e0ce-1128.html">in Section&#160;27.2.2),&#160;</a>the value saved is&#160;the return&#160;pointer that would have&#160;been saved (either&#160;on&#160;the&#160;</p>
</div>
</body>
</html>
