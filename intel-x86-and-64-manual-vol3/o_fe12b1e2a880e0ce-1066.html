<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1066</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1066-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1066.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">24-20&#160;Vol. 3C</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">VIRTUAL MACHINE CONTROL STRUCTURES</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft07"><b>VM-entry MSR-load&#160;address</b>&#160;(64&#160;bits).&#160;This&#160;field&#160;contains the&#160;physical&#160;address of the&#160;VM-entry&#160;MSR-load&#160;<br/>area. The&#160;area is&#160;a table of entries,&#160;16&#160;bytes&#160;per entry,&#160;where the number of&#160;entries is&#160;given by the VM-entry&#160;<br/>MSR-load count.&#160;The format of entries&#160;is de<a href="o_fe12b1e2a880e0ce-1064.html">scribed in Table&#160;24-11.&#160;</a>If&#160;the VM-entry MSR-load count is not zero,&#160;<br/>the&#160;address must be 16-byte aligned.</p>
<p style="position:absolute;top:174px;left:68px;white-space:nowrap" class="ft04">Se<a href="o_fe12b1e2a880e0ce-1109.html">e Section 26.4</a>&#160;for details of&#160;how this&#160;area is&#160;used&#160;on VM&#160;entries.</p>
<p style="position:absolute;top:224px;left:68px;white-space:nowrap" class="ft05">24.8.3&#160;</p>
<p style="position:absolute;top:224px;left:148px;white-space:nowrap" class="ft05">VM-Entry Controls for Event Injection</p>
<p style="position:absolute;top:255px;left:68px;white-space:nowrap" class="ft07">VM&#160;entry can be configured to conclude by delivering an event through the IDT&#160;(after all guest&#160;state and MSRs have&#160;<br/>been&#160;loaded). This process is&#160;called&#160;<b>event injection</b>&#160;and&#160;is controlled by the&#160;following&#160;three&#160;VM-entry control&#160;<br/>fields:</p>
<p style="position:absolute;top:310px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:310px;left:93px;white-space:nowrap" class="ft07"><b>VM-entry interruption-information&#160;field</b>&#160;(32 bits). This field provides&#160;details about the event to be injected.&#160;<br/><a href="o_fe12b1e2a880e0ce-1066.html">Table&#160;24-13 des</a>cribes the&#160;field.</p>
<p style="position:absolute;top:666px;left:93px;white-space:nowrap" class="ft08">—&#160;The&#160;<b>vector</b>&#160;(bits&#160;7:0) determines which entry in&#160;the IDT&#160;is used or&#160;which other&#160;event is&#160;injected.<br/>—&#160;The&#160;<b>interruption type</b>&#160;(bits&#160;10:8)&#160;determines&#160;details of how the&#160;injection&#160;is performed. In general, a&#160;VMM&#160;</p>
<p style="position:absolute;top:706px;left:119px;white-space:nowrap" class="ft07">should use&#160;the&#160;type&#160;<b>hardware&#160;exception</b>&#160;for&#160;all exceptions&#160;other than&#160;breakpoint exceptions&#160;(#BP;&#160;<br/>generated by INT3) and overflow exceptions&#160;(#OF; generated by&#160;INTO);&#160;it should&#160;use the&#160;type&#160;<b>software&#160;<br/>exception</b>&#160;for #BP and&#160;#OF.&#160;The&#160;type&#160;<b>other event</b>&#160;is used&#160;for injection of&#160;events&#160;that are&#160;not delivered&#160;<br/>through the&#160;IDT.</p>
<p style="position:absolute;top:780px;left:93px;white-space:nowrap" class="ft04">—&#160;For&#160;&#160;exceptions,&#160;&#160;the&#160;&#160;<b>deliver-error-code bit</b>&#160;(bit&#160;11)&#160;determines&#160;whether delivery&#160;pushes&#160;an&#160;error&#160;code&#160;on&#160;</p>
<p style="position:absolute;top:796px;left:119px;white-space:nowrap" class="ft04">the guest stack.</p>
<p style="position:absolute;top:820px;left:93px;white-space:nowrap" class="ft04">—&#160;VM&#160;entry&#160;injects&#160;an event if&#160;and only if the&#160;<b>valid bit</b>&#160;(bit 31) is&#160;1.&#160;The&#160;valid&#160;bit in&#160;this field&#160;is cleared&#160;on&#160;</p>
<p style="position:absolute;top:837px;left:119px;white-space:nowrap" class="ft04">every VM&#160;exit&#160;(s<a href="o_fe12b1e2a880e0ce-1122.html">ee Section 27.2).</a></p>
<p style="position:absolute;top:859px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:859px;left:93px;white-space:nowrap" class="ft07"><b>VM-entry exception error code</b>&#160;(32&#160;bits). This field&#160;is used&#160;if and only if&#160;the&#160;valid bit&#160;(bit&#160;31) and the deliver-<br/>error-code bit (bit&#160;11) are both&#160;set in&#160;the VM-entry interruption-information&#160;field.</p>
<p style="position:absolute;top:898px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:898px;left:93px;white-space:nowrap" class="ft07"><b>VM-entry instruction length</b>&#160;(32 bits).&#160;For&#160;injection&#160;of&#160;events whose type is&#160;software interrupt, software&#160;<br/>exception,&#160;or privileged&#160;software&#160;exception, this field is&#160;used&#160;to determine the&#160;value of RIP that&#160;is pushed on&#160;<br/>the stack.</p>
<p style="position:absolute;top:955px;left:68px;white-space:nowrap" class="ft08">Se<a href="o_fe12b1e2a880e0ce-1110.html">e Section 26.5</a>&#160;for details regarding the&#160;mechanics&#160;of event injection,&#160;including the&#160;use&#160;of&#160;the interruption&#160;type&#160;<br/>and the&#160;VM-entry instruction length.<br/>VM&#160;exits clear the&#160;valid bit (bit&#160;31)&#160;in&#160;the VM-entry interruption-information&#160;field.</p>
<p style="position:absolute;top:356px;left:222px;white-space:nowrap" class="ft06">Table 24-13.&#160;&#160;Format of&#160;the VM-Entry Interruption-Information&#160;Field</p>
<p style="position:absolute;top:378px;left:74px;white-space:nowrap" class="ft04">Bit Position(s)</p>
<p style="position:absolute;top:378px;left:180px;white-space:nowrap" class="ft04">Content</p>
<p style="position:absolute;top:400px;left:74px;white-space:nowrap" class="ft04">7:0</p>
<p style="position:absolute;top:400px;left:180px;white-space:nowrap" class="ft04">Vector of&#160;interrupt&#160;or&#160;exception</p>
<p style="position:absolute;top:423px;left:74px;white-space:nowrap" class="ft04">10:8</p>
<p style="position:absolute;top:423px;left:180px;white-space:nowrap" class="ft04">Interruption type:</p>
<p style="position:absolute;top:444px;left:192px;white-space:nowrap" class="ft04">0:&#160;External interrupt</p>
<p style="position:absolute;top:460px;left:192px;white-space:nowrap" class="ft04">1:&#160;Reserved</p>
<p style="position:absolute;top:477px;left:192px;white-space:nowrap" class="ft04">2:&#160;Non-maskable interrupt&#160;(NMI)</p>
<p style="position:absolute;top:493px;left:192px;white-space:nowrap" class="ft04">3:&#160;Hardware&#160;exception</p>
<p style="position:absolute;top:510px;left:192px;white-space:nowrap" class="ft04">4:&#160;Software&#160;interrupt</p>
<p style="position:absolute;top:526px;left:192px;white-space:nowrap" class="ft04">5:&#160;Privileged&#160;software&#160;exception</p>
<p style="position:absolute;top:543px;left:192px;white-space:nowrap" class="ft04">6:&#160;Software&#160;exception</p>
<p style="position:absolute;top:559px;left:192px;white-space:nowrap" class="ft04">7:&#160;Other&#160;event</p>
<p style="position:absolute;top:582px;left:74px;white-space:nowrap" class="ft04">11</p>
<p style="position:absolute;top:582px;left:180px;white-space:nowrap" class="ft04">Deliver&#160;error&#160;code&#160;(0&#160;=&#160;do&#160;not&#160;deliver;&#160;1&#160;=&#160;deliver)</p>
<p style="position:absolute;top:604px;left:74px;white-space:nowrap" class="ft04">30:12</p>
<p style="position:absolute;top:604px;left:180px;white-space:nowrap" class="ft04">Reserved</p>
<p style="position:absolute;top:627px;left:74px;white-space:nowrap" class="ft04">31</p>
<p style="position:absolute;top:627px;left:180px;white-space:nowrap" class="ft04">Valid</p>
</div>
</body>
</html>
