<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 592</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page592-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce592.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">17-18&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">DEBUG,&#160;BRANCH&#160;PROFILE,&#160;TSC,&#160;AND RESOURCE&#160;MONITORING&#160;FEATURES</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft06">The DS&#160;save area is&#160;divided into thre<a href="o_fe12b1e2a880e0ce-593.html">e parts (see Figure&#160;17-5): buffe</a>r&#160;management&#160;area, branch trace store (BTS)&#160;<br/>buffer,&#160;and&#160;PEBS&#160;buffer.&#160;The&#160;buffer management&#160;area&#160;is used&#160;to&#160;define the location and size&#160;of&#160;the BTS and&#160;PEBS&#160;<br/>buffers.&#160;The processor then uses&#160;the buffer&#160;management area to&#160;keep&#160;track of the&#160;branch&#160;and/or&#160;PEBS records in&#160;<br/>their respective buffers&#160;and to&#160;record&#160;the performance&#160;counter reset value.&#160;The&#160;linear&#160;address of the&#160;first byte of&#160;<br/>the DS&#160;buffer&#160;management&#160;area is&#160;specified&#160;with the&#160;IA32_DS_AREA&#160;MSR.<br/>The fields in the&#160;buffer management&#160;area&#160;are as&#160;follows:&#160;</p>
<p style="position:absolute;top:212px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:213px;left:93px;white-space:nowrap" class="ft05"><b>BTS buffer base —&#160;</b>Linear&#160;address of the first byte&#160;of&#160;the BTS buffer.&#160;This&#160;address should&#160;point to&#160;a natural&#160;<br/>doubleword boundary.</p>
<p style="position:absolute;top:251px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:252px;left:93px;white-space:nowrap" class="ft05"><b>BTS index</b>&#160;<b>—&#160;</b>Linear&#160;address of the&#160;first byte of&#160;the next BTS&#160;record to be&#160;written&#160;to. Initially,&#160;this address&#160;<br/>should&#160;be&#160;the same&#160;as the&#160;address in&#160;the BTS buffer base field.</p>
<p style="position:absolute;top:290px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:291px;left:93px;white-space:nowrap" class="ft05"><b>BTS absolute maximum</b>&#160;<b>—&#160;</b>Linear address&#160;of the next&#160;byte past&#160;the&#160;end of the BTS buffer.&#160;This&#160;address should&#160;<br/>be&#160;a multiple of&#160;the&#160;BTS record size&#160;(12&#160;bytes) plus 1.</p>
<p style="position:absolute;top:329px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:330px;left:93px;white-space:nowrap" class="ft05"><b>BTS&#160;interrupt threshold</b>&#160;<b>—&#160;</b>Linear address&#160;of&#160;the&#160;BTS record on&#160;which an&#160;interrupt is&#160;to be generated.&#160;This&#160;<br/>address must point to&#160;an&#160;offset&#160;from the BTS buffer&#160;base&#160;that is a multiple&#160;of&#160;the&#160;BTS record&#160;size. Also, it must&#160;<br/>be several records short of the BTS absolute maximum address to allow a pending interrupt to be handled prior&#160;<br/>to&#160;processor&#160;writing&#160;the BTS absolute&#160;maximum record.</p>
<p style="position:absolute;top:401px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:402px;left:93px;white-space:nowrap" class="ft05"><b>PEBS&#160;buffer base —&#160;</b>Linear&#160;address of&#160;the first byte of the PEBS&#160;buffer.&#160;This address should point to a&#160;natural&#160;<br/>doubleword boundary.</p>
<p style="position:absolute;top:440px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:441px;left:93px;white-space:nowrap" class="ft05"><b>PEBS index</b>&#160;<b>—&#160;</b>Linear&#160;address of the&#160;first&#160;byte of&#160;the next PEBS&#160;record to be written&#160;to. Initially,&#160;this address&#160;<br/>should be the&#160;same as&#160;the address in&#160;the&#160;PEBS&#160;buffer base&#160;field.</p>
<p style="position:absolute;top:479px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:480px;left:93px;white-space:nowrap" class="ft05"><b>PEBS absolute&#160;maximum</b>&#160;<b>—&#160;</b>Linear address&#160;of&#160;the next&#160;byte&#160;past&#160;the end of the&#160;PEBS&#160;buffer.&#160;This&#160;address&#160;<br/>should be a&#160;multiple of&#160;the PEBS&#160;record&#160;size&#160;(40&#160;bytes) plus 1.</p>
<p style="position:absolute;top:518px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:519px;left:93px;white-space:nowrap" class="ft05"><b>PEBS&#160;interrupt&#160;threshold —&#160;</b>Linear&#160;address of the PEBS&#160;record&#160;on which an&#160;interrupt is&#160;to be generated. This&#160;<br/>address&#160;must&#160;point to&#160;an offset&#160;from the&#160;PEBS&#160;buffer&#160;base&#160;that is&#160;a multiple&#160;of the&#160;PEBS record size. Also, it&#160;<br/>must be several records short of the&#160;PEBS&#160;absolute&#160;maximum address&#160;to allow a&#160;pending interrupt&#160;to be&#160;<br/>handled prior to processor writing&#160;the&#160;PEBS&#160;absolute&#160;maximum record.</p>
<p style="position:absolute;top:590px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:591px;left:93px;white-space:nowrap" class="ft05"><b>PEBS counter&#160;reset value —&#160;</b>A 40-bit&#160;value that the&#160;counter is&#160;to be reset to&#160;after state information&#160;has&#160;<br/>collected&#160;following counter&#160;overflow. This&#160;value allows&#160;state information&#160;to be collected&#160;after a&#160;preset&#160;number&#160;<br/>of events&#160;have been counted.&#160;</p>
</div>
</body>
</html>
