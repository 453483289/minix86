<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1795</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:14px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1795-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1795.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3D&#160;39-7</p>
<p style="position:absolute;top:47px;left:713px;white-space:nowrap" class="ft01">ENCLAVE OPERATION</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">39.4.2&#160;</p>
<p style="position:absolute;top:98px;left:149px;white-space:nowrap" class="ft02">Security Version Numbers (SVN)&#160;</p>
<p style="position:absolute;top:127px;left:69px;white-space:nowrap" class="ft06">Intel® SGX supports a&#160;versioning system&#160;that allows&#160;the signer&#160;to identify different versions of the same software&#160;<br/>released&#160;by an author. The security version is independent&#160;of the functional&#160;version an author uses and is intended&#160;<br/>to specify security&#160;equivalence. Multiple releases&#160;with&#160;functional enhancements&#160;may all share&#160;the same&#160;SVN if&#160;they&#160;<br/>all have&#160;the&#160;same&#160;security&#160;properties or&#160;posture. Each&#160;enclave has&#160;an&#160;SVN and&#160;the&#160;underlying hardware has an&#160;<br/>SVN.<br/>The SVNs&#160;are attested&#160;to in&#160;EREPORT&#160;and are included in&#160;the derivation&#160;of&#160;most&#160;keys, thus providing separation&#160;<br/>between data for older/newer versions.&#160;</p>
<p style="position:absolute;top:277px;left:69px;white-space:nowrap" class="ft04">39.4.2.1 &#160;&#160;Enclave&#160;Security Version</p>
<p style="position:absolute;top:304px;left:69px;white-space:nowrap" class="ft06">In the&#160;SIGSTRUCT,&#160;the&#160;MRSIGNER is&#160;associated&#160;with&#160;a&#160;16-bit Product ID (ISVPRODID)&#160;and&#160;a 16 bit&#160;integer SVN&#160;<br/>(ISVSVN). Together they define&#160;a specific group&#160;of versions&#160;of a specific product. Most keys,&#160;including the Seal Key,&#160;<br/>can be bound&#160;to this&#160;pair.&#160;<br/>To&#160;support upgrading from one&#160;release&#160;to another,&#160;EGETKEY will return keys corresponding to any value less than&#160;<br/>or equal to the software's&#160;ISVSVN.</p>
<p style="position:absolute;top:420px;left:69px;white-space:nowrap" class="ft04">39.4.2.2 &#160;&#160;Hardware&#160;Security Version</p>
<p style="position:absolute;top:447px;left:69px;white-space:nowrap" class="ft06">CPUSVN&#160;is a&#160;128 bit&#160;value that&#160;reflects the microcode&#160;update&#160;version&#160;and authenticated code&#160;modules supported&#160;<br/>by&#160;the processor.&#160;Unlike ISVSVN,&#160;CPUSVN&#160;is not an integer and&#160;cannot be compared&#160;mathematically.&#160;Not all values&#160;<br/>are valid&#160;CPUSVNs.&#160;<br/>Software must ensure&#160;that the&#160;CPUSVN&#160;provided to&#160;EGETKEY&#160;is valid. EREPORT&#160;will&#160;return&#160;the CPUSVN of&#160;the&#160;<br/>current environment. Software&#160;can execute EREPORT&#160;with&#160;TARGETINFO set&#160;to zeros&#160;to retrieve&#160;a CPUSVN from&#160;<br/>REPORTDATA. Software can&#160;access&#160;keys for a&#160;CPUSVN&#160;recorded previously, provided that&#160;each&#160;of the&#160;elements&#160;<br/>reflected&#160;in&#160;CPUSVN are&#160;the&#160;same or&#160;have been&#160;upgraded.</p>
<p style="position:absolute;top:602px;left:69px;white-space:nowrap" class="ft02">39.4.3 Keys</p>
<p style="position:absolute;top:631px;left:69px;white-space:nowrap" class="ft06">Intel® SGX&#160;provides&#160;software with access to&#160;keys unique&#160;to each&#160;processor&#160;and rooted&#160;in&#160;HW&#160;keys inserted&#160;into&#160;<br/>the processor during manufacturing.&#160;<br/>Each&#160;enclave requests&#160;keys using&#160;the&#160;EGETKEY&#160;leaf function. The&#160;key&#160;is based&#160;on enclave&#160;parameters such&#160;as&#160;<br/>measurement, the enclave&#160;signing key,&#160;security&#160;attributes of the enclave, and the Hardware Security&#160;version of the&#160;<br/>processor&#160;itself. A full list&#160;of&#160;parameter options&#160;is specified in&#160;the KEYREQUEST structure,&#160;s<a href="o_fe12b1e2a880e0ce-1785.html">ee details in&#160;Section&#160;<br/>38.17.</a>&#160;<br/>By deriving keys&#160;using enclave properties,&#160;SGX guarantees&#160;that if&#160;two enclaves&#160;call EGETKEY,&#160;they will&#160;receive a&#160;<br/>unique key only accessible by the respective&#160;enclave. It&#160;also guarantees that the enclave&#160;will receive&#160;the same key&#160;<br/>on every future&#160;execution of EGETKEY.&#160;Some&#160;parameters are&#160;optional or&#160;configurable by software. For&#160;example, a&#160;<br/>Seal key can&#160;be based on the&#160;signer of the&#160;enclave, resulting in a key available to multiple enclaves signed by the&#160;<br/>same party.<br/>The EGETKEY&#160;leaf function provides several&#160;key types.&#160;Each key&#160;is specific to&#160;the processor,&#160;CPUSVN,&#160;and&#160;the&#160;<br/>enclave that executed&#160;EGETKEY.&#160;The EGETKEY instruction definition details how each of these&#160;keys is derived, see&#160;<br/><a href="o_fe12b1e2a880e0ce-1895.html">Table 41-56. Ad</a>ditionally,</p>
<p style="position:absolute;top:886px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:886px;left:95px;white-space:nowrap" class="ft06">SEAL&#160;Key: The Seal key&#160;is&#160;a&#160;general&#160;purpose&#160;key for the&#160;enclave&#160;to use&#160;to protect secrets.&#160;Typical uses&#160;of&#160;the&#160;<br/>Seal key are&#160;encrypting and calculating&#160;MAC&#160;of&#160;secrets&#160;on disk.&#160;There&#160;are&#160;2&#160;types&#160;of&#160;Seal Key described&#160;in&#160;<br/><a href="o_fe12b1e2a880e0ce-1796.html">Section 39.4.3.1</a>.&#160;</p>
<p style="position:absolute;top:941px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:942px;left:95px;white-space:nowrap" class="ft06">REPORT&#160;Key:&#160;This key is used to compute the MAC on the REPORT&#160;structure.&#160;The EREPORT&#160;leaf&#160;function is used&#160;<br/>to compute this MAC, and&#160;destination&#160;enclave uses the&#160;Report key&#160;to&#160;verify&#160;the MAC.&#160;The software&#160;usage&#160;flow&#160;<br/>is detailed&#160;in<a href="o_fe12b1e2a880e0ce-1796.html">&#160;Section 39.4.3.2.</a>&#160;</p>
<p style="position:absolute;top:997px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:997px;left:95px;white-space:nowrap" class="ft06">EINITOKENKEY:&#160;This&#160;key&#160;is&#160;used&#160;by&#160;Launch&#160;Enclaves&#160;to compute&#160;the MAC on&#160;EINITTOKENs.&#160;These&#160;tokens&#160;are&#160;<br/>then verified&#160;in the EINIT leaf function. The key is only available&#160;to enclaves with&#160;ATTRIBUTE.</p>
<p style="position:absolute;top:1014px;left:718px;white-space:nowrap" class="ft03">EINITTOKENKEY&#160;set&#160;</p>
<p style="position:absolute;top:1030px;left:95px;white-space:nowrap" class="ft03">to 1.&#160;</p>
</div>
</body>
</html>
