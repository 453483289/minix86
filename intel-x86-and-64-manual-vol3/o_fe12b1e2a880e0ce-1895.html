<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1895</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1895-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1895.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:760px;white-space:nowrap" class="ft00">Vol. 3D&#160;41-85</p>
<p style="position:absolute;top:47px;left:654px;white-space:nowrap" class="ft01">SGX INSTRUCTION REFERENCES</p>
<p style="position:absolute;top:447px;left:69px;white-space:nowrap" class="ft06">Keys&#160;that permit the specification of a CPU or&#160;ISV's&#160;code's SVNs have additional requirements. The caller may not&#160;<br/>request&#160;a key for an SVN&#160;beyond the&#160;current CPU or&#160;ISV SVN, respectively.&#160;<br/>Several&#160;keys are access&#160;controlled. Access to the&#160;Provisioning Key and Provisioning Seal key requires the enclave's&#160;<br/>ATTRIBUTES.PROVISIONKEY be&#160;set.&#160;The EINITTOKEN Key requires ATTRIBUTES.EINITTOKENKEY&#160;be&#160;set and&#160;<br/>SECS.MRSIGNER equal IA32_SGXLEPUBKEYHASH.<br/>Some&#160;keys are&#160;derived&#160;based on&#160;a hardcode&#160;PKCS&#160;padding&#160;constant&#160;(352&#160;byte string):&#160;<br/>HARDCODED_PKCS1_5_PADDING[15:0]&#160;</p>
<p style="position:absolute;top:564px;left:362px;white-space:nowrap" class="ft02">&#160;0100H;</p>
<p style="position:absolute;top:586px;left:69px;white-space:nowrap" class="ft02">HARDCODED_PKCS1_5_PADDING[2655:16]&#160;</p>
<p style="position:absolute;top:586px;left:388px;white-space:nowrap" class="ft02">&#160;SignExtend330Byte(-1); //&#160;330&#160;bytes of 0FFH</p>
<p style="position:absolute;top:609px;left:69px;white-space:nowrap" class="ft02">HARDCODED_PKCS1_5_PADDING[2815:2656]&#160;</p>
<p style="position:absolute;top:609px;left:405px;white-space:nowrap" class="ft02">&#160;2004000501020403650148866009060D30313000H;</p>
<p style="position:absolute;top:654px;left:69px;white-space:nowrap" class="ft02">The&#160;error codes are:&#160;</p>
<p style="position:absolute;top:919px;left:69px;white-space:nowrap" class="ft01">Concurrency Restrictions</p>
<p style="position:absolute;top:105px;left:357px;white-space:nowrap" class="ft03">Table&#160;41-56.&#160;&#160;Key&#160;Derivation</p>
<p style="position:absolute;top:144px;left:154px;white-space:nowrap" class="ft02">Key Name&#160;Attributes&#160;</p>
<p style="position:absolute;top:127px;left:340px;white-space:nowrap" class="ft02">Owner&#160;</p>
<p style="position:absolute;top:144px;left:340px;white-space:nowrap" class="ft02">Epoch</p>
<p style="position:absolute;top:144px;left:401px;white-space:nowrap" class="ft02">CPU&#160;SVN</p>
<p style="position:absolute;top:144px;left:487px;white-space:nowrap" class="ft02">ISV&#160;SVN</p>
<p style="position:absolute;top:127px;left:566px;white-space:nowrap" class="ft02">ISV&#160;</p>
<p style="position:absolute;top:144px;left:566px;white-space:nowrap" class="ft02">PRODID&#160;MRENCLAVE&#160;MRSIGNER&#160;RAND&#160;</p>
<p style="position:absolute;top:227px;left:89px;white-space:nowrap" class="ft02">Source</p>
<p style="position:absolute;top:166px;left:154px;white-space:nowrap" class="ft02">Key&#160;</p>
<p style="position:absolute;top:182px;left:154px;white-space:nowrap" class="ft02">Dependent&#160;</p>
<p style="position:absolute;top:199px;left:154px;white-space:nowrap" class="ft02">Constant</p>
<p style="position:absolute;top:166px;left:226px;white-space:nowrap" class="ft02">Y&#160;</p>
<p style="position:absolute;top:182px;left:226px;white-space:nowrap" class="ft02">SECS.ATTRIBUTE</p>
<p style="position:absolute;top:199px;left:226px;white-space:nowrap" class="ft02">S and&#160;</p>
<p style="position:absolute;top:216px;left:226px;white-space:nowrap" class="ft02">SECS.MISCSELECT;</p>
<p style="position:absolute;top:166px;left:340px;white-space:nowrap" class="ft02">CSR_SEO</p>
<p style="position:absolute;top:182px;left:340px;white-space:nowrap" class="ft02">WNEREP</p>
<p style="position:absolute;top:199px;left:340px;white-space:nowrap" class="ft02">OCH</p>
<p style="position:absolute;top:166px;left:401px;white-space:nowrap" class="ft02">Y&#160;CPUSVN&#160;</p>
<p style="position:absolute;top:182px;left:401px;white-space:nowrap" class="ft02">Register;</p>
<p style="position:absolute;top:166px;left:487px;white-space:nowrap" class="ft02">R&#160;</p>
<p style="position:absolute;top:182px;left:487px;white-space:nowrap" class="ft02">Req.ISVSVN;</p>
<p style="position:absolute;top:166px;left:566px;white-space:nowrap" class="ft02">SECS.&#160;</p>
<p style="position:absolute;top:182px;left:566px;white-space:nowrap" class="ft02">ISVID</p>
<p style="position:absolute;top:166px;left:622px;white-space:nowrap" class="ft02">SECS.&#160;</p>
<p style="position:absolute;top:182px;left:622px;white-space:nowrap" class="ft02">MRENCLAVE</p>
<p style="position:absolute;top:166px;left:706px;white-space:nowrap" class="ft02">SECS.&#160;</p>
<p style="position:absolute;top:182px;left:706px;white-space:nowrap" class="ft02">MRSIGNER</p>
<p style="position:absolute;top:166px;left:779px;white-space:nowrap" class="ft02">Req.&#160;</p>
<p style="position:absolute;top:182px;left:779px;white-space:nowrap" class="ft02">KEYID</p>
<p style="position:absolute;top:238px;left:226px;white-space:nowrap" class="ft02">RAttribMask &amp;&#160;</p>
<p style="position:absolute;top:254px;left:226px;white-space:nowrap" class="ft02">SECS.ATTRIBUTE</p>
<p style="position:absolute;top:271px;left:226px;white-space:nowrap" class="ft02">S and&#160;</p>
<p style="position:absolute;top:288px;left:226px;white-space:nowrap" class="ft02">SECS.MISCSELECT;</p>
<p style="position:absolute;top:238px;left:401px;white-space:nowrap" class="ft02">R&#160;</p>
<p style="position:absolute;top:254px;left:401px;white-space:nowrap" class="ft02">Req.CPUSVN;</p>
<p style="position:absolute;top:310px;left:74px;white-space:nowrap" class="ft02">EINITTOKEN&#160;Yes</p>
<p style="position:absolute;top:310px;left:226px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:310px;left:340px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:401px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:310px;left:487px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:310px;left:566px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:622px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:310px;left:706px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:779px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:333px;left:74px;white-space:nowrap" class="ft02">Report</p>
<p style="position:absolute;top:333px;left:154px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:333px;left:226px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:333px;left:340px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:333px;left:401px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:333px;left:487px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:333px;left:566px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:333px;left:622px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:333px;left:706px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:333px;left:779px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:74px;white-space:nowrap" class="ft02">Seal</p>
<p style="position:absolute;top:355px;left:154px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:340px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:355px;left:401px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:487px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:566px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:355px;left:622px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:706px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:355px;left:779px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:378px;left:74px;white-space:nowrap" class="ft02">Provisioning&#160;Yes</p>
<p style="position:absolute;top:378px;left:226px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:378px;left:340px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:378px;left:401px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:378px;left:487px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:378px;left:566px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:378px;left:622px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:378px;left:706px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:378px;left:779px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:400px;left:74px;white-space:nowrap" class="ft02">Provisioning&#160;</p>
<p style="position:absolute;top:417px;left:74px;white-space:nowrap" class="ft02">Seal</p>
<p style="position:absolute;top:400px;left:154px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:400px;left:226px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:400px;left:340px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:400px;left:401px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:400px;left:487px;white-space:nowrap" class="ft02">Request</p>
<p style="position:absolute;top:400px;left:566px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:400px;left:622px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:400px;left:706px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:400px;left:779px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:695px;left:307px;white-space:nowrap" class="ft03">Table 41-57.&#160;&#160;EGETKEY&#160;Return&#160;Value in RAX</p>
<p style="position:absolute;top:717px;left:101px;white-space:nowrap" class="ft02">&#160;Error&#160;<a href="o_fe12b1e2a880e0ce-1812.html">Code (see Table 41-3)</a></p>
<p style="position:absolute;top:717px;left:313px;white-space:nowrap" class="ft02">Value</p>
<p style="position:absolute;top:717px;left:564px;white-space:nowrap" class="ft02">Description</p>
<p style="position:absolute;top:739px;left:73px;white-space:nowrap" class="ft02">No&#160;Error</p>
<p style="position:absolute;top:739px;left:306px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:739px;left:364px;white-space:nowrap" class="ft02">EGETKEY successful</p>
<p style="position:absolute;top:762px;left:73px;white-space:nowrap" class="ft02">SGX_INVALID_ATTRIBUTE</p>
<p style="position:absolute;top:762px;left:364px;white-space:nowrap" class="ft05">The KEYREQUEST contains&#160;a KEYNAME for which the enclave is not&#160;<br/>authorized</p>
<p style="position:absolute;top:801px;left:73px;white-space:nowrap" class="ft02">SGX_INVALID_CPUSVN</p>
<p style="position:absolute;top:801px;left:364px;white-space:nowrap" class="ft02">If KEYREQUEST.CPUSVN&#160;is an unsupported platforms CPUSVN value</p>
<p style="position:absolute;top:823px;left:73px;white-space:nowrap" class="ft02">SGX_INVALID_ISVSVN</p>
<p style="position:absolute;top:823px;left:364px;white-space:nowrap" class="ft02">If KEYREQUEST.ISVSVN is greater than the&#160;enclave's&#160;ISV_SVN</p>
<p style="position:absolute;top:846px;left:73px;white-space:nowrap" class="ft02">SGX_INVALID_KEYNAME</p>
<p style="position:absolute;top:846px;left:364px;white-space:nowrap" class="ft02">If&#160;KEYREQUEST.KEYNAME is an&#160;unsupported value</p>
<p style="position:absolute;top:958px;left:147px;white-space:nowrap" class="ft03">Table 41-58. &#160;Concurrency&#160;Restrictions&#160;of&#160;EGETKEY with&#160;Other Intel® SGX Operations&#160;1 of&#160;2</p>
<p style="position:absolute;top:986px;left:87px;white-space:nowrap" class="ft04">Operation</p>
<p style="position:absolute;top:986px;left:188px;white-space:nowrap" class="ft04">EEXIT</p>
<p style="position:absolute;top:986px;left:264px;white-space:nowrap" class="ft04">EADD</p>
<p style="position:absolute;top:986px;left:321px;white-space:nowrap" class="ft04">EBLOCK</p>
<p style="position:absolute;top:980px;left:378px;white-space:nowrap" class="ft04">ECRE</p>
<p style="position:absolute;top:992px;left:381px;white-space:nowrap" class="ft04">ATE</p>
<p style="position:absolute;top:980px;left:419px;white-space:nowrap" class="ft04">EDBGRD/</p>
<p style="position:absolute;top:992px;left:433px;white-space:nowrap" class="ft04">WR</p>
<p style="position:absolute;top:980px;left:494px;white-space:nowrap" class="ft04">EENTER/</p>
<p style="position:absolute;top:992px;left:492px;white-space:nowrap" class="ft04">ERESUME</p>
<p style="position:absolute;top:986px;left:567px;white-space:nowrap" class="ft04">EEXTEND</p>
<p style="position:absolute;top:986px;left:634px;white-space:nowrap" class="ft04">EGETKEY</p>
<p style="position:absolute;top:986px;left:696px;white-space:nowrap" class="ft04">EINIT</p>
<p style="position:absolute;top:986px;left:743px;white-space:nowrap" class="ft04">ELDB/ELDU</p>
<p style="position:absolute;top:986px;left:818px;white-space:nowrap" class="ft04">EPA</p>
<p style="position:absolute;top:1012px;left:123px;white-space:nowrap" class="ft04">Param&#160;TCS&#160;SSA&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:1012px;left:414px;white-space:nowrap" class="ft04">Targ&#160;SECS&#160;TCS&#160;SSA&#160;SECS&#160;Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS&#160;Targ&#160;VA</p>
<p style="position:absolute;top:1012px;left:786px;white-space:nowrap" class="ft04">SECS&#160;VA</p>
<p style="position:absolute;top:1031px;left:68px;white-space:nowrap" class="ft04">EGETKEY</p>
<p style="position:absolute;top:1031px;left:123px;white-space:nowrap" class="ft04">Param</p>
<p style="position:absolute;top:1031px;left:189px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:1031px;left:414px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1031px;left:503px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:1031px;left:624px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:1051px;left:123px;white-space:nowrap" class="ft04">SECS</p>
<p style="position:absolute;top:1051px;left:219px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:250px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:279px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:312px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:341px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:375px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:414px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:443px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:476px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:503px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:531px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:563px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:592px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:624px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:662px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:696px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:731px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:760px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:786px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:1051px;left:817px;white-space:nowrap" class="ft04">Y</p>
</div>
</body>
</html>
