<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 158</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:14px;font-family:Times;color:#0860a8;}
	.ft07{font-size:18px;font-family:Times;color:#0860a8;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page158-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce158.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">5-6&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft08">—&#160;No&#160;instruction&#160;may write&#160;into&#160;a data segment if it&#160;is not&#160;writable.<br/>—&#160;No instruction may&#160;read&#160;an executable&#160;segment unless&#160;the&#160;readable flag&#160;is set.</p>
<p style="position:absolute;top:146px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:147px;left:93px;white-space:nowrap" class="ft08"><b>When an instruction operand contains&#160;a segment selector</b>&#160;—&#160;Certain instructions can access segments&#160;<br/>or gates of only a&#160;particular&#160;type,&#160;for example:<br/>—&#160;A&#160;far&#160;CALL or far JMP&#160;instruction&#160;can only access&#160;a segment descriptor&#160;for&#160;a conforming&#160;code&#160;segment,&#160;</p>
<p style="position:absolute;top:204px;left:119px;white-space:nowrap" class="ft02">nonconforming code segment,&#160;call&#160;gate, task gate, or&#160;TSS.</p>
<p style="position:absolute;top:228px;left:93px;white-space:nowrap" class="ft010">—&#160;The&#160;LLDT&#160;instruction&#160;must&#160;reference&#160;a segment descriptor for&#160;an&#160;LDT.<br/>—&#160;The LTR instruction must reference a&#160;segment&#160;descriptor for a&#160;TSS.<br/>—&#160;The LAR instruction must&#160;reference a segment or gate&#160;descriptor for an&#160;LDT,&#160;TSS,&#160;call&#160;gate,&#160;task gate,&#160;code&#160;</p>
<p style="position:absolute;top:292px;left:119px;white-space:nowrap" class="ft02">segment, or data segment.</p>
<p style="position:absolute;top:316px;left:93px;white-space:nowrap" class="ft08">—&#160;The LSL instruction must reference a&#160;segment&#160;descriptor for a&#160;LDT,&#160;TSS,&#160;code&#160;segment,&#160;or data&#160;segment.<br/>—&#160;IDT&#160;entries must be interrupt,&#160;trap,&#160;or task gates.</p>
<p style="position:absolute;top:362px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:363px;left:93px;white-space:nowrap" class="ft010"><b>During&#160;certain internal operations</b>&#160;— For example:<br/>—&#160;On&#160;a far call or far jump (executed&#160;with&#160;a far CALL&#160;or far JMP instruction),&#160;the&#160;processor determines&#160;the&#160;</p>
<p style="position:absolute;top:403px;left:119px;white-space:nowrap" class="ft09">type of&#160;control transfer&#160;to be carried&#160;out&#160;(call or&#160;jump&#160;to&#160;another code segment,&#160;a call&#160;or jump through&#160;a&#160;<br/>gate, or&#160;a task switch) by checking&#160;the type field&#160;in the&#160;segment&#160;(or gate) descriptor&#160;pointed&#160;to by the&#160;<br/>segment (or gate) selector&#160;given as an operand&#160;in the CALL or&#160;JMP instruction. If&#160;the&#160;descriptor type&#160;is&#160;for&#160;<br/>a&#160;code&#160;segment&#160;or call gate,&#160;a call or&#160;jump to another code&#160;segment&#160;is indicated;&#160;if the&#160;descriptor type is for&#160;<br/>a TSS or task&#160;gate, a&#160;task switch is&#160;indicated.</p>
<p style="position:absolute;top:493px;left:93px;white-space:nowrap" class="ft02">—&#160;On&#160;a call&#160;or jump through a&#160;call gate (or&#160;on&#160;an interrupt-&#160;or exception-handler call&#160;through&#160;a trap&#160;or&#160;</p>
<p style="position:absolute;top:510px;left:119px;white-space:nowrap" class="ft09">interrupt gate),&#160;the processor automatically checks&#160;that&#160;the segment descriptor&#160;being pointed to&#160;by the&#160;<br/>gate is&#160;for&#160;a code segment.</p>
<p style="position:absolute;top:550px;left:93px;white-space:nowrap" class="ft02">—&#160;On&#160;a call or&#160;jump to&#160;a new task through a&#160;task&#160;gate&#160;(or on an interrupt- or exception-handler&#160;call to a&#160;new&#160;</p>
<p style="position:absolute;top:567px;left:119px;white-space:nowrap" class="ft09">task through a task gate), the processor automatically&#160;checks that the segment&#160;descriptor being pointed to&#160;<br/>by&#160;the task gate&#160;is for a&#160;TSS.</p>
<p style="position:absolute;top:607px;left:93px;white-space:nowrap" class="ft02">—&#160;On&#160;a call or jump to a&#160;new&#160;task&#160;by&#160;a direct&#160;reference&#160;to a TSS,&#160;the&#160;processor automatically checks that the&#160;</p>
<p style="position:absolute;top:624px;left:119px;white-space:nowrap" class="ft02">segment&#160;descriptor&#160;being&#160;pointed to&#160;by&#160;the CALL&#160;or JMP instruction is&#160;for a TSS.</p>
<p style="position:absolute;top:648px;left:93px;white-space:nowrap" class="ft02">—&#160;On return&#160;from&#160;a nested task (initiated by an&#160;IRET&#160;instruction), the&#160;processor&#160;checks that the previous&#160;task&#160;</p>
<p style="position:absolute;top:664px;left:119px;white-space:nowrap" class="ft02">link field&#160;in the&#160;current TSS points&#160;to a&#160;TSS.</p>
<p style="position:absolute;top:715px;left:68px;white-space:nowrap" class="ft05">5.4.1&#160;</p>
<p style="position:absolute;top:715px;left:148px;white-space:nowrap" class="ft05">Null Segment Selector Checking</p>
<p style="position:absolute;top:745px;left:68px;white-space:nowrap" class="ft09">Attempting to&#160;load&#160;a nu<a href="o_fe12b1e2a880e0ce-95.html">ll segment selector (see Section&#160;3.4.2,&#160;“Segment Selectors”)&#160;</a>into the CS or&#160;SS&#160;segment&#160;<br/>register generates a&#160;general-protection exception&#160;(#GP).&#160;A null segment selector can&#160;be&#160;loaded into the&#160;DS, ES,&#160;<br/>FS,&#160;or GS&#160;register, but any&#160;attempt to&#160;access a&#160;segment through one&#160;of these registers when it is&#160;loaded&#160;with&#160;a null&#160;<br/>segment selector&#160;results in&#160;a&#160;#GP exception&#160;being&#160;generated. Loading unused&#160;data-segment&#160;registers with a&#160;null&#160;<br/>segment selector&#160;is&#160;a useful&#160;method of&#160;detecting&#160;accesses to&#160;unused segment registers&#160;and/or preventing&#160;<br/>unwanted&#160;accesses&#160;to data segments.</p>
<p style="position:absolute;top:872px;left:68px;white-space:nowrap" class="ft06">5.4.1.1&#160;&#160;</p>
<p style="position:absolute;top:872px;left:152px;white-space:nowrap" class="ft06">NULL&#160;Segment Checking&#160;in 64-bit&#160;Mode</p>
<p style="position:absolute;top:901px;left:68px;white-space:nowrap" class="ft09">In 64-bit mode,&#160;the&#160;processor does&#160;not&#160;perform runtime checking on NULL segment selectors. The&#160;processor does&#160;<br/>not&#160;cause a&#160;#GP fault when an&#160;attempt is&#160;made&#160;to access memory&#160;where the&#160;referenced segment register&#160;has&#160;a&#160;<br/>NULL segment selector.&#160;</p>
<p style="position:absolute;top:989px;left:68px;white-space:nowrap" class="ft07">5.5 PRIVILEGE&#160;</p>
<p style="position:absolute;top:989px;left:250px;white-space:nowrap" class="ft07">LEVELS</p>
<p style="position:absolute;top:1025px;left:68px;white-space:nowrap" class="ft09">The&#160;processor’s segment-protection mechanism&#160;recognizes&#160;4&#160;privilege levels, numbered from&#160;0&#160;to 3. The greater&#160;<br/>numbers&#160;mean lesser privilege<a href="o_fe12b1e2a880e0ce-159.html">s. Figure&#160;5-3</a>&#160;shows how these&#160;levels&#160;of&#160;privilege can be interpreted as&#160;rings of&#160;<br/>protection.&#160;</p>
</div>
</body>
</html>
