<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 394</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:14px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page394-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce394.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">10-32&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">ADVANCED PROGRAMMABLE INTERRUPT CONTROLLER&#160;(APIC)</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft07">APIC.TPR[bits 7:4] = CR8[bits 3:0],&#160;APIC.TPR[bits 3:0]&#160;=&#160;0. A read of CR8&#160;returns a 64-bit value which is the&#160;<br/>value of&#160;TPR[bits 7:4],&#160;zero extended&#160;to 64&#160;bits.</p>
<p style="position:absolute;top:141px;left:68px;white-space:nowrap" class="ft07">There are no ordering mechanisms&#160;between&#160;direct&#160;updates of&#160;the&#160;APIC.TPR and&#160;CR8.&#160;Operating software&#160;should&#160;<br/>implement either&#160;direct APIC&#160;TPR updates or&#160;CR8 style&#160;TPR updates but not mix them. Software&#160;can use&#160;a serial-<br/>izing instruction (for example,&#160;CPUID) to&#160;serialize updates between MOV CR8&#160;and stores to&#160;the APIC.</p>
<p style="position:absolute;top:229px;left:68px;white-space:nowrap" class="ft04">10.9 SPURIOUS&#160;</p>
<p style="position:absolute;top:229px;left:250px;white-space:nowrap" class="ft04">INTERRUPT</p>
<p style="position:absolute;top:265px;left:68px;white-space:nowrap" class="ft09">A special situation&#160;may occur&#160;when a&#160;processor&#160;raises&#160;its task&#160;priority&#160;to&#160;be&#160;greater&#160;than or equal to the level of the&#160;<br/>interrupt for which&#160;the processor&#160;INTR&#160;signal&#160;is&#160;currently being asserted.&#160;If at the&#160;time&#160;the INTA&#160;cycle&#160;is issued, the&#160;<br/>interrupt that was&#160;to be dispensed has&#160;become&#160;masked&#160;(programmed by software), the&#160;local&#160;APIC will&#160;deliver a&#160;<br/>spurious-interrupt vector.&#160;Dispensing the&#160;spurious-interrupt&#160;vector does not&#160;affect&#160;the ISR,&#160;so the&#160;handler for this&#160;<br/>vector&#160;should&#160;return without&#160;an EOI.<br/>The&#160;vector&#160;number&#160;for the&#160;spurious-interrupt vector is&#160;specified&#160;in&#160;the spurious-interrupt vector register&#160;(see&#160;<br/><a href="o_fe12b1e2a880e0ce-395.html">Figure&#160;10-23).</a>&#160;The&#160;functions&#160;of&#160;the fields in&#160;this register are&#160;as&#160;follows:<br/><b>Spurious Vector</b></p>
<p style="position:absolute;top:393px;left:206px;white-space:nowrap" class="ft03">Determines the&#160;vector&#160;number to be delivered&#160;to&#160;the processor&#160;when&#160;the local APIC generates&#160;</p>
<p style="position:absolute;top:409px;left:205px;white-space:nowrap" class="ft03">a spurious vector.&#160;</p>
<p style="position:absolute;top:430px;left:206px;white-space:nowrap" class="ft03">(Pentium&#160;4 and Intel Xeon processors.) Bits 0&#160;through 7&#160;of the this field are programmable by&#160;</p>
<p style="position:absolute;top:447px;left:205px;white-space:nowrap" class="ft03">software.&#160;</p>
<p style="position:absolute;top:468px;left:206px;white-space:nowrap" class="ft03">(P6&#160;family and&#160;Pentium&#160;processors). Bits&#160;4 through&#160;7 of the&#160;this field are&#160;programmable by&#160;</p>
<p style="position:absolute;top:484px;left:205px;white-space:nowrap" class="ft07">software, and&#160;bits&#160;0&#160;through 3&#160;are&#160;hardwired to logical ones. Software writes&#160;to bits 0 through&#160;<br/>3 have&#160;no effect.</p>
<p style="position:absolute;top:522px;left:68px;white-space:nowrap" class="ft05"><b>APIC Software Enable/Disable</b></p>
<p style="position:absolute;top:543px;left:206px;white-space:nowrap" class="ft03">Allows&#160;software&#160;to temporarily enable (1) or&#160;disable&#160;(0) the&#160;local AP<a href="o_fe12b1e2a880e0ce-370.html">IC (see Section 10.4.3,&#160;</a></p>
<p style="position:absolute;top:559px;left:205px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-370.html">“Enabling&#160;or Disabling&#160;the Local APIC”).</a></p>
<p style="position:absolute;top:580px;left:68px;white-space:nowrap" class="ft05"><b>Focus Processor Checking</b></p>
<p style="position:absolute;top:601px;left:206px;white-space:nowrap" class="ft03">Determines&#160;if focus processor checking&#160;is enabled (0) or disabled (1) when&#160;using the&#160;lowest-</p>
<p style="position:absolute;top:618px;left:205px;white-space:nowrap" class="ft07">priority delivery mode.&#160;In Pentium 4 and&#160;Intel Xeon&#160;processors, this bit is reserved&#160;and should&#160;<br/>be&#160;cleared&#160;to 0.</p>
<p style="position:absolute;top:655px;left:68px;white-space:nowrap" class="ft05"><b>Suppress EOI&#160;Broadcasts</b></p>
<p style="position:absolute;top:676px;left:206px;white-space:nowrap" class="ft03">Determines whether&#160;an&#160;EOI&#160;for a&#160;level-triggered interrupt&#160;causes&#160;EOI&#160;messages to&#160;be&#160;broad-</p>
<p style="position:absolute;top:693px;left:205px;white-space:nowrap" class="ft07">cast&#160;to the I/O&#160;APICs&#160;(0)&#160;or not&#160;(1). Se<a href="o_fe12b1e2a880e0ce-392.html">e Section 10.8.5</a>.&#160;The default value&#160;for this&#160;bit&#160;is 0,&#160;indi-<br/>cating&#160;that EOI broadcasts are performed.&#160;This&#160;bit&#160;is reserved to&#160;0 if the processor does not&#160;<br/>support EOI-broadcast suppression.</p>
<p style="position:absolute;top:760px;left:432px;white-space:nowrap" class="ft06">NOTE</p>
<p style="position:absolute;top:786px;left:120px;white-space:nowrap" class="ft07">Do not program an&#160;LVT or&#160;IOAPIC RTE&#160;with a&#160;spurious vector even if&#160;you set the&#160;mask&#160;bit.&#160;A&#160;<br/>spurious vector ISR does not&#160;do an&#160;EOI. If for&#160;some&#160;reason an&#160;interrupt is&#160;generated by an&#160;LVT or&#160;<br/>RTE entry,&#160;the bit in the in-service&#160;register&#160;will be&#160;left set for&#160;the&#160;spurious vector. This will mask all&#160;<br/>interrupts at&#160;the&#160;same or&#160;lower&#160;priority</p>
<p style="position:absolute;top:891px;left:68px;white-space:nowrap" class="ft04">10.10&#160;&#160;APIC BUS MESSAGE PASSING MECHANISM AND</p>
<p style="position:absolute;top:916px;left:146px;white-space:nowrap" class="ft04">PROTOCOL (P6 FAMILY, PENTIUM PROCESSORS)</p>
<p style="position:absolute;top:952px;left:68px;white-space:nowrap" class="ft07">The Pentium 4 and&#160;Intel Xeon processors pass&#160;messages among the&#160;local and I/O APICs on the&#160;system bus, using&#160;<br/>the&#160;system bus&#160;message passing mechanism and&#160;protocol.<br/>The&#160;P6&#160;family and&#160;Pentium processors,&#160;pass messages&#160;among&#160;the local&#160;and I/O&#160;APICs&#160;on&#160;the serial APIC&#160;bus, as&#160;<br/>follows.&#160;Because only one&#160;message&#160;can be sent&#160;at a&#160;time&#160;on&#160;the APIC bus, the&#160;I/O APIC and&#160;local APICs employ&#160;a&#160;<br/>“rotating&#160;priority” arbitration protocol&#160;to gain&#160;permission&#160;to send a&#160;message&#160;on the&#160;APIC&#160;bus.&#160;One&#160;or&#160;more&#160;APICs&#160;<br/>may start sending their messages simultaneously. At&#160;the beginning of every message, each&#160;APIC presents the type&#160;<br/>of the message it&#160;is sending and its&#160;current&#160;arbitration&#160;priority&#160;on&#160;the APIC bus. This information&#160;is used&#160;for arbi-</p>
</div>
</body>
</html>
