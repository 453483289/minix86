<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 654</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:7px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:8px;line-height:13px;font-family:Times;color:#000000;}
	.ft011{font-size:7px;line-height:9px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page654-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce654.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">18-18&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft09">Writing&#160;0 to&#160;both bits stops the&#160;performance counter.&#160;Writing 11B causes&#160;the counter&#160;to increment&#160;irrespective&#160;<br/>of privilege&#160;levels.</p>
<p style="position:absolute;top:397px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:398px;left:93px;white-space:nowrap" class="ft09"><b>PMI field (fourth&#160;bit in each 4-bit control)</b>&#160;— When&#160;set,&#160;the&#160;logical processor generates an&#160;exception&#160;<br/>through its&#160;local APIC on&#160;overflow&#160;condition&#160;of&#160;the respective&#160;fixed-function&#160;counter.</p>
<p style="position:absolute;top:465px;left:68px;white-space:nowrap" class="ft05">18.4.2&#160;</p>
<p style="position:absolute;top:465px;left:148px;white-space:nowrap" class="ft05">Global Counter Control Facilities</p>
<p style="position:absolute;top:495px;left:68px;white-space:nowrap" class="ft09">Processors&#160;based on&#160;Intel Core microarchitecture&#160;provides simplified&#160;performance counter control&#160;that&#160;simplifies&#160;<br/>the most&#160;frequent operations in&#160;programming&#160;performance events,&#160;i.e.&#160;enabling/disabling&#160;event counting and&#160;<br/>checking the&#160;status of counter&#160;overflows.&#160;This is&#160;done by&#160;the following three&#160;MSRs:</p>
<p style="position:absolute;top:550px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:551px;left:93px;white-space:nowrap" class="ft09">MSR_PERF_GLOBAL_CTRL&#160;enables/disables event&#160;counting&#160;for all or any&#160;combination of fixed-function PMCs&#160;<br/>(MSR_PERF_FIXED_CTRx) or general-purpose&#160;PMCs via&#160;a single&#160;WRMSR.</p>
<p style="position:absolute;top:589px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:590px;left:93px;white-space:nowrap" class="ft09">MSR_PERF_GLOBAL_STATUS&#160;allows software&#160;to query&#160;counter&#160;overflow conditions on&#160;any combination of&#160;<br/>fixed-function&#160;PMCs (MSR_PERF_FIXED_CTRx) or&#160;general-purpose PMCs&#160;via a&#160;single&#160;RDMSR.</p>
<p style="position:absolute;top:628px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:629px;left:93px;white-space:nowrap" class="ft09">MSR_PERF_GLOBAL_OVF_CTRL&#160;allows software&#160;to clear&#160;counter overflow&#160;conditions&#160;on any&#160;combination&#160;of&#160;<br/>fixed-function&#160;PMCs (MSR_PERF_FIXED_CTRx) or&#160;general-purpose PMCs&#160;via a&#160;single&#160;WRMSR.</p>
<p style="position:absolute;top:690px;left:68px;white-space:nowrap" class="ft09">MSR_PERF_GLOBAL_CTRL&#160;MSR provides single-bit&#160;controls&#160;to&#160;enable counting&#160;in&#160;each&#160;performance counter (see&#160;<br/><a href="o_fe12b1e2a880e0ce-654.html">Figure&#160;18-15).</a>&#160;Each enable&#160;bit in MSR_PERF_GLOBAL_CTRL is&#160;AND’ed with the&#160;enable&#160;bits for all privilege&#160;levels&#160;in&#160;<br/>the respective IA32_PERFEVTSELx&#160;or MSR_PERF_FIXED_CTR_CTRL&#160;MSRs&#160;to start/stop&#160;the&#160;counting&#160;of respective&#160;<br/>counters. Counting is&#160;enabled if the&#160;AND’ed results&#160;is&#160;true;&#160;counting&#160;is disabled when the&#160;result is&#160;false.</p>
<p style="position:absolute;top:352px;left:254px;white-space:nowrap" class="ft06">Figure&#160;18-14. &#160;Layout&#160;of&#160;MSR_PERF_FIXED_CTR_CTRL&#160;MSR</p>
<p style="position:absolute;top:999px;left:265px;white-space:nowrap" class="ft06">Figure&#160;18-15. &#160;Layout&#160;of&#160;MSR_PERF_GLOBAL_CTRL&#160;MSR</p>
<p style="position:absolute;top:249px;left:225px;white-space:nowrap" class="ft010">Cntr2 —&#160;Controls for MSR_PERF_FIXED_CTR2<br/>Cntr1 —&#160;Controls for MSR_PERF_FIXED_CTR1<br/>PMI&#160;— Enable PMI&#160;on&#160;overflow<br/>Cntr0 —&#160;Controls for MSR_PERF_FIXED_CTR0</p>
<p style="position:absolute;top:168px;left:576px;white-space:nowrap" class="ft07">8&#160;7</p>
<p style="position:absolute;top:168px;left:678px;white-space:nowrap" class="ft07">0</p>
<p style="position:absolute;top:305px;left:225px;white-space:nowrap" class="ft07">ENABLE — 0:&#160;disable;&#160;1:&#160;OS;&#160;2:&#160;User; 3:&#160;All ring levels</p>
<p style="position:absolute;top:191px;left:671px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:188px;left:636px;white-space:nowrap" class="ft08">P</p>
<p style="position:absolute;top:197px;left:638px;white-space:nowrap" class="ft08">M</p>
<p style="position:absolute;top:207px;left:638px;white-space:nowrap" class="ft08">I</p>
<p style="position:absolute;top:168px;left:530px;white-space:nowrap" class="ft07">11</p>
<p style="position:absolute;top:168px;left:636px;white-space:nowrap" class="ft07">3</p>
<p style="position:absolute;top:168px;left:517px;white-space:nowrap" class="ft07">12</p>
<p style="position:absolute;top:168px;left:662px;white-space:nowrap" class="ft07">1</p>
<p style="position:absolute;top:326px;left:263px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:168px;left:245px;white-space:nowrap" class="ft07">63</p>
<p style="position:absolute;top:168px;left:650px;white-space:nowrap" class="ft07">2</p>
<p style="position:absolute;top:192px;left:620px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:192px;left:569px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:168px;left:627px;white-space:nowrap" class="ft07">4</p>
<p style="position:absolute;top:168px;left:564px;white-space:nowrap" class="ft07">9</p>
<p style="position:absolute;top:168px;left:616px;white-space:nowrap" class="ft07">5</p>
<p style="position:absolute;top:188px;left:586px;white-space:nowrap" class="ft08">P</p>
<p style="position:absolute;top:188px;left:533px;white-space:nowrap" class="ft08">P</p>
<p style="position:absolute;top:196px;left:586px;white-space:nowrap" class="ft08">M</p>
<p style="position:absolute;top:195px;left:533px;white-space:nowrap" class="ft08">M</p>
<p style="position:absolute;top:206px;left:589px;white-space:nowrap" class="ft08">I</p>
<p style="position:absolute;top:205px;left:535px;white-space:nowrap" class="ft08">I</p>
<p style="position:absolute;top:892px;left:221px;white-space:nowrap" class="ft010">FIXED_CTR2&#160;enable<br/>FIXED_CTR1&#160;enable<br/>FIXED_CTR0&#160;enable<br/>PMC1 enable</p>
<p style="position:absolute;top:811px;left:650px;white-space:nowrap" class="ft07">2&#160;1&#160;0</p>
<p style="position:absolute;top:948px;left:221px;white-space:nowrap" class="ft07">PMC0 enable</p>
<p style="position:absolute;top:812px;left:430px;white-space:nowrap" class="ft07">31</p>
<p style="position:absolute;top:812px;left:417px;white-space:nowrap" class="ft07">32</p>
<p style="position:absolute;top:812px;left:404px;white-space:nowrap" class="ft07">33</p>
<p style="position:absolute;top:812px;left:392px;white-space:nowrap" class="ft07">34</p>
<p style="position:absolute;top:812px;left:379px;white-space:nowrap" class="ft07">35</p>
<p style="position:absolute;top:972px;left:252px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:811px;left:240px;white-space:nowrap" class="ft07">63</p>
</div>
</body>
</html>
