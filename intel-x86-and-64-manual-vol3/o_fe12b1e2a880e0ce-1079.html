<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1079</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#0860a8;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1079-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1079.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:769px;white-space:nowrap" class="ft00">Vol. 3C&#160;25-5</p>
<p style="position:absolute;top:47px;left:673px;white-space:nowrap" class="ft01">VMX&#160;NON-ROOT&#160;OPERATION</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft02">—&#160;The&#160;value of ECX&#160;is in the&#160;range C0000000H&#160;–&#160;C0001FFFH&#160;and bit&#160;<i>n</i>&#160;in write bitmap for&#160;high&#160;MSRs is&#160;1,&#160;</p>
<p style="position:absolute;top:117px;left:120px;white-space:nowrap" class="ft02">where&#160;<i>n</i>&#160;is the&#160;value of ECX&#160;&amp;&#160;00001FFFH.</p>
<p style="position:absolute;top:139px;left:94px;white-space:nowrap" class="ft02">S<a href="o_fe12b1e2a880e0ce-1060.html">ee Section 24.6.9&#160;</a>for&#160;details regarding&#160;how these bitmaps are&#160;identified.</p>
<p style="position:absolute;top:161px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:162px;left:95px;white-space:nowrap" class="ft08"><b>XRSTORS.</b>&#160;The&#160;XRSTORS instruction causes&#160;a VM&#160;exit&#160;if&#160;the&#160;“enable&#160;XSAVES/XRSTORS” VM-execution control&#160;<br/>is&#160;1and&#160;any bit&#160;is set in&#160;the&#160;logical-AND of&#160;the&#160;following&#160;three&#160;values: EDX:EAX,&#160;the IA32_XSS&#160;MSR,&#160;and&#160;the&#160;<br/>XS<a href="o_fe12b1e2a880e0ce-1063.html">S-exiting bitmap (see Section 24.6.19).</a></p>
<p style="position:absolute;top:217px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:217px;left:95px;white-space:nowrap" class="ft08"><b>XSAVES.</b>&#160;The XSAVES&#160;instruction&#160;causes&#160;a VM&#160;exit if the&#160;“enable XSAVES/XRSTORS” VM-execution control&#160;is&#160;<br/>1 and any bit is set&#160;in the&#160;logical-AND of the following&#160;three values: EDX:EAX, the IA32_XSS&#160;MSR,&#160;and the XSS-<br/><a href="o_fe12b1e2a880e0ce-1063.html">exiting bitmap (see Section 24.6.19).</a></p>
<p style="position:absolute;top:306px;left:69px;white-space:nowrap" class="ft06">25.2&#160;</p>
<p style="position:absolute;top:306px;left:148px;white-space:nowrap" class="ft06">OTHER CAUSES&#160;OF&#160;VM&#160;EXITS</p>
<p style="position:absolute;top:342px;left:69px;white-space:nowrap" class="ft02">In&#160;addition&#160;to VM&#160;exits caused&#160;by instruction execution,&#160;the following&#160;events can&#160;cause VM&#160;exits:</p>
<p style="position:absolute;top:364px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:364px;left:95px;white-space:nowrap" class="ft08"><b>Exceptions.</b>&#160;Exceptions (faults, traps, and&#160;aborts) cause VM&#160;exits based on the exception bitmap (see<a href="o_fe12b1e2a880e0ce-1058.html">&#160;Section&#160;<br/>24.6.3).</a>&#160;If an exception occurs,&#160;its vector (in the range&#160;0–31) is used to select a bit in the exception bitmap.&#160;If&#160;<br/>the&#160;bit is&#160;1,&#160;a VM&#160;exit&#160;occurs; if the bit is&#160;0,&#160;the exception is&#160;delivered&#160;normally through the&#160;guest&#160;IDT.&#160;This&#160;use&#160;<br/>of the&#160;exception bitmap applies&#160;also&#160;to exceptions generated by the instructions INT3, INTO,&#160;BOUND,&#160;and&#160;UD2.<br/>Page&#160;faults (exceptions&#160;with vector 14) are specially treated.&#160;When&#160;a page&#160;fault&#160;occurs,&#160;a&#160;processor&#160;consults&#160;<br/>(1)&#160;bit&#160;14&#160;of the exception bitmap;&#160;(2)&#160;the&#160;error code&#160;produced with the&#160;page fault&#160;[PFEC]; (3)&#160;the&#160;page-fault&#160;<br/>error-code mask field [PFEC_MASK];&#160;and&#160;(4)&#160;the page-fault&#160;error-code match field [PFEC_MATCH]. It checks if&#160;<br/>PFEC&#160;&amp; PFEC_MASK&#160;=&#160;PFEC_MATCH.&#160;If there&#160;is equality,&#160;the&#160;specification&#160;of bit&#160;14&#160;in the&#160;exception bitmap&#160;is&#160;<br/>followed (for example,&#160;a VM&#160;exit occurs&#160;if&#160;that bit&#160;is&#160;set).&#160;If there&#160;is inequality,&#160;the meaning of that bit is&#160;<br/>reversed (for example, a&#160;VM&#160;exit&#160;occurs if that&#160;bit&#160;is clear).<br/>Thus,&#160;if&#160;software desires&#160;VM&#160;exits&#160;on&#160;all&#160;page&#160;faults,&#160;it can&#160;set bit 14 in&#160;the&#160;exception&#160;bitmap to&#160;1 and set&#160;the&#160;<br/>page-fault error-code&#160;mask&#160;and match&#160;fields each to&#160;00000000H.&#160;If software&#160;desires VM&#160;exits on no&#160;page&#160;<br/>faults, it&#160;can set&#160;bit&#160;14&#160;in the&#160;exception bitmap to 1,&#160;the&#160;page-fault&#160;error-code&#160;mask field&#160;to&#160;00000000H,&#160;and&#160;<br/>the page-fault error-code&#160;match field&#160;to FFFFFFFFH.</p>
<p style="position:absolute;top:613px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:613px;left:95px;white-space:nowrap" class="ft08"><b>Triple fault.</b>&#160;A VM&#160;exit occurs&#160;if&#160;the logical processor encounters an&#160;exception&#160;while attempting to&#160;call the&#160;<br/>double-fault handler and&#160;that exception&#160;itself does&#160;not&#160;cause&#160;a VM&#160;exit&#160;due&#160;to the&#160;exception bitmap.&#160;This&#160;<br/>applies to&#160;the case in&#160;which the&#160;double-fault&#160;exception&#160;was generated within VMX non-root operation,&#160;the case&#160;<br/>in which the double-fault exception was&#160;generated&#160;during&#160;event injection by VM&#160;entry,&#160;and to the&#160;case in&#160;which&#160;<br/>VM&#160;entry&#160;is injecting&#160;a double-fault exception.</p>
<p style="position:absolute;top:701px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:702px;left:95px;white-space:nowrap" class="ft08"><b>External interrupts.</b>&#160;An&#160;external interrupt causes&#160;a VM&#160;exit if&#160;the “external-interrupt exiting” VM-execution&#160;<br/>control&#160;is 1.&#160;(S<a href="o_fe12b1e2a880e0ce-1091.html">ee Section&#160;25.6 for an&#160;</a>exception.)&#160;Otherwise,&#160;the interrupt is&#160;delivered&#160;normally through the&#160;<br/>IDT.&#160;(If a logical processor is in the&#160;shutdown state&#160;or&#160;the wait-for-SIPI state, external&#160;interrupts are&#160;blocked.&#160;<br/>The&#160;interrupt&#160;is not delivered&#160;through&#160;the IDT and&#160;no VM&#160;exit&#160;occurs.)</p>
<p style="position:absolute;top:773px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:774px;left:95px;white-space:nowrap" class="ft08"><b>Non-maskable interrupts (NMIs).</b>&#160;An NMI&#160;causes&#160;a VM&#160;exit if the&#160;“NMI exiting”&#160;VM-execution control is&#160;1.&#160;<br/>Otherwise, it is delivered&#160;using descriptor 2&#160;of&#160;the&#160;IDT.&#160;(If&#160;a logical&#160;processor&#160;is in the wait-for-SIPI state,&#160;NMIs&#160;<br/>are blocked.&#160;The NMI is&#160;not&#160;delivered through the&#160;IDT&#160;and no&#160;VM&#160;exit occurs.)</p>
<p style="position:absolute;top:829px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:829px;left:95px;white-space:nowrap" class="ft08"><b>INIT signals.</b>&#160;INIT signals cause&#160;VM&#160;exits. A logical processor performs&#160;none&#160;of&#160;the&#160;operations&#160;normally&#160;<br/>associated&#160;with these&#160;events.&#160;Such exits do&#160;not&#160;modify&#160;register state or&#160;clear pending&#160;events as&#160;they&#160;would&#160;<br/>outside&#160;of VMX&#160;operation. (If a&#160;logical&#160;processor is&#160;in the wait-for-SIPI state,&#160;INIT signals are&#160;blocked.&#160;They&#160;do&#160;<br/>not cause&#160;VM&#160;exits in this&#160;case.)</p>
<p style="position:absolute;top:901px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:901px;left:95px;white-space:nowrap" class="ft08"><b>Start-up&#160;IPIs&#160;(SIPIs).&#160;SIPIs cause VM&#160;exits.</b>&#160;If a logical processor is not in the&#160;wait-for-SIPI activity&#160;state&#160;<br/>when&#160;a SIPI arrives, no VM&#160;exit occurs&#160;and the&#160;SIPI is&#160;discarded.&#160;VM&#160;exits due to&#160;SIPIs do&#160;not perform any&#160;of&#160;<br/>the normal operations&#160;associated with those events: they&#160;do&#160;not modify register&#160;state&#160;as&#160;they would outside of&#160;<br/>VMX operation. (If a&#160;logical&#160;processor&#160;is not in&#160;the wait-for-SIPI&#160;state,&#160;SIPIs are&#160;blocked. They&#160;do not&#160;cause&#160;<br/>VM&#160;exits in this&#160;case.)</p>
<p style="position:absolute;top:989px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:990px;left:95px;white-space:nowrap" class="ft08"><b>Task switches.&#160;</b>Task&#160;switches&#160;are not allowed in VMX non-root operation.&#160;Any attempt to effect a&#160;task switch&#160;<br/>in VMX non-root operation causes&#160;a VM&#160;exit.&#160;<a href="o_fe12b1e2a880e0ce-1084.html">See Section 25.4.2.</a></p>
<p style="position:absolute;top:1028px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:1029px;left:95px;white-space:nowrap" class="ft08"><b>System-management interrupts&#160;(SMIs).&#160;</b>If&#160;the&#160;logical&#160;processor&#160;is using&#160;the dual-monitor&#160;treatment of&#160;<br/>SMIs and&#160;system-management mode&#160;(SMM),&#160;SMIs cause&#160;SMM&#160;VM&#160;exits.&#160;S<a href="o_fe12b1e2a880e0ce-1269.html">ee&#160;Section&#160;34.15.2.</a></p>
<p style="position:absolute;top:1043px;left:730px;white-space:nowrap" class="ft07">1</p>
</div>
</body>
</html>
