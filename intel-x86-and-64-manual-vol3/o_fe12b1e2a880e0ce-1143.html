<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1143</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:16px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1143-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1143.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3C&#160;27-25</p>
<p style="position:absolute;top:47px;left:782px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft08">count)&#160;is processed in order by&#160;storing the&#160;value of&#160;the MSR&#160;indexed&#160;by bits&#160;31:0&#160;(as&#160;they&#160;would be read&#160;by&#160;<br/>RDMSR)&#160;into bits&#160;127:64.&#160;Processing&#160;of&#160;an entry fails&#160;in either&#160;of the&#160;following cases:</p>
<p style="position:absolute;top:139px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:139px;left:95px;white-space:nowrap" class="ft08">The&#160;value of&#160;bits&#160;31:8&#160;is&#160;000008H,&#160;meaning&#160;that the&#160;indexed&#160;MSR is one&#160;that allows access to&#160;an APIC register&#160;<br/>when&#160;the local&#160;APIC&#160;is in x2APIC mode.&#160;</p>
<p style="position:absolute;top:178px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:178px;left:95px;white-space:nowrap" class="ft08">The&#160;value of bits&#160;31:0&#160;indicates&#160;an MSR&#160;that&#160;can be&#160;read&#160;only&#160;in system-management mode (SMM)&#160;and the&#160;<br/>VM&#160;exit will not end in&#160;SMM.&#160;(IA32_SMBASE&#160;is&#160;an MSR that&#160;can be read only in SMM.)</p>
<p style="position:absolute;top:217px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:217px;left:95px;white-space:nowrap" class="ft08">The value of bits&#160;31:0&#160;indicates&#160;an MSR&#160;that&#160;cannot be&#160;saved on&#160;VM&#160;exits for&#160;model-specific&#160;reasons. A&#160;<br/>processor&#160;may prevent&#160;certain MSRs&#160;(based on the value&#160;of&#160;bits&#160;31:0) from being stored&#160;on&#160;VM&#160;exits,&#160;even if&#160;<br/>they&#160;can normally&#160;be read by&#160;RDMSR.&#160;Such model-specific behavior is&#160;<a href="o_fe12b1e2a880e0ce-1281.html">documented in Chapter&#160;35.</a></p>
<p style="position:absolute;top:272px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:273px;left:95px;white-space:nowrap" class="ft02">Bits&#160;63:32&#160;of the&#160;entry are&#160;not all&#160;0.</p>
<p style="position:absolute;top:295px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:295px;left:95px;white-space:nowrap" class="ft08">An&#160;attempt&#160;to read&#160;the&#160;MSR indexed by&#160;bits&#160;31:0&#160;would&#160;cause&#160;a general-protection exception&#160;if&#160;executed&#160;via&#160;<br/>RDMSR&#160;with CPL&#160;=&#160;0.</p>
<p style="position:absolute;top:336px;left:69px;white-space:nowrap" class="ft02">A VMX&#160;abort occurs&#160;if&#160;processing fails&#160;for&#160;any entry.&#160;S<a href="o_fe12b1e2a880e0ce-1147.html">ee Section 27.7.</a></p>
<p style="position:absolute;top:391px;left:69px;white-space:nowrap" class="ft04">27.5&#160;</p>
<p style="position:absolute;top:391px;left:148px;white-space:nowrap" class="ft04">LOADING HOST&#160;STATE</p>
<p style="position:absolute;top:427px;left:69px;white-space:nowrap" class="ft02">Processor state is&#160;updated on VM&#160;exits in&#160;the following ways:</p>
<p style="position:absolute;top:449px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:450px;left:95px;white-space:nowrap" class="ft02">Some&#160;state is&#160;loaded from or&#160;otherwise&#160;determined&#160;by the&#160;contents&#160;of the&#160;host-state area.</p>
<p style="position:absolute;top:472px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:472px;left:95px;white-space:nowrap" class="ft02">Some&#160;state&#160;is determined&#160;by VM-exit controls.</p>
<p style="position:absolute;top:494px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:495px;left:95px;white-space:nowrap" class="ft02">Some&#160;state&#160;is established in the&#160;same&#160;way&#160;on&#160;every&#160;VM&#160;exit.</p>
<p style="position:absolute;top:517px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:517px;left:95px;white-space:nowrap" class="ft02">The&#160;page-directory&#160;pointers are&#160;loaded&#160;based on the&#160;values&#160;of certain&#160;control registers.</p>
<p style="position:absolute;top:541px;left:69px;white-space:nowrap" class="ft08">This loading may be&#160;performed in any order.<br/>On&#160;processors that support&#160;Intel&#160;64 architecture, the full&#160;values&#160;of&#160;each&#160;64-bit&#160;field&#160;loaded&#160;(for&#160;example,&#160;the&#160;base&#160;<br/>address for GDTR) is&#160;loaded regardless&#160;of&#160;the&#160;mode of&#160;the logical processor before and&#160;after the&#160;VM&#160;exit.<br/>The loading&#160;of host state is&#160;detailed in&#160;<a href="o_fe12b1e2a880e0ce-1143.html">Section&#160;27.5.1 to&#160;</a><a href="o_fe12b1e2a880e0ce-1146.html">Section 27.5.5.</a>&#160;These sections&#160;reference&#160;VMCS&#160;fields&#160;that&#160;<br/>correspond&#160;to processor state.&#160;Unless&#160;otherwise stated, these&#160;references&#160;are&#160;to fields&#160;in the&#160;host-state&#160;area.<br/>A logical processor is&#160;in&#160;IA-32e mode&#160;after a&#160;VM&#160;exit&#160;only&#160;if the&#160;“host address-space&#160;size”&#160;VM-exit&#160;control&#160;is&#160;1.&#160;If&#160;<br/>the logical processor was in IA-32e mode before&#160;the&#160;VM&#160;exit&#160;and&#160;this control is 0, a VMX abort occurs. S<a href="o_fe12b1e2a880e0ce-1147.html">ee Section&#160;<br/>27.7.<br/></a>In addition to&#160;loading host&#160;state, VM&#160;exits clear&#160;address-range&#160;monitoring<a href="o_fe12b1e2a880e0ce-1146.html">&#160;(Section 27.5.6).<br/></a>After&#160;the state&#160;loading described in this&#160;section, VM&#160;exits&#160;may load&#160;MSRs from the&#160;VM-exit&#160;MSR-load area (see&#160;<br/><a href="o_fe12b1e2a880e0ce-1147.html">Section 27.6).&#160;</a>This loading occurs&#160;only&#160;after&#160;the&#160;state loading described in&#160;this section.</p>
<p style="position:absolute;top:794px;left:69px;white-space:nowrap" class="ft05">27.5.1&#160;</p>
<p style="position:absolute;top:794px;left:150px;white-space:nowrap" class="ft05">Loading Host&#160;Control Registers, Debug Registers,&#160;MSRs</p>
<p style="position:absolute;top:825px;left:69px;white-space:nowrap" class="ft02">VM&#160;exits load new values&#160;for&#160;controls&#160;registers,&#160;debug registers, and&#160;some MSRs:</p>
<p style="position:absolute;top:847px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:847px;left:95px;white-space:nowrap" class="ft09">CR0,&#160;CR3,&#160;and&#160;CR4&#160;are&#160;loaded&#160;from&#160;the CR0&#160;field,&#160;the&#160;CR3 field,&#160;and&#160;the&#160;CR4 field,&#160;respectively,&#160;with&#160;the&#160;<br/>following exceptions:<br/>—&#160;The following&#160;bits&#160;are&#160;not&#160;modified:</p>
<p style="position:absolute;top:913px;left:120px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:912px;left:146px;white-space:nowrap" class="ft08">For&#160;CR0,&#160;ET, CD,&#160;NW;&#160;bits&#160;63:32 (on processors&#160;that&#160;support Intel&#160;64&#160;architecture),&#160;28:19,&#160;17, and&#160;<br/>15:6; and&#160;any bits that&#160;are fixed&#160;in&#160;VMX oper<a href="o_fe12b1e2a880e0ce-1045.html">ation (see Section 23.8).</a></p>
<p style="position:absolute;top:926px;left:617px;white-space:nowrap" class="ft07">1</p>
<p style="position:absolute;top:954px;left:120px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:952px;left:146px;white-space:nowrap" class="ft08">For CR3,&#160;bits&#160;63:52&#160;and bits in&#160;the range&#160;51:32 beyond&#160;the processor’s&#160;physical-address width (they&#160;<br/>are cleared&#160;to 0).</p>
<p style="position:absolute;top:966px;left:262px;white-space:nowrap" class="ft07">2</p>
<p style="position:absolute;top:969px;left:269px;white-space:nowrap" class="ft02">&#160;(This item&#160;applies only to processors that&#160;support&#160;Intel 64&#160;architecture.)</p>
<p style="position:absolute;top:1000px;left:69px;white-space:nowrap" class="ft02">1.&#160;Bits&#160;28:19,&#160;17,&#160;and 15:6&#160;of&#160;CR0&#160;and&#160;CR0.ET are&#160;unchanged by&#160;executions&#160;of&#160;MOV to&#160;CR0.&#160;CR0.ET&#160;is always&#160;1&#160;and&#160;the&#160;other bits&#160;are&#160;</p>
<p style="position:absolute;top:1017px;left:91px;white-space:nowrap" class="ft02">always 0.</p>
<p style="position:absolute;top:1038px;left:69px;white-space:nowrap" class="ft02">2.&#160;Software&#160;can&#160;determine&#160;a&#160;processor’s physical-address&#160;width by&#160;executing CPUID with 80000008H&#160;in&#160;EAX.&#160;The&#160;physical-address&#160;</p>
<p style="position:absolute;top:1054px;left:91px;white-space:nowrap" class="ft02">width is&#160;returned&#160;in&#160;bits&#160;7:0 of&#160;EAX.</p>
</div>
</body>
</html>
