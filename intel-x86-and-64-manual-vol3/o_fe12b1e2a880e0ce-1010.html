<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1010</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1010-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1010.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">22-6&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">ARCHITECTURE&#160;COMPATIBILITY</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft03">ID (identification&#160;flag), bit&#160;21.&#160;</p>
<p style="position:absolute;top:124px;left:68px;white-space:nowrap" class="ft03">The AC&#160;flag (bit 18) was&#160;added to&#160;the EFLAGS register&#160;in&#160;the Intel486&#160;processor.</p>
<p style="position:absolute;top:175px;left:68px;white-space:nowrap" class="ft04">22.16.1&#160;&#160;Using EFLAGS Flags to&#160;Distinguish Between 32-Bit IA-32 Processors</p>
<p style="position:absolute;top:205px;left:68px;white-space:nowrap" class="ft03">The&#160;following&#160;bits in&#160;the EFLAGS&#160;register that&#160;can be&#160;used&#160;to differentiate between the&#160;32-bit IA-32 processors:</p>
<p style="position:absolute;top:227px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:228px;left:93px;white-space:nowrap" class="ft07">Bit 18 (the AC flag) can be used to distinguish an Intel386&#160;processor from the P6 family, Pentium, and&#160;Intel486&#160;<br/>processors. Since it&#160;is not&#160;implemented&#160;on the&#160;Intel386 processor,&#160;it will always be clear.</p>
<p style="position:absolute;top:266px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:267px;left:93px;white-space:nowrap" class="ft07">Bit 21&#160;(the&#160;ID flag)&#160;indicates&#160;whether&#160;an application&#160;can&#160;execute&#160;the CPUID&#160;instruction. The&#160;ability to&#160;set and&#160;<br/>clear this bit indicates that&#160;the processor is&#160;a P6 family or Pentium processor.&#160;The CPUID&#160;instruction&#160;can then&#160;<br/>be&#160;used&#160;to determine which processor.&#160;</p>
<p style="position:absolute;top:322px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:322px;left:93px;white-space:nowrap" class="ft07">Bits&#160;19&#160;(the&#160;VIF flag)&#160;and 20&#160;(the&#160;VIP flag)&#160;will&#160;always&#160;be&#160;zero on processors that&#160;do not&#160;support virtual&#160;mode&#160;<br/>extensions,&#160;which includes all&#160;32-bit processors prior&#160;to the&#160;Pentium&#160;processor.</p>
<p style="position:absolute;top:363px;left:68px;white-space:nowrap" class="ft08">Se<a href="˛ˇ">e Chapter&#160;19, ‚ÄúProcessor Identification&#160;and&#160;Feature Determination,‚Äù&#160;</a>in<a href="˛ˇ">&#160;the&#160;<i>Intel¬Æ 64 and&#160;IA-32 Architectures&#160;<br/>Software Developer‚Äôs Manual, Volume&#160;1</i>, for more&#160;</a>information on identifying processors.</p>
<p style="position:absolute;top:435px;left:68px;white-space:nowrap" class="ft06">22.17&#160;STACK&#160;</p>
<p style="position:absolute;top:435px;left:214px;white-space:nowrap" class="ft06">OPERATIONS</p>
<p style="position:absolute;top:471px;left:68px;white-space:nowrap" class="ft03">This section identifies&#160;the&#160;differences&#160;in stack implementation between&#160;the&#160;various IA-32 processors.</p>
<p style="position:absolute;top:521px;left:68px;white-space:nowrap" class="ft04">22.17.1 PUSH&#160;</p>
<p style="position:absolute;top:521px;left:198px;white-space:nowrap" class="ft04">SP</p>
<p style="position:absolute;top:552px;left:68px;white-space:nowrap" class="ft07">The P6 family, Pentium, Intel486, Intel386, and Intel 286 processors push a different value&#160;on&#160;the&#160;stack for&#160;a PUSH&#160;<br/>SP&#160;instruction than the&#160;8086 processor.&#160;The 32-bit&#160;processors&#160;push the&#160;value&#160;of the&#160;SP&#160;register before it&#160;is decre-<br/>mented&#160;as part of the&#160;push operation; the&#160;8086 processor&#160;pushes&#160;the&#160;value&#160;of the&#160;SP&#160;register after&#160;it is&#160;decre-<br/>mented.&#160;If&#160;the&#160;value pushed&#160;is&#160;important,&#160;replace PUSH&#160;SP instructions with&#160;the following three&#160;instructions:</p>
<p style="position:absolute;top:631px;left:88px;white-space:nowrap" class="ft09">PUSH&#160;BP<br/>MOV &#160;BP,&#160;SP<br/>XCHG&#160;BP, [BP]&#160;</p>
<p style="position:absolute;top:691px;left:68px;white-space:nowrap" class="ft07">This code&#160;functions as the 8086&#160;processor PUSH&#160;SP&#160;instruction on the&#160;P6 family, Pentium, Intel486,&#160;Intel386,&#160;and&#160;<br/>Intel 286 processors.</p>
<p style="position:absolute;top:758px;left:68px;white-space:nowrap" class="ft04">22.17.2&#160;&#160;EFLAGS Pushed on the Stack</p>
<p style="position:absolute;top:789px;left:68px;white-space:nowrap" class="ft07">The setting&#160;of the stored values of bits 12 through&#160;15 (which includes the IOPL field and the NT flag) in&#160;the EFLAGS&#160;<br/>register by the&#160;PUSHF instruction,&#160;by interrupts,&#160;and&#160;by&#160;exceptions is&#160;different with the&#160;32-bit IA-32 processors&#160;<br/>than&#160;with the&#160;8086&#160;and Intel&#160;286 processors.&#160;The differences are as&#160;follows:</p>
<p style="position:absolute;top:844px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:844px;left:93px;white-space:nowrap" class="ft03">8086&#160;processor‚Äîbits 12&#160;through&#160;15&#160;are always set.</p>
<p style="position:absolute;top:866px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:867px;left:93px;white-space:nowrap" class="ft03">Intel 286&#160;processor‚Äîbits 12 through&#160;15&#160;are always cleared&#160;in real-address mode.&#160;</p>
<p style="position:absolute;top:889px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:889px;left:93px;white-space:nowrap" class="ft07">32-bit processors in real-address&#160;mode‚Äîbit&#160;15&#160;(reserved)&#160;is&#160;always&#160;cleared,&#160;and bits 12&#160;through 14&#160;have&#160;the&#160;<br/>last&#160;value&#160;loaded&#160;into&#160;them.</p>
<p style="position:absolute;top:961px;left:68px;white-space:nowrap" class="ft06">22.18 X87&#160;</p>
<p style="position:absolute;top:961px;left:192px;white-space:nowrap" class="ft06">FPU</p>
<p style="position:absolute;top:997px;left:68px;white-space:nowrap" class="ft07">This&#160;section&#160;addresses the&#160;issues&#160;that must be faced when porting floating-point&#160;software designed to&#160;run&#160;on&#160;<br/>earlier IA-32 processors and&#160;math coprocessors to&#160;a&#160;Pentium&#160;4,&#160;Intel&#160;Xeon, P6 family, or&#160;Pentium&#160;processor&#160;with&#160;<br/>integrated&#160;x87 FPU.&#160;To&#160;software,&#160;a Pentium 4,&#160;Intel&#160;Xeon, or&#160;P6&#160;family processor looks very much like&#160;a Pentium&#160;<br/>processor.&#160;Floating-point software which runs on&#160;a Pentium or&#160;Intel486 DX processor,&#160;or on an&#160;Intel486 SX&#160;</p>
</div>
</body>
</html>
