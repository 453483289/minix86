<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1896</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:12px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1896-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1896.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">41-86&#160;Vol. 3D</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SGX INSTRUCTION REFERENCES</p>
<p style="position:absolute;top:244px;left:68px;white-space:nowrap" class="ft01">Operation</p>
<p style="position:absolute;top:290px;left:301px;white-space:nowrap" class="ft02">Temp&#160;Variables&#160;in&#160;EGETKEY&#160;Operational&#160;Flow</p>
<p style="position:absolute;top:465px;left:68px;white-space:nowrap" class="ft05">(* Make sure KEYREQUEST&#160;is properly aligned and&#160;inside&#160;the&#160;current&#160;enclave *)<br/>IF (&#160;(DS:RBX&#160;is not 128Byte aligned)&#160;or&#160;(DS:RBX is within&#160;CR_ELRANGE) )&#160;</p>
<p style="position:absolute;top:501px;left:88px;white-space:nowrap" class="ft03">THEN #GP(0); FI;</p>
<p style="position:absolute;top:537px;left:68px;white-space:nowrap" class="ft05">(* Make sure DS:RBX is an EPC address&#160;and the&#160;EPC&#160;page&#160;is&#160;valid *)<br/>IF (&#160;(DS:RBX does not&#160;resolve to an EPC&#160;address) or (EPCM(DS:RBX).VALID =&#160;0) )&#160;</p>
<p style="position:absolute;top:573px;left:88px;white-space:nowrap" class="ft03">THEN #PF(DS:RBX); FI;</p>
<p style="position:absolute;top:609px;left:68px;white-space:nowrap" class="ft03">IF&#160;(EPCM(DS:RBX).BLOCKED&#160;= 1)&#160;)&#160;</p>
<p style="position:absolute;top:627px;left:88px;white-space:nowrap" class="ft03">THEN #PF(DS:RBX); FI;</p>
<p style="position:absolute;top:663px;left:68px;white-space:nowrap" class="ft05">(* Check page&#160;parameters for correctness *)<br/>IF (&#160;(EPCM(DS:RBX).PT&#160;≠&#160;PT_REG) or (EPCM(DS:RBX).ENCLAVESECS&#160;≠&#160;CR_ACTIVE_SECS) or&#160;(EPCM(DS:RBX).PENDING = 1) or</p>
<p style="position:absolute;top:699px;left:88px;white-space:nowrap" class="ft05">(EPCM(DS:RBX).MODIFIED&#160;=&#160;1)&#160;or&#160;(EPCM(DS:RBX).ENCLAVEADDRESS&#160;≠&#160;(DS:RBX &amp; ~0FFFH) ) or (EPCM(DS:RBX).R = 0) )&#160;<br/>THEN #PF(DS:RBX);&#160;</p>
<p style="position:absolute;top:735px;left:68px;white-space:nowrap" class="ft03">FI;</p>
<p style="position:absolute;top:771px;left:68px;white-space:nowrap" class="ft05">(* Make&#160;sure&#160;OUTPUTDATA&#160;is properly aligned and&#160;inside&#160;the current enclave *)<br/>IF&#160;( (DS:RCX is&#160;not 16Byte aligned)&#160;or (DS:RCX is within CR_ELRANGE) )&#160;</p>
<p style="position:absolute;top:807px;left:88px;white-space:nowrap" class="ft03">THEN #GP(0); FI;</p>
<p style="position:absolute;top:843px;left:68px;white-space:nowrap" class="ft05">(* Make sure DS:RCX is an EPC address and the EPC&#160;page&#160;is valid *)<br/>IF (&#160;(DS:RCX does not&#160;resolve to an EPC&#160;address)&#160;or&#160;(EPCM(DS:RCX).VALID =&#160;0)&#160;)&#160;</p>
<p style="position:absolute;top:879px;left:88px;white-space:nowrap" class="ft03">THEN #PF(DS:RCX); FI;</p>
<p style="position:absolute;top:915px;left:68px;white-space:nowrap" class="ft03">IF&#160;(EPCM(DS:RCX).BLOCKED =&#160;1)&#160;)&#160;</p>
<p style="position:absolute;top:933px;left:88px;white-space:nowrap" class="ft03">THEN #PF(DS:RCX); FI;</p>
<p style="position:absolute;top:969px;left:68px;white-space:nowrap" class="ft05">(* Check page&#160;parameters for correctness *)<br/>IF (&#160;(EPCM(DS:RCX).PT&#160;≠&#160;PT_REG) or (EPCM(DS:RCX).ENCLAVESECS&#160;≠&#160;CR_ACTIVE_SECS) or (EPCM(DS:RCX).PENDING&#160;= 1)&#160;or</p>
<p style="position:absolute;top:1005px;left:88px;white-space:nowrap" class="ft05">(EPCM(DS:RCX).MODIFIED = 1) or&#160;(EPCM(DS:RCX).ENCLAVEADDRESS&#160;≠&#160;(DS:RCX &amp; ~0FFFH) ) or&#160;(EPCM(DS:RCX).W =&#160;0) )&#160;<br/>THEN #PF(DS:RCX);&#160;</p>
<p style="position:absolute;top:1041px;left:68px;white-space:nowrap" class="ft03">FI;</p>
<p style="position:absolute;top:116px;left:147px;white-space:nowrap" class="ft02">Table 41-59. &#160;Concurrency Restrictions&#160;of&#160;EGETKEY with&#160;Other&#160;Intel® SGX&#160;Operations&#160;2 of&#160;2</p>
<p style="position:absolute;top:139px;left:91px;white-space:nowrap" class="ft04">Operation</p>
<p style="position:absolute;top:139px;left:169px;white-space:nowrap" class="ft04">EREMOVE</p>
<p style="position:absolute;top:139px;left:236px;white-space:nowrap" class="ft04">EREPORT</p>
<p style="position:absolute;top:139px;left:299px;white-space:nowrap" class="ft04">ETRACK</p>
<p style="position:absolute;top:139px;left:372px;white-space:nowrap" class="ft04">EWB</p>
<p style="position:absolute;top:139px;left:442px;white-space:nowrap" class="ft04">EAUG</p>
<p style="position:absolute;top:139px;left:495px;white-space:nowrap" class="ft04">EMODPE</p>
<p style="position:absolute;top:139px;left:553px;white-space:nowrap" class="ft04">EMODPR</p>
<p style="position:absolute;top:139px;left:615px;white-space:nowrap" class="ft04">EMODT</p>
<p style="position:absolute;top:139px;left:685px;white-space:nowrap" class="ft04">EACCEPT</p>
<p style="position:absolute;top:139px;left:761px;white-space:nowrap" class="ft04">EACCEPTCOPY</p>
<p style="position:absolute;top:158px;left:126px;white-space:nowrap" class="ft04">Param&#160;Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:158px;left:346px;white-space:nowrap" class="ft04">SRC&#160;VA&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECI</p>
<p style="position:absolute;top:170px;left:520px;white-space:nowrap" class="ft04">NFO</p>
<p style="position:absolute;top:158px;left:549px;white-space:nowrap" class="ft04">Targ&#160;SEC</p>
<p style="position:absolute;top:170px;left:578px;white-space:nowrap" class="ft04">S</p>
<p style="position:absolute;top:158px;left:607px;white-space:nowrap" class="ft04">Targ&#160;SEC</p>
<p style="position:absolute;top:170px;left:636px;white-space:nowrap" class="ft04">S</p>
<p style="position:absolute;top:158px;left:665px;white-space:nowrap" class="ft04">Targ&#160;SECI</p>
<p style="position:absolute;top:170px;left:695px;white-space:nowrap" class="ft04">NFO</p>
<p style="position:absolute;top:158px;left:724px;white-space:nowrap" class="ft04">SECS&#160;Targ&#160;SR</p>
<p style="position:absolute;top:170px;left:785px;white-space:nowrap" class="ft04">C</p>
<p style="position:absolute;top:158px;left:811px;white-space:nowrap" class="ft04">SECI</p>
<p style="position:absolute;top:170px;left:811px;white-space:nowrap" class="ft04">NFO</p>
<p style="position:absolute;top:190px;left:72px;white-space:nowrap" class="ft04">EGETKEY</p>
<p style="position:absolute;top:190px;left:126px;white-space:nowrap" class="ft04">Param</p>
<p style="position:absolute;top:190px;left:226px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:190px;left:490px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:190px;left:520px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:190px;left:665px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:190px;left:695px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:190px;left:785px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:190px;left:811px;white-space:nowrap" class="ft04">U</p>
<p style="position:absolute;top:209px;left:126px;white-space:nowrap" class="ft04">SECS</p>
<p style="position:absolute;top:209px;left:165px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:195px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:226px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:264px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:298px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:346px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:375px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:398px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:429px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:459px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:490px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:520px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:549px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:578px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:607px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:636px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:665px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:695px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:724px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:755px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:785px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:209px;left:811px;white-space:nowrap" class="ft04">Y</p>
<p style="position:absolute;top:313px;left:74px;white-space:nowrap" class="ft03">Name</p>
<p style="position:absolute;top:313px;left:240px;white-space:nowrap" class="ft03">Type</p>
<p style="position:absolute;top:313px;left:369px;white-space:nowrap" class="ft03">Size&#160;(Bits)</p>
<p style="position:absolute;top:313px;left:450px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:337px;left:74px;white-space:nowrap" class="ft03">TMP_CURRENTSECS</p>
<p style="position:absolute;top:337px;left:450px;white-space:nowrap" class="ft03">Address of&#160;the&#160;SECS&#160;for the currently executing&#160;enclave.</p>
<p style="position:absolute;top:361px;left:74px;white-space:nowrap" class="ft03">TMP_KEYDEPENDENCIES</p>
<p style="position:absolute;top:361px;left:450px;white-space:nowrap" class="ft03">Temp&#160;space for key derivation.</p>
<p style="position:absolute;top:385px;left:74px;white-space:nowrap" class="ft03">TMP_ATTRIBUTES</p>
<p style="position:absolute;top:385px;left:369px;white-space:nowrap" class="ft03">128</p>
<p style="position:absolute;top:385px;left:450px;white-space:nowrap" class="ft03">Temp&#160;Space&#160;for&#160;the calculation of&#160;the&#160;sealable&#160;Attributes.</p>
<p style="position:absolute;top:409px;left:74px;white-space:nowrap" class="ft03">TMP_OUTPUTKEY</p>
<p style="position:absolute;top:409px;left:369px;white-space:nowrap" class="ft03">128</p>
<p style="position:absolute;top:409px;left:450px;white-space:nowrap" class="ft03">Temp&#160;Space&#160;for&#160;the calculation of&#160;the&#160;key.</p>
</div>
</body>
</html>
