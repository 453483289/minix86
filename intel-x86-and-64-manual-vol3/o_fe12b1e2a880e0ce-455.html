<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 455</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:21px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page455-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce455.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;13-1</p>
<p style="position:absolute;top:96px;left:699px;white-space:nowrap" class="ft01">CHAPTER 13</p>
<p style="position:absolute;top:120px;left:130px;white-space:nowrap" class="ft01">SYSTEM PROGRAMMING FOR INSTRUCTION SET EXTENSIONS AND</p>
<p style="position:absolute;top:144px;left:496px;white-space:nowrap" class="ft01">PROCESSOR&#160;EXTENDED&#160;STATES</p>
<p style="position:absolute;top:214px;left:68px;white-space:nowrap" class="ft07">This chapter describes system&#160;programming features for&#160;instruction set&#160;extensions operating&#160;on the&#160;processor&#160;<br/>state&#160;extension known&#160;as the&#160;SSE state (XMM&#160;registers,&#160;MXCSR) and for other&#160;processor&#160;extended states.&#160;Instruc-<br/>tion&#160;set extensions&#160;operating on the SSE state include&#160;the streaming&#160;SIMD&#160;extensions (SSE), streaming&#160;SIMD&#160;<br/>extensions&#160;2 (SSE2),&#160;streaming SIMD extensions&#160;3 (SSE3), Supplemental SSE3&#160;(SSSE3),&#160;and SSE4.&#160;Collectively,&#160;<br/>these&#160;are&#160;called&#160;&#160;<b>SSE extensions</b></p>
<p style="position:absolute;top:278px;left:298px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:280px;left:305px;white-space:nowrap" class="ft02">&#160;and&#160;the corresponding&#160;instructions&#160;<b>SSE&#160;instructions</b>.&#160;FXSAVE/FXRSTOR&#160;</p>
<p style="position:absolute;top:297px;left:68px;white-space:nowrap" class="ft07">instructions&#160;can be used save/restore&#160;SSE state&#160;along with FP state.&#160;See Section 10.5&#160;in the&#160;<a href="þÿ"><i>IntelÂ®&#160;64 and&#160;IA-32&#160;<br/>Architectures&#160;Software Developerâ€™s Manual, Volume 1</i>&#160;for information</a>&#160;about FXSAVE&#160;and FXRSTOR.<br/><a href="o_fe12b1e2a880e0ce-455.html">Sections 13.1&#160;through 1</a><a href="o_fe12b1e2a880e0ce-460.html">3.4</a>&#160;cover system programming&#160;requirements to&#160;enable&#160;the&#160;SSE extensions,&#160;providing&#160;<br/>operating&#160;system&#160;or&#160;executive support&#160;for the&#160;SSE extensions,&#160;SIMD floating-point exceptions, exception handling,&#160;<br/>and&#160;task&#160;(context)&#160;switching. These&#160;sections primarily discuss&#160;use of FXSAVE/FXRSTOR to save/restore SSE state.<br/><b>XSAVE&#160;feature set</b>&#160;refers&#160;to extensions to&#160;the Intel architecture&#160;that will allow system&#160;executives&#160;to&#160;implement&#160;<br/>support for multiple&#160;processor extended&#160;states&#160;along&#160;with&#160;FP/SSE&#160;states&#160;that may be introduced over time without&#160;<br/>requiring the&#160;system executive&#160;to be&#160;modified&#160;each&#160;time&#160;a new processor state&#160;extension is&#160;introduced.&#160;XSAVE&#160;<br/>feature&#160;set provide mechanisms&#160;to enumerate&#160;the supported&#160;extended&#160;states,&#160;enable&#160;some&#160;or&#160;all&#160;of&#160;them for&#160;soft-<br/>ware&#160;use,&#160;instructions to&#160;save/restore&#160;the&#160;states&#160;and&#160;enumerate&#160;the layout&#160;of&#160;the states when saved to&#160;memory.&#160;<br/>XSAVE/XRSTOR instructions are part of the&#160;XSAVE feature&#160;set. These&#160;instructions&#160;are introduced after&#160;the intro-<br/>duction&#160;of FP/SSE&#160;states&#160;but&#160;can be used to&#160;manage&#160;legacy&#160;FP/SSE&#160;state along&#160;with&#160;processor extended&#160;states. See&#160;<br/><a href="þÿ">CHAPTER 13 in the&#160;<i>IntelÂ® 64&#160;and&#160;IA-32&#160;Architectures Software&#160;Developerâ€™s&#160;Manual,&#160;Volume 1</i></a>&#160;for information&#160;<br/>about XSAVE&#160;feature set.<br/>System&#160;programming&#160;for&#160;managing processor extended&#160;states&#160;is described&#160;in&#160;<a href="o_fe12b1e2a880e0ce-461.html">sections 13.5</a><a href="o_fe12b1e2a880e0ce-463.html">&#160;through 13.6.&#160;</a>XSAVE&#160;<br/>feature set is&#160;designed&#160;to&#160;be compatible with FXSAVE/FXRSTOR and&#160;hence much of the material&#160;through&#160;sections&#160;<br/><a href="o_fe12b1e2a880e0ce-455.html">13.1 to&#160;</a><a href="o_fe12b1e2a880e0ce-460.html">13.4</a>&#160;related&#160;to SSE state also&#160;applies to&#160;XSAVE feature&#160;set with the&#160;exception of enumeration&#160;and&#160;<br/>saving/restoring state.<br/><b>XSAVE&#160;Compaction</b>&#160;is an&#160;XSAVE feature&#160;that allows operating&#160;systems to&#160;allocate&#160;space for only the&#160;states&#160;saved&#160;<br/>to&#160;conserve&#160;memory&#160;usage. A new instruction called XSAVEC&#160;is&#160;introduced&#160;to save&#160;extended&#160;states in&#160;compacted&#160;<br/>format and XRSTOR&#160;instruction is&#160;enhanced&#160;to&#160;comprehend&#160;compacted&#160;format. System programming for managing&#160;<br/>processor extended&#160;states&#160;in&#160;compacted format&#160;is&#160;also described in se<a href="o_fe12b1e2a880e0ce-461.html">ction 13.5.<br/></a><b>Supervisor state</b>&#160;is an extended&#160;state&#160;that can only&#160;be accessed&#160;in&#160;ring&#160;0. XSAVE feature set has been&#160;enhanced&#160;<br/>to manage&#160;supervisor&#160;states.&#160;Two new&#160;ring 0&#160;instructions, XSAVES/XRSTORS, are introduced to&#160;save/restore&#160;<br/>supervisor states along&#160;with&#160;other XSAVE managed states. They&#160;are&#160;privileged instruction and only&#160;operate in&#160;<br/>compacted format.&#160;System programming for managing&#160;supervisor states&#160;in described in&#160;sectio<a href="o_fe12b1e2a880e0ce-464.html">n 13.7.<br/></a>Each&#160;XSAVE managed features&#160;may have&#160;additional feature&#160;specific&#160;system programming requirements such as&#160;<br/>exception&#160;handlers etc.&#160;Feature&#160;specific system programming&#160;requirements&#160;for XSAVE managed features&#160;are&#160;<br/>described&#160;in&#160;<a href="o_fe12b1e2a880e0ce-464.html">section 13.8</a>.</p>
<p style="position:absolute;top:859px;left:68px;white-space:nowrap" class="ft06">13.1&#160;</p>
<p style="position:absolute;top:859px;left:147px;white-space:nowrap" class="ft06">PROVIDING OPERATING SYSTEM SUPPORT FOR SSE EXTENSIONS</p>
<p style="position:absolute;top:895px;left:68px;white-space:nowrap" class="ft07">To&#160;use&#160;SSE extensions,&#160;the operating system or executive&#160;must provide&#160;support for initializing the&#160;processor to use&#160;<br/>these extensions, for handling&#160;SIMD&#160;floating-point exceptions,&#160;and for using&#160;FXSAVE&#160;and&#160;FXRSTO<a href="þÿ">R (Section 10.5&#160;<br/>of the&#160;<i>IntelÂ® 64&#160;and IA-32 Architectures&#160;Software&#160;Developerâ€™s Manual, Volume&#160;1</i></a>)&#160;to manage context.&#160;XSAVE&#160;<br/>feature set can&#160;also be used&#160;to manage&#160;SSE&#160;state along&#160;with other&#160;processor extended&#160;states&#160;as described&#160;in&#160;<a href="o_fe12b1e2a880e0ce-461.html">13.5.</a>&#160;<br/>This section primarily&#160;focuses on&#160;using FXSAVE/FXRSTOR&#160;to manage SSE&#160;state.&#160;Because SSE&#160;extensions share the&#160;<br/>same state,&#160;experience the&#160;same sets of non-numerical&#160;and numerical exception&#160;behavior, these guidelines&#160;that&#160;<br/>apply to SSE&#160;also apply to other&#160;sets of SIMD extensions&#160;that&#160;operate on the&#160;same processor state&#160;and subject to&#160;<br/>the&#160;same sets of non-numerical and&#160;numerical exception behavior.&#160;</p>
<p style="position:absolute;top:1054px;left:68px;white-space:nowrap" class="ft02">1.&#160;The collection also includes PCLMULQDQ and&#160;AES instructions&#160;operating on&#160;XMM&#160;state.</p>
</div>
</body>
</html>
