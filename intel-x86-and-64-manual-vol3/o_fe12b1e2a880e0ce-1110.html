<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1110</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#0860a8;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:14px;font-family:Times;color:#0860a8;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft012{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1110-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1110.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">26-18&#160;Vol. 3C</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">VM&#160;ENTRIES</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft09">An&#160;attempt&#160;to write&#160;bits&#160;127:64&#160;to&#160;the MSR indexed&#160;by bits&#160;31:0&#160;of the&#160;entry would cause a general-protection&#160;<br/>exception if executed&#160;via&#160;WRMSR with CPL&#160;=&#160;0.</p>
<p style="position:absolute;top:114px;left:414px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:141px;left:68px;white-space:nowrap" class="ft09">The VM&#160;entry fails&#160;if processing fails for any&#160;entry.&#160;The&#160;logical&#160;processor responds to&#160;such failures&#160;by loading state&#160;<br/>from&#160;the host-state&#160;area,&#160;as&#160;it would for a&#160;VM&#160;exit.&#160;S<a href="o_fe12b1e2a880e0ce-1117.html">ee&#160;Section&#160;26.7.<br/></a>If any&#160;MSR&#160;is being&#160;loaded in such&#160;a way that would architecturally&#160;require&#160;a TLB flush,&#160;the TLBs are&#160;updated so&#160;<br/>that, after&#160;VM&#160;entry,&#160;the&#160;logical processor&#160;will&#160;not&#160;use any&#160;translations&#160;that&#160;were cached before the&#160;transition.</p>
<p style="position:absolute;top:253px;left:68px;white-space:nowrap" class="ft05">26.5 EVENT&#160;</p>
<p style="position:absolute;top:253px;left:215px;white-space:nowrap" class="ft05">INJECTION</p>
<p style="position:absolute;top:289px;left:68px;white-space:nowrap" class="ft09">If the&#160;valid bit&#160;in the&#160;VM-entry interruption-information field&#160;<a href="o_fe12b1e2a880e0ce-1066.html">(see&#160;Section&#160;24.8.3) is&#160;</a>1,&#160;VM&#160;entry causes&#160;an event&#160;to&#160;<br/>be delivered&#160;(or made&#160;pending) after&#160;all components&#160;of&#160;guest state have&#160;been loaded (including&#160;MSRs)&#160;and after&#160;<br/>the&#160;VM-execution control fields have&#160;been established.</p>
<p style="position:absolute;top:344px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:345px;left:93px;white-space:nowrap" class="ft09">If&#160;the&#160;interruption type in the&#160;field&#160;is 0 (external interrupt), 2&#160;(non-maskable interrupt); 3&#160;(hardware&#160;<br/>exception),&#160;4&#160;(software interrupt),&#160;5 (privileged&#160;software&#160;exception),&#160;or&#160;6 (software&#160;exception),&#160;the event&#160;is&#160;<br/>delivered&#160;as de<a href="o_fe12b1e2a880e0ce-1110.html">scribed in Section 26.5.1.</a></p>
<p style="position:absolute;top:400px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:400px;left:93px;white-space:nowrap" class="ft09">If the&#160;interruption&#160;type&#160;in&#160;the field is&#160;7&#160;(other&#160;event) and&#160;the vector field is&#160;0,&#160;an MTF&#160;VM&#160;exit&#160;is pending after&#160;<br/>VM&#160;entry.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-1113.html">Section 26.5.2</a>.</p>
<p style="position:absolute;top:467px;left:68px;white-space:nowrap" class="ft06">26.5.1 Vectored-Event&#160;</p>
<p style="position:absolute;top:467px;left:278px;white-space:nowrap" class="ft06">Injection</p>
<p style="position:absolute;top:498px;left:68px;white-space:nowrap" class="ft09">VM&#160;entry&#160;delivers an&#160;injected&#160;vectored&#160;event within&#160;the&#160;guest&#160;context established&#160;by VM&#160;entry.&#160;This&#160;means that&#160;<br/>delivery occurs after all components of guest state have&#160;been&#160;loaded&#160;(including MSRs) and after&#160;the VM-execution&#160;<br/>control fields&#160;have&#160;been&#160;established.</p>
<p style="position:absolute;top:528px;left:314px;white-space:nowrap" class="ft04">2</p>
<p style="position:absolute;top:531px;left:320px;white-space:nowrap" class="ft03">&#160;The&#160;event is&#160;delivered using&#160;the&#160;vector in&#160;that field to&#160;select&#160;a descriptor&#160;in&#160;</p>
<p style="position:absolute;top:547px;left:68px;white-space:nowrap" class="ft09">the IDT.&#160;Since event&#160;injection&#160;occurs&#160;after loading IDTR&#160;from&#160;the guest-state area,&#160;this is&#160;the guest IDT.<br/><a href="o_fe12b1e2a880e0ce-1110.html">Section 26.5.1.1 pr</a>ovides&#160;details of vectored-event injection.&#160;In&#160;general,&#160;the event is delivered exactly as if it had&#160;<br/>been&#160;generated&#160;normally.<br/>If event delivery&#160;encounters a&#160;nested&#160;exception (for example,&#160;a general-protection exception because&#160;the vector&#160;<br/>indicates a&#160;descriptor beyond&#160;the IDT limit),&#160;the&#160;exception&#160;bitmap&#160;is consulted using&#160;the vector of that&#160;exception:</p>
<p style="position:absolute;top:650px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:651px;left:93px;white-space:nowrap" class="ft012">If&#160;the&#160;bit for the&#160;nested exception&#160;is 0, the nested exception is&#160;delivered&#160;normally. If the&#160;nested exception&#160;is&#160;<br/>benign, it&#160;is delivered&#160;through&#160;the IDT.&#160;If&#160;it is&#160;contributory or a&#160;page fault, a double&#160;fault&#160;may be&#160;generated,&#160;<br/>depending on the nature of the event whose delivery&#160;encountered&#160;the nested&#160;exception.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-187.html">Chapter 6</a>,&#160;<br/><a href="o_fe12b1e2a880e0ce-214.html">‚ÄúInterrupt&#160;8‚ÄîDouble Fault Exception (#DF)‚Äù in&#160;</a><a href="˛ˇ"><i>Intel¬Æ 64&#160;and&#160;IA-32&#160;Architectures Software&#160;Developer‚Äôs&#160;<br/>Manual, Volume&#160;3A</i></a>.</p>
<p style="position:absolute;top:714px;left:228px;white-space:nowrap" class="ft04">3</p>
<p style="position:absolute;top:739px;left:68px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:739px;left:93px;white-space:nowrap" class="ft09">If the&#160;bit&#160;for&#160;the&#160;nested&#160;exception is&#160;1,&#160;a VM&#160;exit occurs.<a href="o_fe12b1e2a880e0ce-1112.html">&#160;Section&#160;26.5.1.2</a>&#160;details cases in which&#160;event injection&#160;<br/>causes a&#160;VM&#160;exit.</p>
<p style="position:absolute;top:800px;left:68px;white-space:nowrap" class="ft08">26.5.1.1 &#160;&#160;Details of&#160;Vectored-Event&#160;Injection</p>
<p style="position:absolute;top:829px;left:68px;white-space:nowrap" class="ft09">The&#160;event-injection process is&#160;controlled&#160;by the&#160;contents&#160;of&#160;the VM-entry interruption&#160;information field (format&#160;<br/><a href="o_fe12b1e2a880e0ce-1066.html">given in Table&#160;24-13</a>),&#160;the&#160;VM-entry exception&#160;error-code&#160;field,&#160;and&#160;the VM-entry instruction-length&#160;field.&#160;The&#160;<br/>following&#160;items provide&#160;details of&#160;the&#160;process:</p>
<p style="position:absolute;top:913px;left:68px;white-space:nowrap" class="ft03">1.&#160;If&#160;CR0.PG&#160;=&#160;1,&#160;WRMSR to&#160;the IA32_EFER&#160;MSR causes&#160;a&#160;general-protection&#160;exception if&#160;it&#160;would modify the LME&#160;bit.&#160;If&#160;VM&#160;entry has&#160;</p>
<p style="position:absolute;top:930px;left:89px;white-space:nowrap" class="ft03">established&#160;CR0.PG&#160;= 1,&#160;the&#160;IA32_EFER&#160;MSR should&#160;not be&#160;included&#160;in&#160;the VM-entry MSR-load&#160;area&#160;for the purpose of&#160;modifying&#160;the&#160;</p>
<p style="position:absolute;top:946px;left:89px;white-space:nowrap" class="ft03">LME bit.</p>
<p style="position:absolute;top:967px;left:68px;white-space:nowrap" class="ft03">2.&#160;This does&#160;not&#160;imply that&#160;injection of&#160;an&#160;exception&#160;or&#160;interrupt&#160;will cause&#160;a VM&#160;exit&#160;due&#160;to&#160;the settings of&#160;VM-execution&#160;control fields&#160;</p>
<p style="position:absolute;top:984px;left:89px;white-space:nowrap" class="ft03">(such&#160;as&#160;the exception&#160;bitmap) that&#160;would&#160;cause a VM&#160;exit if&#160;the event had occurred&#160;in&#160;VMX&#160;non-root&#160;operation.&#160;In contrast, a nested&#160;</p>
<p style="position:absolute;top:1000px;left:89px;white-space:nowrap" class="ft03">exception encountered during&#160;event delivery&#160;may cause a&#160;VM&#160;exit; se<a href="o_fe12b1e2a880e0ce-1110.html">e Section 26.5.1.1.</a></p>
<p style="position:absolute;top:1021px;left:68px;white-space:nowrap" class="ft03">3.&#160;Hardware&#160;exceptions&#160;with&#160;the&#160;following&#160;unused&#160;vectors&#160;are&#160;considered&#160;benign: 15&#160;and 21‚Äì31.&#160;A&#160;hardware&#160;exception&#160;with&#160;vector&#160;20&#160;</p>
<p style="position:absolute;top:1038px;left:89px;white-space:nowrap" class="ft03">is&#160;considered&#160;benign&#160;unless&#160;the processor&#160;supports the 1-setting of&#160;the ‚ÄúEPT-violation #VE‚Äù VM-execution control;&#160;in that&#160;case,&#160;it&#160;</p>
<p style="position:absolute;top:1054px;left:89px;white-space:nowrap" class="ft03">has the same severity as page&#160;faults.</p>
</div>
</body>
</html>
