<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 611</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:12px;font-family:Times;color:#0860a8;}
	.ft09{font-size:8px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft012{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page611-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce611.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;17-37</p>
<p style="position:absolute;top:47px;left:425px;white-space:nowrap" class="ft01">DEBUG, BRANCH&#160;PROFILE, TSC, AND RESOURCE MONITORING FEATURES</p>
<p style="position:absolute;top:97px;left:69px;white-space:nowrap" class="ft02">17.13&#160;&#160;LAST&#160;BRANCH, INTERRUPT, AND&#160;EXCEPTION</p>
<p style="position:absolute;top:123px;left:147px;white-space:nowrap" class="ft02">RECORDING (PENTIUM M PROCESSORS)</p>
<p style="position:absolute;top:159px;left:69px;white-space:nowrap" class="ft010">Like&#160;the Pentium 4&#160;and Intel Xeon processor family, Pentium M processors&#160;provide last branch interrupt and excep-<br/>tion&#160;recording. The capability operates&#160;almost identically&#160;to&#160;that&#160;found&#160;in Pentium 4&#160;and&#160;Intel Xeon&#160;processors.&#160;<br/>There are differences in the&#160;shape&#160;of the&#160;stack&#160;and&#160;in&#160;some&#160;MSR names and locations. Note&#160;the following:</p>
<p style="position:absolute;top:214px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:214px;left:95px;white-space:nowrap" class="ft011"><b>MSR_DEBUGCTLB MSR —&#160;</b>Enables&#160;debug trace&#160;interrupt, debug&#160;trace&#160;store, trace messages&#160;enable,&#160;<br/>performance monitoring breakpoint flags, single stepping&#160;on branches,&#160;and last&#160;branch. For Pentium M&#160;<br/>processors, this&#160;MSR&#160;is located&#160;at register address 01D9H.&#160;S<a href="o_fe12b1e2a880e0ce-611.html">ee&#160;Figure&#160;17-16</a>&#160;and&#160;the&#160;entries&#160;below for a&#160;<br/>description of&#160;the&#160;flags.<br/>—&#160;<b>LBR (last branch/interrupt/exception) flag (bit 0)&#160;—&#160;</b>When set, the&#160;processor records a running trace&#160;</p>
<p style="position:absolute;top:304px;left:120px;white-space:nowrap" class="ft010">of&#160;the&#160;most recent branches,&#160;interrupts, and/or&#160;exceptions&#160;taken by&#160;the processor (prior&#160;to a&#160;debug&#160;<br/>exception&#160;being generated) in the&#160;last&#160;branch record&#160;(LBR) stack.&#160;For&#160;more&#160;information, see the&#160;“Last&#160;<br/>Branch&#160;Record (LBR)&#160;Stack” bullet below.</p>
<p style="position:absolute;top:361px;left:94px;white-space:nowrap" class="ft03">—&#160;<b>BTF&#160;(single-step&#160;on&#160;branches)&#160;flag&#160;(bit&#160;1)&#160;—&#160;</b>When&#160;set,&#160;the processor treats the&#160;TF flag&#160;in the&#160;EFLAGS&#160;</p>
<p style="position:absolute;top:378px;left:120px;white-space:nowrap" class="ft010">register as a “single-step&#160;on branches”&#160;flag rather than&#160;a&#160;“single-step on&#160;instructions” flag. This mechanism&#160;<br/>allows&#160;single-stepping&#160;the processor on taken branches. Se<a href="o_fe12b1e2a880e0ce-587.html">e&#160;Section&#160;17.4.3, “Single-Stepping on&#160;<br/>Branches,”&#160;</a>for&#160;more information&#160;about the BTF flag.</p>
<p style="position:absolute;top:435px;left:94px;white-space:nowrap" class="ft03">—&#160;<b>PB<i>i</i></b><b>&#160;(performance&#160;monitoring/breakpoint pins) flags (bits&#160;5-2)&#160;—&#160;</b>When&#160;these&#160;flags are set, the&#160;</p>
<p style="position:absolute;top:451px;left:120px;white-space:nowrap" class="ft010">performance monitoring/breakpoint&#160;pins on the&#160;processor&#160;(BP0#, BP1#, BP2#, and&#160;BP3#) report&#160;<br/>breakpoint matches&#160;in the corresponding breakpoint-address registers (DR0&#160;through&#160;DR3).&#160;The processor&#160;<br/>asserts then&#160;deasserts the&#160;corresponding BP<i>i</i># pin&#160;when&#160;a breakpoint match occurs. When&#160;a PB<i>i</i>&#160;flag&#160;is&#160;<br/>clear,&#160;the&#160;performance monitoring/breakpoint&#160;pins&#160;report&#160;performance events.&#160;Processor execution&#160;is not&#160;<br/>affected&#160;by reporting performance&#160;events.</p>
<p style="position:absolute;top:541px;left:94px;white-space:nowrap" class="ft03">—&#160;<b>TR&#160;(trace message enable) flag (bit&#160;6) —&#160;</b>When set, branch trace messages are&#160;enabled. When&#160;the&#160;</p>
<p style="position:absolute;top:558px;left:120px;white-space:nowrap" class="ft010">processor detects a taken branch, interrupt, or exception,&#160;it sends the&#160;branch record out on&#160;the&#160;system bus&#160;<br/>as&#160;a branch trace message&#160;(BTM).&#160;See<a href="o_fe12b1e2a880e0ce-587.html">&#160;Section 17.4.4, “Branch Trace&#160;Messages,” for more&#160;</a>information&#160;<br/>about the&#160;TR flag.</p>
<p style="position:absolute;top:615px;left:94px;white-space:nowrap" class="ft03">—&#160;<b>BTS (branch trace&#160;store)&#160;flag&#160;(bit 7)&#160;—&#160;</b>When set, enables&#160;the BTS&#160;facilities&#160;to log&#160;BTMs to&#160;a memory-</p>
<p style="position:absolute;top:631px;left:120px;white-space:nowrap" class="ft03">resident&#160;BTS buffer&#160;that is&#160;part of the DS&#160;save&#160;area.&#160;Se<a href="o_fe12b1e2a880e0ce-591.html">e&#160;Section 17.4.9, “BTS&#160;and&#160;DS&#160;Save&#160;Area.”</a></p>
<p style="position:absolute;top:655px;left:94px;white-space:nowrap" class="ft03">—&#160;<b>BTINT&#160;(branch trace interrupt)&#160;flag (bits 8)&#160;—&#160;</b>When set, the&#160;BTS facilities generate an interrupt when&#160;</p>
<p style="position:absolute;top:672px;left:120px;white-space:nowrap" class="ft010">the BTS&#160;buffer is&#160;full. When clear,&#160;BTMs&#160;are&#160;logged&#160;to the BTS&#160;buffer&#160;in a circular fashion.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-587.html">Section 17.4.5,&#160;<br/>“Branch Trace Store (BTS),” for a description of&#160;</a>this&#160;mechanism.</p>
<p style="position:absolute;top:973px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:974px;left:95px;white-space:nowrap" class="ft010"><b>Debug store (DS) feature flag (bit 21),&#160;returned by&#160;the&#160;CPUID instruction</b>&#160;— Indicates that&#160;the&#160;<br/>processor provides&#160;the&#160;debug store&#160;(DS) mechanism,&#160;which allows BTMs&#160;to be stored in a&#160;memory-resident&#160;<br/>BTS buffer.&#160;S<a href="o_fe12b1e2a880e0ce-587.html">ee Section 17.4.5,&#160;“Branch&#160;Trace Store (BTS).”</a></p>
<p style="position:absolute;top:919px;left:240px;white-space:nowrap" class="ft08">Figure&#160;17-16. &#160;MSR_DEBUGCTLB MSR for Pentium&#160;M Processors</p>
<p style="position:absolute;top:758px;left:244px;white-space:nowrap" class="ft09">31</p>
<p style="position:absolute;top:848px;left:262px;white-space:nowrap" class="ft00">TR&#160;—&#160;Trace messages enable</p>
<p style="position:absolute;top:821px;left:262px;white-space:nowrap" class="ft00">BTINT&#160;—&#160;Branch trace interrupt</p>
<p style="position:absolute;top:875px;left:262px;white-space:nowrap" class="ft012">BTF&#160;—&#160;Single-step&#160;on branches<br/>LBR&#160;—&#160;Last&#160;branch/interrupt/exception</p>
<p style="position:absolute;top:787px;left:396px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:759px;left:546px;white-space:nowrap" class="ft09">8&#160;7&#160;6&#160;5&#160;4&#160;3&#160;2&#160;1&#160;&#160;&#160;0</p>
<p style="position:absolute;top:835px;left:262px;white-space:nowrap" class="ft00">BTS&#160;—&#160;Branch trace store</p>
<p style="position:absolute;top:862px;left:262px;white-space:nowrap" class="ft00">PB3/2/1/0&#160;—&#160;Performance monitoring&#160;breakpoint flags</p>
</div>
</body>
</html>
