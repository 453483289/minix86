<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 417</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page417-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce417.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;11-5</p>
<p style="position:absolute;top:47px;left:686px;white-space:nowrap" class="ft01">MEMORY CACHE CONTROL</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft05">line can be filled&#160;from memory&#160;with a 8-transfer burst transaction. The&#160;caches do&#160;not support partially-filled cache&#160;<br/>lines, so caching even a&#160;single&#160;doubleword&#160;requires&#160;caching an&#160;entire line.<br/>The L1 and&#160;L2 cache&#160;lines in&#160;the P6 family and&#160;Pentium&#160;processors&#160;are 32 bytes&#160;wide, with&#160;cache&#160;line reads from&#160;<br/>system&#160;memory&#160;beginning on&#160;a 32-byte boundary&#160;(5&#160;least-significant&#160;bits of&#160;a memory address&#160;clear.)&#160;A cache&#160;line&#160;<br/>can be&#160;filled from&#160;memory&#160;with&#160;a 4-transfer&#160;burst&#160;transaction. Partially-filled&#160;cache lines are&#160;not&#160;supported.<br/>The&#160;trace&#160;cache in&#160;processors&#160;based on Intel NetBurst microarchitecture&#160;is&#160;available in&#160;all execution&#160;modes:&#160;<br/>protected&#160;mode, system&#160;management mode&#160;(SMM),&#160;and real-address mode.&#160;The L1,L2,&#160;and&#160;L3&#160;caches&#160;are also&#160;<br/>available in all&#160;execution&#160;modes; however,&#160;use&#160;of&#160;them&#160;must be handled carefully&#160;in&#160;S<a href="o_fe12b1e2a880e0ce-1258.html">MM (see Section 34.4.2,&#160;<br/>“SMRAM Caching”).<br/></a>The TLBs store&#160;the most&#160;recently used&#160;page-directory&#160;and page-table entries.&#160;They&#160;speed up&#160;memory&#160;accesses&#160;<br/>when&#160;paging&#160;is&#160;enabled&#160;by reducing the&#160;number of memory&#160;accesses&#160;that&#160;are&#160;required to read the&#160;page tables&#160;<br/>stored in&#160;system memory.&#160;The TLBs are&#160;divided&#160;into four groups: instruction TLBs for 4-KByte&#160;pages,&#160;data&#160;TLBs&#160;for&#160;<br/>4-KByte&#160;pages; instruction TLBs for large pages&#160;(2-MByte,&#160;4-MByte&#160;or 1-GByte&#160;pages),&#160;and&#160;data TLBs&#160;for large&#160;<br/>pages.&#160;The&#160;TLBs&#160;are normally active&#160;only in protected mode&#160;with paging&#160;enabled.&#160;When paging is&#160;disabled&#160;or the&#160;<br/>processor&#160;is in real-address mode, the&#160;TLBs&#160;maintain their&#160;contents until explicitly&#160;or&#160;implicitly flushed (s<a href="o_fe12b1e2a880e0ce-431.html">ee Section&#160;<br/>11.9,&#160;“Invalidating&#160;the Translation Lookaside Buffers (TLBs)”).<br/></a>Processors&#160;based on Intel Core microarchitectures&#160;implement one&#160;level of&#160;instruction&#160;TLB and&#160;two&#160;levels of data&#160;<br/>TLB.&#160;Intel Core&#160;i7 processor provides&#160;a second-level unified&#160;TLB.&#160;<br/>The store&#160;buffer is&#160;associated&#160;with&#160;the processors instruction&#160;execution&#160;units.&#160;It allows writes&#160;to system&#160;memory&#160;<br/>and/or the&#160;internal caches to be saved and&#160;in&#160;some cases combined to optimize the&#160;processor’s bus accesses. The&#160;<br/>store buffer&#160;is always enabled in all&#160;execution modes.<br/>The processor’s&#160;caches are for the&#160;most&#160;part&#160;transparent&#160;to software. When&#160;enabled,&#160;instructions&#160;and data flow&#160;<br/>through these caches without&#160;the need for&#160;explicit software&#160;control.&#160;However,&#160;knowledge of the behavior of these&#160;<br/>caches may be useful in&#160;optimizing&#160;software&#160;performance.&#160;For example,&#160;knowledge of cache&#160;dimensions&#160;and&#160;<br/>replacement algorithms gives&#160;an indication&#160;of&#160;how&#160;large&#160;of&#160;a data structure&#160;can be&#160;operated on at&#160;once&#160;without&#160;<br/>causing cache&#160;thrashing.<br/>In multiprocessor systems, maintenance of cache consistency may,&#160;in rare circumstances, require&#160;intervention by&#160;<br/>system&#160;software.&#160;For&#160;these rare cases,&#160;the processor provides&#160;privileged&#160;cache&#160;control instructions for&#160;use&#160;in&#160;<br/>flushing caches and&#160;forcing memory&#160;ordering.<br/>There are several&#160;instructions&#160;that software&#160;can use&#160;to improve the&#160;performance of the&#160;L1,&#160;L2, and&#160;L3 caches,&#160;<br/>including&#160;the&#160;PREFETCHh,&#160;CLFLUSH,&#160;and&#160;CLFLUSHOPT&#160;instructions and&#160;the non-temporal&#160;move&#160;instructions&#160;<br/>(MOVNTI, MOVNTQ, MOVNTDQ,&#160;MOVNTPS,&#160;and&#160;MOVNTPD).&#160;The use of these instructions are discusse<a href="o_fe12b1e2a880e0ce-429.html">d in Section&#160;<br/>11.5.5, “Cache Management Instructions.”</a></p>
<p style="position:absolute;top:744px;left:69px;white-space:nowrap" class="ft03">11.2 CACHING&#160;</p>
<p style="position:absolute;top:744px;left:238px;white-space:nowrap" class="ft03">TERMINOLOGY</p>
<p style="position:absolute;top:780px;left:69px;white-space:nowrap" class="ft05">IA-32 processors (beginning&#160;with the&#160;Pentium&#160;processor)&#160;and&#160;Intel 64 processors use&#160;the MESI (modified,&#160;exclu-<br/>sive,&#160;shared, invalid) cache protocol&#160;to maintain consistency with internal&#160;caches and&#160;caches&#160;in other&#160;processors&#160;<br/><a href="o_fe12b1e2a880e0ce-421.html">(see Section 11.4,&#160;“Cache&#160;Control Protocol”).<br/></a>When&#160;the processor recognizes that&#160;an&#160;operand being&#160;read from memory&#160;is cacheable, the&#160;processor&#160;reads&#160;an&#160;<br/>entire&#160;cache line&#160;into the&#160;appropriate cache&#160;(L1,&#160;L2, L3,&#160;or all). This&#160;operation&#160;is called&#160;a&#160;<b>cache line fill</b>. If the&#160;<br/>memory location containing&#160;that operand&#160;is still&#160;cached&#160;the&#160;next time&#160;the&#160;processor attempts to access the&#160;<br/>operand,&#160;the processor can&#160;read&#160;the operand&#160;from the&#160;cache instead of going back&#160;to memory.&#160;This operation is&#160;<br/>called a&#160;<b>cache hit</b>.&#160;<br/>When the&#160;processor attempts&#160;to write&#160;an operand&#160;to a&#160;cacheable area&#160;of memory,&#160;it first checks&#160;if a&#160;cache line for&#160;<br/>that&#160;memory location&#160;exists in&#160;the cache. If&#160;a valid&#160;cache line does exist, the&#160;processor (depending&#160;on the&#160;write&#160;<br/>policy currently in&#160;force)&#160;can write&#160;the operand&#160;into the&#160;cache instead of writing&#160;it out to&#160;system memory. This&#160;<br/>operation is&#160;called a&#160;<b>write hit</b>. If a&#160;write misses&#160;the cache&#160;(that is, a&#160;valid cache line&#160;is not&#160;present&#160;for&#160;area&#160;of&#160;<br/>memory being written to), the processor performs a cache line fill, write allocation. Then it writes&#160;the&#160;operand into&#160;<br/>the cache line&#160;and&#160;(depending on the write policy currently in force) can also write it out to memory. If the operand&#160;<br/>is to&#160;be&#160;written&#160;out to&#160;memory,&#160;it is&#160;written first into&#160;the store&#160;buffer,&#160;and then&#160;written&#160;from the store&#160;buffer to&#160;<br/>memory when the&#160;system&#160;bus&#160;is available. (Note that for&#160;the Pentium&#160;processor,&#160;write&#160;misses do&#160;not result&#160;in a&#160;<br/>cache line fill; they&#160;always result in a&#160;write&#160;to memory. For&#160;this processor,&#160;only read&#160;misses result in cache line&#160;fills.)</p>
</div>
</body>
</html>
