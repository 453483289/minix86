<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 701</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:14px;font-family:Times;color:#0860a8;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page701-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce701.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-65</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">18.11.1&#160;&#160;Processor Event Based Sampling (PEBS) Facility&#160;</p>
<p style="position:absolute;top:129px;left:69px;white-space:nowrap" class="ft06">The PEBS&#160;facility in the 4th&#160;Generation&#160;Intel Core&#160;processor is similar&#160;to those&#160;in processors based&#160;on&#160;Intel micro-<br/>architecture code name Sandy Bridge,&#160;with&#160;several&#160;enhanced&#160;features.&#160;The&#160;key components&#160;and differences of&#160;<br/>PEBS facility&#160;relative to&#160;Intel microarchitecture&#160;code&#160;name&#160;Sandy Bridge&#160;is&#160;summarized&#160;<a href="o_fe12b1e2a880e0ce-701.html">in Table&#160;18-43.</a></p>
<p style="position:absolute;top:588px;left:69px;white-space:nowrap" class="ft03">Only&#160;IA32_PMC0&#160;through IA32_PMC3 support PEBS.&#160;</p>
<p style="position:absolute;top:622px;left:433px;white-space:nowrap" class="ft04">NOTE</p>
<p style="position:absolute;top:648px;left:122px;white-space:nowrap" class="ft06">PEBS events&#160;are&#160;only&#160;valid when the following&#160;fields of IA32_PERFEVTSELx are&#160;all&#160;zero: AnyThread,&#160;<br/>Edge, Invert, CMask.</p>
<p style="position:absolute;top:706px;left:122px;white-space:nowrap" class="ft06">In&#160;a PMU with&#160;PDIR&#160;capability,&#160;PEBS behavior&#160;is unpredictable if&#160;IA32_PERFEVTSELx&#160;or IA32_PMCx&#160;<br/>is changed for a&#160;PEBS-enabled&#160;counter&#160;while an&#160;event&#160;is being counted.&#160;To&#160;avoid this, changes&#160;to&#160;<br/>the programming or&#160;value&#160;of&#160;a PEBS-enabled counter should be&#160;performed&#160;when the counter is&#160;<br/>disabled.</p>
<p style="position:absolute;top:806px;left:69px;white-space:nowrap" class="ft02">18.11.2&#160;&#160;PEBS Data Format</p>
<p style="position:absolute;top:837px;left:69px;white-space:nowrap" class="ft06">The&#160;PEBS&#160;record&#160;format for the&#160;4th Generation Intel Core&#160;processor&#160;is shown&#160;<a href="o_fe12b1e2a880e0ce-702.html">in Table&#160;18-44. The PEBS&#160;</a>record&#160;<br/>format, along with&#160;debug/store area storage format, does&#160;not change regardless&#160;of&#160;whether IA-32e mode is active&#160;<br/>or not.&#160;CPUID.01H:ECX.DTES64[bit 2]&#160;reports whether the&#160;processor's DS&#160;storage format&#160;support&#160;is mode-inde-<br/>pendent.&#160;When set,&#160;it&#160;uses&#160;64-bit DS&#160;storage&#160;format.</p>
<p style="position:absolute;top:203px;left:321px;white-space:nowrap" class="ft05">Table 18-43. &#160;PEBS Facility&#160;Comparison</p>
<p style="position:absolute;top:244px;left:75px;white-space:nowrap" class="ft03">Box</p>
<p style="position:absolute;top:227px;left:253px;white-space:nowrap" class="ft03">Intel® microarchitecture&#160;code&#160;</p>
<p style="position:absolute;top:244px;left:253px;white-space:nowrap" class="ft03">name Haswell</p>
<p style="position:absolute;top:227px;left:452px;white-space:nowrap" class="ft03">Intel®&#160;microarchitecture&#160;code&#160;</p>
<p style="position:absolute;top:244px;left:452px;white-space:nowrap" class="ft03">name Sandy Bridge</p>
<p style="position:absolute;top:244px;left:639px;white-space:nowrap" class="ft03">Comment</p>
<p style="position:absolute;top:268px;left:75px;white-space:nowrap" class="ft03">Valid&#160;IA32_PMCx</p>
<p style="position:absolute;top:268px;left:253px;white-space:nowrap" class="ft03">PMC0-PMC3</p>
<p style="position:absolute;top:268px;left:452px;white-space:nowrap" class="ft03">PMC0-PMC3</p>
<p style="position:absolute;top:268px;left:640px;white-space:nowrap" class="ft03">No PEBS&#160;on&#160;PMC4-PMC7&#160;</p>
<p style="position:absolute;top:292px;left:75px;white-space:nowrap" class="ft03">PEBS&#160;Buffer&#160;Programming</p>
<p style="position:absolute;top:292px;left:253px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-671.html">&#160;Section 18.8.1.1</a></p>
<p style="position:absolute;top:292px;left:452px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-671.html">Section 18.8.1.1</a></p>
<p style="position:absolute;top:292px;left:640px;white-space:nowrap" class="ft03">Unchanged</p>
<p style="position:absolute;top:316px;left:75px;white-space:nowrap" class="ft03">IA32_PEBS_ENABLE&#160;Layout</p>
<p style="position:absolute;top:316px;left:253px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-672.html">&#160;Figure&#160;18-21</a></p>
<p style="position:absolute;top:316px;left:452px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-690.html">Figure&#160;18-35</a></p>
<p style="position:absolute;top:340px;left:75px;white-space:nowrap" class="ft03">PEBS&#160;record&#160;layout</p>
<p style="position:absolute;top:340px;left:253px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-702.html">Table&#160;18-44;</a>&#160;enhanced&#160;fields at&#160;</p>
<p style="position:absolute;top:357px;left:253px;white-space:nowrap" class="ft03">offsets 98H, A0H,&#160;A8H,&#160;B0H.</p>
<p style="position:absolute;top:340px;left:452px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-673.html">Table&#160;18-23; en</a>hanced&#160;fields&#160;</p>
<p style="position:absolute;top:357px;left:452px;white-space:nowrap" class="ft03">at&#160;offsets 98H,&#160;A0H, A8H.</p>
<p style="position:absolute;top:381px;left:75px;white-space:nowrap" class="ft03">Precise Events</p>
<p style="position:absolute;top:381px;left:253px;white-space:nowrap" class="ft03">See&#160;<a href="o_fe12b1e2a880e0ce-691.html">Table&#160;18-32.</a></p>
<p style="position:absolute;top:381px;left:452px;white-space:nowrap" class="ft03">Se<a href="o_fe12b1e2a880e0ce-691.html">e Table&#160;18-32.</a></p>
<p style="position:absolute;top:381px;left:640px;white-space:nowrap" class="ft03">IA32_PMC4-IA32_PMC7&#160;do&#160;not&#160;</p>
<p style="position:absolute;top:397px;left:640px;white-space:nowrap" class="ft03">support PEBS.</p>
<p style="position:absolute;top:421px;left:75px;white-space:nowrap" class="ft03">PEBS-Load&#160;Latency</p>
<p style="position:absolute;top:421px;left:253px;white-space:nowrap" class="ft03">See&#160;<a href="o_fe12b1e2a880e0ce-692.html">Table&#160;18-33.</a></p>
<p style="position:absolute;top:421px;left:452px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-692.html">Table&#160;18-33</a></p>
<p style="position:absolute;top:445px;left:75px;white-space:nowrap" class="ft03">PEBS-Precise Store</p>
<p style="position:absolute;top:445px;left:253px;white-space:nowrap" class="ft03">No, replaced&#160;by data address&#160;</p>
<p style="position:absolute;top:462px;left:253px;white-space:nowrap" class="ft03">profiling.</p>
<p style="position:absolute;top:445px;left:452px;white-space:nowrap" class="ft03">Yes; se<a href="o_fe12b1e2a880e0ce-692.html">e Section 18.9.4.3</a>.</p>
<p style="position:absolute;top:485px;left:75px;white-space:nowrap" class="ft03">PEBS-PDIR</p>
<p style="position:absolute;top:485px;left:253px;white-space:nowrap" class="ft03">Yes</p>
<p style="position:absolute;top:485px;left:452px;white-space:nowrap" class="ft03">Yes</p>
<p style="position:absolute;top:485px;left:640px;white-space:nowrap" class="ft03">IA32_PMC1&#160;only.</p>
<p style="position:absolute;top:510px;left:75px;white-space:nowrap" class="ft03">PEBS&#160;skid&#160;from&#160;EventingIP</p>
<p style="position:absolute;top:510px;left:253px;white-space:nowrap" class="ft03">1 (or 2&#160;if&#160;micro+macro fusion)</p>
<p style="position:absolute;top:510px;left:452px;white-space:nowrap" class="ft03">1</p>
<p style="position:absolute;top:534px;left:75px;white-space:nowrap" class="ft03">SAMPLING Restriction</p>
<p style="position:absolute;top:534px;left:253px;white-space:nowrap" class="ft03">Small SAV(CountDown)&#160;value&#160;incur&#160;higher&#160;overhead&#160;than&#160;prior&#160;</p>
<p style="position:absolute;top:550px;left:253px;white-space:nowrap" class="ft03">generation.</p>
</div>
</body>
</html>
