<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 403</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:10px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:9px;line-height:15px;font-family:Times;color:#000000;}
	.ft011{font-size:9px;line-height:14px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page403-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce403.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:760px;white-space:nowrap" class="ft00">Vol. 3A&#160;10-41</p>
<p style="position:absolute;top:47px;left:484px;white-space:nowrap" class="ft01">ADVANCED PROGRAMMABLE&#160;INTERRUPT CONTROLLER&#160;(APIC)</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft03">x2APIC mode: IA32_APIC_BASE[EN]=1&#160;and IA32_APIC_BASE[EXTD]=1</p>
<p style="position:absolute;top:122px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:123px;left:95px;white-space:nowrap" class="ft03">Invalid: IA32_APIC_BASE[EN]=0&#160;and IA32_APIC_BASE[EXTD]=1</p>
<p style="position:absolute;top:145px;left:69px;white-space:nowrap" class="ft07">The&#160;state corresponding to&#160;EXTD=1&#160;and EN=0 is&#160;not&#160;valid and&#160;it is&#160;not&#160;possible to get into&#160;this&#160;state. An&#160;execution&#160;<br/>of WRMSR to the IA32_APIC_BASE_MSR that&#160;attempts a&#160;transition from a&#160;valid state to&#160;this&#160;invalid state&#160;causes&#160;a&#160;<br/>general-protection except<a href="o_fe12b1e2a880e0ce-403.html">ion. Figure 10-27</a>&#160;shows the comprehensive state transition&#160;diagram&#160;for a&#160;local x2APIC&#160;<br/>unit.&#160;<br/>On&#160;coming out&#160;of&#160;reset, the&#160;local APIC unit is&#160;enabled&#160;and&#160;is in the xAPIC&#160;mode: IA32_APIC_BASE[EN]=1&#160;and&#160;<br/>IA32_APIC_BASE[EXTD]=0. The APIC&#160;registers are&#160;initialized as:</p>
<p style="position:absolute;top:256px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:256px;left:95px;white-space:nowrap" class="ft07">The&#160;local APIC ID is&#160;initialized&#160;by hardware&#160;with&#160;a 32&#160;bit ID&#160;(x2APIC&#160;ID).&#160;The lowest&#160;8 bits of the&#160;x2APIC&#160;ID&#160;is&#160;<br/>the legacy local&#160;xAPIC ID, and&#160;is stored in&#160;the upper&#160;8&#160;bits of&#160;the&#160;APIC register for access in&#160;xAPIC mode.</p>
<p style="position:absolute;top:295px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:295px;left:95px;white-space:nowrap" class="ft09">The&#160;following APIC registers&#160;are reset to&#160;all zeros&#160;for those&#160;fields&#160;that are&#160;defined&#160;in the&#160;xAPIC&#160;mode:<br/>—&#160;IRR, ISR,&#160;TMR,&#160;ICR, LDR,&#160;TPR,&#160;Divide&#160;Configuration&#160;Register (See&#160;Chapter 8 of “Intel® 64&#160;and IA-32&#160;Archi-</p>
<p style="position:absolute;top:336px;left:120px;white-space:nowrap" class="ft03">tectures Software Developer’s Manual“,&#160;Vol. 3B for&#160;details&#160;of&#160;individual&#160;APIC registers),</p>
<p style="position:absolute;top:360px;left:95px;white-space:nowrap" class="ft03">—&#160;Timer initial&#160;count&#160;and timer current count registers,</p>
<p style="position:absolute;top:382px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:382px;left:95px;white-space:nowrap" class="ft03">The&#160;LVT registers&#160;are&#160;reset&#160;to 0s&#160;except for the&#160;mask bits;&#160;these&#160;are&#160;set to&#160;1s.</p>
<p style="position:absolute;top:404px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:405px;left:95px;white-space:nowrap" class="ft03">The&#160;local APIC version register&#160;is not affected.</p>
<p style="position:absolute;top:427px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:427px;left:95px;white-space:nowrap" class="ft03">The&#160;Spurious Interrupt Vector&#160;Register&#160;is initialized to&#160;000000FFH.&#160;</p>
<p style="position:absolute;top:449px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:450px;left:95px;white-space:nowrap" class="ft03">The&#160;DFR (available&#160;only&#160;in xAPIC&#160;mode) is&#160;reset to all 1s.&#160;</p>
<p style="position:absolute;top:472px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:472px;left:95px;white-space:nowrap" class="ft03">SELF IPI register&#160;is reset to&#160;zero.</p>
<p style="position:absolute;top:960px;left:69px;white-space:nowrap" class="ft04">x2APIC After Reset</p>
<p style="position:absolute;top:989px;left:69px;white-space:nowrap" class="ft03">The valid&#160;transitions from the&#160;xAPIC mode&#160;state&#160;are:</p>
<p style="position:absolute;top:1011px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:1011px;left:95px;white-space:nowrap" class="ft07">to the x2APIC mode by&#160;setting EXT to&#160;1 (resulting EN=1, EXTD=&#160;1). The physical&#160;x2AP<a href="o_fe12b1e2a880e0ce-371.html">IC ID (see Figure 10-6)&#160;<br/></a>is preserved across&#160;this transition&#160;and the logical&#160;x2APIC&#160;ID&#160;(see<a href="o_fe12b1e2a880e0ce-407.html">&#160;Figure 10-29</a>)&#160;is&#160;initialized&#160;by&#160;hardware during&#160;<br/>this transition&#160;as document<a href="o_fe12b1e2a880e0ce-407.html">ed in Section 10.12.10.2.</a>&#160;The&#160;state&#160;of the&#160;extended&#160;fields&#160;in other&#160;APIC&#160;registers,&#160;</p>
<p style="position:absolute;top:907px;left:171px;white-space:nowrap" class="ft05">Figure&#160;10-27.&#160;&#160;Local x2APIC&#160;State&#160;Transitions&#160;with&#160;IA32_APIC_BASE,&#160;INIT, and Reset</p>
<p style="position:absolute;top:692px;left:274px;white-space:nowrap" class="ft06">xAPIC&#160;Mode</p>
<p style="position:absolute;top:634px;left:370px;white-space:nowrap" class="ft00">EN =1</p>
<p style="position:absolute;top:627px;left:551px;white-space:nowrap" class="ft00">Illegal</p>
<p style="position:absolute;top:642px;left:564px;white-space:nowrap" class="ft00">Transition</p>
<p style="position:absolute;top:585px;left:531px;white-space:nowrap" class="ft00">Init</p>
<p style="position:absolute;top:824px;left:469px;white-space:nowrap" class="ft00">EN=1,&#160;Extd=1</p>
<p style="position:absolute;top:793px;left:472px;white-space:nowrap" class="ft00">Extended</p>
<p style="position:absolute;top:706px;left:633px;white-space:nowrap" class="ft00">Invalid</p>
<p style="position:absolute;top:719px;left:637px;white-space:nowrap" class="ft00">State</p>
<p style="position:absolute;top:807px;left:472px;white-space:nowrap" class="ft00">Mode</p>
<p style="position:absolute;top:580px;left:407px;white-space:nowrap" class="ft00">Reset</p>
<p style="position:absolute;top:657px;left:585px;white-space:nowrap" class="ft00">Extd&#160;= 1</p>
<p style="position:absolute;top:766px;left:609px;white-space:nowrap" class="ft00">Illegal</p>
<p style="position:absolute;top:779px;left:589px;white-space:nowrap" class="ft00">Transition</p>
<p style="position:absolute;top:793px;left:578px;white-space:nowrap" class="ft00">EN = 0</p>
<p style="position:absolute;top:689px;left:439px;white-space:nowrap" class="ft00">EN = 0</p>
<p style="position:absolute;top:687px;left:508px;white-space:nowrap" class="ft010">Illegal<br/>Transition</p>
<p style="position:absolute;top:703px;left:432px;white-space:nowrap" class="ft00">Extd&#160;= 0</p>
<p style="position:absolute;top:736px;left:385px;white-space:nowrap" class="ft00">Illegal</p>
<p style="position:absolute;top:750px;left:399px;white-space:nowrap" class="ft00">Transition</p>
<p style="position:absolute;top:765px;left:419px;white-space:nowrap" class="ft00">Extd&#160;= 0</p>
<p style="position:absolute;top:711px;left:274px;white-space:nowrap" class="ft00">EN=1,&#160;Extd=0</p>
<p style="position:absolute;top:683px;left:386px;white-space:nowrap" class="ft00">EN = 0</p>
<p style="position:absolute;top:764px;left:324px;white-space:nowrap" class="ft00">Extd&#160;= 1</p>
<p style="position:absolute;top:846px;left:411px;white-space:nowrap" class="ft00">Reset</p>
<p style="position:absolute;top:773px;left:253px;white-space:nowrap" class="ft00">Reset</p>
<p style="position:absolute;top:620px;left:261px;white-space:nowrap" class="ft00">Init</p>
<p style="position:absolute;top:859px;left:552px;white-space:nowrap" class="ft00">Init</p>
<p style="position:absolute;top:611px;left:460px;white-space:nowrap" class="ft06">Disabled</p>
<p style="position:absolute;top:624px;left:459px;white-space:nowrap" class="ft011">EN = 0<br/>Extd&#160;= 0</p>
<p style="position:absolute;top:725px;left:525px;white-space:nowrap" class="ft00">Extd&#160;= 1</p>
<p style="position:absolute;top:750px;left:534px;white-space:nowrap" class="ft00">EN = 0</p>
</div>
</body>
</html>
