<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 599</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:16px;font-family:Times;color:#0860a8;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page599-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce599.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;17-25</p>
<p style="position:absolute;top:47px;left:425px;white-space:nowrap" class="ft01">DEBUG, BRANCH&#160;PROFILE, TSC, AND RESOURCE MONITORING FEATURES</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft08">After&#160;reading the data in the appropriate buffer,&#160;up to but not&#160;including the&#160;current&#160;index into the buffer, the ISR&#160;<br/>must reset the&#160;buffer&#160;index&#160;to the&#160;beginning of the&#160;buffer. Otherwise, everything up&#160;to the&#160;index will look like&#160;<br/>new entries upon the next invocation of the&#160;ISR.</p>
<p style="position:absolute;top:155px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:156px;left:95px;white-space:nowrap" class="ft03">The ISR&#160;must clear&#160;the&#160;mask bit in&#160;the performance&#160;counter LVT&#160;entry.</p>
<p style="position:absolute;top:178px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:178px;left:95px;white-space:nowrap" class="ft08">The&#160;ISR must re-enable&#160;the&#160;counters&#160;to count&#160;via&#160;IA32_PERF_GLOBAL_CTRL/IA32_PERF_GLOBAL_OVF_CTRL&#160;<br/>if it&#160;is servicing an overflow&#160;PMI&#160;due&#160;to PEBS&#160;(or via&#160;CCCR's&#160;ENABLE bit on processor based&#160;on&#160;Intel&#160;NetBurst&#160;<br/>microarchitecture).</p>
<p style="position:absolute;top:233px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:234px;left:95px;white-space:nowrap" class="ft08">The&#160;Pentium 4 Processor and Intel Xeon&#160;Processor mask&#160;PMIs upon receiving an interrupt. Clear this&#160;condition&#160;<br/>before&#160;leaving&#160;the&#160;interrupt&#160;handler.</p>
<p style="position:absolute;top:306px;left:69px;white-space:nowrap" class="ft04">17.5 LAST&#160;</p>
<p style="position:absolute;top:306px;left:201px;white-space:nowrap" class="ft04">BRANCH,&#160;</p>
<p style="position:absolute;top:306px;left:291px;white-space:nowrap" class="ft04">INTERRUPT,&#160;</p>
<p style="position:absolute;top:306px;left:410px;white-space:nowrap" class="ft04">AND&#160;EXCEPTION&#160;RECORDING&#160;(INTEL</p>
<p style="position:absolute;top:310px;left:742px;white-space:nowrap" class="ft05">®</p>
<p style="position:absolute;top:306px;left:748px;white-space:nowrap" class="ft04">&#160;CORE™ 2&#160;</p>
<p style="position:absolute;top:331px;left:147px;white-space:nowrap" class="ft04">DUO AND INTEL</p>
<p style="position:absolute;top:336px;left:295px;white-space:nowrap" class="ft05">®</p>
<p style="position:absolute;top:331px;left:301px;white-space:nowrap" class="ft04">&#160;ATOM™ PROCESSORS)</p>
<p style="position:absolute;top:367px;left:69px;white-space:nowrap" class="ft08">The&#160;Intel Core 2 Duo&#160;processor&#160;family&#160;and Intel&#160;Xeon&#160;processors&#160;based on Intel Core microarchitecture&#160;or&#160;<br/>enhanced&#160;Intel Core&#160;microarchitecture&#160;provide&#160;last&#160;branch interrupt and&#160;exception recording.&#160;The&#160;facilities&#160;<br/>described in&#160;this section&#160;also apply to&#160;45 nm&#160;and 32 nm&#160;Intel Atom processors. These&#160;capabilities&#160;are&#160;similar&#160;to&#160;<br/>those&#160;found&#160;in Pentium 4&#160;processors, including support for the&#160;following&#160;facilities:</p>
<p style="position:absolute;top:439px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:439px;left:95px;white-space:nowrap" class="ft08"><b>Debug Trace and Branch Recording Control —&#160;</b>The IA32_DEBUGCTL&#160;MSR provide&#160;bit fields&#160;for software to&#160;<br/>configure mechanisms related to&#160;debug&#160;trace, branch recording, branch trace&#160;store,&#160;and performance counter&#160;<br/>operations.&#160;See<a href="o_fe12b1e2a880e0ce-585.html">&#160;Section&#160;17.4.1&#160;for&#160;</a>a&#160;description&#160;of&#160;the&#160;flags.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-586.html">Figure&#160;17-3</a>&#160;for the&#160;MSR&#160;layout.</p>
<p style="position:absolute;top:494px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:495px;left:95px;white-space:nowrap" class="ft08"><b>Last&#160;branch&#160;record (LBR) stack&#160;—&#160;</b>There&#160;are&#160;a collection of MSR pairs that store the source and destination&#160;<br/>addresses related&#160;to recently&#160;executed branches.&#160;S<a href="o_fe12b1e2a880e0ce-599.html">ee Section 17.5.1.</a>&#160;</p>
<p style="position:absolute;top:533px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:534px;left:95px;white-space:nowrap" class="ft09"><b>Monitoring&#160;and single-stepping&#160;of&#160;branches, exceptions, and interrupts<br/></b>—&#160;See&#160;<a href="o_fe12b1e2a880e0ce-586.html">Section 17.4.2&#160;</a><a href="o_fe12b1e2a880e0ce-587.html">and Section 17.4.3. In&#160;</a>addition, the&#160;ability&#160;to freeze&#160;the LBR stack on&#160;a PMI request is&#160;</p>
<p style="position:absolute;top:574px;left:120px;white-space:nowrap" class="ft03">available.</p>
<p style="position:absolute;top:598px;left:95px;white-space:nowrap" class="ft03">—&#160;45 nm and&#160;32&#160;nm Intel&#160;Atom&#160;processors&#160;clear&#160;the&#160;TR&#160;flag when the&#160;FREEZE_LBRS_ON_PMI flag&#160;is set.</p>
<p style="position:absolute;top:620px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:621px;left:95px;white-space:nowrap" class="ft06"><b>Branch&#160;trace messages&#160;—&#160;</b>S<a href="o_fe12b1e2a880e0ce-587.html">ee Section&#160;17.4.4.</a>&#160;</p>
<p style="position:absolute;top:643px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:643px;left:95px;white-space:nowrap" class="ft06"><b>Last&#160;exception records —&#160;</b>Se<a href="o_fe12b1e2a880e0ce-609.html">e Section 17.11.3.&#160;</a></p>
<p style="position:absolute;top:665px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:666px;left:95px;white-space:nowrap" class="ft06"><b>Branch&#160;trace store and CPL-qualified&#160;BTS —&#160;</b>S<a href="o_fe12b1e2a880e0ce-587.html">ee Section 17.4.5.</a></p>
<p style="position:absolute;top:688px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:688px;left:95px;white-space:nowrap" class="ft06"><b>FREEZE_LBRS_ON_PMI flag (bit&#160;11) —&#160;</b>see<a href="o_fe12b1e2a880e0ce-588.html">&#160;Section&#160;17.4.7 for&#160;</a>legacy Freeze_LBRs_On_PMI&#160;operation.&#160;</p>
<p style="position:absolute;top:710px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:711px;left:95px;white-space:nowrap" class="ft08"><b>FREEZE_PERFMON_ON_PMI flag (bit&#160;12) —&#160;</b>see<a href="o_fe12b1e2a880e0ce-588.html">&#160;Section&#160;17.4.7 for le</a>gacy Freeze_Perfmon_On_PMI&#160;<br/>operation.&#160;</p>
<p style="position:absolute;top:749px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:750px;left:95px;white-space:nowrap" class="ft08"><b>FREEZE_WHILE_SMM_EN (bit&#160;14) —&#160;</b>FREEZE_WHILE_SMM_EN is&#160;supported&#160;if&#160;<br/>IA32_PERF_CAPABILITIES.FREEZE_WHILE_SMM[Bit&#160;12]&#160;is reporting&#160;1.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-585.html">Section 17.4.1</a>.</p>
<p style="position:absolute;top:817px;left:69px;white-space:nowrap" class="ft07">17.5.1 LBR&#160;</p>
<p style="position:absolute;top:817px;left:186px;white-space:nowrap" class="ft07">Stack&#160;</p>
<p style="position:absolute;top:847px;left:69px;white-space:nowrap" class="ft08">The&#160;last branch record&#160;stack and&#160;top-of-stack (TOS)&#160;pointer MSRs&#160;are supported&#160;across Intel Core 2, Intel Atom&#160;<br/>processor&#160;families,&#160;and Intel processors based on&#160;Intel NetBurst&#160;microarchitecture.&#160;<br/>Four pairs of MSRs&#160;are&#160;supported in the&#160;LBR&#160;stack&#160;for Intel Core 2&#160;processors families&#160;and Intel&#160;processors&#160;based&#160;<br/>on Intel&#160;NetBurst microarchitecture:</p>
<p style="position:absolute;top:926px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:927px;left:95px;white-space:nowrap" class="ft011"><b>Last&#160;Branch Record (LBR) Stack&#160;<br/></b>—&#160;MSR_LASTBRANCH_0_FROM_IP&#160;(address&#160;40H) through MSR_LASTBRANCH_3_FROM_IP&#160;(address&#160;43H)&#160;</p>
<p style="position:absolute;top:967px;left:120px;white-space:nowrap" class="ft03">store source&#160;addresses</p>
<p style="position:absolute;top:991px;left:95px;white-space:nowrap" class="ft03">—&#160;MSR_LASTBRANCH_0_TO_IP (address&#160;60H) through&#160;MSR_LASTBRANCH_3_TO_IP (address&#160;63H) store&#160;</p>
<p style="position:absolute;top:1008px;left:120px;white-space:nowrap" class="ft03">destination addresses</p>
</div>
</body>
</html>
