<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1012</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:14px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1012-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1012.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">22-8&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">ARCHITECTURE&#160;COMPATIBILITY</p>
<p style="position:absolute;top:99px;left:68px;white-space:nowrap" class="ft02">22.18.2.2&#160;&#160;&#160;Stack Fault Flag</p>
<p style="position:absolute;top:127px;left:68px;white-space:nowrap" class="ft05">When&#160;unmasked&#160;stack overflow or&#160;underflow&#160;occurs on&#160;a 32-bit&#160;x87&#160;FPU,&#160;the&#160;IE flag&#160;(bit&#160;0)&#160;and&#160;the&#160;SF&#160;flag&#160;(bit&#160;6)&#160;<br/>of&#160;the&#160;x87 FPU&#160;status word are set&#160;to indicate a&#160;stack fault&#160;and condition&#160;code&#160;flag C1&#160;is set or&#160;cleared&#160;to indicate&#160;<br/>overflow or underflow,&#160;respectively. When&#160;unmasked stack&#160;overflow&#160;or underflow&#160;occurs on a&#160;16-bit IA-32 math&#160;<br/>coprocessor,&#160;only the IE flag is set. Bit 6 is reserved on&#160;these processors. The addition of&#160;the SF&#160;flag&#160;on a 32-bit x87&#160;<br/>FPU has no impact on software. Existing exception handlers need not change, but&#160;may be&#160;upgraded to take advan-<br/>tage of&#160;the additional information.</p>
<p style="position:absolute;top:260px;left:68px;white-space:nowrap" class="ft04">22.18.3&#160;&#160;x87 FPU Control Word</p>
<p style="position:absolute;top:291px;left:68px;white-space:nowrap" class="ft05">Only&#160;affine closure&#160;is supported&#160;for&#160;infinity&#160;control on&#160;a&#160;32-bit x87&#160;FPU.&#160;The infinity control&#160;flag (bit 12&#160;of the&#160;x87&#160;<br/>FPU&#160;control word) remains&#160;programmable on&#160;these processors,&#160;but has&#160;no&#160;effect. This&#160;change was made&#160;to&#160;<br/>conform to&#160;the IEEE Standard 754&#160;for&#160;Binary Floating-Point&#160;Arithmetic.&#160;On a&#160;16-bit IA-32 math coprocessor,&#160;both&#160;<br/>affine and projective&#160;closures&#160;are&#160;supported,&#160;as determined by the&#160;setting&#160;of bit&#160;12.&#160;After&#160;a hardware reset,&#160;the&#160;<br/>default&#160;value of bit 12 is&#160;projective.&#160;Software&#160;that&#160;requires&#160;projective&#160;infinity&#160;arithmetic&#160;may&#160;give&#160;different&#160;results.</p>
<p style="position:absolute;top:407px;left:68px;white-space:nowrap" class="ft04">22.18.4&#160;&#160;x87 FPU Tag Word</p>
<p style="position:absolute;top:438px;left:68px;white-space:nowrap" class="ft05">When loading the tag word of a 32-bit&#160;x87&#160;FPU,&#160;using&#160;an FLDENV,&#160;FRSTOR, or FXRSTOR (Pentium&#160;III&#160;processor only)&#160;<br/>instruction,&#160;the processor examines&#160;the&#160;incoming tag and classifies the location only as&#160;empty or&#160;non-empty.&#160;Thus,&#160;<br/>tag values of 00,&#160;01,&#160;and 10&#160;are&#160;interpreted by the processor to indicate a non-empty location. The tag value of 11&#160;<br/>is interpreted by the&#160;processor&#160;to indicate an&#160;empty location. Subsequent&#160;operations&#160;on a&#160;non-empty register&#160;<br/>always&#160;examine the&#160;value&#160;in&#160;the&#160;register,&#160;not&#160;the value&#160;in&#160;its tag.&#160;The FSTENV, FSAVE,&#160;and FXSAVE&#160;(Pentium&#160;III&#160;<br/>processor only) instructions examine the non-empty registers&#160;and&#160;put&#160;the&#160;correct values&#160;in the tags&#160;before storing&#160;<br/>the tag word.<br/>The corresponding&#160;tag for a 16-bit IA-32 math&#160;coprocessor is checked&#160;before each register&#160;access to&#160;determine the&#160;<br/>class of operand&#160;in the register; the tag&#160;is&#160;updated after&#160;every change to a register so that the tag always&#160;reflects&#160;<br/>the most&#160;recent status&#160;of the&#160;register. Software can load a&#160;tag&#160;with a&#160;value that&#160;disagrees with the&#160;contents of a&#160;<br/>register (for example,&#160;the register&#160;contains&#160;a valid&#160;value, but&#160;the tag says special).&#160;Here, the&#160;16-bit IA-32&#160;math&#160;<br/>coprocessors honor the&#160;tag&#160;and do&#160;not examine&#160;the register.&#160;<br/>Software written to run&#160;on a 16-bit IA-32 math coprocessor&#160;may&#160;not operate correctly&#160;on a 16-bit x87 FPU,&#160;if it uses&#160;<br/>the FLDENV, FRSTOR,&#160;or FXRSTOR&#160;instructions&#160;to change&#160;tags&#160;to values (other&#160;than to empty) that&#160;are different&#160;<br/>from&#160;actual register contents.<br/>The encoding in&#160;the tag&#160;word for the&#160;32-bit x87&#160;FPUs&#160;for unsupported&#160;data formats&#160;(including&#160;pseudo-zero&#160;and&#160;<br/>unnormal) is special (10B), to&#160;comply&#160;with IEEE Standard&#160;754.&#160;The encoding&#160;in the&#160;16-bit IA-32 math coprocessors&#160;<br/>for pseudo-zero and&#160;unnormal&#160;is valid&#160;(00B)&#160;and the encoding for other unsupported data&#160;formats is&#160;special&#160;(10B).&#160;<br/>Code&#160;that&#160;recognizes the pseudo-zero or unnormal format as&#160;valid must therefore be changed if it is ported to&#160;a 32-<br/>bit x87&#160;FPU.</p>
<p style="position:absolute;top:824px;left:68px;white-space:nowrap" class="ft04">22.18.5 Data&#160;</p>
<p style="position:absolute;top:824px;left:191px;white-space:nowrap" class="ft04">Types</p>
<p style="position:absolute;top:855px;left:68px;white-space:nowrap" class="ft03">This section discusses the&#160;differences&#160;of&#160;data&#160;types&#160;for&#160;the various x87&#160;FPUs&#160;and math coprocessors.</p>
<p style="position:absolute;top:899px;left:68px;white-space:nowrap" class="ft02">22.18.5.1&#160;&#160;&#160;NaNs</p>
<p style="position:absolute;top:928px;left:68px;white-space:nowrap" class="ft05">The&#160;32-bit x87&#160;FPUs distinguish between signaling&#160;NaNs&#160;(SNaNs)&#160;and quiet NaNs&#160;(QNaNs). These&#160;x87&#160;FPUs only&#160;<br/>generate&#160;QNaNs and&#160;normally do not generate an exception&#160;upon encountering&#160;a QNaN. An invalid-operation&#160;<br/>exception&#160;(#I)&#160;is generated only&#160;upon&#160;encountering a&#160;SNaN,&#160;except for the&#160;FCOM,&#160;FIST,&#160;and&#160;FBSTP&#160;instructions,&#160;<br/>which also&#160;generates an&#160;invalid-operation&#160;exceptions&#160;for&#160;a QNaNs. This&#160;behavior matches&#160;IEEE&#160;Standard&#160;754.<br/>The&#160;16-bit IA-32 math coprocessors only generate&#160;one kind&#160;of&#160;NaN&#160;(the equivalent of&#160;a&#160;QNaN),&#160;but the&#160;raise an&#160;<br/>invalid-operation&#160;exception upon&#160;encountering any&#160;kind of NaN.</p>
</div>
</body>
</html>
