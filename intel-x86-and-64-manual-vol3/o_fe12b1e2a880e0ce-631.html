<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 631</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page631-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce631.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;17-57</p>
<p style="position:absolute;top:47px;left:425px;white-space:nowrap" class="ft01">DEBUG, BRANCH&#160;PROFILE, TSC, AND RESOURCE MONITORING FEATURES</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft07">caches after a migration.&#160;In general, for best performance, minimize&#160;thread migration&#160;and COS&#160;migration across&#160;<br/>processor logical threads and&#160;processor&#160;cores.</p>
<p style="position:absolute;top:161px;left:69px;white-space:nowrap" class="ft03">17.17.3.3 &#160;&#160;Cache Allocation Technology: Cache Mask&#160;Configuration</p>
<p style="position:absolute;top:190px;left:69px;white-space:nowrap" class="ft07">After determining the&#160;length&#160;of the&#160;capacity&#160;bitmasks (CBM) and&#160;number of COS&#160;supported using&#160;CPUID (see&#160;<br/><a href="o_fe12b1e2a880e0ce-629.html">Section&#160;17.17.3.2),&#160;</a>each COS&#160;needs to be&#160;programmed&#160;with&#160;a CBM to dictate its available cache via a&#160;write&#160;to the&#160;<br/>corresponding&#160;IA32_resourceType_MASK_n register,&#160;where 'n' corresponds to&#160;a number&#160;within the&#160;supported&#160;<br/>range&#160;of COS,&#160;i.e.&#160;the&#160;range&#160;between 0&#160;and CPUID.(EAX=10H, ECX=ResID):EDX[15:0],&#160;inclusive,&#160;and&#160;<br/>'resourceType' corresponds to&#160;a specific resource&#160;as enumerated by&#160;the set bits&#160;of CPUID.(EAX=10H,&#160;<br/>ECX=0):EAX[31:1],&#160;for instance,&#160;‘L2’&#160;or ‘L3’&#160;cache.&#160;<br/>A hierarchy of MSRs&#160;is reserved&#160;for Cache Allocation Technology&#160;registers of&#160;the&#160;form&#160;<br/>IA32_resourceType_MASK_n:&#160;</p>
<p style="position:absolute;top:334px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:335px;left:95px;white-space:nowrap" class="ft07">from 0C90H&#160;through 0D8FH&#160;(inclusive),&#160;providing support for&#160;multiple sub-ranges to support varying resource&#160;<br/>types. The first supported&#160;resourceType is&#160;'L3', corresponding to&#160;the L3 cache in a&#160;platform.&#160;The&#160;MSRs&#160;range&#160;<br/>from&#160;0C90H through 0D0FH&#160;(inclusive),&#160;enables support for up&#160;to 128&#160;L3&#160;CAT&#160;Classes of Service.&#160;</p>
<p style="position:absolute;top:676px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:677px;left:95px;white-space:nowrap" class="ft07">Within the&#160;same&#160;CAT&#160;range&#160;hierarchy,&#160;another&#160;set of registers&#160;is defined&#160;for&#160;resourceType&#160;'L2', corresponding&#160;<br/>to&#160;the L2 cache&#160;in a&#160;platform,&#160;and MSRs IA32_L2_MASK_n are&#160;defined for n=[0,63] at&#160;addresses&#160;0D10H&#160;<br/>through 0D4FH (inclusive).&#160;</p>
<p style="position:absolute;top:734px;left:69px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-631.html">Figure&#160;17-34&#160;</a>and<a href="o_fe12b1e2a880e0ce-631.html">&#160;Figure&#160;17-35</a>&#160;provide&#160;an&#160;overview of the&#160;relevant&#160;registers.&#160;</p>
<p style="position:absolute;top:977px;left:69px;white-space:nowrap" class="ft07">All CAT configuration&#160;registers&#160;can be accessed&#160;using&#160;the standard RDMSR /&#160;WRMSR instructions.&#160;<br/>Note&#160;that&#160;once&#160;L3&#160;or L2 CAT masks are&#160;configured, threads can&#160;be&#160;grouped into&#160;Classes of Service&#160;(COS) using&#160;the&#160;<br/>IA32_PQR_ASSOC MSR as&#160;described<a href="o_fe12b1e2a880e0ce-632.html">&#160;in Section 17.17.3.4&#160;</a>(Class of Service&#160;(COS) to&#160;Cache&#160;Mask Association:&#160;<br/>Common&#160;Across Allocation&#160;Features)</p>
<p style="position:absolute;top:631px;left:259px;white-space:nowrap" class="ft05">Figure&#160;17-34. &#160;IA32_PQR_ASSOC,&#160;IA32_L3_MASK_n&#160;MSRs</p>
<p style="position:absolute;top:931px;left:323px;white-space:nowrap" class="ft05">Figure&#160;17-35.&#160;&#160;IA32_L2_MASK_n&#160;MSRs</p>
<p style="position:absolute;top:434px;left:600px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:434px;left:480px;white-space:nowrap" class="ft06">10</p>
<p style="position:absolute;top:434px;left:202px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:454px;left:531px;white-space:nowrap" class="ft06">RMID</p>
<p style="position:absolute;top:434px;left:498px;white-space:nowrap" class="ft06">9</p>
<p style="position:absolute;top:454px;left:415px;white-space:nowrap" class="ft06">Reserved</p>
<p style="position:absolute;top:452px;left:640px;white-space:nowrap" class="ft06">IA32_PQR_ASSOC</p>
<p style="position:absolute;top:590px;left:642px;white-space:nowrap" class="ft06">IA32_L3_MASK_n</p>
<p style="position:absolute;top:501px;left:601px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:501px;left:410px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:501px;left:202px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:521px;left:278px;white-space:nowrap" class="ft06">Reserved</p>
<p style="position:absolute;top:521px;left:641px;white-space:nowrap" class="ft06">IA32_L3_MASK_0</p>
<p style="position:absolute;top:501px;left:395px;white-space:nowrap" class="ft06">32</p>
<p style="position:absolute;top:523px;left:481px;white-space:nowrap" class="ft06">Bit_Mask</p>
<p style="position:absolute;top:433px;left:385px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:455px;left:271px;white-space:nowrap" class="ft06">COS</p>
<p style="position:absolute;top:555px;left:340px;white-space:nowrap" class="ft06">....</p>
<p style="position:absolute;top:567px;left:601px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:567px;left:410px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:567px;left:202px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:587px;left:278px;white-space:nowrap" class="ft06">Reserved</p>
<p style="position:absolute;top:567px;left:395px;white-space:nowrap" class="ft06">32</p>
<p style="position:absolute;top:589px;left:481px;white-space:nowrap" class="ft06">Bit_Mask</p>
<p style="position:absolute;top:889px;left:642px;white-space:nowrap" class="ft06">IA32_L2_MASK_n</p>
<p style="position:absolute;top:801px;left:601px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:801px;left:410px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:801px;left:202px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:821px;left:278px;white-space:nowrap" class="ft06">Reserved</p>
<p style="position:absolute;top:820px;left:641px;white-space:nowrap" class="ft06">IA32_L2_MASK_0</p>
<p style="position:absolute;top:801px;left:395px;white-space:nowrap" class="ft06">32</p>
<p style="position:absolute;top:822px;left:481px;white-space:nowrap" class="ft06">Bit_Mask</p>
<p style="position:absolute;top:855px;left:340px;white-space:nowrap" class="ft06">....</p>
<p style="position:absolute;top:867px;left:601px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:867px;left:410px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:867px;left:202px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:887px;left:278px;white-space:nowrap" class="ft06">Reserved</p>
<p style="position:absolute;top:867px;left:395px;white-space:nowrap" class="ft06">32</p>
<p style="position:absolute;top:888px;left:481px;white-space:nowrap" class="ft06">Bit_Mask</p>
</div>
</body>
</html>
