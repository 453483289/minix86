<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 668</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page668-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce668.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">18-32&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft06">With PEBS&#160;record&#160;format&#160;encoding&#160;0011b,&#160;offset&#160;90H&#160;reports&#160;the “applicable&#160;counter” field,&#160;which is&#160;a multi-<br/>counter PEBS&#160;resolution index&#160;allowing software to&#160;correlate&#160;the PEBS record entry with the&#160;eventing&#160;PEBS&#160;over-<br/>flow when multiple&#160;counters are&#160;configured to&#160;record&#160;PEBS&#160;records. Additionally,&#160;offset&#160;C0H captures&#160;a snapshot&#160;of&#160;<br/>the TSC that&#160;provides&#160;a time&#160;line annotation for each&#160;PEBS&#160;record&#160;entry.</p>
<p style="position:absolute;top:194px;left:68px;white-space:nowrap" class="ft03">18.7.1.1 &#160;&#160;PEBS Data Linear&#160;Address Profiling</p>
<p style="position:absolute;top:223px;left:68px;white-space:nowrap" class="ft06">Goldmont&#160;supports&#160;the Data Linear Address field introduced&#160;in Haswell.&#160;It&#160;does not&#160;support&#160;the Data Source&#160;<br/>Encoding or Latency Value fields that are also part of Data&#160;Address Profiling. The fields&#160;are&#160;present in the record but&#160;<br/>are reserved.&#160;<br/>For&#160;Goldmont,&#160;the&#160;Data Linear Address field will record&#160;the linear&#160;address of memory accesses in&#160;the previous&#160;<br/>instruction&#160;(e.g. the&#160;one&#160;that triggered a&#160;precise event that&#160;caused&#160;the PEBS record to be generated).</p>
<p style="position:absolute;top:340px;left:68px;white-space:nowrap" class="ft03">18.7.1.2 &#160;&#160;Reduced&#160;Skid PEBS</p>
<p style="position:absolute;top:369px;left:68px;white-space:nowrap" class="ft06">For&#160;precise&#160;events,&#160;upon triggering&#160;a PEBS assist, there&#160;will be&#160;a&#160;finite&#160;delay&#160;between&#160;the&#160;time&#160;the counter&#160;over-<br/>flows and&#160;when&#160;the microcode starts&#160;to carry out&#160;its data&#160;collection&#160;obligations. The Reduced Skid mechanism miti-<br/>gates&#160;the “skid” problem by providing an&#160;early&#160;indication&#160;of when the&#160;counter&#160;is about to overflow, allowing&#160;the&#160;<br/>machine to more&#160;precisely trap on the&#160;instruction&#160;that actually caused the counter overflow&#160;thus&#160;greatly reducing&#160;<br/>skid.<br/>This mechanism is&#160;a superset&#160;of&#160;the PDIR&#160;mechanism&#160;available&#160;in&#160;the Sandy Bridge&#160;microarchitecture.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-693.html">Section&#160;<br/>18.9.4.4<br/></a>In the&#160;Goldmont microarchitecture, the&#160;mechanism&#160;applies&#160;to all&#160;precise events including INST_RETIRED.&#160;<br/>However,&#160;the&#160;Reduced Skid&#160;mechanism is&#160;disabled&#160;for any&#160;counter when the&#160;INV,&#160;ANY,&#160;E,&#160;or CMASK&#160;fields&#160;are set.<br/>To&#160;ensure&#160;the Reduced Skid mechanism operates&#160;correctly,&#160;disable PEBS via the&#160;IA32_PEBS_ENABLE or&#160;<br/>IA32_PERF_GLOBAL_CTRL&#160;MSRs before&#160;writing&#160;to the configuration registers (IA32_PERFEVTSELx) or to the coun-<br/>ters (IA32_PMCx&#160;and IA32_A_PMCx).</p>
<p style="position:absolute;top:617px;left:68px;white-space:nowrap" class="ft03">18.7.1.3 &#160;&#160;Enhancements&#160;to IA32_PERF_GLOBAL_STATUS.OvfDSBuffer[62]&#160;</p>
<p style="position:absolute;top:646px;left:68px;white-space:nowrap" class="ft06">In addition to&#160;IA32_PERF_GLOBAL_STATUS.OvfDSBuffer[62] being&#160;set when PEBS_Index&#160;reaches the&#160;<br/>PEBS_Interrupt_Theshold,&#160;the&#160;bit is&#160;also set when PEBS_Index&#160;is out of&#160;bounds.&#160;That is, the bit&#160;will&#160;be set&#160;when&#160;<br/>PEBS_Index&#160;&lt; PEBS_Buffer_Base or PEBS_Index &gt; PEBS_Absolute_Maximum.&#160;Note&#160;that when&#160;an out&#160;of&#160;bound&#160;<br/>condition is encountered,&#160;the&#160;overflow bits in IA32_PERF_GLOBAL_STATUS will be&#160;cleared according&#160;to Applicable&#160;<br/>Counters, however&#160;the IA32_PMCx values will&#160;not&#160;be&#160;reloaded&#160;with the&#160;Reset values&#160;stored&#160;in the&#160;DS_AREA.</p>
<p style="position:absolute;top:762px;left:68px;white-space:nowrap" class="ft04">18.7.2&#160;</p>
<p style="position:absolute;top:762px;left:148px;white-space:nowrap" class="ft04">Offcore Response Event</p>
<p style="position:absolute;top:793px;left:68px;white-space:nowrap" class="ft08">Event number&#160;0B7H support&#160;offcore response monitoring&#160;using&#160;an associated configuration&#160;MSR,&#160;<br/>MSR_OFFCORE_RSP0 (address&#160;1A6H)&#160;in conjunction with umask&#160;value&#160;01H&#160;or MSR_OFFCORE_RSP1&#160;(address&#160;<br/>1A7H)&#160;in conjunction with umask value 02H.<a href="o_fe12b1e2a880e0ce-661.html">&#160;Table&#160;18-14</a>&#160;lists&#160;the event code, mask value and&#160;additional&#160;off-core&#160;<br/>configuration&#160;MSR&#160;that must be programmed&#160;to&#160;count&#160;off-core response events&#160;using&#160;IA32_PMCx.&#160;<br/>The Goldmont&#160;microarchitecture provides unique&#160;pairs&#160;of MSR_OFFCORE_RSPx&#160;registers per core.<br/>The&#160;layout of MSR_OFFCORE_RSP0&#160;and&#160;MSR_OFFCORE_RSP1&#160;are organized&#160;as&#160;follows:</p>
<p style="position:absolute;top:912px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:913px;left:93px;white-space:nowrap" class="ft02">Bits 15:0 specifies&#160;the request type of a&#160;transaction request to&#160;the&#160;uncore.&#160;This&#160;is described<a href="o_fe12b1e2a880e0ce-669.html">&#160;in&#160;Table&#160;18-21</a>.</p>
<p style="position:absolute;top:934px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:935px;left:93px;white-space:nowrap" class="ft02">Bits&#160;30:16&#160;specifies common supplier information&#160;or&#160;an L2&#160;Hit, and&#160;is described<a href="o_fe12b1e2a880e0ce-663.html">&#160;in&#160;Table&#160;18-16</a>.&#160;</p>
<p style="position:absolute;top:957px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:958px;left:93px;white-space:nowrap" class="ft06">If L2&#160;misses,&#160;then Bits&#160;37:31&#160;can be used&#160;to&#160;specify&#160;snoop response&#160;information&#160;and is&#160;described in&#160;<br/><a href="o_fe12b1e2a880e0ce-669.html">Table&#160;18-22.</a>&#160;</p>
<p style="position:absolute;top:996px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:997px;left:93px;white-space:nowrap" class="ft06">For outstanding&#160;requests, bit 38 can&#160;enable&#160;measurement of average latency&#160;of&#160;specific type of offcore&#160;<br/>transaction&#160;requests&#160;using two programmable&#160;counter simultaneously; see<a href="o_fe12b1e2a880e0ce-664.html">&#160;Section 18.6.3&#160;</a>for&#160;details.&#160;</p>
</div>
</body>
</html>
