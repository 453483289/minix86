<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1123</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1123-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1123.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:769px;white-space:nowrap" class="ft00">Vol. 3C&#160;27-5</p>
<p style="position:absolute;top:47px;left:782px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:108px;left:95px;white-space:nowrap" class="ft02">—&#160;For&#160;a&#160;page-fault exception, the exit qualification&#160;contains the linear address&#160;that caused&#160;the page fault.&#160;On&#160;</p>
<p style="position:absolute;top:124px;left:120px;white-space:nowrap" class="ft06">processors that&#160;support&#160;Intel 64&#160;architecture,&#160;bits&#160;63:32&#160;are&#160;cleared&#160;if&#160;the logical processor was&#160;not in 64-<br/>bit mode&#160;before&#160;the&#160;VM&#160;exit.<br/>If the&#160;page-fault exception occurred during&#160;execution&#160;of&#160;an instruction in enclave mode (and&#160;not during&#160;<br/>delivery&#160;of an event incident to&#160;enclave&#160;mode),&#160;bits&#160;11:0 of the&#160;exit qualification&#160;are cleared.</p>
<p style="position:absolute;top:205px;left:95px;white-space:nowrap" class="ft02">—&#160;For a&#160;start-up&#160;IPI (SIPI),&#160;the exit qualification&#160;contains&#160;the SIPI vector information&#160;in bits&#160;7:0.&#160;Bits&#160;63:8 of&#160;</p>
<p style="position:absolute;top:222px;left:120px;white-space:nowrap" class="ft02">the&#160;exit qualification&#160;are cleared&#160;to&#160;0.</p>
<p style="position:absolute;top:246px;left:95px;white-space:nowrap" class="ft02">—&#160;For a&#160;task switch,&#160;the&#160;exit&#160;qualification contains&#160;details about the&#160;task&#160;switch, encoded&#160;as shown&#160;in&#160;</p>
<p style="position:absolute;top:262px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1123.html">Table&#160;27-2.</a></p>
<p style="position:absolute;top:286px;left:95px;white-space:nowrap" class="ft02">—&#160;For INVLPG,&#160;the exit&#160;qualification contains the&#160;linear-address&#160;operand of the&#160;instruction.</p>
<p style="position:absolute;top:312px;left:120px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:310px;left:146px;white-space:nowrap" class="ft06">On processors&#160;that support&#160;Intel 64&#160;architecture, bits&#160;63:32 are&#160;cleared if the&#160;logical&#160;processor was&#160;not&#160;<br/>in 64-bit&#160;mode before the&#160;VM&#160;exit.</p>
<p style="position:absolute;top:352px;left:120px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:351px;left:146px;white-space:nowrap" class="ft06">If the&#160;INVLPG&#160;source operand specifies&#160;an unusable&#160;segment, the&#160;linear address&#160;specified in&#160;the exit&#160;<br/>qualification will match&#160;the linear&#160;address that&#160;the INVLPG would have&#160;used if no&#160;VM&#160;exit&#160;occurred. This&#160;<br/>address is&#160;not architecturally&#160;defined and&#160;may&#160;be&#160;implementation-specific.</p>
<p style="position:absolute;top:673px;left:95px;white-space:nowrap" class="ft02">—&#160;For&#160;INVEPT,&#160;INVPCID,&#160;INVVPID,&#160;LGDT,&#160;LIDT,&#160;LLDT,&#160;LTR,&#160;SGDT,&#160;SIDT,&#160;SLDT,&#160;STR,&#160;VMCLEAR,&#160;VMPTRLD,&#160;</p>
<p style="position:absolute;top:690px;left:120px;white-space:nowrap" class="ft06">VMPTRST,&#160;VMREAD,&#160;VMWRITE,&#160;VMXON,&#160;XRSTORS,&#160;and&#160;XSAVES, the exit qualification&#160;receives&#160;the value of&#160;<br/>the&#160;instruction’s displacement&#160;field, which&#160;is sign-extended to&#160;64&#160;bits if&#160;necessary (32 bits on processors&#160;<br/>that do not support Intel&#160;64&#160;architecture). If the&#160;instruction has&#160;no displacement (for&#160;example,&#160;has a&#160;<br/>register operand), zero&#160;is stored into&#160;the exit&#160;qualification.</p>
<p style="position:absolute;top:763px;left:119px;white-space:nowrap" class="ft02">On processors&#160;that support Intel 64&#160;architecture, an&#160;exception&#160;is made&#160;for&#160;RIP-relative&#160;addressing&#160;(used&#160;</p>
<p style="position:absolute;top:780px;left:120px;white-space:nowrap" class="ft06">only&#160;in 64-bit&#160;mode). Such addressing&#160;causes&#160;an instruction&#160;to use an&#160;address that is&#160;the&#160;sum of the&#160;<br/>displacement field&#160;and&#160;the value of RIP&#160;that references&#160;the following&#160;instruction. In this&#160;case, the exit&#160;<br/>qualification is loaded&#160;with the sum of&#160;the displacement field and the appropriate RIP value.</p>
<p style="position:absolute;top:837px;left:119px;white-space:nowrap" class="ft02">In all&#160;cases, bits&#160;of this&#160;field beyond&#160;the instruction’s address&#160;size are undefined. For example,&#160;suppose&#160;</p>
<p style="position:absolute;top:853px;left:120px;white-space:nowrap" class="ft06">that the address-size field in the&#160;VM-exit instruction-information&#160;field&#160;(see&#160;<a href="o_fe12b1e2a880e0ce-1069.html">Section 24.9.4 and Se</a><a href="o_fe12b1e2a880e0ce-1130.html">ction&#160;<br/>27.2.4</a>)&#160;reports&#160;an&#160;<i>n</i>-bit address size. Then&#160;bits 63:<i>n</i>&#160;(bits&#160;31:<i>n&#160;</i>on&#160;processors that&#160;do not support Intel 64&#160;<br/>architecture) of&#160;the instruction displacement are undefined.</p>
<p style="position:absolute;top:910px;left:95px;white-space:nowrap" class="ft02">—&#160;For a&#160;control-register&#160;access, the&#160;exit qualification&#160;contains information&#160;about the&#160;access&#160;and has&#160;the&#160;</p>
<p style="position:absolute;top:927px;left:120px;white-space:nowrap" class="ft02">format given&#160;in<a href="o_fe12b1e2a880e0ce-1124.html">&#160;Table&#160;27-3.</a></p>
<p style="position:absolute;top:951px;left:95px;white-space:nowrap" class="ft02">—&#160;For MOV&#160;DR, the&#160;exit qualification&#160;contains&#160;information about the&#160;instruction&#160;and has&#160;the format given in&#160;</p>
<p style="position:absolute;top:967px;left:120px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1125.html">Table&#160;27-4.</a></p>
<p style="position:absolute;top:991px;left:95px;white-space:nowrap" class="ft02">—&#160;For an&#160;I/O instruction,&#160;the&#160;exit&#160;qualification contains&#160;information about&#160;the instruction&#160;and has the format&#160;</p>
<p style="position:absolute;top:1008px;left:120px;white-space:nowrap" class="ft02">give<a href="o_fe12b1e2a880e0ce-1126.html">n in&#160;Table&#160;27-5.</a></p>
<p style="position:absolute;top:415px;left:298px;white-space:nowrap" class="ft05">Table 27-2. &#160;Exit&#160;Qualification&#160;for&#160;Task Switch</p>
<p style="position:absolute;top:448px;left:80px;white-space:nowrap" class="ft02">Bit Position(s)</p>
<p style="position:absolute;top:448px;left:229px;white-space:nowrap" class="ft02">Contents</p>
<p style="position:absolute;top:477px;left:80px;white-space:nowrap" class="ft02">15:0</p>
<p style="position:absolute;top:477px;left:229px;white-space:nowrap" class="ft02">Selector&#160;of&#160;task-state&#160;segment (TSS) to&#160;which the guest attempted to&#160;switch</p>
<p style="position:absolute;top:505px;left:80px;white-space:nowrap" class="ft02">29:16</p>
<p style="position:absolute;top:505px;left:229px;white-space:nowrap" class="ft02">Reserved&#160;(cleared&#160;to 0)</p>
<p style="position:absolute;top:534px;left:80px;white-space:nowrap" class="ft02">31:30</p>
<p style="position:absolute;top:534px;left:229px;white-space:nowrap" class="ft02">Source of&#160;task switch initiation:</p>
<p style="position:absolute;top:555px;left:241px;white-space:nowrap" class="ft02">0: CALL instruction</p>
<p style="position:absolute;top:571px;left:241px;white-space:nowrap" class="ft02">1: IRET instruction</p>
<p style="position:absolute;top:588px;left:241px;white-space:nowrap" class="ft02">2: JMP instruction</p>
<p style="position:absolute;top:604px;left:241px;white-space:nowrap" class="ft02">3: Task gate in IDT</p>
<p style="position:absolute;top:633px;left:80px;white-space:nowrap" class="ft02">63:32</p>
<p style="position:absolute;top:633px;left:229px;white-space:nowrap" class="ft02">Reserved&#160;(cleared&#160;to 0).&#160;These bits&#160;exist only&#160;on&#160;processors that&#160;support Intel 64 architecture.</p>
</div>
</body>
</html>
