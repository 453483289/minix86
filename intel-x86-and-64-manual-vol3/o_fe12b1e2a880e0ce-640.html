<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 640</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:14px;font-family:Times;color:#0860a8;}
	.ft07{font-size:12px;font-family:Times;color:#0860a8;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page640-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce640.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">18-4&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft08"><b>Unit&#160;mask&#160;(UMASK)&#160;field&#160;(bits 8&#160;through 15)&#160;</b>—&#160;These&#160;bits&#160;qualify the&#160;condition that&#160;the&#160;selected&#160;event&#160;<br/>logic unit detects. Valid UMASK&#160;values&#160;for each&#160;event&#160;logic unit are specific to&#160;the unit.&#160;For&#160;each architectural&#160;<br/>performance&#160;event, its corresponding UMASK&#160;value&#160;defines&#160;a specific microarchitectural&#160;condition.&#160;<br/>A pre-defined&#160;microarchitectural&#160;condition associated with an architectural event may not be applicable to&#160;a&#160;<br/>given&#160;processor.&#160;The&#160;processor&#160;then&#160;reports only a&#160;subset&#160;of pre-defined&#160;architectural events.&#160;Pre-defined&#160;<br/>architectural events are<a href="o_fe12b1e2a880e0ce-640.html">&#160;listed in&#160;Table 18-1;&#160;</a>support&#160;for&#160;pre-defined architectural events&#160;is enumerated&#160;using&#160;<br/>CPUID.0AH:EBX.&#160;Architectural&#160;performance events&#160;available in&#160;the&#160;initial&#160;implementation are&#160;listed in&#160;<a href="o_fe12b1e2a880e0ce-758.html">Table&#160;<br/>19-1.</a></p>
<p style="position:absolute;top:244px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:244px;left:93px;white-space:nowrap" class="ft08"><b>USR (user mode) flag (bit 16)&#160;—&#160;</b>Specifies that&#160;the selected microarchitectural&#160;condition is&#160;counted when&#160;<br/>the logical processor is&#160;operating at&#160;privilege levels&#160;1,&#160;2&#160;or&#160;3.&#160;This&#160;flag&#160;can&#160;be&#160;used&#160;with&#160;the&#160;OS&#160;flag.</p>
<p style="position:absolute;top:283px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:283px;left:93px;white-space:nowrap" class="ft08"><b>OS&#160;(operating system&#160;mode) flag (bit 17)&#160;—&#160;</b>Specifies that the&#160;selected&#160;microarchitectural condition&#160;is&#160;<br/>counted&#160;when&#160;the logical processor is&#160;operating at&#160;privilege&#160;level 0. This flag&#160;can&#160;be used&#160;with&#160;the USR flag.</p>
<p style="position:absolute;top:322px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:322px;left:93px;white-space:nowrap" class="ft08"><b>E&#160;(edge detect) flag&#160;(bit 18) —&#160;</b>Enables&#160;(when&#160;set) edge detection&#160;of the&#160;selected&#160;microarchitectural&#160;<br/>condition. The&#160;logical&#160;processor&#160;counts&#160;the&#160;number&#160;of deasserted to&#160;asserted&#160;transitions for&#160;any condition that&#160;<br/>can be expressed&#160;by&#160;the&#160;other&#160;fields. The mechanism does&#160;not permit&#160;back-to-back assertions&#160;to be&#160;distin-<br/>guished.&#160;<br/>This mechanism allows software to measure not only the fraction of time spent&#160;in&#160;a particular state, but also&#160;the&#160;<br/>average&#160;length&#160;of&#160;time spent in&#160;such&#160;a state&#160;(for example, the&#160;time spent waiting&#160;for an&#160;interrupt to&#160;be&#160;<br/>serviced).</p>
<p style="position:absolute;top:449px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:450px;left:93px;white-space:nowrap" class="ft08"><b>PC (pin control) flag&#160;(bit 19)&#160;—&#160;</b>When set,&#160;the logical processor toggles&#160;the PM<i>i</i>&#160;pins and&#160;increments the&#160;<br/>counter when&#160;performance-monitoring events occur; when&#160;clear,&#160;the&#160;processor&#160;toggles&#160;the&#160;PM<i>i</i>&#160;pins when the&#160;<br/>counter&#160;overflows.&#160;The&#160;toggling of a&#160;pin&#160;is defined as&#160;assertion&#160;of&#160;the&#160;pin&#160;for&#160;a single bus clock followed&#160;by&#160;<br/>deassertion.</p>
<p style="position:absolute;top:521px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:522px;left:93px;white-space:nowrap" class="ft08"><b>INT (APIC&#160;interrupt enable) flag&#160;(bit 20)&#160;—&#160;</b>When set, the&#160;logical&#160;processor&#160;generates&#160;an exception&#160;<br/>through its&#160;local APIC on&#160;counter&#160;overflow.</p>
<p style="position:absolute;top:560px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:561px;left:93px;white-space:nowrap" class="ft08"><b>EN (Enable Counters)&#160;Flag (bit&#160;22) —&#160;</b>When set, performance&#160;counting is&#160;enabled&#160;in the&#160;corresponding&#160;<br/>performance-monitoring counter; when clear,&#160;the corresponding&#160;counter is disabled. The&#160;event logic unit for a&#160;<br/>UMASK must be disabled by setting IA32_PERFEVTSELx[bit&#160;22]&#160;=&#160;0,&#160;before&#160;writing&#160;to&#160;IA32_PMCx.</p>
<p style="position:absolute;top:616px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:616px;left:93px;white-space:nowrap" class="ft08"><b>INV (invert)&#160;flag (bit 23) —&#160;</b>When&#160;set, inverts the&#160;counter-mask (CMASK)&#160;comparison,&#160;so that both&#160;greater&#160;<br/>than&#160;or equal to&#160;and less than comparisons&#160;can&#160;be&#160;made&#160;(0: greater than or&#160;equal;&#160;1:&#160;less than). Note&#160;if&#160;<br/>counter-mask is&#160;programmed&#160;to zero, INV flag&#160;is ignored.</p>
<p style="position:absolute;top:671px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:672px;left:93px;white-space:nowrap" class="ft08"><b>Counter&#160;mask&#160;(CMASK)&#160;field&#160;(bits 24&#160;through&#160;31)&#160;—&#160;</b>When this&#160;field&#160;is not zero, a&#160;logical&#160;processor&#160;<br/>compares this mask to&#160;the events&#160;count&#160;of&#160;the detected&#160;microarchitectural condition&#160;during&#160;a single cycle.&#160;If&#160;<br/>the event count&#160;is&#160;greater than or equal to this mask, the counter is incremented by one. Otherwise the counter&#160;<br/>is not incremented.&#160;<br/>This mask is&#160;intended for software&#160;to characterize&#160;microarchitectural conditions&#160;that can count&#160;multiple&#160;<br/>occurrences per cycle&#160;(for&#160;example,&#160;two&#160;or more&#160;instructions&#160;retired per clock; or&#160;bus queue occupations). If&#160;<br/>the counter-mask&#160;field&#160;is 0, then&#160;the counter&#160;is incremented each&#160;cycle by the&#160;event&#160;count associated with&#160;<br/>multiple&#160;occurrences.</p>
<p style="position:absolute;top:838px;left:68px;white-space:nowrap" class="ft06">18.2.1.2 &#160;&#160;Pre-defined&#160;Architectural Performance Events</p>
<p style="position:absolute;top:866px;left:68px;white-space:nowrap" class="ft04"><a href="o_fe12b1e2a880e0ce-640.html">Table&#160;18-1&#160;</a>lists architecturally defined events.</p>
<p style="position:absolute;top:897px;left:125px;white-space:nowrap" class="ft07">Table 18-1. &#160;UMask&#160;and&#160;Event&#160;Select&#160;Encodings&#160;for&#160;Pre-Defined&#160;Architectural&#160;Performance Events</p>
<p style="position:absolute;top:921px;left:77px;white-space:nowrap" class="ft04">Bit Position&#160;</p>
<p style="position:absolute;top:936px;left:77px;white-space:nowrap" class="ft04">CPUID.AH.EBX</p>
<p style="position:absolute;top:921px;left:225px;white-space:nowrap" class="ft04">Event Name</p>
<p style="position:absolute;top:921px;left:491px;white-space:nowrap" class="ft04">UMask</p>
<p style="position:absolute;top:921px;left:667px;white-space:nowrap" class="ft04">Event&#160;Select</p>
<p style="position:absolute;top:960px;left:77px;white-space:nowrap" class="ft04">0</p>
<p style="position:absolute;top:960px;left:225px;white-space:nowrap" class="ft04">UnHalted&#160;Core&#160;Cycles</p>
<p style="position:absolute;top:960px;left:491px;white-space:nowrap" class="ft04">00H</p>
<p style="position:absolute;top:960px;left:667px;white-space:nowrap" class="ft04">3CH</p>
<p style="position:absolute;top:984px;left:77px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:984px;left:225px;white-space:nowrap" class="ft04">Instruction Retired</p>
<p style="position:absolute;top:984px;left:491px;white-space:nowrap" class="ft04">00H</p>
<p style="position:absolute;top:984px;left:667px;white-space:nowrap" class="ft04">C0H</p>
<p style="position:absolute;top:1008px;left:77px;white-space:nowrap" class="ft04">2</p>
<p style="position:absolute;top:1008px;left:225px;white-space:nowrap" class="ft04">UnHalted&#160;Reference&#160;Cycles</p>
<p style="position:absolute;top:1008px;left:491px;white-space:nowrap" class="ft04">01H</p>
<p style="position:absolute;top:1008px;left:667px;white-space:nowrap" class="ft04">3CH</p>
<p style="position:absolute;top:1032px;left:77px;white-space:nowrap" class="ft04">3</p>
<p style="position:absolute;top:1032px;left:225px;white-space:nowrap" class="ft04">LLC&#160;&#160;Reference</p>
<p style="position:absolute;top:1032px;left:491px;white-space:nowrap" class="ft04">4FH</p>
<p style="position:absolute;top:1032px;left:667px;white-space:nowrap" class="ft04">2EH</p>
<p style="position:absolute;top:1056px;left:77px;white-space:nowrap" class="ft04">4</p>
<p style="position:absolute;top:1056px;left:225px;white-space:nowrap" class="ft04">LLC&#160;Misses</p>
<p style="position:absolute;top:1056px;left:491px;white-space:nowrap" class="ft04">41H</p>
<p style="position:absolute;top:1056px;left:667px;white-space:nowrap" class="ft04">2EH</p>
</div>
</body>
</html>
