<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 182</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page182-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce182.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">5-30&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:97px;left:68px;white-space:nowrap" class="ft02">5.13&#160;</p>
<p style="position:absolute;top:97px;left:147px;white-space:nowrap" class="ft02">PAGE-LEVEL PROTECTION AND EXECUTE-DISABLE BIT</p>
<p style="position:absolute;top:133px;left:68px;white-space:nowrap" class="ft07">In addition&#160;to page-level protection&#160;offered by the U/S&#160;and R/W&#160;flags,&#160;paging&#160;structures&#160;used&#160;with PAE paging and&#160;<br/>IA-32e&#160;paging (see<a href="o_fe12b1e2a880e0ce-105.html">&#160;Chapter&#160;4) p</a>rovide&#160;the&#160;execute-disable&#160;bit.&#160;This&#160;bit offers additional protection for data&#160;pages.&#160;<br/>An Intel&#160;64&#160;or IA-32 processor with&#160;the&#160;execute-disable&#160;bit&#160;capability can&#160;prevent data&#160;pages from being used&#160;by&#160;<br/>malicious software&#160;to&#160;execute&#160;code.&#160;This capability is&#160;provided in:</p>
<p style="position:absolute;top:212px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:213px;left:93px;white-space:nowrap" class="ft03">32-bit protected&#160;mode with PAE&#160;enabled.</p>
<p style="position:absolute;top:235px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:235px;left:93px;white-space:nowrap" class="ft03">IA-32e&#160;mode.</p>
<p style="position:absolute;top:259px;left:68px;white-space:nowrap" class="ft07">While&#160;the&#160;execute-disable bit capability does&#160;not&#160;introduce&#160;new instructions,&#160;it does require operating&#160;systems to&#160;<br/>use a&#160;PAE-enabled environment&#160;and establish a&#160;page-granular&#160;protection policy for memory&#160;pages.&#160;<br/>If the execute-disable&#160;bit of a memory page&#160;is set, that page&#160;can be&#160;used only as data.&#160;An attempt&#160;to&#160;execute code&#160;<br/>from&#160;a memory page&#160;with the&#160;execute-disable&#160;bit&#160;set&#160;causes a&#160;page-fault&#160;exception.&#160;<br/>The execute-disable&#160;capability&#160;is supported&#160;only with PAE paging&#160;and IA-32e&#160;paging. It is&#160;not supported with&#160;32-bit&#160;<br/>paging.&#160;Existing&#160;page-level&#160;protection mechanisms (see<a href="o_fe12b1e2a880e0ce-179.html">&#160;Section 5.11,&#160;“Page-Level Protection”) continue to&#160;</a>apply&#160;<br/>to memory pages&#160;independent of the execute-disable setting.</p>
<p style="position:absolute;top:424px;left:68px;white-space:nowrap" class="ft05">5.13.1&#160;</p>
<p style="position:absolute;top:424px;left:148px;white-space:nowrap" class="ft05">Detecting and Enabling&#160;the Execute-Disable Capability</p>
<p style="position:absolute;top:454px;left:68px;white-space:nowrap" class="ft07">Software can&#160;detect the&#160;presence of&#160;the&#160;execute-disable&#160;capability using&#160;the CPUID&#160;instruction.&#160;<br/>CPUID.80000001H:EDX.NX&#160;[bit&#160;20]&#160;=&#160;1 indicates the&#160;capability is&#160;available.<br/>If the&#160;capability is&#160;available, software&#160;can enable&#160;it by&#160;setting IA32_EFER.NXE[bit&#160;11]&#160;to 1.&#160;IA32_EFER is&#160;available&#160;<br/>if CPUID.80000001H.EDX[bit 20&#160;or&#160;29]&#160;= 1.&#160;<br/>If&#160;the execute-disable capability&#160;is not available,&#160;a write&#160;to set IA32_EFER.NXE produces&#160;a #GP exception. See&#160;<br/><a href="o_fe12b1e2a880e0ce-182.html">Table 5-4.</a></p>
<p style="position:absolute;top:691px;left:68px;white-space:nowrap" class="ft05">5.13.2&#160;</p>
<p style="position:absolute;top:691px;left:148px;white-space:nowrap" class="ft05">Execute-Disable Page Protection</p>
<p style="position:absolute;top:721px;left:68px;white-space:nowrap" class="ft07">The&#160;execute-disable&#160;bit&#160;in the&#160;paging&#160;structures enhances&#160;page&#160;protection for data pages.&#160;Instructions cannot be&#160;<br/>fetched from a&#160;memory page if IA32_EFER.NXE =1&#160;and&#160;the&#160;execute-disable bit is set in any&#160;of the paging-structure&#160;<br/>entries used to&#160;map the&#160;page.&#160;<a href="o_fe12b1e2a880e0ce-183.html">Table 5-5 lists th</a>e&#160;valid usage&#160;of a&#160;page in relation&#160;to the&#160;value of execute-disable&#160;bit&#160;<br/>(bit 63) of the&#160;corresponding entry in&#160;each&#160;level&#160;of&#160;the&#160;paging&#160;structures.&#160;Execute-disable protection can be&#160;acti-<br/>vated using&#160;the execute-disable bit&#160;at&#160;any&#160;level of the&#160;paging structure, irrespective&#160;of&#160;the&#160;corresponding entry&#160;in&#160;<br/>other levels.&#160;When&#160;execute-disable&#160;protection&#160;is not&#160;activated,&#160;the&#160;page&#160;can be&#160;used&#160;as&#160;code&#160;or data.</p>
<p style="position:absolute;top:583px;left:270px;white-space:nowrap" class="ft06">Table 5-4. &#160;Extended&#160;Feature&#160;Enable MSR (IA32_EFER)</p>
<p style="position:absolute;top:606px;left:75px;white-space:nowrap" class="ft03">63:12</p>
<p style="position:absolute;top:606px;left:168px;white-space:nowrap" class="ft03">11</p>
<p style="position:absolute;top:606px;left:298px;white-space:nowrap" class="ft03">10</p>
<p style="position:absolute;top:606px;left:417px;white-space:nowrap" class="ft03">9</p>
<p style="position:absolute;top:606px;left:506px;white-space:nowrap" class="ft03">8</p>
<p style="position:absolute;top:606px;left:630px;white-space:nowrap" class="ft03">7:1</p>
<p style="position:absolute;top:606px;left:716px;white-space:nowrap" class="ft03">0</p>
<p style="position:absolute;top:630px;left:75px;white-space:nowrap" class="ft03">Reserved</p>
<p style="position:absolute;top:630px;left:168px;white-space:nowrap" class="ft03">Execute-disable bit&#160;</p>
<p style="position:absolute;top:646px;left:168px;white-space:nowrap" class="ft03">enable (NXE)</p>
<p style="position:absolute;top:630px;left:298px;white-space:nowrap" class="ft03">IA-32e&#160;mode&#160;</p>
<p style="position:absolute;top:646px;left:298px;white-space:nowrap" class="ft03">active&#160;(LMA)</p>
<p style="position:absolute;top:630px;left:417px;white-space:nowrap" class="ft03">Reserved</p>
<p style="position:absolute;top:630px;left:506px;white-space:nowrap" class="ft03">IA-32e&#160;mode&#160;</p>
<p style="position:absolute;top:646px;left:506px;white-space:nowrap" class="ft03">enable (LME)</p>
<p style="position:absolute;top:630px;left:630px;white-space:nowrap" class="ft03">Reserved</p>
<p style="position:absolute;top:630px;left:717px;white-space:nowrap" class="ft03">SysCall enable (SCE)</p>
</div>
</body>
</html>
