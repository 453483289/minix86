<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1925</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1925-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1925.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3D&#160;42-7</p>
<p style="position:absolute;top:47px;left:438px;white-space:nowrap" class="ft01">INTEL® SGX INTERACTIONS WITH IA32&#160;AND INTEL® 64&#160;ARCHITECTURE</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft06">SIGSTRUCT includes&#160;the&#160;following fields:<br/>SIGSTRUCT.ATTRIBUTES, SIGSTRUCT.ATTRIBUTEMASK, SIGSTRUCT.MISCSELECT, SIGSTRUCT.MISCMASK.</p>
<p style="position:absolute;top:167px;left:69px;white-space:nowrap" class="ft03">42.7.2.6 &#160;&#160;REPORT.ATTRIBUTES.XFRM and REPORT.MISCSELECT</p>
<p style="position:absolute;top:194px;left:69px;white-space:nowrap" class="ft07">The processor extended states and miscellaneous states that&#160;are enabled&#160;inside&#160;the enclave form an integral part&#160;<br/>of the&#160;enclave's identity and&#160;are&#160;therefore included&#160;in&#160;the enclave's&#160;report, as&#160;provided by the&#160;ENCLU[EREPORT]&#160;<br/>leaf function.&#160;The REPORT&#160;structure includes the&#160;enclave's XFRM&#160;and MISCSELECT configurations.</p>
<p style="position:absolute;top:271px;left:69px;white-space:nowrap" class="ft03">42.7.2.7 &#160;&#160;KEYREQUEST</p>
<p style="position:absolute;top:298px;left:69px;white-space:nowrap" class="ft07">An enclave developer can&#160;specify&#160;which bits out of XFRM&#160;and MISCSELECT&#160;ENCLU[EGETKEY] should&#160;include in&#160;the&#160;<br/>derivation of the&#160;sealing key&#160;by&#160;specifying&#160;ATTRIBUTESMASK&#160;and MISCMASK in&#160;the KEYREQUEST structure.</p>
<p style="position:absolute;top:365px;left:69px;white-space:nowrap" class="ft04">42.7.3&#160;</p>
<p style="position:absolute;top:365px;left:149px;white-space:nowrap" class="ft04">Processor Extended States and ENCLS[ECREATE]</p>
<p style="position:absolute;top:394px;left:69px;white-space:nowrap" class="ft07">The ECREATE leaf function of the ENCLS instruction enforces a number of consistency checks described&#160;earlier.&#160;The&#160;<br/>execution of ENCLS[ECREATE]&#160;leaf function&#160;results&#160;in&#160;a #GP(0)&#160;in any&#160;of the&#160;following cases:</p>
<p style="position:absolute;top:433px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:433px;left:95px;white-space:nowrap" class="ft02">SECS.ATTRIBUTES.XFRM[1:0]&#160;is not 3.&#160;</p>
<p style="position:absolute;top:455px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:456px;left:95px;white-space:nowrap" class="ft09">The processor&#160;does&#160;not support XSAVE and any of&#160;the following is&#160;true:&#160;<br/>—&#160;SECS.ATTRIBUTES.XFRM[63:2]&#160;is not 0.<br/>—&#160;SECS.SSAFRAMESIZE&#160;&#160;is&#160;&#160;0.</p>
<p style="position:absolute;top:526px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:526px;left:95px;white-space:nowrap" class="ft09">The&#160;processor supports XSAVE&#160;and any&#160;of&#160;the following is&#160;true:<br/>—&#160;XSETBV would fault on&#160;an&#160;attempt to load&#160;XFRM&#160;into&#160;XCR0.&#160;<br/>—&#160;XFRM[63]=1.&#160;<br/>—&#160;The SSAFRAME&#160;is too&#160;small&#160;to hold&#160;required,&#160;enabled states&#160;(see&#160;<a href="o_fe12b1e2a880e0ce-1924.html">Section 42.7.2.2).</a></p>
<p style="position:absolute;top:649px;left:69px;white-space:nowrap" class="ft04">42.7.4&#160;</p>
<p style="position:absolute;top:649px;left:149px;white-space:nowrap" class="ft04">Processor Extended States and ENCLU[EENTER]</p>
<p style="position:absolute;top:700px;left:69px;white-space:nowrap" class="ft03">42.7.4.1 &#160;&#160;Fault Checking</p>
<p style="position:absolute;top:727px;left:69px;white-space:nowrap" class="ft07">The EENTER leaf&#160;function&#160;of the&#160;ENCLU&#160;instruction&#160;enforces a&#160;number of&#160;consistency&#160;requirements&#160;described&#160;<br/>earlier.&#160;The&#160;execution of&#160;the&#160;ENCLU[EENTER]&#160;leaf function results&#160;in a&#160;#GP(0) in&#160;any of the&#160;following&#160;cases:</p>
<p style="position:absolute;top:765px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:766px;left:95px;white-space:nowrap" class="ft02">If CR4.OSFXSR=0.&#160;</p>
<p style="position:absolute;top:787px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:788px;left:95px;white-space:nowrap" class="ft08">If The processor supports XSAVE and either&#160;of the&#160;following is&#160;true:<br/>—&#160;CR4.OSXSAVE=0&#160;and&#160;SECS.ATTRIBUTES.XFRM&#160;is not&#160;3.&#160;<br/>—&#160;(SECS.ATTRIBUTES.XFRM &amp;&#160;XCR0)&#160;!= SECS.ATTRIBUTES.XFRM</p>
<p style="position:absolute;top:880px;left:69px;white-space:nowrap" class="ft03">42.7.4.2 &#160;&#160;State Loading</p>
<p style="position:absolute;top:907px;left:69px;white-space:nowrap" class="ft07">If ENCLU[EENTER] is&#160;successful,&#160;the current&#160;value&#160;of XCR0 is&#160;saved internally&#160;by&#160;the&#160;processor and&#160;replaced&#160;by&#160;<br/>SECS.ATTRIBUTES.XFRM.</p>
</div>
</body>
</html>
