<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 211</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page211-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a211.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:775px;white-space:nowrap" class="ft00">Vol. 1&#160;8-21</p>
<p style="position:absolute;top:47px;left:634px;white-space:nowrap" class="ft01">PROGRAMMING&#160;WITH&#160;THE X87&#160;FPU</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft06">first be moved to&#160;the AX&#160;register in&#160;the integer unit.&#160;The&#160;FSTSW&#160;AX (store status word) instruction can&#160;be&#160;used&#160;for&#160;<br/>this purpose.&#160;When these flags&#160;are&#160;in&#160;the AX&#160;register,&#160;the TEST instruction can&#160;be&#160;used&#160;to control conditional&#160;<br/>branching as&#160;follows:<br/>1.&#160;Check for an unordered&#160;result.&#160;Use&#160;the&#160;TEST&#160;instruction&#160;to compare the&#160;contents&#160;of the&#160;AX register&#160;with the&#160;</p>
<p style="position:absolute;top:174px;left:95px;white-space:nowrap" class="ft05">constant 0400H (see<a href="o_7281d5ea06a5b67a-211.html">&#160;Table&#160;8-8</a>).&#160;This operation will clear the ZF flag&#160;in the&#160;EFLAGS register&#160;if&#160;the condition&#160;code&#160;<br/>flags indicate an&#160;unordered&#160;result; otherwise, the&#160;ZF flag&#160;will be set.&#160;The JNZ&#160;instruction&#160;can then&#160;be&#160;used&#160;to&#160;<br/>transfer control (if&#160;necessary) to&#160;a procedure&#160;for&#160;handling unordered&#160;operands.</p>
<p style="position:absolute;top:397px;left:69px;white-space:nowrap" class="ft02">2.&#160;Check&#160;ordered comparison result. Use the constants given in&#160;<a href="o_7281d5ea06a5b67a-211.html">Table 8-8 in&#160;</a>the&#160;TEST instruction&#160;to test for&#160;a less&#160;</p>
<p style="position:absolute;top:414px;left:95px;white-space:nowrap" class="ft05">than,&#160;equal&#160;to, or&#160;greater than result, then&#160;use the&#160;corresponding&#160;conditional&#160;branch instruction to&#160;transfer&#160;<br/>program control to&#160;the appropriate procedure or&#160;section of code.</p>
<p style="position:absolute;top:454px;left:69px;white-space:nowrap" class="ft05">If a program or procedure&#160;has&#160;been thoroughly&#160;tested and it&#160;incorporates periodic&#160;checks&#160;for&#160;QNaN results, then&#160;it&#160;<br/>is&#160;not necessary&#160;to check for&#160;the unordered result&#160;every&#160;time a&#160;comparison is&#160;made.<br/><a href="o_7281d5ea06a5b67a-196.html">See Section 8.1.4, “Branching&#160;and&#160;Conditional Moves&#160;on&#160;Condition&#160;Codes,” for</a>&#160;another technique for&#160;branching on&#160;<br/>x87 FPU condition codes.<br/>Some non-comparison&#160;x87 FPU instructions update the condition code flags in the x87 FPU status word. To&#160;ensure&#160;<br/>that the&#160;status word is&#160;not altered inadvertently,&#160;store&#160;it immediately following&#160;a comparison&#160;operation.</p>
<p style="position:absolute;top:602px;left:69px;white-space:nowrap" class="ft03">8.3.7 Trigonometric&#160;</p>
<p style="position:absolute;top:602px;left:266px;white-space:nowrap" class="ft03">Instructions</p>
<p style="position:absolute;top:633px;left:69px;white-space:nowrap" class="ft02">The following&#160;instructions perform four&#160;common&#160;trigonometric&#160;functions:</p>
<p style="position:absolute;top:670px;left:69px;white-space:nowrap" class="ft02">FSIN</p>
<p style="position:absolute;top:670px;left:207px;white-space:nowrap" class="ft02">Sine</p>
<p style="position:absolute;top:691px;left:69px;white-space:nowrap" class="ft02">FCOS</p>
<p style="position:absolute;top:691px;left:207px;white-space:nowrap" class="ft02">Cosine</p>
<p style="position:absolute;top:712px;left:69px;white-space:nowrap" class="ft02">FSINCOS</p>
<p style="position:absolute;top:712px;left:207px;white-space:nowrap" class="ft02">Sine&#160;and&#160;cosine</p>
<p style="position:absolute;top:733px;left:69px;white-space:nowrap" class="ft02">FPTAN</p>
<p style="position:absolute;top:733px;left:207px;white-space:nowrap" class="ft02">Tangent</p>
<p style="position:absolute;top:754px;left:69px;white-space:nowrap" class="ft02">FPATAN</p>
<p style="position:absolute;top:754px;left:207px;white-space:nowrap" class="ft02">Arctangent</p>
<p style="position:absolute;top:778px;left:69px;white-space:nowrap" class="ft05">These instructions&#160;operate on the&#160;top&#160;one or two registers&#160;of&#160;the x87 FPU&#160;register stack and&#160;they&#160;return&#160;their&#160;<br/>results to&#160;the stack. The&#160;source&#160;operands for the&#160;FSIN,&#160;FCOS, FSINCOS,&#160;and FPTAN instructions must be given&#160;in&#160;<br/>radians; the&#160;source operand&#160;for&#160;the&#160;FPATAN instruction&#160;is&#160;given in&#160;rectangular coordinate units.<br/>The FSINCOS instruction returns&#160;both the&#160;sine and&#160;the&#160;cosine of a&#160;source operand&#160;value.&#160;It operates&#160;faster than&#160;<br/>executing&#160;the FSIN and FCOS&#160;instructions&#160;in succession.<br/>The FPATAN instruction computes&#160;the arctangent of&#160;ST(1)&#160;divided by ST(0), returning&#160;a result&#160;in radians.&#160;It is&#160;<br/>useful&#160;for converting&#160;rectangular coordinates to&#160;polar coordinates.<br/>Se<a href="o_7281d5ea06a5b67a-211.html">e Section 8.3.8,&#160;“Approximation&#160;of Pi”&#160;</a>and<a href="o_7281d5ea06a5b67a-212.html">&#160;Section 8.3.10, “Transcendental&#160;Instruction Accuracy”&#160;</a>for&#160;information&#160;<br/>regarding the&#160;accuracy of these instructions.&#160;</p>
<p style="position:absolute;top:983px;left:69px;white-space:nowrap" class="ft03">8.3.8&#160;</p>
<p style="position:absolute;top:983px;left:149px;white-space:nowrap" class="ft03">Approximation of&#160;Pi</p>
<p style="position:absolute;top:1014px;left:69px;white-space:nowrap" class="ft05">When the&#160;argument (source&#160;operand) of a&#160;trigonometric function is&#160;within the domain of the function, the&#160;argu-<br/>ment is&#160;automatically&#160;reduced by the&#160;appropriate multiple&#160;of 2π&#160;through the same&#160;reduction mechanism used by&#160;</p>
<p style="position:absolute;top:1047px;left:69px;white-space:nowrap" class="ft02">the FPREM and FPREM1&#160;instructions.&#160;The&#160;internal value of&#160;π&#160;(3.1415926…) that&#160;the x87 FPU&#160;uses for argument&#160;</p>
<p style="position:absolute;top:237px;left:238px;white-space:nowrap" class="ft04">Table 8-8.&#160;&#160;TEST&#160;Instruction Constants for&#160;Conditional&#160;Branching</p>
<p style="position:absolute;top:259px;left:243px;white-space:nowrap" class="ft02">Order</p>
<p style="position:absolute;top:259px;left:526px;white-space:nowrap" class="ft02">Constant</p>
<p style="position:absolute;top:259px;left:725px;white-space:nowrap" class="ft02">Branch</p>
<p style="position:absolute;top:281px;left:74px;white-space:nowrap" class="ft02">ST(0)&#160;&gt;&#160;Source Operand</p>
<p style="position:absolute;top:281px;left:533px;white-space:nowrap" class="ft02">4500H</p>
<p style="position:absolute;top:281px;left:741px;white-space:nowrap" class="ft02">JZ</p>
<p style="position:absolute;top:304px;left:74px;white-space:nowrap" class="ft02">ST(0)&#160;&lt;&#160;Source Operand</p>
<p style="position:absolute;top:304px;left:533px;white-space:nowrap" class="ft02">0100H</p>
<p style="position:absolute;top:304px;left:736px;white-space:nowrap" class="ft02">JNZ</p>
<p style="position:absolute;top:326px;left:74px;white-space:nowrap" class="ft02">ST(0)&#160;=&#160;Source Operand</p>
<p style="position:absolute;top:326px;left:533px;white-space:nowrap" class="ft02">4000H</p>
<p style="position:absolute;top:326px;left:736px;white-space:nowrap" class="ft02">JNZ</p>
<p style="position:absolute;top:349px;left:74px;white-space:nowrap" class="ft02">Unordered</p>
<p style="position:absolute;top:349px;left:533px;white-space:nowrap" class="ft02">0400H</p>
<p style="position:absolute;top:349px;left:736px;white-space:nowrap" class="ft02">JNZ</p>
</div>
</body>
</html>
