<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 395</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:8px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:18px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;font-family:Times;color:#0860a8;}
	.ft08{font-size:6px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page395-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a395.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:775px;white-space:nowrap" class="ft00">Vol. 1&#160;17-7</p>
<p style="position:absolute;top:47px;left:590px;white-space:nowrap" class="ft01">INTEL®&#160;MEMORY PROTECTION EXTENSIONS</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft02">—&#160;The size&#160;of the&#160;bound directory&#160;depends on the&#160;value&#160;of MAWA. Specifically,&#160;the bound&#160;directory comprises&#160;</p>
<p style="position:absolute;top:117px;left:120px;white-space:nowrap" class="ft02">of 2</p>
<p style="position:absolute;top:114px;left:145px;white-space:nowrap" class="ft03">28+MAWA</p>
<p style="position:absolute;top:117px;left:202px;white-space:nowrap" class="ft02">&#160;64-bit entries; thus,&#160;the size&#160;of a&#160;bound directory&#160;in 64-bit&#160;mode is&#160;2</p>
<p style="position:absolute;top:114px;left:658px;white-space:nowrap" class="ft03">1+MAWA</p>
<p style="position:absolute;top:117px;left:713px;white-space:nowrap" class="ft02">GBytes.&#160;The&#160;value&#160;</p>
<p style="position:absolute;top:133px;left:120px;white-space:nowrap" class="ft02">of&#160;MAWA&#160;depends on CPL:</p>
<p style="position:absolute;top:159px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:157px;left:146px;white-space:nowrap" class="ft02">If&#160;CPL &lt; 3,&#160;the supervisor&#160;MAWA&#160;(MAWAS)&#160;is used.&#160;This value&#160;is 0. Thus, when CPL&#160;&lt;&#160;3,&#160;a bound&#160;</p>
<p style="position:absolute;top:174px;left:145px;white-space:nowrap" class="ft02">directory comprises of&#160;2</p>
<p style="position:absolute;top:171px;left:308px;white-space:nowrap" class="ft03">28&#160;</p>
<p style="position:absolute;top:174px;left:325px;white-space:nowrap" class="ft02">64-bit entries and&#160;the size&#160;of&#160;a bound directory&#160;is 2&#160;GBytes.</p>
<p style="position:absolute;top:199px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:198px;left:146px;white-space:nowrap" class="ft02">If CPL&#160;=&#160;3,&#160;the&#160;user MAWA&#160;(MAWAU) is&#160;used.&#160;The&#160;value of&#160;MAWAU is&#160;enumerated&#160;in&#160;</p>
<p style="position:absolute;top:214px;left:145px;white-space:nowrap" class="ft09">CPUID.(EAX=07H,ECX=0H):ECX.MAWAU[bits 21:17].&#160;When&#160;CPL&#160;=&#160;3,&#160;a&#160;bound directory comprises&#160;of&#160;<br/>2</p>
<p style="position:absolute;top:228px;left:153px;white-space:nowrap" class="ft03">28+MAWAU&#160;</p>
<p style="position:absolute;top:231px;left:221px;white-space:nowrap" class="ft02">64-bit entries and&#160;the size&#160;of&#160;a bound directory&#160;is 2</p>
<p style="position:absolute;top:228px;left:566px;white-space:nowrap" class="ft03">1+MAWAU</p>
<p style="position:absolute;top:231px;left:628px;white-space:nowrap" class="ft02">GBytes.</p>
<p style="position:absolute;top:265px;left:433px;white-space:nowrap" class="ft05">NOTE</p>
<p style="position:absolute;top:291px;left:122px;white-space:nowrap" class="ft09">Software&#160;operating&#160;with&#160;CPL&#160;=&#160;3&#160;in 64-bit mode should use CPUID to determine the proper amount&#160;<br/>of memory to allocate for the bound&#160;directory.</p>
<p style="position:absolute;top:329px;left:69px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:330px;left:95px;white-space:nowrap" class="ft010">Outside&#160;64-bit mode:<br/>—&#160;Each bound table&#160;comprises of 2</p>
<p style="position:absolute;top:351px;left:339px;white-space:nowrap" class="ft03">10</p>
<p style="position:absolute;top:354px;left:353px;white-space:nowrap" class="ft02">&#160;16-byte entries; thus,&#160;the&#160;size&#160;of a&#160;bound table&#160;outside 64-bit&#160;mode&#160;is&#160;</p>
<p style="position:absolute;top:370px;left:120px;white-space:nowrap" class="ft02">16&#160;KBytes.</p>
<p style="position:absolute;top:394px;left:95px;white-space:nowrap" class="ft02">—&#160;The&#160;bound&#160;directory comprises of&#160;2</p>
<p style="position:absolute;top:392px;left:358px;white-space:nowrap" class="ft03">20</p>
<p style="position:absolute;top:394px;left:372px;white-space:nowrap" class="ft02">&#160;32-bit entries; thus,&#160;the size&#160;of a bound&#160;directory&#160;outside&#160;64-bit&#160;</p>
<p style="position:absolute;top:411px;left:120px;white-space:nowrap" class="ft02">mode&#160;is&#160;4&#160;MBytes.&#160;This size&#160;is&#160;independent of MAWA&#160;and&#160;CPL.</p>
<p style="position:absolute;top:433px;left:69px;white-space:nowrap" class="ft09">Bounds in memory&#160;are&#160;associated with&#160;the memory&#160;address where the pointer is stored, i.e.,&#160;Ap. A&#160;linear&#160;address&#160;<br/>LAp is&#160;computed&#160;by adding the&#160;appropriate&#160;segment&#160;base&#160;to Ap. (Note: for these instructions,&#160;the segment over-<br/>ride&#160;applies only to&#160;<a href="o_7281d5ea06a5b67a-395.html">the computation.) Section 17.4.3.1&#160;and</a><a href="o_7281d5ea06a5b67a-396.html">&#160;Section 17.4.3.2</a>&#160;describe how&#160;BNDLDX&#160;and&#160;BNDSTX&#160;<br/>parse LAp to&#160;locate&#160;a bound-directory&#160;entry (BDE), which&#160;contains the address&#160;of a&#160;bound&#160;table, and then&#160;a bound-<br/>table&#160;entry (BTE),&#160;which contains the extended bounds for the&#160;pointer.&#160;</p>
<p style="position:absolute;top:544px;left:69px;white-space:nowrap" class="ft05">17.4.3.1&#160;&#160;&#160;BNDLDX&#160;and&#160;BNDSTX in&#160;64-Bit Mode</p>
<p style="position:absolute;top:572px;left:69px;white-space:nowrap" class="ft02"><a href="o_7281d5ea06a5b67a-395.html">Figure&#160;17-4 shows the&#160;</a>two-level&#160;structures&#160;for address&#160;translation of extended&#160;bounds in&#160;64-bit mode.</p>
<p style="position:absolute;top:1044px;left:194px;white-space:nowrap" class="ft07">Figure&#160;17-4.&#160;&#160;Bound Paging&#160;Structure and&#160;Address&#160;Translation&#160;in&#160;64-Bit Mode</p>
<p style="position:absolute;top:661px;left:450px;white-space:nowrap" class="ft00">12&#160;11</p>
<p style="position:absolute;top:662px;left:226px;white-space:nowrap" class="ft00">63</p>
<p style="position:absolute;top:645px;left:386px;white-space:nowrap" class="ft00">BNDCFGU/BNDCFGS</p>
<p style="position:absolute;top:662px;left:700px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:753px;left:443px;white-space:nowrap" class="ft00">20&#160;19</p>
<p style="position:absolute;top:754px;left:219px;white-space:nowrap" class="ft00">63</p>
<p style="position:absolute;top:754px;left:637px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:881px;left:697px;white-space:nowrap" class="ft00">Lower&#160;Bound</p>
<p style="position:absolute;top:865px;left:696px;white-space:nowrap" class="ft00">Upper Bound</p>
<p style="position:absolute;top:849px;left:697px;white-space:nowrap" class="ft00">Pointer Value</p>
<p style="position:absolute;top:833px;left:696px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:740px;left:392px;white-space:nowrap" class="ft00">Linear Address of&#160;“pointer” (LAp)</p>
<p style="position:absolute;top:753px;left:601px;white-space:nowrap" class="ft00">3</p>
<p style="position:absolute;top:797px;left:654px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:797px;left:601px;white-space:nowrap" class="ft00">5</p>
<p style="position:absolute;top:816px;left:631px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:798px;left:458px;white-space:nowrap" class="ft00">21</p>
<p style="position:absolute;top:815px;left:485px;white-space:nowrap" class="ft00">LAp[19:3]</p>
<p style="position:absolute;top:862px;left:506px;white-space:nowrap" class="ft00">22</p>
<p style="position:absolute;top:799px;left:403px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:799px;left:359px;white-space:nowrap" class="ft00">3</p>
<p style="position:absolute;top:817px;left:380px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:799px;left:207px;white-space:nowrap" class="ft00">30+MAWA</p>
<p style="position:absolute;top:817px;left:234px;white-space:nowrap" class="ft00">LAp[47+MAWA:20]</p>
<p style="position:absolute;top:887px;left:185px;white-space:nowrap" class="ft00">31+MAWA</p>
<p style="position:absolute;top:903px;left:538px;white-space:nowrap" class="ft00">Bound Table Entries</p>
<p style="position:absolute;top:980px;left:538px;white-space:nowrap" class="ft00">Bound Table (4&#160;MBytes)</p>
<p style="position:absolute;top:945px;left:261px;white-space:nowrap" class="ft00">Bound Directory&#160;Entries</p>
<p style="position:absolute;top:754px;left:277px;white-space:nowrap" class="ft00">47+MAWA</p>
<p style="position:absolute;top:1002px;left:269px;white-space:nowrap" class="ft00">Bound Directory (2</p>
<p style="position:absolute;top:999px;left:355px;white-space:nowrap" class="ft08">1+MAWA</p>
<p style="position:absolute;top:1002px;left:393px;white-space:nowrap" class="ft00">GBytes)</p>
<p style="position:absolute;top:710px;left:304px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:710px;left:261px;white-space:nowrap" class="ft00">12</p>
<p style="position:absolute;top:729px;left:282px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:710px;left:109px;white-space:nowrap" class="ft00">63</p>
<p style="position:absolute;top:728px;left:136px;white-space:nowrap" class="ft00">BNDCFGx[63:12]</p>
<p style="position:absolute;top:888px;left:770px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:870px;left:770px;white-space:nowrap" class="ft00">8</p>
<p style="position:absolute;top:852px;left:770px;white-space:nowrap" class="ft00">16</p>
<p style="position:absolute;top:833px;left:770px;white-space:nowrap" class="ft00">24</p>
<p style="position:absolute;top:964px;left:648px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:990px;left:391px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:679px;left:235px;white-space:nowrap" class="ft00">Base of&#160;Bound Directory (Linear Address)</p>
<p style="position:absolute;top:866px;left:170px;white-space:nowrap" class="ft00">64</p>
<p style="position:absolute;top:954px;left:431px;white-space:nowrap" class="ft00">61</p>
</div>
</body>
</html>
