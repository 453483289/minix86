<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 398</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page398-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a398.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">17-10&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INTEL® MEMORY&#160;PROTECTION&#160;EXTENSIONS</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft06">In compatibility and&#160;legacy&#160;modes (including&#160;16-bit&#160;code&#160;segments,&#160;real and virtual 8086&#160;modes) all Intel&#160;MPX&#160;<br/>instructions&#160;use 32-bit&#160;operands for bounds&#160;and 32&#160;bit&#160;addressing. The&#160;upper&#160;32-bits of destination bound&#160;register&#160;<br/>are cleared&#160;(consistent with&#160;behavior of integer&#160;registers)<br/>In 32-bit&#160;and compatibility mode, the&#160;bounds&#160;are 32-bit, and&#160;are treated&#160;same as&#160;32-bit integer registers. There-<br/>fore, when 32-bit bound is updated in a bound register,&#160;the upper 32-bits are undefined. When switching from 64-<br/>bit, the&#160;behavior of content&#160;of&#160;bounds register&#160;will&#160;be&#160;similar to&#160;that of general&#160;purpose&#160;registers.<br/><a href="o_7281d5ea06a5b67a-398.html">Table&#160;17-3&#160;de</a>scribes&#160;the impact of 67H&#160;prefix on memory&#160;forms&#160;of Intel&#160;MPX instructions&#160;(register-only&#160;forms&#160;<br/>ignore 67H&#160;prefix) when Intel&#160;MPX is&#160;enabled:</p>
<p style="position:absolute;top:488px;left:68px;white-space:nowrap" class="ft03">17.5.2&#160;</p>
<p style="position:absolute;top:488px;left:148px;white-space:nowrap" class="ft03">Intel MPX Support for Pointer Operations with Branching</p>
<p style="position:absolute;top:517px;left:68px;white-space:nowrap" class="ft02">Intel&#160;MPX provides&#160;flexibility&#160;in supporting pointer operation&#160;across control flow changes. Intel MPX&#160;allows&#160;</p>
<p style="position:absolute;top:539px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:540px;left:93px;white-space:nowrap" class="ft06">compatibility with legacy code&#160;that may perform pointer operation across control flow changes and are unaware&#160;<br/>of Intel&#160;MPX, along&#160;with</p>
<p style="position:absolute;top:578px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:579px;left:93px;white-space:nowrap" class="ft02">Intel MPX-aware code that&#160;adds&#160;bounds&#160;checking protection&#160;to pointer operation across&#160;control&#160;flow&#160;changes.</p>
<p style="position:absolute;top:601px;left:68px;white-space:nowrap" class="ft02">The interface&#160;to provide such flexibility consists of:</p>
<p style="position:absolute;top:623px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:624px;left:93px;white-space:nowrap" class="ft02">Using&#160;a prefix, referred to&#160;as BND&#160;prefix,&#160;to relevant&#160;branch instructions: CALL, RET,&#160;JMP and&#160;Jcc</p>
<p style="position:absolute;top:646px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:646px;left:93px;white-space:nowrap" class="ft02">BNDCFGU and&#160;BNDCFGS&#160;provides&#160;the&#160;bit field,&#160;BNDPRESERVE (bit&#160;1).</p>
<p style="position:absolute;top:669px;left:68px;white-space:nowrap" class="ft06">The value of&#160;BNDPRESERVE&#160;in&#160;conjunction&#160;with&#160;the presence/absence the&#160;BND&#160;prefix with&#160;those branching instruc-<br/>tion will determine whether&#160;the&#160;values&#160;in&#160;BND0-BND3&#160;will be initialized&#160;or&#160;unchanged.</p>
<p style="position:absolute;top:736px;left:68px;white-space:nowrap" class="ft03">17.5.3&#160;</p>
<p style="position:absolute;top:736px;left:148px;white-space:nowrap" class="ft03">CALL, RET,&#160;JMP and All Jcc</p>
<p style="position:absolute;top:765px;left:68px;white-space:nowrap" class="ft06">An application compiled to&#160;use Intel MPX&#160;will&#160;use the REPNE&#160;(F2H) prefix&#160;(denoted by BND) for all&#160;forms&#160;of&#160;near&#160;<br/>CALL,&#160;near RET,&#160;near&#160;JMP,&#160;short&#160;&amp; near&#160;Jcc instructions (BND+CALL,&#160;BND+RET,&#160;BND+JMP,&#160;BND+Jcc).&#160;See&#160;<a href="o_7281d5ea06a5b67a-399.html">Table&#160;<br/>17-4&#160;for spe</a>cific&#160;opcodes. All far CALL, RET and&#160;JMP instructions&#160;plus short JMP (JMP rel 8, opcode EB) instructions&#160;<br/>will&#160;never cause&#160;bound registers&#160;to be initialized.<br/>If BNDPRESERVE bit is&#160;one,&#160;above&#160;instructions will NOT INIT the&#160;bounds registers&#160;when&#160;BND prefix&#160;is not present&#160;<br/>for above instructions (legacy behavior). However,&#160;If BNDPRESERVE is zero, above&#160;instructions will INIT ALL bound&#160;<br/>registers&#160;(BND0-BND3) when&#160;BND prefix&#160;is not present&#160;for&#160;above instructions.&#160;If BND&#160;prefix is&#160;present for above&#160;<br/>instructions, the&#160;BND&#160;registers will NOT INIT&#160;any&#160;bound registers&#160;(BND0-BND3).<br/>The legacy code will continue to&#160;use non-prefixed forms of&#160;these instructions,&#160;so if&#160;BNDPRESERVE is&#160;zero, all&#160;the&#160;<br/>bound&#160;registers&#160;will INIT by legacy code.&#160;This allows the&#160;legacy&#160;function to&#160;execute&#160;and return&#160;to callee with all&#160;<br/>bound&#160;registers initialized (legacy code by definition&#160;cannot make&#160;or load&#160;bounds&#160;in bound&#160;registers because it&#160;does&#160;<br/>not have&#160;Intel&#160;MPX instructions).&#160;This will eliminate compatibility concerns&#160;when&#160;legacy function might&#160;have&#160;<br/>changed the pointer&#160;in registers&#160;but did not&#160;update&#160;the&#160;value&#160;of the&#160;bounds&#160;registers associated with these&#160;<br/>pointers.&#160;<br/>If BNDCFGx.BNDPRESERVE&#160;is clear then non-prefixed forms&#160;of these&#160;instructions will initialize&#160;all the&#160;bound&#160;regis-<br/>ters.&#160;If this bit is set then&#160;non-prefixed and prefixed&#160;forms of&#160;these&#160;instructions&#160;will preserve the&#160;contents of bound&#160;<br/>registers&#160;as shown&#160;<a href="o_7281d5ea06a5b67a-399.html">in Table 17-4.</a></p>
<p style="position:absolute;top:266px;left:193px;white-space:nowrap" class="ft05">Table&#160;17-3. &#160;&#160;Effective&#160;Address Size&#160;of&#160;Intel&#160;MPX&#160;Instructions&#160;with&#160;67H&#160;Prefix</p>
<p style="position:absolute;top:290px;left:84px;white-space:nowrap" class="ft02">Addressing Mode</p>
<p style="position:absolute;top:290px;left:216px;white-space:nowrap" class="ft02">67H&#160;Prefix</p>
<p style="position:absolute;top:290px;left:321px;white-space:nowrap" class="ft02">Effective&#160;Address&#160;Size&#160;used for&#160;Intel&#160;MPX&#160;instructions&#160;when Intel MPX&#160;is&#160;enabled</p>
<p style="position:absolute;top:315px;left:101px;white-space:nowrap" class="ft02">64-bit&#160;Mode</p>
<p style="position:absolute;top:315px;left:245px;white-space:nowrap" class="ft02">Y</p>
<p style="position:absolute;top:315px;left:301px;white-space:nowrap" class="ft02">64&#160;bit addressing&#160;used&#160;</p>
<p style="position:absolute;top:339px;left:101px;white-space:nowrap" class="ft02">64-bit&#160;Mode</p>
<p style="position:absolute;top:339px;left:244px;white-space:nowrap" class="ft02">N</p>
<p style="position:absolute;top:339px;left:301px;white-space:nowrap" class="ft02">64&#160;bit addressing&#160;used&#160;</p>
<p style="position:absolute;top:362px;left:101px;white-space:nowrap" class="ft02">32-bit&#160;Mode</p>
<p style="position:absolute;top:362px;left:245px;white-space:nowrap" class="ft02">Y</p>
<p style="position:absolute;top:362px;left:301px;white-space:nowrap" class="ft02">#UD</p>
<p style="position:absolute;top:387px;left:101px;white-space:nowrap" class="ft02">32-bit&#160;Mode</p>
<p style="position:absolute;top:387px;left:244px;white-space:nowrap" class="ft02">N</p>
<p style="position:absolute;top:387px;left:301px;white-space:nowrap" class="ft02">32&#160;bit addressing&#160;used&#160;</p>
<p style="position:absolute;top:411px;left:101px;white-space:nowrap" class="ft02">16-bit&#160;Mode</p>
<p style="position:absolute;top:411px;left:245px;white-space:nowrap" class="ft02">Y</p>
<p style="position:absolute;top:411px;left:301px;white-space:nowrap" class="ft02">32&#160;bit addressing&#160;used&#160;</p>
<p style="position:absolute;top:435px;left:101px;white-space:nowrap" class="ft02">16-bit&#160;Mode</p>
<p style="position:absolute;top:435px;left:244px;white-space:nowrap" class="ft02">N</p>
<p style="position:absolute;top:435px;left:301px;white-space:nowrap" class="ft02">#UD</p>
</div>
</body>
</html>
