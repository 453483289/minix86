<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 299</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
	.ft011{font-size:8px;line-height:11px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page299-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a299.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 1&#160;12-19</p>
<p style="position:absolute;top:47px;left:414px;white-space:nowrap" class="ft01">PROGRAMMING WITH&#160;INTEL®&#160;SSE3,&#160;SSSE3,&#160;INTEL® SSE4 AND INTEL® AESNI</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">12.12.2&#160;&#160;Checking for SSE4.1 Support</p>
<p style="position:absolute;top:129px;left:69px;white-space:nowrap" class="ft07">Before&#160;an&#160;application attempts to&#160;use SSE4.1&#160;instructions,&#160;the&#160;application should&#160;follow the&#160;steps illustrated in&#160;<br/><a href="o_7281d5ea06a5b67a-273.html">Section 11.6.2, “Checking for SSE/SSE2&#160;Support.”&#160;</a>Next, use&#160;the additional step provided&#160;below:<br/>Check&#160;that&#160;the&#160;processor&#160;supports SSE4.1&#160;(if CPUID.01H:ECX.SSE4_1[bit 19] = 1),&#160;SSE3&#160;(if&#160;<br/>CPUID.01H:ECX.SSE3[bit 0]&#160;= 1),&#160;and&#160;SSSE3&#160;(if CPUID.01H:ECX.SSSE3[bit 9] = 1).&#160;</p>
<p style="position:absolute;top:236px;left:69px;white-space:nowrap" class="ft02">12.12.3&#160;&#160;Checking for SSE4.2 Support</p>
<p style="position:absolute;top:267px;left:69px;white-space:nowrap" class="ft07">Before&#160;an&#160;application attempts to&#160;use the&#160;following SSE4.2&#160;instructions:&#160;PCMPESTRI/PCMPESTRM/PCMP-<br/>ISTRI/PCMPISTRM, PCMPGTQ;the&#160;application should&#160;follow the steps illustrated&#160;<a href="o_7281d5ea06a5b67a-273.html">in&#160;Section&#160;11.6.2, “Checking&#160;for&#160;<br/>SSE/SSE2&#160;Support.”</a>&#160;Next,&#160;use&#160;the&#160;additional step provided&#160;below:<br/>Check&#160;that&#160;the&#160;processor&#160;supports SSE4.2&#160;(if CPUID.01H:ECX.SSE4_2[bit 20] = 1),&#160;SSE4.1&#160;(if&#160;<br/>CPUID.01H:ECX.SSE4_1[bit 19]&#160;=&#160;1),&#160;and&#160;SSSE3&#160;(if CPUID.01H:ECX.SSSE3[bit&#160;9] = 1).&#160;<br/>Before an application attempts to use the CRC32 instruction, it must&#160;check that the processor supports SSE4.2 (if&#160;<br/>CPUID.01H:ECX.SSE4_2[bit 20] = 1).<br/>Before an application attempts&#160;to use the&#160;POPCNT instruction,&#160;it must check that the processor supports SSE4.2 (if&#160;<br/>CPUID.01H:ECX.SSE4_2[bit 20] =&#160;1)&#160;and POPCNT (if CPUID.01H:ECX.POPCNT[bit 23] = 1).</p>
<p style="position:absolute;top:477px;left:69px;white-space:nowrap" class="ft04">12.13 AESNI&#160;</p>
<p style="position:absolute;top:477px;left:210px;white-space:nowrap" class="ft04">OVERVIEW</p>
<p style="position:absolute;top:513px;left:69px;white-space:nowrap" class="ft07">The AESNI extension provides&#160;six instructions&#160;to accelerate symmetric block encryption/decryption&#160;of&#160;128-bit data&#160;<br/>blocks&#160;using&#160;the&#160;Advanced&#160;Encryption&#160;Standard (AES) specified by&#160;the&#160;NIST publication FIPS 197. Specifically, two&#160;<br/>instructions&#160;(AESENC,&#160;AESENCLAST) target&#160;the&#160;AES&#160;encryption rounds, two&#160;instructions&#160;(AESDEC,&#160;AESDECLAST)&#160;<br/>target AES decryption&#160;rounds&#160;using the&#160;Equivalent&#160;Inverse Cipher.&#160;One instruction (AESIMC) targets the Inverse&#160;<br/>MixColumn transformation primitive and&#160;one instruction (AESKEYGEN)&#160;targets generation of round&#160;keys from the&#160;<br/>cipher&#160;key for the AES encryption/decryption&#160;rounds.<br/>AES supports encryption/decryption using&#160;cipher&#160;key lengths of&#160;128,&#160;192,&#160;and&#160;256&#160;bits&#160;by processing the&#160;data&#160;<br/>block in&#160;10,&#160;12,&#160;14&#160;rounds&#160;of predefined&#160;transformation<a href="o_7281d5ea06a5b67a-299.html">s. Figure 12-5&#160;</a>depicts the&#160;cryptographic&#160;processing&#160;of a&#160;<br/>block of 128-bit plain&#160;text into cipher text.&#160;</p>
<p style="position:absolute;top:929px;left:69px;white-space:nowrap" class="ft07">The&#160;predefined&#160;AES transformation primitives&#160;are described&#160;in the&#160;next few sections, they&#160;are also&#160;referenced in&#160;<br/>the operation flow of instruction reference&#160;page of these instructions.</p>
<p style="position:absolute;top:996px;left:69px;white-space:nowrap" class="ft02">12.13.1&#160;&#160;Little-Endian Architecture&#160;and Big-Endian Specification (FIPS 197)</p>
<p style="position:absolute;top:1025px;left:69px;white-space:nowrap" class="ft07">FIPS&#160;197 document defines the&#160;Advanced Encryption&#160;Standard&#160;(AES) and includes a set of test vectors for testing&#160;<br/>all of the&#160;steps in&#160;the&#160;algorithm,&#160;and&#160;can be&#160;used&#160;for testing&#160;and&#160;debugging.&#160;</p>
<p style="position:absolute;top:883px;left:357px;white-space:nowrap" class="ft05">Figure&#160;12-5.&#160;&#160;AES&#160;State&#160;Flow</p>
<p style="position:absolute;top:804px;left:217px;white-space:nowrap" class="ft00">Plain text</p>
<p style="position:absolute;top:805px;left:310px;white-space:nowrap" class="ft06">AES State</p>
<p style="position:absolute;top:708px;left:267px;white-space:nowrap" class="ft00">RK(0)</p>
<p style="position:absolute;top:761px;left:269px;white-space:nowrap" class="ft06">XOR</p>
<p style="position:absolute;top:759px;left:454px;white-space:nowrap" class="ft00">Rounds 2.. n-2</p>
<p style="position:absolute;top:783px;left:358px;white-space:nowrap" class="ft06">Round 1</p>
<p style="position:absolute;top:786px;left:594px;white-space:nowrap" class="ft06">Last&#160;</p>
<p style="position:absolute;top:710px;left:368px;white-space:nowrap" class="ft00">RK(1)</p>
<p style="position:absolute;top:708px;left:601px;white-space:nowrap" class="ft00">RK(n-1)</p>
<p style="position:absolute;top:804px;left:398px;white-space:nowrap" class="ft06">AES State</p>
<p style="position:absolute;top:804px;left:539px;white-space:nowrap" class="ft06">AES State</p>
<p style="position:absolute;top:803px;left:634px;white-space:nowrap" class="ft00">Cipher&#160;text</p>
<p style="position:absolute;top:835px;left:218px;white-space:nowrap" class="ft010">AES-128: n = 10<br/>AES-192: n = 12<br/>AES-256: n = 14</p>
<p style="position:absolute;top:798px;left:594px;white-space:nowrap" class="ft011">Round&#160;<br/>n-1</p>
</div>
</body>
</html>
