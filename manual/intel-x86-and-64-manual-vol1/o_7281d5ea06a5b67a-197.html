<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 197</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:7px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:9px;line-height:14px;font-family:Times;color:#000000;}
	.ft011{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page197-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a197.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:782px;white-space:nowrap" class="ft00">Vol. 1&#160;8-7</p>
<p style="position:absolute;top:47px;left:634px;white-space:nowrap" class="ft01">PROGRAMMING&#160;WITH&#160;THE X87&#160;FPU</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft08">The new mechanism&#160;is available beginning&#160;with&#160;the P6 family processors. Using&#160;this mechanism,&#160;the new&#160;floating-<br/>point compare and set EFLAGS instructions (FCOMI, FCOMIP, FUCOMI, and FUCOMIP) compare two floating-point&#160;<br/>values and set&#160;the ZF, PF,&#160;and CF&#160;flags in the EFLAGS&#160;register&#160;directly. A single&#160;instruction&#160;thus replaces&#160;the&#160;three&#160;<br/>instructions&#160;required&#160;by the&#160;old&#160;mechanism.<br/>Note also that the FCMOV<i>cc</i>&#160;instructions (also new in the P6&#160;family processors) allow conditional moves of floating-<br/>point values&#160;(values in the&#160;x87&#160;FPU data registers)&#160;based on&#160;the setting of the&#160;status&#160;flags&#160;(ZF,&#160;PF, and CF) in&#160;the&#160;<br/>EFLAGS&#160;register.&#160;These instructions eliminate&#160;the&#160;need&#160;for an&#160;IF statement to&#160;perform&#160;conditional moves of&#160;<br/>floating-point values.</p>
<p style="position:absolute;top:274px;left:69px;white-space:nowrap" class="ft04">8.1.5&#160;</p>
<p style="position:absolute;top:274px;left:149px;white-space:nowrap" class="ft04">x87 FPU Control Word</p>
<p style="position:absolute;top:304px;left:69px;white-space:nowrap" class="ft08">The&#160;16-bit&#160;x87 FPU control word&#160;(see<a href="o_7281d5ea06a5b67a-197.html">&#160;Figure&#160;8-6) controls t</a>he&#160;precision&#160;of the x87&#160;FPU and&#160;rounding method&#160;used.&#160;<br/>It also contains the x87&#160;FPU floating-point exception mask&#160;bits. The control word is cached&#160;in the&#160;x87 FPU control&#160;<br/>register.&#160;The&#160;contents of this&#160;register can&#160;be loaded&#160;with&#160;the FLDCW&#160;instruction&#160;and stored in&#160;memory with the&#160;<br/>FSTCW/FNSTCW instructions.</p>
<p style="position:absolute;top:748px;left:69px;white-space:nowrap" class="ft08">When&#160;the x87 FPU&#160;is initialized with&#160;either&#160;an FINIT/FNINIT&#160;or FSAVE/FNSAVE instruction,&#160;the x87 FPU&#160;control&#160;<br/>word is&#160;set to&#160;037FH, which&#160;masks&#160;all floating-point exceptions, sets rounding&#160;to nearest,&#160;and sets the&#160;x87 FPU&#160;<br/>precision&#160;to 64&#160;bits.</p>
<p style="position:absolute;top:826px;left:69px;white-space:nowrap" class="ft05">8.1.5.1&#160;&#160;</p>
<p style="position:absolute;top:826px;left:153px;white-space:nowrap" class="ft05">x87 FPU Floating-Point&#160;Exception Mask&#160;Bits</p>
<p style="position:absolute;top:854px;left:69px;white-space:nowrap" class="ft08">The exception-flag&#160;mask&#160;bits&#160;(bits 0 through 5&#160;of the&#160;x87 FPU&#160;control word) mask&#160;the&#160;6&#160;floating-point exception&#160;<br/>flags&#160;in the&#160;x87&#160;FPU status&#160;word. When&#160;one of these mask&#160;bits&#160;is set, its&#160;corresponding&#160;x87&#160;FPU floating-point&#160;<br/>exception is&#160;blocked&#160;from being generated.</p>
<p style="position:absolute;top:931px;left:69px;white-space:nowrap" class="ft05">8.1.5.2&#160;&#160;</p>
<p style="position:absolute;top:931px;left:153px;white-space:nowrap" class="ft05">Precision Control Field</p>
<p style="position:absolute;top:960px;left:69px;white-space:nowrap" class="ft08">The precision-control (PC) field&#160;(bits&#160;8 and&#160;9 of the x87&#160;FPU control word) determines the&#160;precision&#160;(64,&#160;53,&#160;or 24&#160;<br/>bits) of&#160;floating-point&#160;calculations made by&#160;the&#160;x87 FPU&#160;(s<a href="o_7281d5ea06a5b67a-198.html">ee&#160;Table 8-2).</a>&#160;The&#160;default&#160;precision is&#160;double&#160;extended&#160;<br/>precision, which uses the full 64-bit significand available&#160;with&#160;the double extended-precision&#160;floating-point format&#160;<br/>of the x87 FPU data registers. This setting is best suited for&#160;most applications, because it allows applications&#160;to take&#160;<br/>full advantage of&#160;the maximum precision available&#160;with the&#160;x87&#160;FPU data registers.</p>
<p style="position:absolute;top:703px;left:338px;white-space:nowrap" class="ft06">Figure&#160;8-6.&#160;&#160;x87 FPU&#160;Control Word</p>
<p style="position:absolute;top:479px;left:379px;white-space:nowrap" class="ft07">15</p>
<p style="position:absolute;top:479px;left:404px;white-space:nowrap" class="ft07">13</p>
<p style="position:absolute;top:479px;left:391px;white-space:nowrap" class="ft07">14</p>
<p style="position:absolute;top:479px;left:417px;white-space:nowrap" class="ft07">12&#160;11&#160;10&#160;9&#160;8&#160;7&#160;6&#160;5&#160;4&#160;3&#160;2&#160;1&#160;0</p>
<p style="position:absolute;top:502px;left:419px;white-space:nowrap" class="ft07">X</p>
<p style="position:absolute;top:498px;left:573px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:507px;left:571px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:498px;left:508px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:507px;left:507px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:498px;left:533px;white-space:nowrap" class="ft07">O</p>
<p style="position:absolute;top:507px;left:532px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:498px;left:520px;white-space:nowrap" class="ft07">U</p>
<p style="position:absolute;top:507px;left:520px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:497px;left:546px;white-space:nowrap" class="ft07">Z</p>
<p style="position:absolute;top:507px;left:545px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:498px;left:558px;white-space:nowrap" class="ft07">D</p>
<p style="position:absolute;top:507px;left:558px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:502px;left:435px;white-space:nowrap" class="ft07">RC</p>
<p style="position:absolute;top:502px;left:461px;white-space:nowrap" class="ft07">PC</p>
<p style="position:absolute;top:412px;left:495px;white-space:nowrap" class="ft011">Infinity Control<br/>Rounding Control<br/>Precision Control</p>
<p style="position:absolute;top:558px;left:321px;white-space:nowrap" class="ft011">Exception Masks<br/>&#160;&#160; Precision<br/>&#160;&#160; Underflow<br/>&#160;&#160; Overflow<br/>&#160;&#160; Zero Divide<br/>&#160;&#160; Denormal Operand<br/>&#160;&#160; Invalid Operation</p>
<p style="position:absolute;top:667px;left:351px;white-space:nowrap" class="ft00">Reserved</p>
</div>
</body>
</html>
