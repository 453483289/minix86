<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 186</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page186-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a186.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">7-22&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROGRAMMING WITH GENERAL-PURPOSE INSTRUCTIONS</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft06">code&#160;segment&#160;is 0&#160;(most privileged),&#160;the&#160;IOPL bits (bits&#160;13&#160;and&#160;12)&#160;also are&#160;affected. If&#160;the&#160;I/O&#160;privilege&#160;level&#160;<br/>(IOPL) is&#160;greater&#160;than or equal to&#160;the CPL,&#160;numerically, the&#160;IF flag (bit&#160;9)&#160;also is&#160;affected.&#160;<br/>The POPFD instruction pops&#160;a doubleword&#160;into the EFLAGS&#160;register.&#160;This&#160;instruction&#160;can&#160;change the state of&#160;the AC&#160;<br/>bit (bit 18) and&#160;the ID bit (bit&#160;21),&#160;as well as&#160;the&#160;bits affected by a&#160;POPF instruction.&#160;The restrictions for changing&#160;<br/>the IOPL&#160;bits and the&#160;IF flag&#160;that were&#160;given for the&#160;POPF&#160;instruction&#160;also apply to&#160;the POPFD&#160;instruction.</p>
<p style="position:absolute;top:218px;left:68px;white-space:nowrap" class="ft03">7.3.13.3 &#160;&#160;Interrupt Flag Instructions</p>
<p style="position:absolute;top:247px;left:68px;white-space:nowrap" class="ft06">The STI (set interrupt&#160;flag)&#160;and CLI&#160;(clear&#160;interrupt flag)&#160;instructions allow the&#160;interrupt&#160;IF flag&#160;in the&#160;EFLAGS&#160;<br/>register&#160;to&#160;be&#160;modified&#160;directly.&#160;The&#160;IF&#160;flag&#160;controls&#160;the&#160;servicing of hardware-generated interrupts (those received&#160;<br/>at the processor’s INTR pin). If the IF flag&#160;is set, the processor services hardware interrupts; if the IF&#160;flag is clear,&#160;<br/>hardware&#160;interrupts are masked.<br/>The&#160;ability&#160;to execute&#160;these&#160;instructions depends&#160;on the&#160;operating mode&#160;of the&#160;processor&#160;and the&#160;current privilege&#160;<br/>level (CPL) of the&#160;program&#160;or task attempting&#160;to execute these instructions.</p>
<p style="position:absolute;top:387px;left:68px;white-space:nowrap" class="ft04">7.3.14&#160;</p>
<p style="position:absolute;top:387px;left:148px;white-space:nowrap" class="ft04">Flag Control (RFLAG) Instructions in 64-Bit Mode</p>
<p style="position:absolute;top:418px;left:68px;white-space:nowrap" class="ft06">In 64-bit&#160;mode,&#160;the LAHF and&#160;SAHF&#160;instructions&#160;are&#160;supported if&#160;CPUID.80000001H:ECX.LAHF-SAHF[bit&#160;0] = 1.<br/>PUSHF and&#160;POPF&#160;behave the&#160;same&#160;in&#160;64-bit mode&#160;as&#160;in&#160;non-64-bit&#160;mode.&#160;PUSHFD&#160;always pushes&#160;64-bit RFLAGS&#160;<br/>onto&#160;the&#160;stack&#160;(with the RF&#160;and VM flags read&#160;as clear).&#160;POPFD always pops a&#160;64-bit value from the&#160;top of&#160;the stack&#160;<br/>and loads the&#160;lower 32 bits&#160;into RFLAGS. It&#160;then zero&#160;extends&#160;the upper bits of RFLAGS.</p>
<p style="position:absolute;top:525px;left:68px;white-space:nowrap" class="ft04">7.3.15&#160;</p>
<p style="position:absolute;top:525px;left:148px;white-space:nowrap" class="ft04">Segment Register Instructions</p>
<p style="position:absolute;top:556px;left:68px;white-space:nowrap" class="ft06">The processor provides&#160;a variety&#160;of instructions that&#160;address the segment registers of the processor directly.&#160;These&#160;<br/>instructions are&#160;only used&#160;when&#160;an operating system&#160;or&#160;executive is using&#160;the&#160;segmented&#160;or the real-address mode&#160;<br/>memory&#160;model.&#160;<br/>For the&#160;purpose&#160;of this discussion,&#160;these&#160;instructions&#160;are divided&#160;into subordinate subgroups of instructions that&#160;<br/>allow:</p>
<p style="position:absolute;top:651px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:652px;left:93px;white-space:nowrap" class="ft02">Segment-register load&#160;and store</p>
<p style="position:absolute;top:673px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:674px;left:93px;white-space:nowrap" class="ft02">Far control&#160;transfers</p>
<p style="position:absolute;top:696px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:697px;left:93px;white-space:nowrap" class="ft02">Software interrupt&#160;calls</p>
<p style="position:absolute;top:718px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:719px;left:93px;white-space:nowrap" class="ft02">Handling of&#160;far pointers</p>
<p style="position:absolute;top:763px;left:68px;white-space:nowrap" class="ft03">7.3.15.1&#160;&#160;&#160;Segment-Register&#160;Load&#160;and Store Instructions</p>
<p style="position:absolute;top:792px;left:68px;white-space:nowrap" class="ft06">The MOV&#160;in<a href="o_7281d5ea06a5b67a-167.html">struction (introduced in Section&#160;7.3.1.1,&#160;“General Data Movement Instructions”) and the PUSH&#160;</a>and&#160;POP&#160;<br/>instructions<a href="o_7281d5ea06a5b67a-169.html">&#160;(introduced in&#160;Section&#160;7.3.1.4, “Stack&#160;Manipulation Instructions”)&#160;</a>can transfer&#160;16-bit segment selec-<br/>tors to and from segment&#160;registers&#160;(DS,&#160;ES, FS, GS,&#160;and SS). The transfers&#160;are always made to or from a segment&#160;<br/>register&#160;and a&#160;general-purpose register or&#160;memory.&#160;Transfers between&#160;segment registers&#160;are not&#160;supported.<br/>The POP&#160;and&#160;MOV instructions cannot place a&#160;value&#160;in&#160;the CS&#160;register. Only the&#160;far&#160;control-transfer&#160;versions of the&#160;<br/>JMP,&#160;CALL, and&#160;RET instruct<a href="o_7281d5ea06a5b67a-186.html">ions (see Section 7.3.15.2, “Far&#160;Control Transfer Instructions”) affect the&#160;</a>CS register&#160;<br/>directly.&#160;</p>
<p style="position:absolute;top:943px;left:68px;white-space:nowrap" class="ft03">7.3.15.2 &#160;&#160;Far&#160;Control Transfer&#160;Instructions</p>
<p style="position:absolute;top:971px;left:68px;white-space:nowrap" class="ft06">The JMP and CALL instructions&#160;(see<a href="o_7281d5ea06a5b67a-178.html">&#160;Section&#160;7.3.8, “Control&#160;Transfer Instructions”)&#160;</a>both&#160;accept&#160;a far pointer as&#160;a&#160;<br/>destination to transfer program control&#160;to a segment other than&#160;the&#160;segment currently&#160;being&#160;pointed to by the CS&#160;<br/>register. When a far call&#160;is made with the CALL instruction,&#160;the current&#160;values&#160;of the&#160;EIP&#160;and CS registers are&#160;both&#160;<br/>pushed on&#160;the stack.<br/>The&#160;RET instruction (see&#160;“Call and&#160;return instructions”&#160;on<a href="o_7281d5ea06a5b67a-179.html">&#160;page&#160;7-15)&#160;</a>can be&#160;used&#160;to&#160;execute&#160;a far return.&#160;Here,&#160;<br/>program&#160;control is&#160;transferred from&#160;a code&#160;segment&#160;that&#160;contains a&#160;called procedure&#160;back to&#160;the&#160;code segment that&#160;</p>
</div>
</body>
</html>
