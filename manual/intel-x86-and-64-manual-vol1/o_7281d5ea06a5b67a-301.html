<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 301</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;font-family:Times;color:#0860a8;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page301-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a301.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 1&#160;12-21</p>
<p style="position:absolute;top:47px;left:414px;white-space:nowrap" class="ft01">PROGRAMMING WITH&#160;INTEL®&#160;SSE3,&#160;SSSE3,&#160;INTEL® SSE4 AND INTEL® AESNI</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft08">This vector has the “least&#160;significant”&#160;byte d4 and the&#160;significant byte e5 (written in Big Endian format&#160;in the FIPS&#160;<br/>document).&#160;When it&#160;is translated&#160;to IA notations,&#160;the encoding is:</p>
<p style="position:absolute;top:431px;left:69px;white-space:nowrap" class="ft03">12.13.2&#160;&#160;AES Transformations and Functions</p>
<p style="position:absolute;top:460px;left:69px;white-space:nowrap" class="ft08">The following&#160;functions and transformations are&#160;used in the algorithmic descriptions of AES instruction&#160;extensions&#160;<br/>AESDEC,&#160;AESDECLAST,&#160;AESENC,&#160;AESENCLAST,&#160;AESIMC,&#160;AESKEYGENASSIST.<br/>Note that these transformations are&#160;expressed&#160;here in&#160;a&#160;Little Endian&#160;format&#160;(and not as&#160;in the&#160;FIPS 197&#160;docu-<br/>ment).</p>
<p style="position:absolute;top:538px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:538px;left:95px;white-space:nowrap" class="ft08">MixColumns(): A byte-oriented 4x4 matrix transformation&#160;on&#160;the matrix representation of a 128-bit AES state.&#160;<br/>A FIPS-197&#160;defined&#160;4x4 matrix is&#160;multiplied&#160;to each&#160;4x1&#160;column vector of&#160;the&#160;AES state.&#160;The columns are&#160;<br/>considered polynomials with coefficients&#160;in&#160;the Finite&#160;Field&#160;that is&#160;used&#160;in the&#160;definition of FIPS&#160;197,&#160;the&#160;<br/>operations (“multiplication” and&#160;“addition”) are&#160;in that&#160;Finite Field,&#160;and&#160;the polynomials are&#160;reduced modulo&#160;<br/>x</p>
<p style="position:absolute;top:602px;left:103px;white-space:nowrap" class="ft05">4</p>
<p style="position:absolute;top:604px;left:109px;white-space:nowrap" class="ft02">+1.&#160;</p>
<p style="position:absolute;top:627px;left:95px;white-space:nowrap" class="ft08">The MixColumns() transformation defines&#160;the relationship&#160;between&#160;each byte&#160;of the&#160;result state,&#160;represented<br/>as S’(i, j)&#160;of a&#160;4x4&#160;<a href="o_7281d5ea06a5b67a-299.html">matrix (see Section 12.13.1)</a>, as&#160;a&#160;function&#160;of input state bytes, S(i, j), as&#160;follows<br/>S’(0, j)&#160;&#160;FF_MUL(&#160;02H,&#160;S(0,&#160;j) ) XOR&#160;FF_MUL(03H,&#160;S(1,&#160;j) )&#160;XOR S(2, j)&#160;XOR S(3,&#160;j)<br/>S’(1, j)&#160;&#160;S(0,&#160;j)&#160;XOR FF_MUL(&#160;02H,&#160;S(1, j)&#160;) XOR FF_MUL(03H,&#160;S(2,&#160;j) )&#160;XOR S(3,&#160;j)&#160;<br/>S’(2, j)&#160;&#160;S(0,&#160;j) XOR S(1,&#160;j) XOR&#160;FF_MUL( 02H,&#160;S(2,&#160;j) )&#160;XOR FF_MUL(03H, S(3, j)&#160;)&#160;<br/>S’(3, j)&#160;&#160;FF_MUL(03H, S(0,&#160;j)&#160;) XOR S(1,&#160;j) XOR&#160;S(2,&#160;j) XOR&#160;FF_MUL( 02H, S(3, j)&#160;)&#160;<br/>where j = 0,&#160;1, 2,&#160;3. FF_MUL(Byte1,&#160;Byte2) denotes&#160;the result of&#160;multiplying two elements&#160;(represented&#160;by<br/>Byte1 and byte2) in the Finite Field representation&#160;&#160;that&#160;&#160;defines&#160;&#160;AES.&#160;&#160;The&#160;&#160;result&#160;&#160;of&#160;&#160;produced&#160;&#160;bye<br/>FF_MUL(Byte1, Byte2) is&#160;an element&#160;in the&#160;Finite Field (represented as&#160;a byte). A Finite&#160;Field&#160;is a&#160;field with a<br/>finite number&#160;of&#160;elements, and when this&#160;number can&#160;be&#160;represented&#160;as a&#160;power of&#160;2 (2n),&#160;its elements can<br/>be&#160;represented as the set of 2n binary strings of length&#160;n.&#160;AES uses a finite&#160;field with n=8 (having&#160;256<br/>elements).&#160;With this representation,&#160;“addition” of two elements&#160;in that field is a&#160;bit-wise&#160;XOR of their binary-<br/>string representation, producing another&#160;element&#160;in&#160;the&#160;field.&#160;Multiplication&#160;of two elements in that&#160;field&#160;is<br/>defined using an&#160;irreducible&#160;polynomial (for&#160;AES,&#160;this polynomial is m(x) = x</p>
<p style="position:absolute;top:869px;left:631px;white-space:nowrap" class="ft06"><i>8</i></p>
<p style="position:absolute;top:871px;left:638px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:869px;left:668px;white-space:nowrap" class="ft06"><i>4</i></p>
<p style="position:absolute;top:871px;left:675px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:869px;left:706px;white-space:nowrap" class="ft06"><i>3</i></p>
<p style="position:absolute;top:871px;left:713px;white-space:nowrap" class="ft02">&#160;+ x&#160;+ 1).&#160;In this</p>
<p style="position:absolute;top:888px;left:95px;white-space:nowrap" class="ft08">Finite&#160;Field&#160;representation, the&#160;bit value of bit&#160;position&#160;k of&#160;a byte represents the&#160;coefficient of&#160;a polynomial&#160;of<br/>order&#160;k,&#160;e.g.,&#160;1010_1101B (ADH) is represented by&#160;the&#160;polynomial (x</p>
<p style="position:absolute;top:902px;left:573px;white-space:nowrap" class="ft06"><i>7</i></p>
<p style="position:absolute;top:904px;left:580px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:902px;left:609px;white-space:nowrap" class="ft06"><i>5</i></p>
<p style="position:absolute;top:904px;left:616px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:902px;left:646px;white-space:nowrap" class="ft06"><i>3</i></p>
<p style="position:absolute;top:904px;left:653px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:902px;left:682px;white-space:nowrap" class="ft06"><i>2</i></p>
<p style="position:absolute;top:904px;left:689px;white-space:nowrap" class="ft02">&#160;+ 1).&#160;The byte&#160;value</p>
<p style="position:absolute;top:921px;left:95px;white-space:nowrap" class="ft08">result of multiplication of two elements is obtained&#160;by a carry-less multiplication of the two corresponding<br/>polynomials, followed by reduction modulo the polynomial, where the remainder is&#160;calculated using<br/>operations defined&#160;in&#160;the&#160;field.&#160;For example,&#160;FF_MUL(57H,&#160;83H) = C1H,&#160;because&#160;the&#160;carry-less&#160;polynomial<br/>multiplication of the&#160;polynomials&#160;represented&#160;by&#160;57H and 83H produces&#160;(x</p>
<p style="position:absolute;top:968px;left:603px;white-space:nowrap" class="ft06"><i>13</i></p>
<p style="position:absolute;top:970px;left:616px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:968px;left:645px;white-space:nowrap" class="ft06"><i>11</i></p>
<p style="position:absolute;top:970px;left:659px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:968px;left:688px;white-space:nowrap" class="ft06"><i>9</i></p>
<p style="position:absolute;top:970px;left:694px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:968px;left:723px;white-space:nowrap" class="ft06"><i>8</i></p>
<p style="position:absolute;top:970px;left:730px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:968px;left:759px;white-space:nowrap" class="ft06"><i>6</i></p>
<p style="position:absolute;top:970px;left:766px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:968px;left:794px;white-space:nowrap" class="ft06"><i>5</i></p>
<p style="position:absolute;top:970px;left:801px;white-space:nowrap" class="ft02">&#160;+&#160;x</p>
<p style="position:absolute;top:968px;left:830px;white-space:nowrap" class="ft06"><i>4</i></p>
<p style="position:absolute;top:987px;left:95px;white-space:nowrap" class="ft02">+ x</p>
<p style="position:absolute;top:984px;left:118px;white-space:nowrap" class="ft06"><i>3</i></p>
<p style="position:absolute;top:987px;left:125px;white-space:nowrap" class="ft02">&#160;+&#160;1), and the remainder modulo&#160;m(x)&#160;is (x</p>
<p style="position:absolute;top:984px;left:423px;white-space:nowrap" class="ft06"><i>7</i></p>
<p style="position:absolute;top:987px;left:430px;white-space:nowrap" class="ft02">&#160;+ x</p>
<p style="position:absolute;top:984px;left:458px;white-space:nowrap" class="ft06"><i>6</i></p>
<p style="position:absolute;top:987px;left:465px;white-space:nowrap" class="ft02">&#160;+ 1).</p>
<p style="position:absolute;top:1009px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:1009px;left:95px;white-space:nowrap" class="ft08">RotWord():&#160;performs a&#160;byte-wise cyclic permutation&#160;(rotate&#160;right in&#160;little-endian&#160;byte order) on&#160;a&#160;32-bit AES&#160;<br/>word.</p>
<p style="position:absolute;top:155px;left:248px;white-space:nowrap" class="ft07">Table&#160;12-10.&#160;&#160;Little Endian&#160;Representation of&#160;a 128-bit State</p>
<p style="position:absolute;top:180px;left:107px;white-space:nowrap" class="ft02">Byte&#160;&#160;#</p>
<p style="position:absolute;top:180px;left:196px;white-space:nowrap" class="ft02">15</p>
<p style="position:absolute;top:180px;left:237px;white-space:nowrap" class="ft02">14</p>
<p style="position:absolute;top:180px;left:278px;white-space:nowrap" class="ft02">13</p>
<p style="position:absolute;top:180px;left:318px;white-space:nowrap" class="ft02">12</p>
<p style="position:absolute;top:180px;left:359px;white-space:nowrap" class="ft02">11</p>
<p style="position:absolute;top:180px;left:400px;white-space:nowrap" class="ft02">10</p>
<p style="position:absolute;top:180px;left:445px;white-space:nowrap" class="ft02">9</p>
<p style="position:absolute;top:180px;left:485px;white-space:nowrap" class="ft02">8</p>
<p style="position:absolute;top:180px;left:526px;white-space:nowrap" class="ft02">7</p>
<p style="position:absolute;top:180px;left:567px;white-space:nowrap" class="ft02">6</p>
<p style="position:absolute;top:180px;left:608px;white-space:nowrap" class="ft02">5</p>
<p style="position:absolute;top:180px;left:649px;white-space:nowrap" class="ft02">4</p>
<p style="position:absolute;top:180px;left:689px;white-space:nowrap" class="ft02">3</p>
<p style="position:absolute;top:180px;left:730px;white-space:nowrap" class="ft02">2</p>
<p style="position:absolute;top:180px;left:771px;white-space:nowrap" class="ft02">1</p>
<p style="position:absolute;top:180px;left:812px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:204px;left:96px;white-space:nowrap" class="ft02">State&#160;Byte</p>
<p style="position:absolute;top:204px;left:200px;white-space:nowrap" class="ft02">P</p>
<p style="position:absolute;top:204px;left:240px;white-space:nowrap" class="ft02">O</p>
<p style="position:absolute;top:204px;left:281px;white-space:nowrap" class="ft02">N</p>
<p style="position:absolute;top:204px;left:321px;white-space:nowrap" class="ft02">M</p>
<p style="position:absolute;top:204px;left:364px;white-space:nowrap" class="ft02">L</p>
<p style="position:absolute;top:204px;left:404px;white-space:nowrap" class="ft02">K</p>
<p style="position:absolute;top:204px;left:447px;white-space:nowrap" class="ft02">J</p>
<p style="position:absolute;top:204px;left:488px;white-space:nowrap" class="ft02">I</p>
<p style="position:absolute;top:204px;left:526px;white-space:nowrap" class="ft02">H</p>
<p style="position:absolute;top:204px;left:567px;white-space:nowrap" class="ft02">G</p>
<p style="position:absolute;top:204px;left:608px;white-space:nowrap" class="ft02">F</p>
<p style="position:absolute;top:204px;left:649px;white-space:nowrap" class="ft02">E</p>
<p style="position:absolute;top:204px;left:689px;white-space:nowrap" class="ft02">D</p>
<p style="position:absolute;top:204px;left:731px;white-space:nowrap" class="ft02">C</p>
<p style="position:absolute;top:204px;left:771px;white-space:nowrap" class="ft02">B</p>
<p style="position:absolute;top:204px;left:811px;white-space:nowrap" class="ft02">A</p>
<p style="position:absolute;top:227px;left:94px;white-space:nowrap" class="ft02">State&#160;&#160;Value</p>
<p style="position:absolute;top:227px;left:196px;white-space:nowrap" class="ft02">e5</p>
<p style="position:absolute;top:227px;left:237px;white-space:nowrap" class="ft02">98</p>
<p style="position:absolute;top:227px;left:278px;white-space:nowrap" class="ft02">27</p>
<p style="position:absolute;top:227px;left:319px;white-space:nowrap" class="ft02">1e</p>
<p style="position:absolute;top:227px;left:361px;white-space:nowrap" class="ft02">f1</p>
<p style="position:absolute;top:227px;left:400px;white-space:nowrap" class="ft02">11</p>
<p style="position:absolute;top:227px;left:441px;white-space:nowrap" class="ft02">41</p>
<p style="position:absolute;top:227px;left:482px;white-space:nowrap" class="ft02">b8</p>
<p style="position:absolute;top:227px;left:523px;white-space:nowrap" class="ft02">ae</p>
<p style="position:absolute;top:227px;left:563px;white-space:nowrap" class="ft02">52</p>
<p style="position:absolute;top:227px;left:604px;white-space:nowrap" class="ft02">b4</p>
<p style="position:absolute;top:227px;left:645px;white-space:nowrap" class="ft02">e0</p>
<p style="position:absolute;top:227px;left:685px;white-space:nowrap" class="ft02">30</p>
<p style="position:absolute;top:227px;left:727px;white-space:nowrap" class="ft02">5d</p>
<p style="position:absolute;top:227px;left:769px;white-space:nowrap" class="ft02">bf</p>
<p style="position:absolute;top:227px;left:808px;white-space:nowrap" class="ft02">d4</p>
<p style="position:absolute;top:281px;left:239px;white-space:nowrap" class="ft07">Table&#160;12-11.&#160;&#160;Little Endian&#160;Representation of&#160;a&#160;4x4 Byte Matrix</p>
<p style="position:absolute;top:306px;left:101px;white-space:nowrap" class="ft02">A</p>
<p style="position:absolute;top:306px;left:173px;white-space:nowrap" class="ft02">E</p>
<p style="position:absolute;top:306px;left:246px;white-space:nowrap" class="ft02">I</p>
<p style="position:absolute;top:306px;left:314px;white-space:nowrap" class="ft02">M</p>
<p style="position:absolute;top:306px;left:425px;white-space:nowrap" class="ft02">d4</p>
<p style="position:absolute;top:306px;left:540px;white-space:nowrap" class="ft02">e0</p>
<p style="position:absolute;top:306px;left:656px;white-space:nowrap" class="ft02">b8</p>
<p style="position:absolute;top:306px;left:771px;white-space:nowrap" class="ft02">1e</p>
<p style="position:absolute;top:330px;left:102px;white-space:nowrap" class="ft02">B</p>
<p style="position:absolute;top:330px;left:173px;white-space:nowrap" class="ft02">F</p>
<p style="position:absolute;top:330px;left:246px;white-space:nowrap" class="ft02">J</p>
<p style="position:absolute;top:330px;left:314px;white-space:nowrap" class="ft02">N</p>
<p style="position:absolute;top:330px;left:427px;white-space:nowrap" class="ft02">bf</p>
<p style="position:absolute;top:330px;left:540px;white-space:nowrap" class="ft02">b4</p>
<p style="position:absolute;top:330px;left:655px;white-space:nowrap" class="ft02">41</p>
<p style="position:absolute;top:330px;left:770px;white-space:nowrap" class="ft02">27</p>
<p style="position:absolute;top:353px;left:102px;white-space:nowrap" class="ft02">C</p>
<p style="position:absolute;top:353px;left:173px;white-space:nowrap" class="ft02">G</p>
<p style="position:absolute;top:353px;left:244px;white-space:nowrap" class="ft02">K</p>
<p style="position:absolute;top:353px;left:314px;white-space:nowrap" class="ft02">O</p>
<p style="position:absolute;top:353px;left:425px;white-space:nowrap" class="ft02">5d</p>
<p style="position:absolute;top:353px;left:540px;white-space:nowrap" class="ft02">52</p>
<p style="position:absolute;top:353px;left:655px;white-space:nowrap" class="ft02">11</p>
<p style="position:absolute;top:353px;left:770px;white-space:nowrap" class="ft02">98</p>
<p style="position:absolute;top:378px;left:102px;white-space:nowrap" class="ft02">D</p>
<p style="position:absolute;top:378px;left:172px;white-space:nowrap" class="ft02">H</p>
<p style="position:absolute;top:378px;left:244px;white-space:nowrap" class="ft02">L</p>
<p style="position:absolute;top:378px;left:315px;white-space:nowrap" class="ft02">P</p>
<p style="position:absolute;top:378px;left:425px;white-space:nowrap" class="ft02">30</p>
<p style="position:absolute;top:378px;left:541px;white-space:nowrap" class="ft02">ae</p>
<p style="position:absolute;top:378px;left:657px;white-space:nowrap" class="ft02">f1</p>
<p style="position:absolute;top:378px;left:771px;white-space:nowrap" class="ft02">e5</p>
</div>
</body>
</html>
