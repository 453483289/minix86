<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 184</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:14px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page184-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a184.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">7-20&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROGRAMMING WITH GENERAL-PURPOSE INSTRUCTIONS</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft08">When fast-string&#160;operation is&#160;enabled (because IA32_MISC_ENABLE[0]&#160;= 1),&#160;some&#160;processors may&#160;further&#160;<br/>enhance the operation of the REP&#160;MOVSB&#160;and&#160;REP&#160;STOSB&#160;instructions.&#160;A processor supports these enhancements&#160;<br/>if CPUID.(EAX=07H,&#160;ECX=0H):EBX[bit&#160;9] is&#160;1. The<a href="˛ˇ">&#160;<i>Intel¬Æ 64 and&#160;IA-32 Architectures Optimization Reference&#160;<br/>Manual</i></a>&#160;may include&#160;model-specific recommendations&#160;for&#160;use of these enhancements.<br/>The stores&#160;produced by&#160;fast-string operation may&#160;appear&#160;to&#160;execute&#160;out&#160;of order.&#160;Software dependent upon&#160;<br/>sequential&#160;store&#160;ordering&#160;should not use&#160;string&#160;operations&#160;for&#160;the entire data structure&#160;to be stored.&#160;Data&#160;and&#160;<br/>semaphores should&#160;be&#160;separated. Order-dependent code&#160;should&#160;write to&#160;a discrete&#160;semaphore&#160;variable after any&#160;<br/>string operations to&#160;allow&#160;correctly ordered data to be&#160;seen&#160;by all&#160;processors.&#160;Atomicity&#160;of load and&#160;store&#160;operations&#160;<br/>is guaranteed&#160;only for native&#160;data&#160;elements&#160;of&#160;the&#160;string&#160;with&#160;native&#160;data size,&#160;and only if they&#160;are included in&#160;a&#160;<br/>single cache&#160;line. S<a href="˛ˇ">ee Section 8.2.4,&#160;‚ÄúFast-String&#160;Operation and Out-of-Order Stores‚Äù of&#160;<i>Intel¬Æ&#160;64&#160;and IA-32&#160;Archi-<br/>tectures&#160;Software Developer‚Äôs Manual, Volume&#160;3A.</i></a></p>
<p style="position:absolute;top:317px;left:68px;white-space:nowrap" class="ft04">7.3.9.4 &#160;</p>
<p style="position:absolute;top:317px;left:152px;white-space:nowrap" class="ft04">String Operations in 64-Bit Mode</p>
<p style="position:absolute;top:346px;left:68px;white-space:nowrap" class="ft07">The behavior of MOVS (Move&#160;String), CMPS (Compare string), SCAS&#160;(Scan string), LODS (Load string), and STOS&#160;<br/>(Store&#160;string) instructions in 64-bit mode is similar to their behavior in non-64-bit modes,&#160;with the following differ-<br/>ences:</p>
<p style="position:absolute;top:400px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:401px;left:93px;white-space:nowrap" class="ft02">The&#160;source&#160;operand is&#160;specified by RSI or&#160;DS:ESI,&#160;depending on&#160;the address&#160;size attribute of the&#160;operation.&#160;</p>
<p style="position:absolute;top:423px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:424px;left:93px;white-space:nowrap" class="ft07">The&#160;destination operand&#160;is specified&#160;by RDI or&#160;DS:EDI, depending on the&#160;address size attribute&#160;of the&#160;<br/>operation.&#160;</p>
<p style="position:absolute;top:462px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:463px;left:93px;white-space:nowrap" class="ft02">Operation on 64-bit&#160;data&#160;is supported by using&#160;the REX.W&#160;prefix.</p>
<p style="position:absolute;top:487px;left:68px;white-space:nowrap" class="ft07">When using&#160;REP prefixes for&#160;string&#160;operations in&#160;64-bit mode,&#160;the&#160;repeat count is&#160;specified by&#160;RCX or&#160;ECX&#160;<br/>(depending on&#160;the address&#160;size attribute of the&#160;operation).&#160;The&#160;default address&#160;size is&#160;64&#160;bits.</p>
<p style="position:absolute;top:554px;left:68px;white-space:nowrap" class="ft06">7.3.10 I/O&#160;</p>
<p style="position:absolute;top:554px;left:176px;white-space:nowrap" class="ft06">Instructions</p>
<p style="position:absolute;top:584px;left:68px;white-space:nowrap" class="ft010">The&#160;IN&#160;(input&#160;from&#160;port&#160;to&#160;register),&#160;INS&#160;(input&#160;from&#160;port&#160;to&#160;string),&#160;OUT&#160;(output&#160;from&#160;register&#160;to&#160;port),&#160;and&#160;OUTS&#160;<br/>(output string&#160;to port) instructions move&#160;data&#160;between&#160;the&#160;processor‚Äôs&#160;I/O ports&#160;and either a&#160;register&#160;or memory.<br/>The register&#160;I/O&#160;instructions (IN&#160;and OUT)&#160;move&#160;data between&#160;an&#160;I/O port&#160;and&#160;the&#160;EAX register&#160;(32-bit I/O),&#160;the&#160;<br/>AX register&#160;(16-bit I/O),&#160;or the&#160;AL&#160;(8-bit I/O)&#160;register.&#160;The&#160;I/O port&#160;being read or&#160;written&#160;to is&#160;specified with an&#160;<br/>immediate operand&#160;or an address&#160;in the&#160;DX&#160;register.&#160;<br/>The block&#160;I/O instructions (INS and&#160;OUTS)&#160;instructions&#160;move&#160;blocks of&#160;data (strings) between an I/O&#160;port&#160;and&#160;<br/>memory.&#160;These instructions operate similar to&#160;the string instructions&#160;(see<a href="o_7281d5ea06a5b67a-182.html">&#160;Section 7.3.9, ‚ÄúString Operations‚Äù). The&#160;<br/></a>ESI and EDI registers are used&#160;to specify string elements in&#160;memory and the repeat prefix&#160;(REP) is used&#160;to repeat&#160;<br/>the instructions to&#160;implement block&#160;moves. The&#160;assembler recognizes&#160;the following&#160;alternate&#160;mnemonics&#160;for these&#160;<br/>instructions:&#160;INSB&#160;(input byte), INSW (input&#160;word),&#160;and INSD&#160;(input doubleword),&#160;and OUTSB&#160;(output byte),&#160;<br/>OUTSW (output&#160;word), and OUTSD (output&#160;doubleword).<br/>The&#160;INS&#160;and OUTS&#160;instructions use&#160;an address&#160;in&#160;the DX register&#160;to specify&#160;the I/O&#160;port&#160;to be read or written&#160;to.</p>
<p style="position:absolute;top:839px;left:68px;white-space:nowrap" class="ft06">7.3.11&#160;</p>
<p style="position:absolute;top:839px;left:148px;white-space:nowrap" class="ft06">I/O Instructions in 64-Bit Mode</p>
<p style="position:absolute;top:869px;left:68px;white-space:nowrap" class="ft02">For&#160;I/O instructions to&#160;and from memory, the differences&#160;in&#160;64-bit&#160;mode&#160;are:</p>
<p style="position:absolute;top:891px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:892px;left:93px;white-space:nowrap" class="ft02">The&#160;source&#160;operand is&#160;specified by RSI or&#160;DS:ESI,&#160;depending on&#160;the address&#160;size attribute of the&#160;operation.&#160;</p>
<p style="position:absolute;top:913px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:914px;left:93px;white-space:nowrap" class="ft07">The&#160;destination operand&#160;is specified&#160;by RDI or&#160;DS:EDI, depending on the&#160;address size attribute&#160;of the&#160;<br/>operation.&#160;</p>
<p style="position:absolute;top:952px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:953px;left:93px;white-space:nowrap" class="ft02">Operation on 64-bit&#160;data&#160;is not encodable&#160;and&#160;REX prefixes are&#160;silently&#160;ignored.</p>
</div>
</body>
</html>
