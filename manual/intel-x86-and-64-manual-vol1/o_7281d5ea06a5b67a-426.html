<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 426</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:14px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:10px;font-family:Times;color:#1e191a;}
	.ft07{font-size:9px;font-family:Times;color:#1e191a;}
	.ft08{font-size:8px;font-family:Times;color:#1e191a;}
	.ft09{font-size:8px;font-family:Times;color:#1e191a;}
	.ft010{font-size:7px;font-family:Times;color:#1e191a;}
	.ft011{font-size:11px;font-family:Times;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft012{font-size:10px;font-family:Times;color:#000000;}
	.ft013{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft014{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft015{font-size:10px;line-height:14px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page426-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a426.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">D-4&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">GUIDELINES&#160;FOR WRITING X87 FPU EXCEPTION HANDLERS</p>
<p style="position:absolute;top:99px;left:68px;white-space:nowrap" class="ft02">D.2.1.2 &#160;</p>
<p style="position:absolute;top:99px;left:152px;white-space:nowrap" class="ft02">Recommended&#160;External&#160;Hardware&#160;to&#160;Support&#160;the MS-DOS*&#160;Compatibility Sub-mode</p>
<p style="position:absolute;top:127px;left:68px;white-space:nowrap" class="ft014"><a href="o_7281d5ea06a5b67a-426.html">Figure&#160;D-1 pro</a>vides an&#160;external circuit&#160;that will assure&#160;proper&#160;handling of FERR# and&#160;IGNNE#&#160;when&#160;an x87&#160;FPU&#160;<br/>exception occurs. In particular, it&#160;assures&#160;that&#160;IGNNE#&#160;will&#160;be&#160;active&#160;only inside&#160;the&#160;x87 FPU exception handler&#160;<br/>without depending on&#160;the order of actions by the&#160;exception handler.&#160;Some hardware implementations&#160;have&#160;been&#160;<br/>less robust&#160;because they&#160;have&#160;depended&#160;on the&#160;exception&#160;handler to&#160;clear&#160;the x87 FPU&#160;exception interrupt request&#160;<br/>to the PIC&#160;(FP_IRQ signal)&#160;<b>before</b>&#160;the handler causes FERR#&#160;to be de-asserted by&#160;clearing the&#160;exception from&#160;the&#160;<br/>x87&#160;FPU&#160;itself<a href="o_7281d5ea06a5b67a-427.html">. Figure&#160;D-2</a>&#160;shows the&#160;details&#160;of how&#160;IGNNE# will&#160;behave&#160;when&#160;the&#160;circuit in<a href="o_7281d5ea06a5b67a-426.html">&#160;Figure&#160;D-1&#160;is</a>&#160;imple-<br/>mented. The temporal regions within&#160;the x87 FPU&#160;exception&#160;handler activity&#160;are described as&#160;follows:<br/>1.&#160;The FERR# signal&#160;is activated by an&#160;x87 FPU exception and sends&#160;an interrupt&#160;request through the&#160;PIC to&#160;the&#160;</p>
<p style="position:absolute;top:267px;left:93px;white-space:nowrap" class="ft03">processor’s INTR pin.</p>
<p style="position:absolute;top:291px;left:68px;white-space:nowrap" class="ft03">2.&#160;During the&#160;x87&#160;FPU&#160;interrupt service&#160;routine&#160;(exception&#160;handler)&#160;the processor will need to&#160;clear the&#160;interrupt&#160;</p>
<p style="position:absolute;top:307px;left:93px;white-space:nowrap" class="ft013">request latch&#160;(Flip Flop #1). It may also&#160;want to execute non-control x87 FPU instructions&#160;before&#160;the exception&#160;<br/>is&#160;cleared&#160;from&#160;the&#160;x87&#160;FPU.&#160;For this purpose the&#160;IGNNE#&#160;must&#160;be&#160;driven low.&#160;Typically in the&#160;PC environment&#160;<br/>an I/O&#160;access&#160;to Port 0F0H clears&#160;the external&#160;x87 FPU&#160;exception interrupt&#160;request (FP_IRQ).&#160;In&#160;the&#160;<br/>recommended&#160;circuit, this access also is used&#160;to activate&#160;IGNNE#. With IGNNE#&#160;active,&#160;the x87 FPU exception&#160;<br/>handler may execute any&#160;x87 FPU&#160;instruction&#160;without being blocked&#160;by an active&#160;x87 FPU&#160;exception.</p>
<p style="position:absolute;top:397px;left:68px;white-space:nowrap" class="ft03">3.&#160;Clearing&#160;the exception&#160;within the&#160;x87&#160;FPU will cause&#160;the&#160;FERR# signal&#160;to be deactivated&#160;and then&#160;there&#160;is no&#160;</p>
<p style="position:absolute;top:414px;left:93px;white-space:nowrap" class="ft013">further need for IGNNE# to&#160;be&#160;active.&#160;In&#160;the recommended circuit, the&#160;deactivation&#160;of&#160;FERR#&#160;is used to&#160;<br/>deactivate IGNNE#.&#160;If another circuit&#160;is used,&#160;the software&#160;and circuit&#160;together must assure&#160;that IGNNE# is&#160;<br/>deactivated no&#160;later than&#160;the&#160;exit&#160;from the&#160;x87&#160;FPU exception handler.</p>
<p style="position:absolute;top:1031px;left:222px;white-space:nowrap" class="ft05">Figure&#160;D-1. &#160;Recommended&#160;Circuit&#160;for MS-DOS Compatibility&#160;x87 FPU</p>
<p style="position:absolute;top:1049px;left:387px;white-space:nowrap" class="ft05">Exception Handling</p>
<p style="position:absolute;top:607px;left:290px;white-space:nowrap" class="ft06">I/O Port F0H</p>
<p style="position:absolute;top:620px;left:289px;white-space:nowrap" class="ft06">Address Decode</p>
<p style="position:absolute;top:693px;left:344px;white-space:nowrap" class="ft07">FERR#</p>
<p style="position:absolute;top:902px;left:339px;white-space:nowrap" class="ft07">IGNNE#</p>
<p style="position:absolute;top:932px;left:352px;white-space:nowrap" class="ft07">INTR</p>
<p style="position:absolute;top:939px;left:498px;white-space:nowrap" class="ft06">Interrupt</p>
<p style="position:absolute;top:953px;left:496px;white-space:nowrap" class="ft06">Controller</p>
<p style="position:absolute;top:512px;left:539px;white-space:nowrap" class="ft07">RESET</p>
<p style="position:absolute;top:948px;left:570px;white-space:nowrap" class="ft08"><b>FP_IRQ</b></p>
<p style="position:absolute;top:870px;left:522px;white-space:nowrap" class="ft09">+5V</p>
<p style="position:absolute;top:846px;left:543px;white-space:nowrap" class="ft09">PR</p>
<p style="position:absolute;top:796px;left:500px;white-space:nowrap" class="ft09">+5V</p>
<p style="position:absolute;top:747px;left:539px;white-space:nowrap" class="ft09">+5V</p>
<p style="position:absolute;top:661px;left:506px;white-space:nowrap" class="ft09">+5V</p>
<p style="position:absolute;top:710px;left:543px;white-space:nowrap" class="ft09">PR</p>
<p style="position:absolute;top:793px;left:539px;white-space:nowrap" class="ft09">CLR</p>
<p style="position:absolute;top:683px;left:535px;white-space:nowrap" class="ft010"><b>FF #1</b></p>
<p style="position:absolute;top:818px;left:537px;white-space:nowrap" class="ft010"><b>FF #2</b></p>
<p style="position:absolute;top:872px;left:319px;white-space:nowrap" class="ft011">Intel486</p>
<p style="position:absolute;top:821px;left:319px;white-space:nowrap" class="ft011">™</p>
<p style="position:absolute;top:810px;left:319px;white-space:nowrap" class="ft011">&#160;Processor</p>
<p style="position:absolute;top:872px;left:336px;white-space:nowrap" class="ft011">Pentium</p>
<p style="position:absolute;top:819px;left:336px;white-space:nowrap" class="ft011">®</p>
<p style="position:absolute;top:812px;left:336px;white-space:nowrap" class="ft011">&#160;Processor</p>
<p style="position:absolute;top:872px;left:352px;white-space:nowrap" class="ft011">Pentium</p>
<p style="position:absolute;top:819px;left:352px;white-space:nowrap" class="ft011">®</p>
<p style="position:absolute;top:812px;left:352px;white-space:nowrap" class="ft011">&#160;Pro Processor</p>
<p style="position:absolute;top:972px;left:283px;white-space:nowrap" class="ft015">LEGEND:<br/>FF #n &#160; Flip Flop #n<br/>CLR &#160; &#160; Clear or Reset</p>
</div>
</body>
</html>
