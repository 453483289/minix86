<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 78</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:14px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#0860a8;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page78-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_7281d5ea06a5b67a078.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">3-18&#160;Vol. 1</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">BASIC EXECUTION ENVIRONMENT</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft07">For&#160;a detailed description of these flags:&#160;<a href="˛ˇ">see Chapter 3,&#160;‚ÄúProtected-Mode&#160;Memory Management,‚Äù</a>&#160;in the&#160;<i>Intel¬Æ 64&#160;<br/>and IA-32&#160;Architectures&#160;Software Developer‚Äôs&#160;Manual,&#160;Volume&#160;3A.</i>&#160;</p>
<p style="position:absolute;top:161px;left:68px;white-space:nowrap" class="ft04">3.4.3.4&#160;&#160;</p>
<p style="position:absolute;top:161px;left:152px;white-space:nowrap" class="ft04">RFLAGS Register in&#160;64-Bit Mode</p>
<p style="position:absolute;top:190px;left:68px;white-space:nowrap" class="ft08">In&#160;64-bit mode, EFLAGS is&#160;extended&#160;to 64 bits and&#160;called RFLAGS. The upper 32 bits of RFLAGS&#160;register&#160;is&#160;<br/>reserved. The lower 32&#160;bits&#160;of&#160;RFLAGS&#160;is&#160;the&#160;same&#160;as&#160;EFLAGS.</p>
<p style="position:absolute;top:261px;left:68px;white-space:nowrap" class="ft05">3.5 INSTRUCTION&#160;</p>
<p style="position:absolute;top:261px;left:281px;white-space:nowrap" class="ft05">POINTER</p>
<p style="position:absolute;top:298px;left:68px;white-space:nowrap" class="ft08">The instruction&#160;pointer (EIP)&#160;register contains the offset in&#160;the current code segment for the next instruction to&#160;be&#160;<br/>executed. It&#160;is advanced from&#160;one&#160;instruction&#160;boundary&#160;to&#160;the next&#160;in straight-line code or&#160;it is&#160;moved&#160;ahead&#160;or&#160;<br/>backwards by a&#160;number of instructions&#160;when&#160;executing JMP,&#160;J<i>cc</i>,&#160;CALL, RET,&#160;and&#160;IRET instructions.&#160;<br/>The EIP&#160;register cannot be accessed&#160;directly&#160;by&#160;software; it&#160;is&#160;controlled&#160;implicitly by control-transfer&#160;instructions&#160;<br/>(such as JMP,&#160;J<i>cc</i>,&#160;CALL,&#160;and&#160;RET),&#160;interrupts,&#160;and exceptions.&#160;The&#160;only&#160;way to read the&#160;EIP&#160;register is to&#160;execute&#160;a&#160;<br/>CALL instruction and&#160;then read&#160;the&#160;value of the&#160;return&#160;instruction pointer from&#160;the procedure&#160;stack.&#160;The EIP&#160;<br/>register can be loaded&#160;indirectly by&#160;modifying&#160;the value&#160;of&#160;a return instruction pointer on the&#160;procedure stack and&#160;<br/>executing a&#160;return instruction (RET&#160;or IRET). See<a href="o_7281d5ea06a5b67a-147.html">&#160;Section 6.2.4.2,&#160;‚ÄúReturn Instruction Pointer.‚Äù<br/></a>All IA-32 processors prefetch instructions.&#160;Because of&#160;instruction&#160;prefetching, an&#160;instruction&#160;address&#160;read&#160;from&#160;the&#160;<br/>bus during&#160;an instruction load does not&#160;match&#160;the&#160;value in&#160;the EIP&#160;register. Even though different processor gener-<br/>ations use&#160;different prefetching&#160;mechanisms, the&#160;function of&#160;the EIP&#160;register to direct program&#160;flow remains&#160;fully&#160;<br/>compatible&#160;with&#160;all software&#160;written&#160;to run on IA-32 processors.</p>
<p style="position:absolute;top:545px;left:68px;white-space:nowrap" class="ft06">3.5.1&#160;</p>
<p style="position:absolute;top:545px;left:148px;white-space:nowrap" class="ft06">Instruction Pointer in 64-Bit Mode</p>
<p style="position:absolute;top:575px;left:68px;white-space:nowrap" class="ft08">In 64-bit&#160;mode,&#160;the RIP register&#160;becomes&#160;the instruction pointer.&#160;This register&#160;holds the&#160;64-bit offset of the&#160;next&#160;<br/>instruction&#160;to be executed. 64-bit&#160;mode also&#160;supports&#160;a&#160;technique&#160;called RIP-relative addressing.&#160;Using&#160;this tech-<br/>nique,&#160;the effective address&#160;is determined&#160;by adding&#160;a&#160;displacement&#160;to&#160;the RIP of the&#160;next instruction.</p>
<p style="position:absolute;top:664px;left:68px;white-space:nowrap" class="ft05">3.6&#160;</p>
<p style="position:absolute;top:664px;left:147px;white-space:nowrap" class="ft05">OPERAND-SIZE&#160;AND ADDRESS-SIZE&#160;ATTRIBUTES</p>
<p style="position:absolute;top:700px;left:68px;white-space:nowrap" class="ft08">When the&#160;processor&#160;is executing in&#160;protected&#160;mode,&#160;every code segment has&#160;a default&#160;operand-size attribute&#160;and&#160;<br/>address-size attribute.&#160;These&#160;attributes are&#160;selected&#160;with&#160;the&#160;D&#160;(default size) flag in the segment descriptor for the&#160;<br/>code segmen<a href="˛ˇ">t (see Chapter&#160;3, ‚ÄúProtected-Mode&#160;Memory Management,‚Äù</a>&#160;in the&#160;<i>Intel¬Æ 64&#160;and IA-32 Architectures&#160;<br/>Software Developer‚Äôs Manual, Volume&#160;3A)</i>. When&#160;the D flag&#160;is set,&#160;the 32-bit&#160;operand-size and&#160;address-size attri-<br/>butes&#160;are selected; when&#160;the flag&#160;is clear,&#160;the 16-bit&#160;size&#160;attributes&#160;are selected. When&#160;the processor is&#160;executing&#160;<br/>in real-address mode, virtual-8086 mode,&#160;or&#160;SMM,&#160;the default&#160;operand-size and&#160;address-size attributes are&#160;always&#160;<br/>16 bits.<br/>The&#160;operand-size&#160;attribute&#160;selects the&#160;size&#160;of&#160;operands.&#160;When&#160;the 16-bit&#160;operand-size attribute is&#160;in force,&#160;oper-<br/>ands can generally be&#160;either&#160;8 bits or 16&#160;bits,&#160;and when the 32-bit operand-size&#160;attribute is&#160;in force,&#160;operands&#160;can&#160;<br/>generally be&#160;8&#160;bits&#160;or 32&#160;bits.<br/>The&#160;address-size&#160;attribute&#160;selects the&#160;sizes of addresses&#160;used&#160;to address&#160;memory:&#160;16 bits or&#160;32&#160;bits.&#160;When&#160;the 16-<br/>bit address-size&#160;attribute&#160;is in&#160;force, segment offsets&#160;and displacements&#160;are 16 bits.&#160;This restriction&#160;limits the&#160;size&#160;<br/>of&#160;a segment&#160;to 64 KBytes.&#160;When the 32-bit&#160;address-size&#160;attribute&#160;is in force,&#160;segment offsets and&#160;displacements&#160;<br/>are 32 bits,&#160;allowing&#160;up to&#160;4 GBytes&#160;to be addressed.<br/>The&#160;default operand-size&#160;attribute&#160;and/or address-size&#160;attribute&#160;can be&#160;overridden for a&#160;particular instruction by&#160;<br/>adding&#160;an operand-size&#160;and/or&#160;address-size&#160;prefix&#160;to an&#160;instruction. See&#160;<a href="˛ˇ">Chapter 2,&#160;‚ÄúInstruction&#160;Format,‚Äù</a>&#160;in the&#160;<br/><i>Intel¬Æ 64&#160;and&#160;IA-32 Architectures Software&#160;Developer‚Äôs&#160;Manual, Volume&#160;2A.</i>&#160;The&#160;effect&#160;of&#160;this&#160;prefix applies only&#160;<br/>to&#160;the targeted instruction.<br/><a href="o_7281d5ea06a5b67a-79.html">Table 3-4&#160;shows</a>&#160;effective operand&#160;size and address size&#160;(when executing in&#160;protected mode or compatibility mode)&#160;<br/>depending on&#160;the settings of the&#160;D&#160;flag&#160;and the&#160;operand-size and address-size&#160;prefixes.</p>
</div>
</body>
</html>
