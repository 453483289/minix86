<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 982</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page982-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce982.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">20-6&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">8086&#160;EMULATION</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft06">As in real-address mode,&#160;any new or legacy program that&#160;has been assembled and/or compiled to&#160;run on an Intel&#160;<br/>8086 processor will run in a&#160;virtual-8086-mode&#160;task.&#160;And&#160;several 8086&#160;programs&#160;can be&#160;run as virtual-8086-mode&#160;<br/>tasks&#160;concurrently&#160;with normal protected-mode tasks,&#160;using the&#160;processor’s multitasking facilities.</p>
<p style="position:absolute;top:808px;left:68px;white-space:nowrap" class="ft03">20.2.1&#160;</p>
<p style="position:absolute;top:808px;left:148px;white-space:nowrap" class="ft03">Enabling Virtual-8086 Mode</p>
<p style="position:absolute;top:838px;left:68px;white-space:nowrap" class="ft08">The processor runs in virtual-8086&#160;mode&#160;when the VM&#160;(virtual&#160;machine)&#160;flag in the EFLAGS&#160;register&#160;is set.&#160;This&#160;flag&#160;<br/>can only be&#160;set&#160;when&#160;the processor switches&#160;to a&#160;new&#160;protected-mode task or&#160;resumes virtual-8086&#160;mode via an&#160;<br/>IRET instruction.<br/>System&#160;software cannot change the&#160;state&#160;of&#160;the VM flag&#160;directly&#160;in&#160;the EFLAGS&#160;register (for example,&#160;by&#160;using the&#160;<br/>POPFD instruction). Instead it&#160;changes the&#160;flag&#160;in&#160;the image of the EFLAGS&#160;register stored in the TSS or on&#160;the&#160;<br/>stack&#160;following&#160;a call to&#160;an interrupt-&#160;or exception-handler procedure.&#160;For example,&#160;software sets the VM flag in the&#160;<br/>EFLAGS&#160;image in&#160;the TSS when first&#160;creating&#160;a virtual-8086&#160;task.<br/>The processor tests the&#160;VM&#160;flag under three&#160;general conditions:</p>
<p style="position:absolute;top:991px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:991px;left:93px;white-space:nowrap" class="ft02">When loading segment registers, to&#160;determine&#160;whether to&#160;use 8086-style address&#160;translation.</p>
<p style="position:absolute;top:1013px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:1014px;left:93px;white-space:nowrap" class="ft06">When&#160;decoding&#160;instructions,&#160;to determine&#160;which&#160;instructions&#160;are not supported&#160;in virtual-8086&#160;mode&#160;and&#160;which&#160;<br/>instructions are&#160;sensitive to&#160;IOPL.</p>
<p style="position:absolute;top:151px;left:255px;white-space:nowrap" class="ft05">Table 20-1. &#160;Real-Address Mode Exceptions and Interrupts</p>
<p style="position:absolute;top:175px;left:74px;white-space:nowrap" class="ft02">Vector&#160;</p>
<p style="position:absolute;top:190px;left:74px;white-space:nowrap" class="ft02">No.</p>
<p style="position:absolute;top:175px;left:146px;white-space:nowrap" class="ft02">Description</p>
<p style="position:absolute;top:175px;left:406px;white-space:nowrap" class="ft02">Real-Address Mode</p>
<p style="position:absolute;top:175px;left:541px;white-space:nowrap" class="ft02">Virtual-8086&#160;Mode</p>
<p style="position:absolute;top:175px;left:684px;white-space:nowrap" class="ft02">Intel&#160;8086 Processor</p>
<p style="position:absolute;top:214px;left:74px;white-space:nowrap" class="ft02">&#160;0</p>
<p style="position:absolute;top:214px;left:146px;white-space:nowrap" class="ft02">Divide Error&#160;(#DE)</p>
<p style="position:absolute;top:214px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:214px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:214px;left:684px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:238px;left:74px;white-space:nowrap" class="ft02">&#160;1</p>
<p style="position:absolute;top:238px;left:146px;white-space:nowrap" class="ft02">Debug&#160;Exception (#DB)</p>
<p style="position:absolute;top:238px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:238px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:238px;left:684px;white-space:nowrap" class="ft02">No</p>
<p style="position:absolute;top:262px;left:74px;white-space:nowrap" class="ft02">&#160;2</p>
<p style="position:absolute;top:262px;left:146px;white-space:nowrap" class="ft02">NMI Interrupt</p>
<p style="position:absolute;top:262px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:262px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:262px;left:684px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:286px;left:74px;white-space:nowrap" class="ft02">&#160;3</p>
<p style="position:absolute;top:286px;left:146px;white-space:nowrap" class="ft02">Breakpoint (#BP)</p>
<p style="position:absolute;top:286px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:286px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:286px;left:684px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:74px;white-space:nowrap" class="ft02">&#160;4</p>
<p style="position:absolute;top:310px;left:146px;white-space:nowrap" class="ft02">Overflow (#OF)</p>
<p style="position:absolute;top:310px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:310px;left:684px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:334px;left:74px;white-space:nowrap" class="ft02">&#160;5</p>
<p style="position:absolute;top:334px;left:146px;white-space:nowrap" class="ft02">BOUND&#160;Range Exceeded&#160;(#BR)</p>
<p style="position:absolute;top:334px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:334px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:334px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:358px;left:74px;white-space:nowrap" class="ft02">&#160;6</p>
<p style="position:absolute;top:358px;left:146px;white-space:nowrap" class="ft02">Invalid&#160;Opcode&#160;(#UD)</p>
<p style="position:absolute;top:358px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:358px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:358px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:382px;left:74px;white-space:nowrap" class="ft02">&#160;7</p>
<p style="position:absolute;top:382px;left:146px;white-space:nowrap" class="ft02">Device Not Available (#NM)</p>
<p style="position:absolute;top:382px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:382px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:382px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:406px;left:74px;white-space:nowrap" class="ft02">&#160;8</p>
<p style="position:absolute;top:406px;left:146px;white-space:nowrap" class="ft02">Double&#160;Fault (#DF)</p>
<p style="position:absolute;top:406px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:406px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:406px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:430px;left:74px;white-space:nowrap" class="ft02">&#160;9</p>
<p style="position:absolute;top:430px;left:146px;white-space:nowrap" class="ft02">(Intel reserved.&#160;Do not use.)</p>
<p style="position:absolute;top:430px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:430px;left:541px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:430px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:454px;left:74px;white-space:nowrap" class="ft02">10</p>
<p style="position:absolute;top:454px;left:146px;white-space:nowrap" class="ft02">Invalid TSS&#160;(#TS)</p>
<p style="position:absolute;top:454px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:454px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:454px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:478px;left:74px;white-space:nowrap" class="ft02">11</p>
<p style="position:absolute;top:478px;left:146px;white-space:nowrap" class="ft02">Segment Not Present (#NP)</p>
<p style="position:absolute;top:478px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:478px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:478px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:502px;left:74px;white-space:nowrap" class="ft02">12</p>
<p style="position:absolute;top:502px;left:146px;white-space:nowrap" class="ft02">Stack&#160;Fault (#SS)</p>
<p style="position:absolute;top:502px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:502px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:502px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:526px;left:74px;white-space:nowrap" class="ft02">13</p>
<p style="position:absolute;top:526px;left:146px;white-space:nowrap" class="ft02">General Protection&#160;(#GP)*</p>
<p style="position:absolute;top:526px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:526px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:526px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:550px;left:74px;white-space:nowrap" class="ft02">14</p>
<p style="position:absolute;top:550px;left:146px;white-space:nowrap" class="ft02">Page&#160;Fault (#PF)</p>
<p style="position:absolute;top:550px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:550px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:550px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:574px;left:74px;white-space:nowrap" class="ft02">15</p>
<p style="position:absolute;top:574px;left:146px;white-space:nowrap" class="ft02">(Intel reserved. Do&#160;not use.)</p>
<p style="position:absolute;top:574px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:574px;left:541px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:574px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:598px;left:74px;white-space:nowrap" class="ft02">16</p>
<p style="position:absolute;top:598px;left:146px;white-space:nowrap" class="ft02">Floating-Point&#160;Error (#MF)</p>
<p style="position:absolute;top:598px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:598px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:598px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:622px;left:74px;white-space:nowrap" class="ft02">17</p>
<p style="position:absolute;top:622px;left:146px;white-space:nowrap" class="ft02">Alignment Check&#160;(#AC)</p>
<p style="position:absolute;top:622px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:622px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:622px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:646px;left:74px;white-space:nowrap" class="ft02">18</p>
<p style="position:absolute;top:646px;left:146px;white-space:nowrap" class="ft02">Machine Check (#MC)</p>
<p style="position:absolute;top:646px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:646px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:646px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:670px;left:74px;white-space:nowrap" class="ft02">19-31</p>
<p style="position:absolute;top:670px;left:146px;white-space:nowrap" class="ft02">(Intel reserved.&#160;Do not use.)</p>
<p style="position:absolute;top:670px;left:406px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:670px;left:541px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:670px;left:684px;white-space:nowrap" class="ft02">Reserved</p>
<p style="position:absolute;top:694px;left:74px;white-space:nowrap" class="ft02">32-255</p>
<p style="position:absolute;top:694px;left:146px;white-space:nowrap" class="ft02">User&#160;Defined&#160;Interrupts</p>
<p style="position:absolute;top:694px;left:406px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:694px;left:541px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:694px;left:684px;white-space:nowrap" class="ft02">Yes</p>
<p style="position:absolute;top:718px;left:74px;white-space:nowrap" class="ft01">NOTE:</p>
<p style="position:absolute;top:737px;left:74px;white-space:nowrap" class="ft02">*&#160;&#160;In the real-address&#160;mode,&#160;vector 13 is the&#160;segment overrun&#160;exception.&#160;In&#160;protected and virtual-8086&#160;modes, this&#160;exception cov-</p>
<p style="position:absolute;top:754px;left:88px;white-space:nowrap" class="ft02">ers&#160;all general-protection error&#160;conditions,&#160;including traps&#160;to&#160;the&#160;virtual-8086 monitor from&#160;virtual-8086 mode.</p>
</div>
</body>
</html>
