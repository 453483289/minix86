<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 482</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page482-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce482.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">14-16&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">POWER AND THERMAL&#160;MANAGEMENT</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft08">A value&#160;of&#160;zero in IA32_THREAD_STALL indicates either&#160;HDC is&#160;not&#160;supported or&#160;the logical processor never&#160;<br/>serviced&#160;any forced HDC idle.&#160;A&#160;non-zero&#160;value&#160;in IA32_THREAD_STALL&#160;indicates the&#160;HDC&#160;forced-idle&#160;residency&#160;<br/>times of&#160;the&#160;logical processor.&#160;It&#160;also indicates the&#160;forced-idle&#160;cycles due to&#160;HDC that&#160;could appear&#160;as C0&#160;time to&#160;<br/>traditional OS accounting&#160;mechanisms&#160;(e.g. time-stamping OS&#160;idle/exit&#160;events).<br/>Software&#160;can read&#160;IA32_THREAD_STALL&#160;irrespective&#160;of&#160;the state of IA32_PKG_HDC_CTL&#160;and&#160;IA32_PM_CTL1,&#160;as&#160;<br/>long&#160;as CPUID.06H:EAX[bit 13] = 1.</p>
<p style="position:absolute;top:235px;left:68px;white-space:nowrap" class="ft03">14.5.4.2 &#160;&#160;Non-Architectural HDC Residency Counters</p>
<p style="position:absolute;top:263px;left:68px;white-space:nowrap" class="ft02">Processors&#160;that support HDC operation may&#160;provide&#160;the&#160;following&#160;model-specific HDC residency counters.</p>
<p style="position:absolute;top:300px;left:68px;white-space:nowrap" class="ft04">MSR_CORE_HDC_RESIDENCY</p>
<p style="position:absolute;top:326px;left:68px;white-space:nowrap" class="ft08">Software&#160;can track&#160;per-core HDC residency using&#160;the&#160;counter MSR_CORE_HDC_RESIDENCY. This&#160;counter incre-<br/>ments when the core is&#160;in&#160;C3 state or deeper (all logical processors in this&#160;core&#160;are&#160;idle due to either HDC&#160;or other&#160;<br/>mechanisms) and at&#160;least one&#160;of the&#160;logical&#160;processors&#160;is in HDC forced idle state.&#160;The layout&#160;of&#160;the&#160;<br/>MSR_CORE_HDC_RESIDENCY&#160;is sh<a href="o_fe12b1e2a880e0ce-482.html">own in Figure&#160;14-15</a>.&#160;Each&#160;processor core&#160;in a&#160;package&#160;has its&#160;own&#160;<br/>MSR_CORE_HDC_RESIDENCY&#160;MSR.&#160;The&#160;bit fields are&#160;described&#160;below:&#160;</p>
<p style="position:absolute;top:569px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:570px;left:93px;white-space:nowrap" class="ft08"><b>Core_Cx_Duty_Cycle_Cnt (bits 63:0, R/O)</b>&#160;— Stores&#160;accumulated HDC forced-idle&#160;cycle&#160;count&#160;of this&#160;<br/>processor&#160;core&#160;since&#160;last RESET.&#160;This&#160;counter increments at the&#160;same rate&#160;of&#160;the TSC.&#160;The count is updated only&#160;<br/>after core C-state exit from&#160;a forced idled C-state. At&#160;each update, the increment counts cycles when&#160;the&#160;core&#160;<br/>is&#160;in a&#160;Cx state&#160;(all&#160;its logical processor are&#160;idle) and&#160;at least&#160;one logical processor in&#160;this&#160;core&#160;was forced into&#160;<br/>idle state&#160;due to HDC. If&#160;CPUID.06H:EAX[bit 13] = 0, attempt&#160;to access this MSR will cause&#160;a #GP fault. Default&#160;<br/>= zero&#160;(0).&#160;</p>
<p style="position:absolute;top:676px;left:68px;white-space:nowrap" class="ft08">A value of&#160;zero in MSR_CORE_HDC_RESIDENCY&#160;indicates either HDC is not supported or this processor core never&#160;<br/>serviced&#160;any forced HDC idle.&#160;</p>
<p style="position:absolute;top:729px;left:68px;white-space:nowrap" class="ft04">MSR_PKG_HDC_SHALLOW_RESIDENCY</p>
<p style="position:absolute;top:756px;left:68px;white-space:nowrap" class="ft08">The&#160;counter MSR_PKG_HDC_SHALLOW_RESIDENCY allows&#160;software to&#160;track HDC residency time&#160;when&#160;the&#160;<br/>package&#160;is&#160;in&#160;C2&#160;state,&#160;all processor cores&#160;in the&#160;package&#160;are&#160;not&#160;active&#160;and&#160;at least&#160;one logical processor was&#160;<br/>forced into idle&#160;state due to&#160;HDC. The&#160;layout&#160;of&#160;the MSR_PKG_HDC_SHALLOW_RESIDENCY is&#160;shown in&#160;<br/><a href="o_fe12b1e2a880e0ce-482.html">Figure&#160;14-16.</a>&#160;There is&#160;one MSR_PKG_HDC_SHALLOW_RESIDENCY&#160;per package.&#160;The&#160;bit fields are described&#160;<br/>below:&#160;</p>
<p style="position:absolute;top:1000px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:1001px;left:93px;white-space:nowrap" class="ft08"><b>Pkg_Duty_Cycle_Cnt&#160;(bits 63:0, R/O)</b>&#160;—&#160;Stores&#160;accumulated&#160;HDC&#160;forced-idle cycle count of this&#160;processor&#160;<br/>core&#160;since last RESET.&#160;This&#160;counter&#160;increments at the&#160;same&#160;rate&#160;of&#160;the&#160;TSC.&#160;Package shallow residency&#160;may&#160;be&#160;<br/>implementation specific. In&#160;the initial implementation,&#160;the threshold is&#160;package&#160;C2-state.&#160;The count is&#160;<br/>updated only after&#160;package&#160;C2-state&#160;exit from a&#160;forced&#160;idled&#160;C-state.&#160;At&#160;each update,&#160;the&#160;increment counts&#160;</p>
<p style="position:absolute;top:516px;left:290px;white-space:nowrap" class="ft04">Figure&#160;14-15.&#160;&#160;MSR_CORE_HDC_RESIDENCY&#160;MSR</p>
<p style="position:absolute;top:948px;left:257px;white-space:nowrap" class="ft04">Figure&#160;14-16. &#160;MSR_PKG_HDC_SHALLOW_RESIDENCY MSR</p>
<p style="position:absolute;top:441px;left:267px;white-space:nowrap" class="ft07">63</p>
<p style="position:absolute;top:441px;left:667px;white-space:nowrap" class="ft07">0</p>
<p style="position:absolute;top:462px;left:367px;white-space:nowrap" class="ft00">Core_Cx_duty_cycle_cnt</p>
<p style="position:absolute;top:870px;left:267px;white-space:nowrap" class="ft07">63</p>
<p style="position:absolute;top:870px;left:667px;white-space:nowrap" class="ft07">0</p>
<p style="position:absolute;top:891px;left:367px;white-space:nowrap" class="ft00">Pkg_Duty_cycle_cnt</p>
</div>
</body>
</html>
