<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 639</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;font-family:Times;color:#0860a8;}
	.ft08{font-size:8px;font-family:Times;color:#000000;}
	.ft09{font-size:7px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft012{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
	.ft013{font-size:9px;line-height:14px;font-family:Times;color:#000000;}
	.ft014{font-size:7px;line-height:9px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page639-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce639.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-3</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft010">Number of performance monitoring counters available in&#160;a logical processor&#160;(each IA32_PERFEVTSELx MSR is&#160;<br/>paired&#160;to the corresponding IA32_PMCx&#160;MSR)</p>
<p style="position:absolute;top:139px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:139px;left:95px;white-space:nowrap" class="ft03">Number of bits supported&#160;in each&#160;IA32_PMCx&#160;</p>
<p style="position:absolute;top:161px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:162px;left:95px;white-space:nowrap" class="ft03">Number of architectural performance&#160;monitoring&#160;events supported&#160;in&#160;a logical processor</p>
<p style="position:absolute;top:186px;left:69px;white-space:nowrap" class="ft010">Software can&#160;use CPUID&#160;to discover&#160;architectural performance monitoring availability (CPUID.0AH). The&#160;architec-<br/>tural performance&#160;monitoring leaf&#160;provides&#160;an&#160;identifier&#160;corresponding&#160;to&#160;the version number of&#160;architectural&#160;<br/>performance monitoring available in&#160;the processor.<br/>The&#160;version identifier is&#160;retrieved&#160;by querying&#160;CPUID.0AH:EAX[bits&#160;7:0]&#160;(see&#160;<a href="˛ˇ">Chapter 3, ‚ÄúInstruction Set Refer-<br/>ence,&#160;A-L,‚Äù in&#160;</a>the&#160;<a href="˛ˇ"><i>Intel¬Æ 64&#160;and IA-32&#160;Architectures Software Developer‚Äôs&#160;Manual, Volume 2A</i></a>).&#160;If the version iden-<br/>tifier is&#160;greater than zero, architectural&#160;performance monitoring capability&#160;is supported. Software&#160;queries the&#160;<br/>CPUID.0AH for the version&#160;identifier&#160;first;&#160;it then&#160;analyzes&#160;the value returned&#160;in&#160;CPUID.0AH.EAX,&#160;CPUID.0AH.EBX&#160;<br/>to determine the&#160;facilities&#160;available.<br/>In&#160;the initial&#160;implementation of architectural performance&#160;monitoring;&#160;software can&#160;determine how&#160;many&#160;<br/>IA32_PERFEVTSELx/ IA32_PMCx MSR&#160;pairs are supported&#160;per&#160;core, the bit-width of PMC,&#160;and&#160;the number of&#160;archi-<br/>tectural&#160;performance monitoring events&#160;available.</p>
<p style="position:absolute;top:410px;left:69px;white-space:nowrap" class="ft05">18.2.1.1&#160;&#160;&#160;Architectural Performance Monitoring&#160;Version 1 Facilities</p>
<p style="position:absolute;top:439px;left:69px;white-space:nowrap" class="ft010">Architectural performance monitoring facilities include&#160;a&#160;set of&#160;performance&#160;monitoring counters and&#160;performance&#160;<br/>event&#160;select registers.&#160;These&#160;MSRs&#160;have the&#160;following&#160;properties:</p>
<p style="position:absolute;top:477px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:478px;left:95px;white-space:nowrap" class="ft010">IA32_PMCx MSRs&#160;start at&#160;address 0C1H&#160;and&#160;occupy&#160;a contiguous block of&#160;MSR&#160;address space;&#160;the&#160;number&#160;of&#160;<br/>MSRs&#160;per logical processor is&#160;reported&#160;using&#160;CPUID.0AH:EAX[15:8].</p>
<p style="position:absolute;top:516px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:517px;left:95px;white-space:nowrap" class="ft010">IA32_PERFEVTSELx&#160;MSRs&#160;start at&#160;address 186H and&#160;occupy&#160;a&#160;contiguous&#160;block of MSR&#160;address space.&#160;Each&#160;<br/>performance&#160;event&#160;select register is&#160;paired&#160;with a&#160;corresponding&#160;performance counter in&#160;the 0C1H address&#160;<br/>block.</p>
<p style="position:absolute;top:571px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:572px;left:95px;white-space:nowrap" class="ft010">The&#160;bit width of an IA32_PMCx&#160;MSR&#160;is reported&#160;using the&#160;CPUID.0AH:EAX[23:16].&#160;This the&#160;number of valid bits&#160;<br/>for read operation.&#160;On write operations, the&#160;lower-order&#160;32 bits of&#160;the&#160;MSR may&#160;be&#160;written&#160;with&#160;any value, and&#160;<br/>the high-order bits are&#160;sign-extended from the&#160;value of bit 31.&#160;</p>
<p style="position:absolute;top:627px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:628px;left:95px;white-space:nowrap" class="ft03">Bit field layout&#160;of&#160;IA32_PERFEVTSELx&#160;MSRs&#160;is defined&#160;architecturally.</p>
<p style="position:absolute;top:652px;left:69px;white-space:nowrap" class="ft03">Se<a href="o_fe12b1e2a880e0ce-639.html">e Figure&#160;18-1&#160;</a>for&#160;the bit field&#160;layout&#160;of&#160;IA32_PERFEVTSELx&#160;MSRs.&#160;The&#160;bit fields&#160;are:</p>
<p style="position:absolute;top:673px;left:69px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:674px;left:95px;white-space:nowrap" class="ft010"><b>Event select&#160;field (bits 0 through 7) ‚Äî&#160;</b>Selects the&#160;event logic&#160;unit used to&#160;detect&#160;microarchitectural&#160;<br/><a href="o_fe12b1e2a880e0ce-640.html">conditions (see Table 18-1,</a>&#160;for a&#160;list of&#160;architectural events&#160;and&#160;their&#160;8-bit&#160;codes).&#160;The set of values&#160;for&#160;this field&#160;<br/>is&#160;defined&#160;architecturally;&#160;each value corresponds&#160;to an event logic unit for&#160;use&#160;with an architectural&#160;<br/>performance&#160;event.&#160;The&#160;number&#160;of&#160;architectural&#160;events&#160;is queried&#160;using CPUID.0AH:EAX.&#160;A&#160;processor may&#160;<br/>support only&#160;a subset of&#160;pre-defined values.</p>
<p style="position:absolute;top:995px;left:287px;white-space:nowrap" class="ft07">Figure&#160;18-1.&#160;&#160;Layout&#160;of&#160;IA32_PERFEVTSELx MSRs</p>
<p style="position:absolute;top:800px;left:305px;white-space:nowrap" class="ft08">31</p>
<p style="position:absolute;top:881px;left:222px;white-space:nowrap" class="ft012">INV‚ÄîInvert counter mask<br/>EN‚ÄîEnable counters<br/>INT‚ÄîAPIC interrupt enable<br/>PC‚ÄîPin control</p>
<p style="position:absolute;top:801px;left:573px;white-space:nowrap" class="ft08">8&#160;7</p>
<p style="position:absolute;top:801px;left:673px;white-space:nowrap" class="ft08">0</p>
<p style="position:absolute;top:831px;left:603px;white-space:nowrap" class="ft08">Event&#160;Select</p>
<p style="position:absolute;top:936px;left:222px;white-space:nowrap" class="ft012">E‚ÄîEdge detect<br/>OS‚ÄîOperating system mode<br/>USR‚ÄîUser&#160;Mode</p>
<p style="position:absolute;top:823px;left:312px;white-space:nowrap" class="ft08">Counter Mask&#160;</p>
<p style="position:absolute;top:831px;left:447px;white-space:nowrap" class="ft09">E</p>
<p style="position:absolute;top:828px;left:396px;white-space:nowrap" class="ft014">E<br/>N</p>
<p style="position:absolute;top:821px;left:423px;white-space:nowrap" class="ft09">I</p>
<p style="position:absolute;top:831px;left:422px;white-space:nowrap" class="ft014">N<br/>T</p>
<p style="position:absolute;top:800px;left:431px;white-space:nowrap" class="ft08">19</p>
<p style="position:absolute;top:800px;left:469px;white-space:nowrap" class="ft08">16</p>
<p style="position:absolute;top:800px;left:444px;white-space:nowrap" class="ft08">18</p>
<p style="position:absolute;top:800px;left:481px;white-space:nowrap" class="ft08">15</p>
<p style="position:absolute;top:800px;left:456px;white-space:nowrap" class="ft08">17</p>
<p style="position:absolute;top:800px;left:419px;white-space:nowrap" class="ft08">20</p>
<p style="position:absolute;top:800px;left:406px;white-space:nowrap" class="ft08">21</p>
<p style="position:absolute;top:800px;left:393px;white-space:nowrap" class="ft08">22</p>
<p style="position:absolute;top:800px;left:381px;white-space:nowrap" class="ft08">23</p>
<p style="position:absolute;top:800px;left:368px;white-space:nowrap" class="ft08">24</p>
<p style="position:absolute;top:947px;left:612px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:821px;left:385px;white-space:nowrap" class="ft09">I</p>
<p style="position:absolute;top:831px;left:384px;white-space:nowrap" class="ft014">N<br/>V</p>
<p style="position:absolute;top:828px;left:434px;white-space:nowrap" class="ft014">P<br/>C</p>
<p style="position:absolute;top:821px;left:472px;white-space:nowrap" class="ft014">U<br/>S<br/>R</p>
<p style="position:absolute;top:828px;left:459px;white-space:nowrap" class="ft09">O</p>
<p style="position:absolute;top:837px;left:459px;white-space:nowrap" class="ft09">S</p>
<p style="position:absolute;top:830px;left:486px;white-space:nowrap" class="ft08">Unit Mask&#160;(UMASK)</p>
<p style="position:absolute;top:835px;left:321px;white-space:nowrap" class="ft08">(CMASK)</p>
<p style="position:absolute;top:800px;left:242px;white-space:nowrap" class="ft08">63</p>
</div>
</body>
</html>
