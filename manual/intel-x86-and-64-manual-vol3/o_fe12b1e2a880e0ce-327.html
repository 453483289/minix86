<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 327</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:9px;line-height:12px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page327-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce327.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;9-15</p>
<p style="position:absolute;top:47px;left:560px;white-space:nowrap" class="ft01">PROCESSOR&#160;MANAGEMENT&#160;AND INITIALIZATION</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:95px;white-space:nowrap" class="ft03">Load&#160;the necessary protected-mode&#160;system data structures&#160;into&#160;RAM.</p>
<p style="position:absolute;top:122px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:123px;left:95px;white-space:nowrap" class="ft06">Load&#160;the&#160;system registers with the&#160;necessary pointers to&#160;the data structures&#160;and the&#160;appropriate flag&#160;settings&#160;<br/>for protected-mode&#160;operation.</p>
<p style="position:absolute;top:161px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:162px;left:95px;white-space:nowrap" class="ft03">Switch&#160;the processor to&#160;protected mode.</p>
<p style="position:absolute;top:186px;left:69px;white-space:nowrap" class="ft07"><a href="o_fe12b1e2a880e0ce-327.html">Figure&#160;9-3 shows&#160;</a>the physical memory layout&#160;for&#160;the processor&#160;following&#160;a hardware reset and&#160;the starting point&#160;<br/>of this example.&#160;The EPROM that contains the&#160;initialization code resides at the&#160;upper&#160;end&#160;of the&#160;processor’s&#160;physical&#160;<br/>memory address&#160;range, starting at&#160;address FFFFFFFFH and&#160;going down from there.&#160;The address&#160;of the&#160;first&#160;instruc-<br/>tion&#160;to&#160;be executed is&#160;at FFFFFFF0H, the&#160;default starting address&#160;for&#160;the processor following a&#160;hardware reset.<br/>The main steps carried&#160;out&#160;in this example are&#160;summarized&#160;<a href="o_fe12b1e2a880e0ce-328.html">in Table&#160;9-5.</a>&#160;The&#160;source&#160;listing&#160;for&#160;the&#160;example&#160;(with&#160;<br/>the filename&#160;STARTUP.ASM) is given&#160;<a href="o_fe12b1e2a880e0ce-329.html">in Example 9-1.</a>&#160;The line numbers given&#160;<a href="o_fe12b1e2a880e0ce-328.html">in Table 9-5 refer to th</a>e&#160;source&#160;listing.<br/>The following&#160;are&#160;some additional notes&#160;concerning this&#160;example:</p>
<p style="position:absolute;top:322px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:322px;left:95px;white-space:nowrap" class="ft06">When&#160;the&#160;processor is&#160;switched&#160;into&#160;protected mode,&#160;the&#160;original code segment base-address&#160;value of&#160;<br/>FFFF0000H&#160;(located&#160;in the&#160;hidden part of&#160;the&#160;CS&#160;register)&#160;is retained&#160;and execution continues&#160;from the current&#160;<br/>offset in the&#160;EIP register. The&#160;processor will&#160;thus&#160;continue&#160;to execute&#160;code&#160;in the EPROM&#160;until&#160;a far jump&#160;or call&#160;<br/>is&#160;made&#160;to&#160;a new code&#160;segment, at&#160;which time, the&#160;base&#160;address in&#160;the CS&#160;register will be changed.</p>
<p style="position:absolute;top:394px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:394px;left:95px;white-space:nowrap" class="ft06">Maskable hardware interrupts&#160;are&#160;disabled&#160;after a hardware reset and should remain&#160;disabled&#160;until&#160;the&#160;<br/>necessary&#160;interrupt&#160;handlers have&#160;been&#160;installed. The&#160;NMI&#160;interrupt is&#160;not disabled following a&#160;reset. The NMI#&#160;<br/>pin must thus be&#160;inhibited from being asserted until an&#160;NMI handler has been loaded&#160;and made available&#160;to the&#160;<br/>processor.</p>
<p style="position:absolute;top:466px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:466px;left:95px;white-space:nowrap" class="ft06">The&#160;use of&#160;a&#160;temporary GDT allows simple transfer&#160;of&#160;tables from the&#160;EPROM&#160;to anywhere in&#160;the RAM&#160;area.&#160;A&#160;<br/>GDT entry&#160;is constructed&#160;with&#160;its base pointing to&#160;address 0&#160;and a&#160;limit of 4 GBytes.&#160;When&#160;the DS&#160;and ES&#160;<br/>registers are&#160;loaded with this descriptor,&#160;the&#160;temporary&#160;GDT is&#160;no&#160;longer&#160;needed and&#160;can be replaced by the&#160;<br/>application GDT.</p>
<p style="position:absolute;top:538px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:538px;left:95px;white-space:nowrap" class="ft06">This&#160;code&#160;loads&#160;one&#160;TSS and&#160;no LDTs. If&#160;more&#160;TSSs exist&#160;in the&#160;application, they&#160;must&#160;be&#160;loaded into RAM. If&#160;<br/>there are LDTs&#160;they&#160;may be loaded&#160;as well.</p>
<p style="position:absolute;top:1021px;left:319px;white-space:nowrap" class="ft04">Figure&#160;9-3. &#160;Processor State&#160;After Reset</p>
<p style="position:absolute;top:989px;left:533px;white-space:nowrap" class="ft05">0</p>
<p style="position:absolute;top:624px;left:534px;white-space:nowrap" class="ft05">FFFF FFFFH</p>
<p style="position:absolute;top:612px;left:451px;white-space:nowrap" class="ft00">After Reset</p>
<p style="position:absolute;top:639px;left:295px;white-space:nowrap" class="ft00">[CS.BASE+EIP]</p>
<p style="position:absolute;top:640px;left:534px;white-space:nowrap" class="ft05">FFFF FFF0H</p>
<p style="position:absolute;top:702px;left:265px;white-space:nowrap" class="ft00">EIP = 0000 FFF0H</p>
<p style="position:absolute;top:992px;left:288px;white-space:nowrap" class="ft00">[SP,&#160;DS, SS, ES]</p>
<p style="position:absolute;top:713px;left:534px;white-space:nowrap" class="ft05">FFFF 0000H</p>
<p style="position:absolute;top:676px;left:592px;white-space:nowrap" class="ft05">64K&#160;EPROM</p>
<p style="position:absolute;top:714px;left:265px;white-space:nowrap" class="ft08">CS.BASE =&#160;FFFF 0000H<br/>DS.BASE =&#160;0H<br/>ES.BASE = 0H<br/>SS.BASE = 0H<br/>ESP =&#160;0H</p>
</div>
</body>
</html>
