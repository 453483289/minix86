<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 177</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page177-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce177.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;5-25</p>
<p style="position:absolute;top:47px;left:763px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft02">2.&#160;Checks that the&#160;segment&#160;selector&#160;points&#160;to a segment descriptor&#160;that is&#160;within the descriptor table&#160;limit&#160;(GDT&#160;</p>
<p style="position:absolute;top:117px;left:95px;white-space:nowrap" class="ft02">or LDT).</p>
<p style="position:absolute;top:141px;left:69px;white-space:nowrap" class="ft04">3.&#160;Checks that the&#160;segment&#160;descriptor is&#160;a code,&#160;data, LDT,&#160;call gate,&#160;task gate,&#160;or TSS segment-descriptor type.<br/>4.&#160;If the&#160;segment&#160;is not&#160;a conforming code&#160;segment,&#160;checks if&#160;the segment descriptor&#160;is visible&#160;at&#160;the CPL&#160;(that&#160;</p>
<p style="position:absolute;top:181px;left:94px;white-space:nowrap" class="ft02">is, if&#160;the CPL&#160;and&#160;the RPL of the segment selector are&#160;less&#160;than&#160;or equal to the&#160;DPL).</p>
<p style="position:absolute;top:205px;left:69px;white-space:nowrap" class="ft02">5.&#160;If the&#160;privilege level&#160;and type checks&#160;pass, loads the&#160;second&#160;doubleword of&#160;the segment descriptor into&#160;the&#160;</p>
<p style="position:absolute;top:222px;left:94px;white-space:nowrap" class="ft05">destination&#160;register (masked by&#160;the&#160;value 00FXFF00H, where X indicates&#160;that&#160;the corresponding&#160;4 bits are&#160;<br/>undefined) and&#160;sets&#160;the&#160;ZF flag&#160;in the&#160;EFLAGS&#160;register.&#160;If&#160;the segment selector&#160;is&#160;not visible at&#160;the current&#160;<br/>privilege&#160;level&#160;or is&#160;an invalid type&#160;for the&#160;LAR instruction,&#160;the instruction does not&#160;modify&#160;the destination&#160;<br/>register and&#160;clears&#160;the&#160;ZF&#160;flag.</p>
<p style="position:absolute;top:295px;left:69px;white-space:nowrap" class="ft02">Once&#160;loaded&#160;in the&#160;destination register, software can&#160;preform additional checks&#160;on&#160;the access rights information.</p>
<p style="position:absolute;top:346px;left:69px;white-space:nowrap" class="ft03">5.10.2&#160;</p>
<p style="position:absolute;top:346px;left:149px;white-space:nowrap" class="ft03">Checking Read/Write Rights&#160;(VERR and VERW Instructions)</p>
<p style="position:absolute;top:376px;left:69px;white-space:nowrap" class="ft06">When&#160;the processor accesses&#160;any code or&#160;data segment&#160;it checks&#160;the read/write&#160;privileges&#160;assigned to the&#160;<br/>segment to&#160;verify that the&#160;intended&#160;read or&#160;write&#160;operation&#160;is allowed. Software&#160;can check&#160;read/write rights&#160;using&#160;<br/>the VERR&#160;(verify&#160;for reading)&#160;and&#160;VERW&#160;(verify for&#160;writing)&#160;instructions. Both these&#160;instructions specify the&#160;<br/>segment selector for the&#160;segment&#160;being checked.&#160;The&#160;instructions then&#160;perform&#160;the following operations:<br/>1.&#160;Check&#160;that the segment selector&#160;is not null.<br/>2.&#160;Checks that the&#160;segment&#160;selector&#160;points&#160;to a segment descriptor&#160;that is&#160;within the descriptor table&#160;limit&#160;(GDT&#160;</p>
<p style="position:absolute;top:490px;left:95px;white-space:nowrap" class="ft02">or LDT).</p>
<p style="position:absolute;top:514px;left:69px;white-space:nowrap" class="ft06">3.&#160;Checks that the&#160;segment&#160;descriptor is&#160;a code or&#160;data-segment descriptor type.<br/>4.&#160;If the&#160;segment&#160;is not&#160;a conforming code&#160;segment,&#160;checks if&#160;the segment descriptor&#160;is visible&#160;at&#160;the CPL&#160;(that&#160;</p>
<p style="position:absolute;top:555px;left:94px;white-space:nowrap" class="ft02">is, if&#160;the CPL&#160;and&#160;the RPL of the segment selector are&#160;less&#160;than&#160;or equal to the&#160;DPL).</p>
<p style="position:absolute;top:579px;left:69px;white-space:nowrap" class="ft05">5.&#160;Checks that the&#160;segment&#160;is readable (for the&#160;VERR&#160;instruction) or&#160;writable&#160;(for&#160;the VERW) instruction.<br/>The VERR instruction sets the&#160;ZF flag in the EFLAGS register if the segment is visible at the CPL&#160;and readable; the&#160;<br/>VERW&#160;sets the ZF flag&#160;if the&#160;segment&#160;is visible and&#160;writable.&#160;(Code segments are&#160;never&#160;writable.) The&#160;ZF flag&#160;is&#160;<br/>cleared&#160;if any&#160;of these&#160;checks fail.</p>
<p style="position:absolute;top:686px;left:69px;white-space:nowrap" class="ft03">5.10.3&#160;</p>
<p style="position:absolute;top:686px;left:149px;white-space:nowrap" class="ft03">Checking That the Pointer Offset&#160;Is Within Limits (LSL Instruction)</p>
<p style="position:absolute;top:717px;left:69px;white-space:nowrap" class="ft04">When&#160;the processor accesses&#160;any segment it&#160;performs a&#160;limit&#160;check to&#160;insure that the&#160;offset is&#160;within&#160;the&#160;limit of&#160;<br/>the segment.&#160;Software&#160;can perform this&#160;limit check&#160;using the&#160;LSL (load segment limit)&#160;instruction. Like&#160;the&#160;LAR&#160;<br/>instruction,&#160;the LSL instruction specifies&#160;the segment selector for the&#160;segment&#160;descriptor whose limit&#160;is to&#160;be&#160;<br/>checked and&#160;a destination register.&#160;The&#160;instruction&#160;then&#160;performs the&#160;following&#160;operations:<br/>1.&#160;Check&#160;that the segment selector&#160;is not null.<br/>2.&#160;Checks that the&#160;segment&#160;selector&#160;points&#160;to a segment descriptor&#160;that is&#160;within the descriptor table&#160;limit&#160;(GDT&#160;</p>
<p style="position:absolute;top:831px;left:95px;white-space:nowrap" class="ft02">or LDT).</p>
<p style="position:absolute;top:855px;left:69px;white-space:nowrap" class="ft06">3.&#160;Checks that the&#160;segment&#160;descriptor is&#160;a code, data,&#160;LDT,&#160;or TSS&#160;segment-descriptor type.<br/>4.&#160;If the&#160;segment&#160;is not&#160;a conforming code&#160;segment,&#160;checks if&#160;the segment descriptor&#160;is visible&#160;at&#160;the CPL&#160;(that&#160;</p>
<p style="position:absolute;top:895px;left:94px;white-space:nowrap" class="ft02">is, if&#160;the CPL&#160;and&#160;the RPL of the segment&#160;selector less&#160;than or equal to&#160;the DPL).</p>
<p style="position:absolute;top:919px;left:69px;white-space:nowrap" class="ft02">5.&#160;If the&#160;privilege&#160;level and type&#160;checks&#160;pass, loads the&#160;unscrambled&#160;limit&#160;(the limit&#160;scaled&#160;according&#160;to the setting&#160;</p>
<p style="position:absolute;top:936px;left:94px;white-space:nowrap" class="ft05">of the G flag in&#160;the&#160;segment descriptor)&#160;into the destination register&#160;and&#160;sets the ZF flag in the EFLAGS register.&#160;<br/>If&#160;the segment selector&#160;is not visible at&#160;the current&#160;privilege&#160;level&#160;or is&#160;an invalid type&#160;for the&#160;LSL&#160;instruction,&#160;<br/>the instruction does not&#160;modify&#160;the destination register and clears&#160;the&#160;ZF&#160;flag.</p>
<p style="position:absolute;top:993px;left:69px;white-space:nowrap" class="ft02">Once&#160;loaded&#160;in the&#160;destination register, software can&#160;compare&#160;the segment limit&#160;with the&#160;offset of a&#160;pointer.&#160;</p>
</div>
</body>
</html>
