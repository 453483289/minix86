<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1090</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1090-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1090.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">25-16&#160;Vol. 3C</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">VMX NON-ROOT&#160;OPERATION</p>
<p style="position:absolute;top:102px;left:119px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:144px;white-space:nowrap" class="ft03">If bit&#160;7&#160;of&#160;the entry is&#160;1,&#160;or if the entry is&#160;an EPT&#160;PTE,&#160;the entry maps&#160;a page.&#160;If the processor uses&#160;such&#160;</p>
<p style="position:absolute;top:117px;left:143px;white-space:nowrap" class="ft07">an entry&#160;to translate a&#160;guest-physical&#160;address, and&#160;if&#160;an access to&#160;that&#160;address causes an&#160;EPT violation,&#160;<br/>the EPT&#160;violation&#160;is convertible if&#160;and only if bit&#160;63&#160;of&#160;the entry is&#160;0.</p>
<p style="position:absolute;top:159px;left:119px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:157px;left:144px;white-space:nowrap" class="ft03">If bit&#160;7&#160;of the&#160;entry&#160;is 0 and&#160;the entry&#160;is not an&#160;EPT&#160;PTE, the&#160;entry&#160;references another EPT paging&#160;</p>
<p style="position:absolute;top:174px;left:143px;white-space:nowrap" class="ft07">structure.&#160;The processor does not&#160;use the&#160;value&#160;of bit&#160;63 of the&#160;entry to&#160;determine&#160;whether&#160;any&#160;<br/>subsequent EPT violation is&#160;convertible.</p>
<p style="position:absolute;top:214px;left:68px;white-space:nowrap" class="ft08">If an&#160;access to a guest-physical&#160;address causes&#160;an&#160;EPT violation,&#160;bit&#160;63 of exactly one of the EPT paging-structure&#160;<br/>entries used&#160;to translate that address is used&#160;to determine whether the EPT violation is convertible:&#160;either a entry&#160;<br/>that is not present (if the guest-physical address does not translate to a physical address) or an entry that maps a&#160;<br/>page&#160;(if it&#160;does).<br/>A convertible EPT violation instead causes&#160;a virtualization exception&#160;if&#160;the following all&#160;hold:</p>
<p style="position:absolute;top:310px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:310px;left:93px;white-space:nowrap" class="ft03">CR0.PE = 1;</p>
<p style="position:absolute;top:332px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:333px;left:93px;white-space:nowrap" class="ft03">the logical processor is&#160;not&#160;in the&#160;process&#160;of&#160;delivering&#160;an event through&#160;the IDT;&#160;and</p>
<p style="position:absolute;top:355px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:355px;left:93px;white-space:nowrap" class="ft03">the&#160;32&#160;bits&#160;at offset 4&#160;in the&#160;virtualization-exception information area&#160;are all 0.</p>
<p style="position:absolute;top:379px;left:68px;white-space:nowrap" class="ft07">Delivery of&#160;virtualization exceptions&#160;writes&#160;the&#160;value&#160;FFFFFFFFH&#160;to offset&#160;4 in&#160;the virtualization-exception informa-<br/>tion&#160;<a href="o_fe12b1e2a880e0ce-1090.html">area (see Section&#160;25.5.6.2). Thus, once&#160;</a>a virtualization&#160;exception&#160;occurs, another&#160;can&#160;occur only&#160;if&#160;software&#160;<br/>clears this&#160;field.</p>
<p style="position:absolute;top:457px;left:68px;white-space:nowrap" class="ft05">25.5.6.2 &#160;&#160;Virtualization-Exception&#160;Information</p>
<p style="position:absolute;top:485px;left:68px;white-space:nowrap" class="ft07">Virtualization&#160;exceptions save data&#160;into the&#160;virtualization-exception&#160;information area&#160;(see<a href="o_fe12b1e2a880e0ce-1062.html">&#160;Section 24.6.18)</a>.&#160;<br/><a href="o_fe12b1e2a880e0ce-1090.html">Table&#160;25-1 e</a>numerates the&#160;data&#160;saved&#160;and&#160;the&#160;format of the&#160;area.</p>
<p style="position:absolute;top:870px;left:68px;white-space:nowrap" class="ft05">25.5.6.3 &#160;&#160;Delivery&#160;of&#160;Virtualization Exceptions</p>
<p style="position:absolute;top:898px;left:68px;white-space:nowrap" class="ft07">After saving virtualization-exception&#160;information, the&#160;processor treats&#160;a virtualization&#160;exception as&#160;it does other&#160;<br/>exceptions:</p>
<p style="position:absolute;top:937px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:937px;left:93px;white-space:nowrap" class="ft07">If bit&#160;20&#160;(#VE)&#160;is 1&#160;in the&#160;exception bitmap in the&#160;VMCS, a&#160;virtualization exception&#160;causes a&#160;VM&#160;exit&#160;(see&#160;<br/>below). If&#160;the&#160;bit&#160;is 0,&#160;the virtualization&#160;exception is&#160;delivered using&#160;gate&#160;descriptor 20&#160;in the&#160;IDT.</p>
<p style="position:absolute;top:976px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:976px;left:93px;white-space:nowrap" class="ft07">Virtualization exceptions produce&#160;no error code. Delivery&#160;of a virtualization exception pushes no error code on&#160;<br/>the stack.</p>
<p style="position:absolute;top:1015px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:1015px;left:93px;white-space:nowrap" class="ft07">With&#160;respect to double&#160;faults, virtualization&#160;exceptions have&#160;the&#160;same&#160;severity&#160;as&#160;page&#160;faults.&#160;If&#160;delivery&#160;of&#160;a&#160;<br/>virtualization&#160;exception encounters&#160;a nested fault that&#160;is either contributory or&#160;a page fault, a&#160;double&#160;fault&#160;</p>
<p style="position:absolute;top:532px;left:221px;white-space:nowrap" class="ft06">Table&#160;25-1.&#160;&#160;Format&#160;of&#160;the&#160;Virtualization-Exception Information Area</p>
<p style="position:absolute;top:566px;left:77px;white-space:nowrap" class="ft03">Byte Offset</p>
<p style="position:absolute;top:566px;left:243px;white-space:nowrap" class="ft03">Contents</p>
<p style="position:absolute;top:594px;left:77px;white-space:nowrap" class="ft03">0</p>
<p style="position:absolute;top:594px;left:243px;white-space:nowrap" class="ft03">The&#160;32-bit value&#160;that&#160;would&#160;have&#160;been&#160;saved into&#160;the VMCS as an exit&#160;reason&#160;had a VM exit&#160;occurred&#160;</p>
<p style="position:absolute;top:611px;left:243px;white-space:nowrap" class="ft03">instead of&#160;the&#160;virtualization exception. For EPT violations, this value is&#160;48 (00000030H)</p>
<p style="position:absolute;top:639px;left:77px;white-space:nowrap" class="ft03">4</p>
<p style="position:absolute;top:639px;left:243px;white-space:nowrap" class="ft03">FFFFFFFFH</p>
<p style="position:absolute;top:668px;left:77px;white-space:nowrap" class="ft03">8</p>
<p style="position:absolute;top:668px;left:243px;white-space:nowrap" class="ft03">The&#160;64-bit value&#160;that&#160;would&#160;have&#160;been&#160;saved into&#160;the&#160;VMCS&#160;as an&#160;exit&#160;qualification had&#160;a VM&#160;exit&#160;</p>
<p style="position:absolute;top:684px;left:243px;white-space:nowrap" class="ft03">occurred&#160;instead of&#160;the virtualization&#160;exception</p>
<p style="position:absolute;top:713px;left:77px;white-space:nowrap" class="ft03">16</p>
<p style="position:absolute;top:713px;left:243px;white-space:nowrap" class="ft03">The&#160;64-bit value&#160;that&#160;would&#160;have&#160;been&#160;saved into&#160;the VMCS&#160;as&#160;a guest-linear address had a&#160;VM&#160;exit&#160;</p>
<p style="position:absolute;top:729px;left:243px;white-space:nowrap" class="ft03">occurred&#160;instead of&#160;the virtualization&#160;exception</p>
<p style="position:absolute;top:758px;left:77px;white-space:nowrap" class="ft03">24</p>
<p style="position:absolute;top:758px;left:243px;white-space:nowrap" class="ft03">The&#160;64-bit value&#160;that&#160;would&#160;have&#160;been&#160;saved into&#160;the VMCS&#160;as&#160;a guest-physical&#160;address&#160;had a&#160;VM&#160;</p>
<p style="position:absolute;top:774px;left:243px;white-space:nowrap" class="ft03">exit&#160;occurred instead of&#160;the&#160;virtualization exception</p>
<p style="position:absolute;top:803px;left:77px;white-space:nowrap" class="ft03">32</p>
<p style="position:absolute;top:803px;left:243px;white-space:nowrap" class="ft03">The current&#160;16-bit value&#160;of&#160;the&#160;EPTP&#160;index VM-execution&#160;control&#160;(see<a href="o_fe12b1e2a880e0ce-1062.html">&#160;Section 24.6.18 a</a>nd<a href="o_fe12b1e2a880e0ce-1088.html">&#160;Section&#160;</a></p>
<p style="position:absolute;top:819px;left:243px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-1088.html">25.5.5.3)</a></p>
</div>
</body>
</html>
