<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 602</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page602-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce602.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">17-28&#160;Vol. 3B</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">DEBUG,&#160;BRANCH&#160;PROFILE,&#160;TSC,&#160;AND RESOURCE&#160;MONITORING&#160;FEATURES</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">17.7.1 LBR&#160;</p>
<p style="position:absolute;top:98px;left:184px;white-space:nowrap" class="ft02">Stack</p>
<p style="position:absolute;top:129px;left:68px;white-space:nowrap" class="ft05">Processors based&#160;on Intel&#160;microarchitecture code name&#160;Nehalem provide 16 pairs of MSR&#160;to&#160;record&#160;last branch&#160;<br/>record information. The layout&#160;of&#160;each&#160;MSR pair is&#160;<a href="o_fe12b1e2a880e0ce-602.html">shown in Table&#160;17-8&#160;</a>and&#160;<a href="o_fe12b1e2a880e0ce-602.html">Table&#160;17-9</a>.</p>
<p style="position:absolute;top:495px;left:68px;white-space:nowrap" class="ft03">Processors based&#160;on Intel&#160;microarchitecture code name&#160;Nehalem have an&#160;LBR MSR Stack as&#160;shown in&#160;<a href="o_fe12b1e2a880e0ce-602.html">Table&#160;17-10.</a></p>
<p style="position:absolute;top:529px;left:277px;white-space:nowrap" class="ft04">Table&#160;17-10.&#160;&#160;LBR Stack&#160;Size&#160;and TOS&#160;Pointer&#160;Range</p>
<p style="position:absolute;top:667px;left:68px;white-space:nowrap" class="ft02">17.7.2&#160;</p>
<p style="position:absolute;top:667px;left:148px;white-space:nowrap" class="ft02">Filtering of&#160;Last&#160;Branch&#160;Records</p>
<p style="position:absolute;top:697px;left:68px;white-space:nowrap" class="ft05">MSR_LBR_SELECT is&#160;cleared to zero&#160;at&#160;RESET,&#160;and&#160;LBR&#160;filtering is&#160;disabled,&#160;i.e.&#160;all branches will be captured.&#160;<br/>MSR_LBR_SELECT provides&#160;bit&#160;fields&#160;to&#160;specify the&#160;conditions of subsets of branches that&#160;will&#160;not be&#160;captured&#160;in&#160;<br/>the LBR.&#160;The&#160;layout&#160;of MSR_LBR_SELECT is&#160;<a href="o_fe12b1e2a880e0ce-602.html">shown in&#160;Table&#160;17-11</a>.</p>
<p style="position:absolute;top:200px;left:297px;white-space:nowrap" class="ft04">Table&#160;17-8. &#160;&#160;MSR_LASTBRANCH_x_FROM_IP&#160;</p>
<p style="position:absolute;top:222px;left:72px;white-space:nowrap" class="ft03">Bit Field</p>
<p style="position:absolute;top:222px;left:191px;white-space:nowrap" class="ft03">Bit&#160;Offset</p>
<p style="position:absolute;top:222px;left:270px;white-space:nowrap" class="ft03">Access</p>
<p style="position:absolute;top:222px;left:332px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:244px;left:72px;white-space:nowrap" class="ft03">Data</p>
<p style="position:absolute;top:244px;left:191px;white-space:nowrap" class="ft03">47:0</p>
<p style="position:absolute;top:244px;left:270px;white-space:nowrap" class="ft03">R/O</p>
<p style="position:absolute;top:244px;left:332px;white-space:nowrap" class="ft03">This is&#160;the “branch from“ address.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-590.html">Section 17.4.8.1</a>&#160;for address&#160;format.</p>
<p style="position:absolute;top:267px;left:72px;white-space:nowrap" class="ft03">SIGN_EXt</p>
<p style="position:absolute;top:267px;left:191px;white-space:nowrap" class="ft03">62:48</p>
<p style="position:absolute;top:267px;left:270px;white-space:nowrap" class="ft03">R/0</p>
<p style="position:absolute;top:267px;left:332px;white-space:nowrap" class="ft03">Signed&#160;extension of&#160;bit 47 of&#160;this register.</p>
<p style="position:absolute;top:289px;left:72px;white-space:nowrap" class="ft03">MISPRED</p>
<p style="position:absolute;top:289px;left:191px;white-space:nowrap" class="ft03">63</p>
<p style="position:absolute;top:289px;left:270px;white-space:nowrap" class="ft03">R/O</p>
<p style="position:absolute;top:289px;left:332px;white-space:nowrap" class="ft03">When set, indicates either&#160;the target&#160;of&#160;the branch&#160;was mispredicted&#160;and/or&#160;the&#160;</p>
<p style="position:absolute;top:306px;left:332px;white-space:nowrap" class="ft03">direction (taken/non-taken) was mispredicted; otherwise,&#160;the&#160;target&#160;branch&#160;was&#160;</p>
<p style="position:absolute;top:322px;left:332px;white-space:nowrap" class="ft03">predicted.</p>
<p style="position:absolute;top:390px;left:307px;white-space:nowrap" class="ft04">Table 17-9. &#160;&#160;MSR_LASTBRANCH_x_TO_IP&#160;</p>
<p style="position:absolute;top:412px;left:72px;white-space:nowrap" class="ft03">Bit Field</p>
<p style="position:absolute;top:412px;left:191px;white-space:nowrap" class="ft03">Bit&#160;Offset</p>
<p style="position:absolute;top:412px;left:270px;white-space:nowrap" class="ft03">Access</p>
<p style="position:absolute;top:412px;left:332px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:435px;left:72px;white-space:nowrap" class="ft03">Data</p>
<p style="position:absolute;top:435px;left:191px;white-space:nowrap" class="ft03">47:0</p>
<p style="position:absolute;top:435px;left:270px;white-space:nowrap" class="ft03">R/O</p>
<p style="position:absolute;top:435px;left:332px;white-space:nowrap" class="ft03">This is&#160;the “branch to“ address. See<a href="o_fe12b1e2a880e0ce-590.html">&#160;Section 17.4.8.1 for address</a>&#160;format</p>
<p style="position:absolute;top:457px;left:72px;white-space:nowrap" class="ft03">SIGN_EXt</p>
<p style="position:absolute;top:457px;left:191px;white-space:nowrap" class="ft03">63:48</p>
<p style="position:absolute;top:457px;left:270px;white-space:nowrap" class="ft03">R/0</p>
<p style="position:absolute;top:457px;left:332px;white-space:nowrap" class="ft03">Signed&#160;extension of&#160;bit 47 of&#160;this register.</p>
<p style="position:absolute;top:568px;left:75px;white-space:nowrap" class="ft03">DisplayFamily_DisplayModel</p>
<p style="position:absolute;top:568px;left:333px;white-space:nowrap" class="ft03">Size&#160;of&#160;LBR Stack</p>
<p style="position:absolute;top:568px;left:586px;white-space:nowrap" class="ft03">Range of&#160;TOS Pointer</p>
<p style="position:absolute;top:591px;left:75px;white-space:nowrap" class="ft03">06_1AH</p>
<p style="position:absolute;top:591px;left:333px;white-space:nowrap" class="ft03">16</p>
<p style="position:absolute;top:591px;left:586px;white-space:nowrap" class="ft03">0 to 15</p>
<p style="position:absolute;top:779px;left:182px;white-space:nowrap" class="ft04">Table 17-11. &#160;&#160;MSR_LBR_SELECT&#160;for&#160;&#160;Intel microarchitecture&#160;code name Nehalem</p>
<p style="position:absolute;top:801px;left:74px;white-space:nowrap" class="ft03">Bit Field</p>
<p style="position:absolute;top:801px;left:192px;white-space:nowrap" class="ft03">Bit Offset</p>
<p style="position:absolute;top:801px;left:272px;white-space:nowrap" class="ft03">Access</p>
<p style="position:absolute;top:801px;left:333px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:823px;left:74px;white-space:nowrap" class="ft03">CPL_EQ_0</p>
<p style="position:absolute;top:823px;left:192px;white-space:nowrap" class="ft03">0</p>
<p style="position:absolute;top:823px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:823px;left:333px;white-space:nowrap" class="ft03">When&#160;set, do&#160;not capture branches occurring in&#160;ring&#160;0</p>
<p style="position:absolute;top:846px;left:74px;white-space:nowrap" class="ft03">CPL_NEQ_0</p>
<p style="position:absolute;top:846px;left:192px;white-space:nowrap" class="ft03">1</p>
<p style="position:absolute;top:846px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:846px;left:333px;white-space:nowrap" class="ft03">When&#160;set, do&#160;not capture branches occurring in&#160;ring&#160;&gt;0</p>
<p style="position:absolute;top:868px;left:74px;white-space:nowrap" class="ft03">JCC</p>
<p style="position:absolute;top:868px;left:192px;white-space:nowrap" class="ft03">2</p>
<p style="position:absolute;top:868px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:868px;left:333px;white-space:nowrap" class="ft03">When&#160;set, do&#160;not capture conditional branches</p>
<p style="position:absolute;top:891px;left:74px;white-space:nowrap" class="ft03">NEAR_REL_CALL</p>
<p style="position:absolute;top:891px;left:192px;white-space:nowrap" class="ft03">3</p>
<p style="position:absolute;top:891px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:891px;left:333px;white-space:nowrap" class="ft03">When set, do not capture near relative&#160;calls</p>
<p style="position:absolute;top:913px;left:74px;white-space:nowrap" class="ft03">NEAR_IND_CALL</p>
<p style="position:absolute;top:913px;left:192px;white-space:nowrap" class="ft03">4</p>
<p style="position:absolute;top:913px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:913px;left:333px;white-space:nowrap" class="ft03">When set, do not capture near indirect calls</p>
<p style="position:absolute;top:936px;left:74px;white-space:nowrap" class="ft03">NEAR_RET</p>
<p style="position:absolute;top:936px;left:192px;white-space:nowrap" class="ft03">5</p>
<p style="position:absolute;top:936px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:936px;left:333px;white-space:nowrap" class="ft03">When set, do not capture near returns</p>
<p style="position:absolute;top:958px;left:74px;white-space:nowrap" class="ft03">NEAR_IND_JMP</p>
<p style="position:absolute;top:958px;left:192px;white-space:nowrap" class="ft03">6</p>
<p style="position:absolute;top:958px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:958px;left:333px;white-space:nowrap" class="ft03">When set, do not capture near indirect jumps</p>
<p style="position:absolute;top:981px;left:74px;white-space:nowrap" class="ft03">NEAR_REL_JMP</p>
<p style="position:absolute;top:981px;left:192px;white-space:nowrap" class="ft03">7</p>
<p style="position:absolute;top:981px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:981px;left:333px;white-space:nowrap" class="ft03">When set, do not capture&#160;near&#160;relative&#160;jumps&#160;</p>
<p style="position:absolute;top:1003px;left:74px;white-space:nowrap" class="ft03">FAR_BRANCH</p>
<p style="position:absolute;top:1003px;left:192px;white-space:nowrap" class="ft03">8</p>
<p style="position:absolute;top:1003px;left:272px;white-space:nowrap" class="ft03">R/W</p>
<p style="position:absolute;top:1003px;left:333px;white-space:nowrap" class="ft03">When&#160;set, do&#160;not capture far&#160;branches</p>
<p style="position:absolute;top:1026px;left:74px;white-space:nowrap" class="ft03">Reserved</p>
<p style="position:absolute;top:1026px;left:192px;white-space:nowrap" class="ft03">63:9</p>
<p style="position:absolute;top:1026px;left:333px;white-space:nowrap" class="ft03">Must&#160;be&#160;zero</p>
</div>
</body>
</html>
