<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 671</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:8px;line-height:12px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page671-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce671.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-35</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:487px;left:69px;white-space:nowrap" class="ft02">18.8.1&#160;</p>
<p style="position:absolute;top:487px;left:149px;white-space:nowrap" class="ft02">Enhancements of&#160;Performance Monitoring in the Processor Core</p>
<p style="position:absolute;top:517px;left:69px;white-space:nowrap" class="ft03">The&#160;notable&#160;enhancements&#160;in the&#160;monitoring&#160;of performance events in&#160;the processor core&#160;include:</p>
<p style="position:absolute;top:539px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:540px;left:95px;white-space:nowrap" class="ft08">Four&#160;general purpose performance counters,&#160;IA32_PMCx, associated&#160;counter&#160;configuration&#160;MSRs,&#160;<br/>IA32_PERFEVTSELx,&#160;and global&#160;counter control MSR supporting simplified&#160;control of four counters. Each of the&#160;<br/>four performance&#160;counter&#160;can support processor event&#160;based sampling (PEBS)&#160;and thread-qualification of&#160;<br/>architectural and non-architectural performance events.&#160;Width&#160;of&#160;IA32_PMCx supported by hardware has been&#160;<br/>increased.&#160;The width of counter&#160;reported by CPUID.0AH:EAX[23:16]&#160;is 48 bits.&#160;The PEBS facility in Intel&#160;micro-<br/>architecture&#160;code&#160;name Nehalem has been enhanced&#160;to&#160;include new data format&#160;to&#160;capture additional infor-<br/>mation, such&#160;as&#160;load&#160;latency.</p>
<p style="position:absolute;top:660px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:661px;left:95px;white-space:nowrap" class="ft08">Load&#160;latency sampling facility.&#160;Average&#160;latency of memory load&#160;operation&#160;can be sampled&#160;using load-latency&#160;<br/>facility in&#160;processors&#160;based on Intel microarchitecture&#160;code&#160;name&#160;Nehalem. This&#160;field&#160;measures the&#160;load&#160;<br/>latency&#160;from&#160;load's&#160;first dispatch&#160;of till final data&#160;writeback&#160;from&#160;the memory subsystem. The&#160;latency is&#160;<br/>reported for retired&#160;demand&#160;load operations and in core&#160;cycles (it&#160;accounts for re-dispatches). This&#160;facility is&#160;<br/>used in conjunction&#160;with&#160;the&#160;PEBS&#160;facility.</p>
<p style="position:absolute;top:749px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:750px;left:95px;white-space:nowrap" class="ft08">Off-core response counting&#160;facility.&#160;This facility in&#160;the processor core&#160;allows&#160;software&#160;to&#160;count&#160;certain&#160;<br/>transaction&#160;responses&#160;between&#160;the processor core&#160;to sub-systems&#160;outside&#160;the processor core&#160;(uncore).&#160;<br/>Counting off-core&#160;response requires additional event qualification&#160;configuration facility&#160;in&#160;conjunction with&#160;<br/>IA32_PERFEVTSELx.&#160;Two off-core&#160;response MSRs are provided&#160;to use&#160;in conjunction with specific event&#160;codes&#160;<br/>that must&#160;be&#160;specified&#160;with IA32_PERFEVTSELx.</p>
<p style="position:absolute;top:860px;left:69px;white-space:nowrap" class="ft05">18.8.1.1 &#160;&#160;Processor Event Based Sampling (PEBS)</p>
<p style="position:absolute;top:888px;left:69px;white-space:nowrap" class="ft08">All four general-purpose performance&#160;counters,&#160;IA32_PMCx,&#160;can be used for PEBS if the&#160;performance event&#160;<br/>supports&#160;PEBS.&#160;Software uses&#160;IA32_MISC_ENABLE[7]&#160;and&#160;IA32_MISC_ENABLE[12] to&#160;detect whether the&#160;perfor-<br/>mance&#160;monitoring&#160;facility&#160;and&#160;PEBS&#160;functionality&#160;are&#160;supported in&#160;the processor.&#160;The&#160;MSR IA32_PEBS_ENABLE&#160;<br/>provides&#160;4 bits that&#160;software&#160;must use&#160;to enable&#160;which IA32_PMCx&#160;overflow condition will&#160;cause the&#160;PEBS record&#160;<br/>to be&#160;captured.&#160;<br/>Additionally, the&#160;PEBS record is&#160;expanded to&#160;allow latency&#160;information to&#160;be&#160;captured. The MSR&#160;<br/>IA32_PEBS_ENABLE provides 4 additional bits&#160;that software&#160;must use to enable latency data recording in the PEBS&#160;<br/>record&#160;upon the respective IA32_PMCx&#160;overflow condition.&#160;The&#160;layout of IA32_PEBS_ENABLE for processors&#160;based&#160;<br/>on Intel&#160;microarchitecture code name&#160;Nehalem is&#160;shown in&#160;<a href="o_fe12b1e2a880e0ce-672.html">Figure&#160;18-21.</a></p>
<p style="position:absolute;top:434px;left:289px;white-space:nowrap" class="ft06">Figure&#160;18-20.&#160;&#160;IA32_PERF_GLOBAL_STATUS MSR&#160;</p>
<p style="position:absolute;top:220px;left:205px;white-space:nowrap" class="ft010">CHG (R/W)<br/>OVF_PMI (R/W)</p>
<p style="position:absolute;top:148px;left:585px;white-space:nowrap" class="ft07">8&#160;7</p>
<p style="position:absolute;top:148px;left:688px;white-space:nowrap" class="ft07">0</p>
<p style="position:absolute;top:149px;left:473px;white-space:nowrap" class="ft07">32</p>
<p style="position:absolute;top:148px;left:645px;white-space:nowrap" class="ft07">3</p>
<p style="position:absolute;top:148px;left:671px;white-space:nowrap" class="ft07">1</p>
<p style="position:absolute;top:403px;left:237px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:148px;left:253px;white-space:nowrap" class="ft07">63</p>
<p style="position:absolute;top:148px;left:659px;white-space:nowrap" class="ft07">2</p>
<p style="position:absolute;top:148px;left:636px;white-space:nowrap" class="ft07">4</p>
<p style="position:absolute;top:149px;left:484px;white-space:nowrap" class="ft07">31</p>
<p style="position:absolute;top:148px;left:625px;white-space:nowrap" class="ft07">5</p>
<p style="position:absolute;top:148px;left:610px;white-space:nowrap" class="ft07">6</p>
<p style="position:absolute;top:148px;left:268px;white-space:nowrap" class="ft07">62</p>
<p style="position:absolute;top:148px;left:298px;white-space:nowrap" class="ft07">60</p>
<p style="position:absolute;top:148px;left:285px;white-space:nowrap" class="ft07">61</p>
<p style="position:absolute;top:295px;left:205px;white-space:nowrap" class="ft010">OVF_PC7 (R/O), if CCNT&gt;7<br/>OVF_PC6 (R/O), if CCNT&gt;6<br/>OVF_PC5 (R/O), if CCNT&gt;5<br/>OVF_PC4 (R/O), if CCNT&gt;4<br/>OVF_PC3&#160;(R/O)<br/>OVF_PC2&#160;(R/O)<br/>OVF_PC1&#160;(R/O)<br/>OVF_PC0&#160;(R/O)</p>
<p style="position:absolute;top:404px;left:335px;white-space:nowrap" class="ft07">RESET Value —&#160;00000000_00000000H</p>
<p style="position:absolute;top:253px;left:204px;white-space:nowrap" class="ft010">OVF_FC2 (R/O)<br/>OVF_FC1 (R/O)</p>
<p style="position:absolute;top:149px;left:437px;white-space:nowrap" class="ft07">353433</p>
<p style="position:absolute;top:278px;left:204px;white-space:nowrap" class="ft07">OVF_FC0 (R/O)</p>
<p style="position:absolute;top:405px;left:548px;white-space:nowrap" class="ft07">CCNT: CPUID.AH:EAX[15:8]</p>
</div>
</body>
</html>
