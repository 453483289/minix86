<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 156</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:7px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:9px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft012{font-size:7px;line-height:9px;font-family:Times;color:#000000;}
	.ft013{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page156-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce156.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">5-4&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft010">IA-32e&#160;mode&#160;uses&#160;a previously&#160;unused&#160;bit&#160;in the&#160;CS&#160;descriptor.&#160;Bit 53&#160;is&#160;defined as&#160;the&#160;64-bit&#160;(L) flag and&#160;is&#160;<br/>used to select&#160;between&#160;64-bit mode&#160;and compatibility mode&#160;when&#160;IA-32e&#160;mode is&#160;active (IA32_EFER.LMA = 1).&#160;<br/>S<a href="o_fe12b1e2a880e0ce-156.html">ee Figure&#160;5-2.<br/></a>—&#160;If&#160;CS.L&#160;=&#160;0 and IA-32e mode is&#160;active, the&#160;processor&#160;is running in&#160;compatibility&#160;mode. In this&#160;case, CS.D&#160;</p>
<p style="position:absolute;top:174px;left:119px;white-space:nowrap" class="ft09">selects the default size for data&#160;and&#160;addresses. If CS.D&#160;= 0,&#160;the default data and address&#160;size&#160;is 16&#160;bits. If&#160;<br/>CS.D&#160;= 1, the&#160;default&#160;data and address&#160;size is&#160;32&#160;bits.</p>
<p style="position:absolute;top:214px;left:93px;white-space:nowrap" class="ft03">—&#160;If CS.L&#160;= 1&#160;and&#160;IA-32e&#160;mode&#160;is active,&#160;the only valid&#160;setting&#160;is CS.D = 0.&#160;This setting indicates a&#160;default&#160;</p>
<p style="position:absolute;top:231px;left:119px;white-space:nowrap" class="ft09">operand&#160;size of 32&#160;bits&#160;and a&#160;default address size&#160;of&#160;64&#160;bits.&#160;The&#160;CS.L&#160;= 1&#160;and CS.D&#160;= 1&#160;bit combination is&#160;<br/>reserved&#160;for future&#160;use and a&#160;#GP fault&#160;will be generated&#160;on an attempt&#160;to use a&#160;code&#160;segment with these&#160;<br/>bits set in&#160;IA-32e&#160;mode.</p>
<p style="position:absolute;top:286px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:286px;left:93px;white-space:nowrap" class="ft03">In IA-32e mode,&#160;the CS&#160;descriptor’s DPL is&#160;used&#160;for&#160;execution&#160;privilege&#160;checks&#160;(as in legacy 32-bit&#160;mode).</p>
<p style="position:absolute;top:684px;left:68px;white-space:nowrap" class="ft04">5.3 LIMIT&#160;</p>
<p style="position:absolute;top:684px;left:202px;white-space:nowrap" class="ft04">CHECKING</p>
<p style="position:absolute;top:721px;left:68px;white-space:nowrap" class="ft09">The limit field&#160;of a segment descriptor prevents programs&#160;or&#160;procedures from addressing memory locations outside&#160;<br/>the segment.&#160;The effective value of the limit&#160;depends on the setting&#160;of the&#160;G&#160;(granularity)&#160;flag (see<a href="o_fe12b1e2a880e0ce-155.html">&#160;Figure&#160;5-1).</a>&#160;For&#160;<br/>data segments,&#160;the limit&#160;also depends on&#160;the&#160;E&#160;(expansion&#160;direction) flag&#160;and the&#160;B (default&#160;stack pointer&#160;size&#160;<br/>and/or upper&#160;bound)&#160;flag.&#160;The&#160;E&#160;flag&#160;is&#160;one&#160;of the&#160;bits&#160;in&#160;the&#160;type&#160;field when the segment&#160;descriptor is&#160;for&#160;a data-<br/>segment type.<br/>When the&#160;G flag&#160;is&#160;clear (byte&#160;granularity),&#160;the&#160;effective&#160;limit is&#160;the value&#160;of&#160;the 20-bit&#160;limit field in the&#160;segment&#160;<br/>descriptor. Here, the&#160;limit ranges&#160;from 0&#160;to&#160;FFFFFH (1&#160;MByte). When&#160;the G&#160;flag is&#160;set&#160;(4-KByte&#160;page granularity),&#160;<br/>the processor scales the&#160;value&#160;in the limit field by a factor of&#160;2</p>
<p style="position:absolute;top:839px;left:482px;white-space:nowrap" class="ft00">12</p>
<p style="position:absolute;top:844px;left:497px;white-space:nowrap" class="ft03">&#160;(4 KBytes). In this case,&#160;the&#160;effective&#160;limit ranges&#160;</p>
<p style="position:absolute;top:860px;left:68px;white-space:nowrap" class="ft09">from&#160;FFFH (4 KBytes) to FFFFFFFFH (4&#160;GBytes). Note that when&#160;scaling is used (G flag is&#160;set), the&#160;lower 12&#160;bits of&#160;<br/>a segment offset (address)&#160;are&#160;not&#160;checked against the&#160;limit; for example, note&#160;that if&#160;the&#160;segment limit is&#160;0,&#160;<br/>offsets 0&#160;through&#160;FFFH are&#160;still&#160;valid.<br/>For all types of&#160;segments except&#160;expand-down&#160;data segments, the effective limit is&#160;the&#160;last address that&#160;is allowed&#160;<br/>to be accessed&#160;in the&#160;segment, which&#160;is one&#160;less&#160;than the&#160;size,&#160;in bytes, of the&#160;segment. The&#160;processor causes&#160;a&#160;<br/>general-protection&#160;exception (or,&#160;if&#160;the segment is&#160;SS,&#160;a&#160;stack-fault&#160;exception) any&#160;time an&#160;attempt is&#160;made&#160;to&#160;<br/>access&#160;the following&#160;addresses&#160;in a&#160;segment:</p>
<p style="position:absolute;top:988px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:989px;left:93px;white-space:nowrap" class="ft03">A&#160;byte at&#160;an&#160;offset greater than&#160;the effective limit</p>
<p style="position:absolute;top:1011px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:1012px;left:93px;white-space:nowrap" class="ft03">A&#160;word at&#160;an offset greater&#160;than&#160;the (effective-limit –&#160;1)</p>
<p style="position:absolute;top:1033px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:1034px;left:93px;white-space:nowrap" class="ft03">A doubleword at&#160;an&#160;offset greater than the (effective-limit&#160;–&#160;3)</p>
<p style="position:absolute;top:1056px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:1057px;left:93px;white-space:nowrap" class="ft03">A&#160;quadword at&#160;an offset greater&#160;than&#160;the (effective-limit – 7)</p>
<p style="position:absolute;top:627px;left:248px;white-space:nowrap" class="ft05">Figure&#160;5-2. &#160;Descriptor&#160;Fields&#160;with&#160;Flags&#160;used&#160;in&#160;IA-32e&#160;Mode</p>
<p style="position:absolute;top:373px;left:240px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:373px;left:331px;white-space:nowrap" class="ft06">24&#160;23&#160;22&#160;21&#160;20&#160;19</p>
<p style="position:absolute;top:373px;left:431px;white-space:nowrap" class="ft06">16&#160;15</p>
<p style="position:absolute;top:373px;left:469px;white-space:nowrap" class="ft06">13</p>
<p style="position:absolute;top:373px;left:457px;white-space:nowrap" class="ft06">14</p>
<p style="position:absolute;top:373px;left:482px;white-space:nowrap" class="ft06">12&#160;11</p>
<p style="position:absolute;top:373px;left:536px;white-space:nowrap" class="ft06">8&#160;7</p>
<p style="position:absolute;top:373px;left:639px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:403px;left:446px;white-space:nowrap" class="ft06">P</p>
<p style="position:absolute;top:403px;left:344px;white-space:nowrap" class="ft06">G</p>
<p style="position:absolute;top:395px;left:464px;white-space:nowrap" class="ft012">D<br/>P</p>
<p style="position:absolute;top:414px;left:465px;white-space:nowrap" class="ft06">L</p>
<p style="position:absolute;top:395px;left:507px;white-space:nowrap" class="ft07">Type</p>
<p style="position:absolute;top:415px;left:484px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:403px;left:370px;white-space:nowrap" class="ft06">L</p>
<p style="position:absolute;top:403px;left:650px;white-space:nowrap" class="ft00">4</p>
<p style="position:absolute;top:439px;left:639px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:469px;left:650px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:395px;left:382px;white-space:nowrap" class="ft012">A<br/>V</p>
<p style="position:absolute;top:414px;left:383px;white-space:nowrap" class="ft06">L</p>
<p style="position:absolute;top:403px;left:357px;white-space:nowrap" class="ft06">D</p>
<p style="position:absolute;top:415px;left:534px;white-space:nowrap" class="ft06">A</p>
<p style="position:absolute;top:415px;left:520px;white-space:nowrap" class="ft06">R</p>
<p style="position:absolute;top:415px;left:508px;white-space:nowrap" class="ft06">C</p>
<p style="position:absolute;top:415px;left:497px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:347px;left:369px;white-space:nowrap" class="ft08"><b>Code-Segment&#160;Descriptor</b></p>
<p style="position:absolute;top:440px;left:239px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:518px;left:270px;white-space:nowrap" class="ft00">A</p>
<p style="position:absolute;top:548px;left:269px;white-space:nowrap" class="ft013">C<br/>D<br/>DPL</p>
<p style="position:absolute;top:518px;left:302px;white-space:nowrap" class="ft00">Accessed</p>
<p style="position:absolute;top:548px;left:301px;white-space:nowrap" class="ft013">Conforming<br/>Default<br/>Descriptor&#160;Privilege Level</p>
<p style="position:absolute;top:532px;left:484px;white-space:nowrap" class="ft013">G<br/>R</p>
<p style="position:absolute;top:532px;left:523px;white-space:nowrap" class="ft013">Granularity<br/>Readable</p>
<p style="position:absolute;top:533px;left:269px;white-space:nowrap" class="ft00">AVL&#160;Available to Sys. Programmer’s</p>
<p style="position:absolute;top:589px;left:269px;white-space:nowrap" class="ft00">L</p>
<p style="position:absolute;top:589px;left:303px;white-space:nowrap" class="ft00">64-Bit Flag</p>
<p style="position:absolute;top:559px;left:484px;white-space:nowrap" class="ft00">P Present</p>
</div>
</body>
</html>
