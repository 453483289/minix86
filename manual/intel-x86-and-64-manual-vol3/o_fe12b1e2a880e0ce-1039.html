<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1039</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1039-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1039.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;22-35</p>
<p style="position:absolute;top:47px;left:657px;white-space:nowrap" class="ft01">ARCHITECTURE&#160;COMPATIBILITY</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">22.37.1 Model-Specific&#160;</p>
<p style="position:absolute;top:98px;left:271px;white-space:nowrap" class="ft02">Registers</p>
<p style="position:absolute;top:129px;left:69px;white-space:nowrap" class="ft05">The Pentium processor introduced&#160;a&#160;set of model-specific&#160;registers&#160;(MSRs) for use&#160;in controlling hardware func-<br/>tions and&#160;performance monitoring.&#160;To&#160;access these MSRs, two new instructions were&#160;added&#160;to the&#160;IA-32 architec-<br/>ture:&#160;read&#160;MSR (RDMSR) and&#160;write MSR (WRMSR). The MSRs&#160;in&#160;the&#160;Pentium&#160;processor are not guaranteed&#160;to&#160;be&#160;<br/>duplicated&#160;or&#160;provided in the&#160;next generation&#160;IA-32 processors.<br/>The&#160;P6&#160;family processors greatly increased the&#160;number of&#160;MSRs available to&#160;software.&#160;S<a href="o_fe12b1e2a880e0ce-1281.html">ee Chapter&#160;35, ‚ÄúModel-<br/>Specific Registers (MSRs),‚Äù&#160;for a&#160;</a>complete&#160;list&#160;of&#160;the&#160;available&#160;MSRs.&#160;The&#160;new&#160;registers control&#160;the&#160;debug&#160;exten-<br/>sions, the performance counters, the&#160;machine-check exception capability,&#160;the&#160;machine-check architecture, and the&#160;<br/>MTRRs. These registers&#160;are accessible&#160;using the&#160;RDMSR&#160;and&#160;WRMSR instructions.&#160;Specific&#160;information on some&#160;of&#160;<br/>these new MSRs is&#160;provided in the following sections. As&#160;with the&#160;Pentium processor MSR, the P6 family processor&#160;<br/>MSRs are&#160;not guaranteed&#160;to be&#160;duplicated&#160;or provided&#160;in&#160;the next&#160;generation&#160;IA-32&#160;processors.</p>
<p style="position:absolute;top:335px;left:69px;white-space:nowrap" class="ft02">22.37.2&#160;&#160;RDMSR and WRMSR Instructions</p>
<p style="position:absolute;top:366px;left:69px;white-space:nowrap" class="ft07">The RDMSR (read model-specific register)&#160;and WRMSR&#160;(write&#160;model-specific register) instructions&#160;recognize a&#160;<br/>much larger number&#160;of&#160;model-specific registers&#160;in&#160;the P6&#160;family processors.&#160;(See ‚ÄúRDMSR‚ÄîRead&#160;from Model&#160;<br/>Specific Register‚Äù and&#160;‚ÄúWRMSR‚ÄîWrite&#160;to Model&#160;Specific Register‚Äù in the<a href="˛ˇ">&#160;<i>Intel¬Æ 64&#160;and IA-32 Architectures&#160;Soft-<br/>ware Developer‚Äôs Manual, Volumes&#160;2A, 2B, 2C&#160;&amp;&#160;2D</i>&#160;fo</a>r more&#160;information.)</p>
<p style="position:absolute;top:466px;left:69px;white-space:nowrap" class="ft02">22.37.3&#160;&#160;Memory Type Range Registers</p>
<p style="position:absolute;top:496px;left:69px;white-space:nowrap" class="ft05">Memory type&#160;range registers&#160;(MTRRs) are&#160;a new feature&#160;introduced into&#160;the IA-32 in&#160;the Pentium&#160;Pro&#160;processor.&#160;<br/>MTRRs allow the&#160;processor&#160;to optimize&#160;memory operations&#160;for&#160;different types of memory,&#160;such as&#160;RAM, ROM,&#160;<br/>frame buffer&#160;memory,&#160;and&#160;memory-mapped I/O.<br/>MTRRs are&#160;MSRs that contain&#160;an&#160;internal map of how&#160;physical&#160;address ranges are&#160;mapped&#160;to various types of&#160;<br/>memory. The&#160;processor uses&#160;this&#160;internal memory map&#160;to&#160;determine the&#160;cacheability of various physical memory&#160;<br/>locations and the&#160;optimal method of&#160;accessing memory locations. For&#160;example,&#160;if a memory location is specified in&#160;<br/>an&#160;MTRR&#160;as write-through&#160;memory,&#160;the processor handles accesses to&#160;this location&#160;as&#160;follows. It&#160;reads&#160;data&#160;from&#160;<br/>that&#160;location&#160;in&#160;lines&#160;and&#160;caches&#160;the&#160;read&#160;data&#160;or&#160;maps&#160;all writes to that location&#160;to&#160;the bus and updates&#160;the cache&#160;<br/>to maintain cache&#160;coherency.&#160;In mapping the&#160;physical&#160;address space with MTRRs, the&#160;processor&#160;recognizes&#160;five&#160;<br/>types of&#160;memory: uncacheable (UC), uncacheable,&#160;speculatable, write-combining&#160;(WC), write-through (WT),&#160;<br/>write-protected (WP),&#160;and&#160;writeback&#160;(WB).<br/>Earlier IA-32&#160;processors (such as&#160;the Intel486&#160;and&#160;Pentium&#160;processors)&#160;used&#160;the&#160;KEN#&#160;(cache&#160;enable) pin and&#160;<br/>external logic to&#160;maintain&#160;an&#160;external memory map&#160;and signal cacheable&#160;accesses&#160;to the&#160;processor.&#160;The&#160;MTRR&#160;<br/>mechanism simplifies hardware designs by&#160;eliminating&#160;the KEN#&#160;pin and the&#160;external logic required&#160;to&#160;drive it.<br/>Se<a href="o_fe12b1e2a880e0ce-313.html">e Chapter 9, ‚ÄúProcessor&#160;Management&#160;and Initialization,‚Äù&#160;</a>an<a href="˛ˇ">d Chapter 35, ‚ÄúModel-Specific&#160;Registers (MSRs),‚Äù</a>&#160;for&#160;<br/>more&#160;information on&#160;the&#160;MTRRs.</p>
<p style="position:absolute;top:817px;left:69px;white-space:nowrap" class="ft02">22.37.4&#160;&#160;Machine-Check Exception and Architecture</p>
<p style="position:absolute;top:847px;left:69px;white-space:nowrap" class="ft05">The Pentium processor introduced&#160;a&#160;new&#160;exception&#160;called&#160;the machine-check exception&#160;(#MC,&#160;interrupt&#160;18).&#160;This&#160;<br/>exception is&#160;used&#160;to detect hardware-related errors,&#160;such as&#160;a parity&#160;error on&#160;a read cycle.&#160;<br/>The&#160;P6&#160;family processors extend&#160;the&#160;types&#160;of errors&#160;that&#160;can be detected&#160;and that generate&#160;a&#160;machine-check&#160;<br/>exception.&#160;It also&#160;provides&#160;a new machine-check architecture for recording information&#160;about&#160;a machine-check&#160;<br/>error and provides&#160;extended&#160;recovery capability.<br/>The&#160;machine-check&#160;architecture provides several banks of&#160;reporting&#160;registers&#160;for recording machine-check errors.&#160;<br/>Each&#160;bank of registers&#160;is associated&#160;with a&#160;specific&#160;hardware unit in&#160;the processor.&#160;The primary&#160;focus&#160;of&#160;the&#160;<br/>machine&#160;checks is&#160;on bus&#160;and interconnect&#160;operations; however,&#160;checks are&#160;also&#160;made of translation lookaside&#160;<br/>buffer&#160;(TLB) and&#160;cache operations.<br/>The&#160;machine-check&#160;architecture can&#160;correct some&#160;errors automatically and allow for reliable restart of instruction&#160;<br/>execution. It also collects sufficient information for&#160;software to use in correcting other machine errors not corrected&#160;<br/>by hardware.</p>
</div>
</body>
</html>
