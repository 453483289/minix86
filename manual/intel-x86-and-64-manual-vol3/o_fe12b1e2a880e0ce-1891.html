<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1891</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1891-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1891.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:760px;white-space:nowrap" class="ft00">Vol. 3D&#160;41-81</p>
<p style="position:absolute;top:47px;left:654px;white-space:nowrap" class="ft01">SGX INSTRUCTION REFERENCES</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">EEXIT—Exits an Enclave</p>
<p style="position:absolute;top:248px;left:354px;white-space:nowrap" class="ft03">Instruction Operand&#160;Encoding</p>
<p style="position:absolute;top:333px;left:69px;white-space:nowrap" class="ft01">Description</p>
<p style="position:absolute;top:355px;left:69px;white-space:nowrap" class="ft06">The ENCLU[EEXIT] instruction exits the&#160;currently&#160;executing&#160;enclave and branches&#160;to&#160;the location&#160;specified in&#160;RBX.&#160;<br/>RCX receives the current AEP.&#160;If RBX is not within&#160;the&#160;CS&#160;(32-bit mode) or is&#160;not canonical (64-bit mode) a #GP(0)&#160;<br/>results.</p>
<p style="position:absolute;top:434px;left:331px;white-space:nowrap" class="ft03">EEXIT&#160;Memory&#160;Parameter Semantics</p>
<p style="position:absolute;top:519px;left:69px;white-space:nowrap" class="ft07">If RBX specifies&#160;an address&#160;that&#160;is inside the&#160;enclave,&#160;the instruction will&#160;complete normally.&#160;The&#160;fetch of the next&#160;<br/>instruction&#160;will occur&#160;in non-enclave&#160;mode, but will attempt&#160;to&#160;fetch from inside the&#160;enclave.&#160;This has the&#160;effect of&#160;<br/>abort page semantics&#160;on the&#160;next&#160;destination.<br/>If&#160;secrets&#160;are contained in&#160;any&#160;registers,&#160;it is&#160;responsibility of enclave software&#160;to clear those&#160;registers.<br/>If&#160;XCR0&#160;was modified on enclave&#160;entry,&#160;it&#160;is restored&#160;to&#160;the value it&#160;had&#160;at the&#160;time&#160;of the&#160;most recent&#160;EENTER&#160;or&#160;<br/>ERESUME.<br/>If the&#160;enclave&#160;is opt-out,&#160;RFLAGS.TF&#160;is loaded&#160;from&#160;the&#160;value previously&#160;saved on EENTER.&#160;<br/>Code&#160;and data breakpoints are&#160;unsuppressed.<br/>Performance monitoring counters&#160;are unsuppressed.</p>
<p style="position:absolute;top:715px;left:69px;white-space:nowrap" class="ft01">Concurrency Restrictions</p>
<p style="position:absolute;top:123px;left:78px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:139px;left:78px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:260px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:123px;left:316px;white-space:nowrap" class="ft04">64/32&#160;</p>
<p style="position:absolute;top:139px;left:316px;white-space:nowrap" class="ft04">bit Mode&#160;</p>
<p style="position:absolute;top:155px;left:316px;white-space:nowrap" class="ft04">Support</p>
<p style="position:absolute;top:123px;left:389px;white-space:nowrap" class="ft04">CPUID&#160;</p>
<p style="position:absolute;top:139px;left:389px;white-space:nowrap" class="ft04">Feature&#160;</p>
<p style="position:absolute;top:155px;left:389px;white-space:nowrap" class="ft04">Flag</p>
<p style="position:absolute;top:123px;left:456px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:175px;left:78px;white-space:nowrap" class="ft04">&#160;EAX = 04H</p>
<p style="position:absolute;top:175px;left:260px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:175px;left:316px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:175px;left:389px;white-space:nowrap" class="ft04">SGX1</p>
<p style="position:absolute;top:175px;left:456px;white-space:nowrap" class="ft04">This leaf&#160;function is used to&#160;exit an enclave.</p>
<p style="position:absolute;top:195px;left:78px;white-space:nowrap" class="ft04">ENCLU[EEXIT]</p>
<p style="position:absolute;top:271px;left:96px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:271px;left:236px;white-space:nowrap" class="ft04">EAX</p>
<p style="position:absolute;top:271px;left:451px;white-space:nowrap" class="ft04">RBX</p>
<p style="position:absolute;top:271px;left:699px;white-space:nowrap" class="ft04">RCX</p>
<p style="position:absolute;top:295px;left:108px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:295px;left:221px;white-space:nowrap" class="ft04">EEXIT&#160;(In)</p>
<p style="position:absolute;top:295px;left:353px;white-space:nowrap" class="ft04">Target&#160;address&#160;outside&#160;the&#160;enclave (In)</p>
<p style="position:absolute;top:295px;left:622px;white-space:nowrap" class="ft04">Address of&#160;the&#160;current AEP (In)</p>
<p style="position:absolute;top:457px;left:407px;white-space:nowrap" class="ft04">Target&#160;Address</p>
<p style="position:absolute;top:481px;left:345px;white-space:nowrap" class="ft04">&#160;Non-Enclave read&#160;and execute&#160;access</p>
<p style="position:absolute;top:754px;left:174px;white-space:nowrap" class="ft03">Table 41-54. &#160;Concurrency Restrictions&#160;of&#160;EEXIT with&#160;Intel® SGX&#160;Instructions - 1of&#160;2</p>
<p style="position:absolute;top:782px;left:85px;white-space:nowrap" class="ft05">Operation</p>
<p style="position:absolute;top:782px;left:181px;white-space:nowrap" class="ft05">EEXIT</p>
<p style="position:absolute;top:782px;left:257px;white-space:nowrap" class="ft05">EADD</p>
<p style="position:absolute;top:782px;left:314px;white-space:nowrap" class="ft05">EBLOCK</p>
<p style="position:absolute;top:776px;left:371px;white-space:nowrap" class="ft05">ECRE</p>
<p style="position:absolute;top:788px;left:374px;white-space:nowrap" class="ft05">ATE</p>
<p style="position:absolute;top:776px;left:412px;white-space:nowrap" class="ft05">EDBGRD/</p>
<p style="position:absolute;top:788px;left:426px;white-space:nowrap" class="ft05">WR</p>
<p style="position:absolute;top:776px;left:487px;white-space:nowrap" class="ft05">EENTER/</p>
<p style="position:absolute;top:788px;left:485px;white-space:nowrap" class="ft05">ERESUME</p>
<p style="position:absolute;top:782px;left:560px;white-space:nowrap" class="ft05">EEXTEND</p>
<p style="position:absolute;top:782px;left:627px;white-space:nowrap" class="ft05">EGETKEY</p>
<p style="position:absolute;top:782px;left:689px;white-space:nowrap" class="ft05">EINIT</p>
<p style="position:absolute;top:782px;left:737px;white-space:nowrap" class="ft05">ELDB/ELDU</p>
<p style="position:absolute;top:782px;left:814px;white-space:nowrap" class="ft05">EPA</p>
<p style="position:absolute;top:808px;left:115px;white-space:nowrap" class="ft05">Param&#160;Targ&#160;VA</p>
<p style="position:absolute;top:808px;left:213px;white-space:nowrap" class="ft05">SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:808px;left:407px;white-space:nowrap" class="ft05">Targ&#160;SECS&#160;TCS&#160;SSA&#160;SECS&#160;Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS&#160;Targ&#160;VA</p>
<p style="position:absolute;top:808px;left:782px;white-space:nowrap" class="ft05">SECS&#160;VA</p>
<p style="position:absolute;top:827px;left:72px;white-space:nowrap" class="ft05">EEXIT</p>
<p style="position:absolute;top:827px;left:115px;white-space:nowrap" class="ft05">TCS</p>
<p style="position:absolute;top:827px;left:244px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:273px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:305px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:368px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:469px;white-space:nowrap" class="ft05">N</p>
<p style="position:absolute;top:827px;left:496px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:555px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:585px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:617px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:689px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:723px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:753px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:782px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:827px;left:814px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:115px;white-space:nowrap" class="ft05">SSA</p>
<p style="position:absolute;top:847px;left:183px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:847px;left:244px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:273px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:305px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:368px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:469px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:496px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:847px;left:555px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:585px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:617px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:847px;left:689px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:723px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:753px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:782px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:847px;left:814px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:115px;white-space:nowrap" class="ft05">SECS</p>
<p style="position:absolute;top:866px;left:213px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:244px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:273px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:305px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:334px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:368px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:436px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:469px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:496px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:524px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:555px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:585px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:617px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:655px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:689px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:723px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:753px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:782px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:866px;left:814px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:917px;left:172px;white-space:nowrap" class="ft03">Table 41-55. &#160;Concurrency Restrictions&#160;of&#160;EEXIT with&#160;Intel® SGX&#160;Instructions&#160;-&#160;2&#160;of&#160;2</p>
<p style="position:absolute;top:946px;left:85px;white-space:nowrap" class="ft05">Operation</p>
<p style="position:absolute;top:946px;left:155px;white-space:nowrap" class="ft05">EREMOVE</p>
<p style="position:absolute;top:946px;left:221px;white-space:nowrap" class="ft05">EREPORT</p>
<p style="position:absolute;top:940px;left:284px;white-space:nowrap" class="ft05">ETRA</p>
<p style="position:absolute;top:952px;left:290px;white-space:nowrap" class="ft05">CK</p>
<p style="position:absolute;top:946px;left:348px;white-space:nowrap" class="ft05">EWB</p>
<p style="position:absolute;top:946px;left:421px;white-space:nowrap" class="ft05">EAUG</p>
<p style="position:absolute;top:946px;left:475px;white-space:nowrap" class="ft05">EMODPE</p>
<p style="position:absolute;top:946px;left:538px;white-space:nowrap" class="ft05">EMODPR</p>
<p style="position:absolute;top:946px;left:606px;white-space:nowrap" class="ft05">EMODT</p>
<p style="position:absolute;top:946px;left:680px;white-space:nowrap" class="ft05">EACCEPT</p>
<p style="position:absolute;top:946px;left:758px;white-space:nowrap" class="ft05">EACCEPTCOPY</p>
<p style="position:absolute;top:971px;left:117px;white-space:nowrap" class="ft05">Para</p>
<p style="position:absolute;top:983px;left:117px;white-space:nowrap" class="ft05">m</p>
<p style="position:absolute;top:971px;left:152px;white-space:nowrap" class="ft05">Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:971px;left:320px;white-space:nowrap" class="ft05">SRC&#160;VA</p>
<p style="position:absolute;top:971px;left:375px;white-space:nowrap" class="ft05">SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECI</p>
<p style="position:absolute;top:983px;left:500px;white-space:nowrap" class="ft05">NFO</p>
<p style="position:absolute;top:971px;left:530px;white-space:nowrap" class="ft05">Targ&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECI</p>
<p style="position:absolute;top:983px;left:690px;white-space:nowrap" class="ft05">NFO</p>
<p style="position:absolute;top:971px;left:719px;white-space:nowrap" class="ft05">SECS&#160;Targ&#160;SRC&#160;SECI</p>
<p style="position:absolute;top:983px;left:809px;white-space:nowrap" class="ft05">NFO</p>
<p style="position:absolute;top:1003px;left:74px;white-space:nowrap" class="ft05">EEXIT</p>
<p style="position:absolute;top:1003px;left:117px;white-space:nowrap" class="ft05">TCS</p>
<p style="position:absolute;top:1003px;left:152px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:213px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:281px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:320px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:347px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:436px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:469px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:500px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:530px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:595px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:660px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:690px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:751px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:780px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1003px;left:809px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:117px;white-space:nowrap" class="ft05">SSA</p>
<p style="position:absolute;top:1022px;left:152px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:281px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:320px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:347px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:436px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:469px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:500px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:1022px;left:530px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:595px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:660px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:690px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:1022px;left:751px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1022px;left:780px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:1022px;left:809px;white-space:nowrap" class="ft05">U</p>
<p style="position:absolute;top:1042px;left:117px;white-space:nowrap" class="ft05">SECS&#160;Y</p>
<p style="position:absolute;top:1042px;left:181px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:213px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:250px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:281px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:320px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:347px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:375px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:407px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:436px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:469px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:500px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:530px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:561px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:595px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:626px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:660px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:690px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:719px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:751px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:780px;white-space:nowrap" class="ft05">Y</p>
<p style="position:absolute;top:1042px;left:809px;white-space:nowrap" class="ft05">Y</p>
</div>
</body>
</html>
