<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1181</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:21px;font-family:Times;color:#0860a8;}
	.ft02{font-size:14px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#0860a8;}
	.ft06{font-size:18px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1181-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1181.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:769px;white-space:nowrap" class="ft00">Vol. 3C&#160;30-1</p>
<p style="position:absolute;top:96px;left:699px;white-space:nowrap" class="ft01">CHAPTER 30</p>
<p style="position:absolute;top:120px;left:502px;white-space:nowrap" class="ft01">VMX INSTRUCTION REFERENCE</p>
<p style="position:absolute;top:189px;left:432px;white-space:nowrap" class="ft02">NOTE</p>
<p style="position:absolute;top:214px;left:120px;white-space:nowrap" class="ft08">This chapter was previously&#160;located&#160;in the&#160;<a href="˛ˇ"><i>Intel¬Æ 64 and&#160;IA-32 Architectures Software Developer‚Äôs&#160;<br/>Manual, Volume&#160;2B</i>&#160;</a>as chapter 5.&#160;</p>
<p style="position:absolute;top:286px;left:68px;white-space:nowrap" class="ft05">30.1 OVERVIEW</p>
<p style="position:absolute;top:322px;left:68px;white-space:nowrap" class="ft010">This chapter describes the&#160;virtual-machine&#160;extensions&#160;(VMX) for the Intel&#160;64&#160;and IA-32 architectures.&#160;VMX is&#160;<br/>intended to&#160;support virtualization of&#160;processor hardware&#160;and a&#160;system&#160;software layer acting as&#160;a host to&#160;multiple&#160;<br/>guest software&#160;environments.&#160;The virtual-machine extensions&#160;(VMX)&#160;includes five instructions that&#160;manage the&#160;<br/>virtual-machine&#160;control structure&#160;(VMCS),&#160;four instructions&#160;that manage VMX&#160;operation, two TLB-management&#160;<br/>instructions, and two instructions for use&#160;by&#160;guest software. Additional details&#160;of VMX are de<a href="˛ˇ">scribed in Chapter 23&#160;<br/>through Chapter&#160;29.&#160;<br/></a>The behavior of&#160;the VMCS-maintenance&#160;instructions is&#160;summarized below:</p>
<p style="position:absolute;top:451px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:451px;left:93px;white-space:nowrap" class="ft09"><b>VMPTRLD ‚Äî&#160;</b>This instruction takes a single 64-bit&#160;source&#160;operand that&#160;is in memory. It&#160;makes the&#160;referenced&#160;<br/>VMCS active and&#160;current, loading the current-VMCS pointer&#160;with&#160;this operand and establishes&#160;the current VMCS&#160;<br/>based&#160;on the&#160;contents of VMCS-data area&#160;in the&#160;referenced VMCS region.&#160;Because this&#160;makes the referenced&#160;<br/>VMCS active, a logical processor may start maintaining on&#160;the&#160;processor some&#160;of the&#160;VMCS data for&#160;the VMCS.</p>
<p style="position:absolute;top:523px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:523px;left:93px;white-space:nowrap" class="ft09"><b>VMPTRST ‚Äî&#160;</b>This instruction takes a&#160;single&#160;64-bit destination&#160;operand that is&#160;in memory.&#160;The current-VMCS&#160;<br/>pointer is&#160;stored into the&#160;destination&#160;operand.</p>
<p style="position:absolute;top:562px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:562px;left:93px;white-space:nowrap" class="ft09"><b>VMCLEAR ‚Äî&#160;</b>This instruction takes a&#160;single&#160;64-bit operand&#160;that&#160;is&#160;in&#160;memory. The&#160;instruction sets&#160;the&#160;launch&#160;<br/>state of the VMCS&#160;referenced&#160;by&#160;the&#160;operand&#160;to ‚Äúclear‚Äù,&#160;renders that VMCS inactive, and ensures that data&#160;for&#160;<br/>the VMCS have&#160;been&#160;written to the VMCS-data area in&#160;the referenced&#160;VMCS&#160;region. If the operand is the same&#160;<br/>as&#160;the current-VMCS pointer,&#160;that&#160;pointer&#160;is made invalid.</p>
<p style="position:absolute;top:634px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:634px;left:93px;white-space:nowrap" class="ft09"><b>VMREAD ‚Äî&#160;</b>This instruction reads a&#160;component&#160;from&#160;a VMCS&#160;(the&#160;encoding&#160;of that field is&#160;given in a&#160;register&#160;<br/>operand)&#160;and stores&#160;it into&#160;a destination operand that&#160;may&#160;be&#160;a register or&#160;in memory.</p>
<p style="position:absolute;top:673px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:673px;left:93px;white-space:nowrap" class="ft09"><b>VMWRITE ‚Äî&#160;</b>This instruction writes a&#160;component to a VMCS (the&#160;encoding of that field is&#160;given in a&#160;register&#160;<br/>operand) from&#160;a source&#160;operand that&#160;may be a&#160;register or&#160;in&#160;memory.</p>
<p style="position:absolute;top:714px;left:68px;white-space:nowrap" class="ft03">The behavior of&#160;the VMX&#160;management&#160;instructions&#160;is summarized&#160;below:</p>
<p style="position:absolute;top:736px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:736px;left:93px;white-space:nowrap" class="ft09"><b>VMLAUNCH&#160;‚Äî&#160;</b>This instruction launches&#160;a virtual machine managed by&#160;the VMCS.&#160;A&#160;VM&#160;entry&#160;occurs, trans-<br/>ferring&#160;control to&#160;the VM.</p>
<p style="position:absolute;top:775px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:775px;left:93px;white-space:nowrap" class="ft09"><b>VMRESUME ‚Äî&#160;</b>This&#160;instruction resumes&#160;a virtual machine managed by&#160;the VMCS.&#160;A&#160;VM&#160;entry&#160;occurs, trans-<br/>ferring&#160;control to&#160;the VM.</p>
<p style="position:absolute;top:814px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:814px;left:93px;white-space:nowrap" class="ft07"><b>VMXOFF&#160;‚Äî&#160;</b>This instruction causes&#160;the&#160;processor&#160;to&#160;leave&#160;VMX&#160;operation.</p>
<p style="position:absolute;top:836px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:837px;left:93px;white-space:nowrap" class="ft09"><b>VMXON ‚Äî&#160;</b>This&#160;instruction takes a&#160;single&#160;64-bit source&#160;operand that&#160;is in&#160;memory. It&#160;causes&#160;a logical processor&#160;<br/>to&#160;enter VMX root&#160;operation&#160;and to&#160;use the&#160;memory&#160;referenced&#160;by&#160;the&#160;operand&#160;to&#160;support VMX&#160;operation.</p>
<p style="position:absolute;top:877px;left:68px;white-space:nowrap" class="ft03">The behavior of&#160;the VMX-specific&#160;TLB-management instructions is&#160;summarized below:</p>
<p style="position:absolute;top:899px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:900px;left:93px;white-space:nowrap" class="ft09"><b>INVEPT</b>&#160;<b>‚Äî</b>&#160;This instruction&#160;invalidates entries&#160;in the TLBs and paging-structure&#160;caches&#160;that were derived from&#160;<br/>extended&#160;page&#160;tables&#160;(EPT).</p>
<p style="position:absolute;top:938px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:939px;left:93px;white-space:nowrap" class="ft09"><b>INVVPID</b>&#160;<b>‚Äî</b>&#160;This&#160;instruction&#160;invalidates entries in&#160;the TLBs&#160;and paging-structure&#160;caches based&#160;on&#160;a Virtual-<br/>Processor Identifier (VPID).</p>
<p style="position:absolute;top:979px;left:68px;white-space:nowrap" class="ft010">None of&#160;the&#160;instructions above can&#160;be executed in&#160;compatibility&#160;mode; they generate&#160;invalid-opcode exceptions if&#160;<br/>executed&#160;in compatibility mode.<br/>The&#160;behavior of&#160;the&#160;guest-available&#160;instructions&#160;is summarized&#160;below:</p>
<p style="position:absolute;top:1042px;left:68px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:1042px;left:93px;white-space:nowrap" class="ft09"><b>VMCALL&#160;‚Äî&#160;</b>This instruction allows software&#160;in VMX non-root&#160;operation&#160;to call&#160;the&#160;VMM for service. A VM&#160;exit&#160;<br/>occurs, transferring&#160;control to&#160;the VMM.</p>
</div>
</body>
</html>
