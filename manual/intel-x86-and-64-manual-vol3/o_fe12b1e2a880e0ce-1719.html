<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1719</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1719-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1719.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3C&#160;36-35</p>
<p style="position:absolute;top:47px;left:685px;white-space:nowrap" class="ft01">INTEL®&#160;PROCESSOR TRACE</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft05">the trace.&#160;This&#160;is not an&#160;expected&#160;scenario.&#160;No CYC packets are&#160;generated during&#160;overflow,&#160;even&#160;if the&#160;cycle&#160;<br/>counter wraps.<br/>Note that, if&#160;cycle-accurate mode is enabled, the OVF packet&#160;will&#160;generate&#160;a CYC packet. Because&#160;the&#160;cycle&#160;counter&#160;<br/>counts during&#160;overflows, this&#160;CYC&#160;packet can provide the duration&#160;of the overflow. However,&#160;there is a risk&#160;that the&#160;<br/>cycle&#160;counter wrapped&#160;during&#160;the&#160;overflow,&#160;which could render this&#160;CYC misleading.</p>
<p style="position:absolute;top:223px;left:69px;white-space:nowrap" class="ft03">36.3.9 Operational&#160;</p>
<p style="position:absolute;top:223px;left:248px;white-space:nowrap" class="ft03">Errors</p>
<p style="position:absolute;top:252px;left:69px;white-space:nowrap" class="ft05">Errors are&#160;detected&#160;as a&#160;result of&#160;packet output&#160;configuration problems,&#160;which can&#160;include output&#160;alignment issues,&#160;<br/>ToPA&#160;reserved bit&#160;violations, or&#160;overlapping&#160;packet&#160;output&#160;with restricted&#160;memory<a href="o_fe12b1e2a880e0ce-1698.html">. See&#160;“ToPA Errors”&#160;</a><a href="o_fe12b1e2a880e0ce-1693.html">in Section&#160;<br/>36.2.6.2&#160;for d</a>etails on&#160;ToPA&#160;errors,&#160;and<a href="o_fe12b1e2a880e0ce-1699.html">&#160;Section 36.2.6.4&#160;for details</a>&#160;on&#160;restricted memory&#160;errors. Operational&#160;<br/>errors are&#160;only detected&#160;and&#160;signaled&#160;when&#160;TraceEn=1.<br/>When an&#160;operational&#160;error is&#160;detected, tracing is&#160;disabled&#160;and the&#160;error&#160;is logged. Specifically,&#160;<br/>IA32_RTIT_STATUS.Error&#160;is set,&#160;which will cause&#160;IA32_RTIT_STATUS.TriggerEn&#160;to be 0.&#160;This will disable&#160;genera-<br/>tion of all&#160;packets.&#160;Some&#160;causes of operational errors may&#160;lead&#160;to packet&#160;bytes being dropped.<br/>It&#160;should be noted that&#160;the timing&#160;of&#160;error detection&#160;may not be predictable.&#160;Errors are&#160;signaled when the&#160;<br/>processor&#160;encounters the&#160;problematic configuration.&#160;This could be&#160;as&#160;soon&#160;as packet&#160;generation&#160;is enabled but&#160;<br/>could&#160;also&#160;be later when the&#160;problematic&#160;entry or&#160;field needs&#160;to&#160;be used.&#160;<br/>Once&#160;an&#160;error is&#160;signaled, software&#160;should disable&#160;packet&#160;generation by clearing TraceEn, diagnose&#160;and fix the error&#160;<br/>condition,&#160;and clear IA32_RTIT_STATUS.Error.&#160;At&#160;this point,&#160;packet&#160;generation&#160;can be&#160;re-enabled.</p>
<p style="position:absolute;top:507px;left:69px;white-space:nowrap" class="ft04">36.4&#160;</p>
<p style="position:absolute;top:507px;left:148px;white-space:nowrap" class="ft04">TRACE PACKETS AND DATA TYPES</p>
<p style="position:absolute;top:541px;left:69px;white-space:nowrap" class="ft05">This section details the&#160;data&#160;packets generated by Intel Processor Trace. It&#160;is useful for&#160;developers&#160;writing the&#160;<br/>interpretation&#160;code&#160;that will decode&#160;the data packets&#160;and apply it&#160;to the&#160;traced source&#160;code.</p>
<p style="position:absolute;top:608px;left:69px;white-space:nowrap" class="ft03">36.4.1&#160;</p>
<p style="position:absolute;top:608px;left:149px;white-space:nowrap" class="ft03">Packet&#160;Relationships and Ordering</p>
<p style="position:absolute;top:637px;left:69px;white-space:nowrap" class="ft05">This section introduces the&#160;concept of packet “binding”,&#160;which involves determining the IP in a&#160;binary disassembly&#160;<br/>at which the change&#160;indicated&#160;by a given packet&#160;applies.&#160;Some&#160;packets have&#160;the associated IP as the payload (FUP,&#160;<br/>TIP), while&#160;for others the decoder need&#160;only search for the&#160;next instance of&#160;a&#160;particular instruction (or instructions)&#160;<br/>to bind the&#160;packet&#160;(TNT).&#160;However,&#160;in many&#160;cases, the&#160;decoder will need&#160;to consider&#160;the relationship&#160;between&#160;<br/>packets, and&#160;to use&#160;this packet&#160;context&#160;to determine how to&#160;bind&#160;the packet.<br/><a href="o_fe12b1e2a880e0ce-1720.html">Section&#160;36.4.2 b</a>elow provides&#160;detailed&#160;descriptions&#160;of&#160;the packets, including&#160;how&#160;packets bind to&#160;IPs in&#160;the disas-<br/>sembly, to other&#160;packets, or&#160;to nothing at&#160;all.&#160;Many&#160;packets listed are simple&#160;to bind,&#160;because&#160;they&#160;are&#160;generated&#160;<br/>in&#160;only a&#160;few scenarios. Those that require more consideration&#160;are typically part of&#160;“compound packet&#160;events”,&#160;such&#160;<br/>as&#160;interrupts, exceptions, and&#160;some instructions,&#160;where&#160;multiple packets&#160;are generated by&#160;a single&#160;operation&#160;<br/>(instruction&#160;or event).&#160;These&#160;compound packet&#160;events&#160;frequently begin&#160;with&#160;a FUP&#160;to indicate&#160;the&#160;source&#160;address&#160;<br/>(if it is not clear&#160;from the disassembly), and are concluded&#160;by a TIP or TIP.PGD&#160;packet&#160;that&#160;indicates the&#160;destination&#160;<br/>address (if one&#160;is&#160;provided). In&#160;this&#160;scenario,&#160;the FUP is&#160;said to&#160;be&#160;“coupled”&#160;with&#160;the&#160;TIP packet.<br/>Other packets&#160;could&#160;be&#160;in&#160;between&#160;the&#160;coupled FUP&#160;and&#160;TIP&#160;packet.&#160;Timing&#160;packets, such as&#160;TSC, MTC, CYC,&#160;or&#160;<br/>CBR,&#160;could arrive&#160;at&#160;any time, and&#160;hence&#160;could intercede&#160;in&#160;a compound packet&#160;event. If&#160;an operation changes&#160;CR3&#160;<br/>or the&#160;processor’s mode&#160;of execution,&#160;a&#160;state update&#160;packet&#160;(i.e.,&#160;PIP&#160;or MODE) is&#160;generated.&#160;The&#160;state&#160;changes&#160;<br/>indicated by these&#160;intermediate&#160;packets&#160;should be applied&#160;at&#160;the IP&#160;of the&#160;TIP*&#160;packet.&#160;A&#160;summary of&#160;compound&#160;<br/>packet&#160;events is provided<a href="o_fe12b1e2a880e0ce-1720.html">&#160;in Table&#160;36-15; see&#160;Section 36.4.2 for&#160;</a>more per-packet details an<a href="o_fe12b1e2a880e0ce-1749.html">d Section 36.7 for m</a>ore&#160;<br/>detailed packet generation&#160;examples.</p>
</div>
</body>
</html>
