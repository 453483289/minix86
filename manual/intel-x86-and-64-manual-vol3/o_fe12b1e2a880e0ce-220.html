<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 220</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:14px;font-family:Times;color:#0860a8;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page220-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce220.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-34&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INTERRUPT&#160;AND EXCEPTION&#160;HANDLING</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">Interrupt&#160;11—Segment Not Present (#NP)</p>
<p style="position:absolute;top:146px;left:68px;white-space:nowrap" class="ft03">Exception&#160;Class</p>
<p style="position:absolute;top:144px;left:206px;white-space:nowrap" class="ft04">Fault.</p>
<p style="position:absolute;top:185px;left:68px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:211px;left:68px;white-space:nowrap" class="ft07">Indicates&#160;that the&#160;present flag&#160;of&#160;a segment or&#160;gate&#160;descriptor&#160;is clear.&#160;The&#160;processor&#160;can&#160;generate this exception&#160;<br/>during any&#160;of&#160;the following operations:</p>
<p style="position:absolute;top:250px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:250px;left:93px;white-space:nowrap" class="ft07">While attempting to load&#160;CS, DS,&#160;ES, FS, or GS registers.&#160;[Detection of a&#160;not-present&#160;segment while loading the&#160;<br/>SS&#160;register&#160;causes&#160;a stack&#160;fault&#160;exception (#SS)&#160;to be generated.] This&#160;situation can&#160;occur&#160;while performing&#160;a&#160;<br/>task switch.</p>
<p style="position:absolute;top:305px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:306px;left:93px;white-space:nowrap" class="ft07">While&#160;attempting to&#160;load the LDTR&#160;using an LLDT&#160;instruction.&#160;Detection of a not-present LDT&#160;while loading the&#160;<br/>LDTR&#160;during&#160;a task switch&#160;operation&#160;causes an&#160;invalid-TSS&#160;exception (#TS) to&#160;be&#160;generated.</p>
<p style="position:absolute;top:344px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:345px;left:93px;white-space:nowrap" class="ft05">When&#160;executing&#160;the LTR instruction and&#160;the TSS is&#160;marked&#160;not present.</p>
<p style="position:absolute;top:367px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:367px;left:93px;white-space:nowrap" class="ft05">While attempting to use a&#160;gate&#160;descriptor or TSS that&#160;is marked&#160;segment-not-present, but is&#160;otherwise&#160;valid.</p>
<p style="position:absolute;top:391px;left:68px;white-space:nowrap" class="ft07">An operating&#160;system&#160;typically uses the&#160;segment-not-present&#160;exception to implement virtual memory at&#160;the&#160;<br/>segment level. If&#160;the exception&#160;handler loads the&#160;segment&#160;and returns, the&#160;interrupted&#160;program or&#160;task&#160;resumes&#160;<br/>execution.<br/>A not-present indication&#160;in a&#160;gate&#160;descriptor,&#160;however,&#160;does not indicate&#160;that&#160;a segment is&#160;not present (because&#160;<br/>gates&#160;do not correspond&#160;to&#160;segments). The operating&#160;system&#160;may use&#160;the present&#160;flag&#160;for gate descriptors&#160;to&#160;<br/>trigger&#160;exceptions of special&#160;significance to&#160;the operating&#160;system.<br/>A contributory&#160;exception&#160;or&#160;page fault that&#160;subsequently&#160;referenced&#160;a not-present segment would cause&#160;a double&#160;<br/>fault&#160;(#DF)&#160;to be generated instead of #NP.</p>
<p style="position:absolute;top:559px;left:68px;white-space:nowrap" class="ft03">Exception&#160;Error&#160;Code</p>
<p style="position:absolute;top:585px;left:68px;white-space:nowrap" class="ft07">An error code&#160;containing the segment selector index for the&#160;segment descriptor that caused&#160;the violation&#160;is pushed&#160;<br/>onto&#160;the stack of the exception&#160;handler.&#160;If&#160;the EXT flag&#160;is&#160;set, it&#160;indicates&#160;that the&#160;exception resulted&#160;from either:</p>
<p style="position:absolute;top:623px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:624px;left:93px;white-space:nowrap" class="ft07">an external event (NMI or INTR) that&#160;caused&#160;an interrupt, which subsequently&#160;referenced a&#160;not-present&#160;<br/>segment</p>
<p style="position:absolute;top:662px;left:68px;white-space:nowrap" class="ft06">•</p>
<p style="position:absolute;top:663px;left:93px;white-space:nowrap" class="ft05">a benign exception&#160;that&#160;subsequently&#160;referenced&#160;a not-present segment&#160;</p>
<p style="position:absolute;top:687px;left:68px;white-space:nowrap" class="ft07">The IDT&#160;flag is&#160;set&#160;if the&#160;error code refers&#160;to an&#160;IDT entry.&#160;This occurs&#160;when the IDT&#160;entry&#160;for an interrupt being&#160;<br/>serviced references&#160;a not-present gate.&#160;Such an&#160;event&#160;could&#160;be&#160;generated&#160;by an INT instruction or&#160;a hardware&#160;<br/>interrupt.</p>
<p style="position:absolute;top:757px;left:68px;white-space:nowrap" class="ft03">Saved Instruction&#160;Pointer</p>
<p style="position:absolute;top:783px;left:68px;white-space:nowrap" class="ft07">The saved contents&#160;of&#160;CS and EIP&#160;registers normally&#160;point&#160;to&#160;the instruction&#160;that&#160;generated&#160;the exception. If the&#160;<br/>exception occurred while&#160;loading segment descriptors&#160;for&#160;the&#160;segment selectors in&#160;a new TSS,&#160;the&#160;CS and EIP&#160;<br/>registers point&#160;to the&#160;first instruction in the new task.&#160;If&#160;the&#160;exception occurred&#160;while&#160;accessing a&#160;gate&#160;descriptor,&#160;<br/>the CS&#160;and EIP&#160;registers point to&#160;the instruction that invoked&#160;the access (for example&#160;a CALL&#160;instruction&#160;that&#160;refer-<br/>ences a&#160;call gate).</p>
<p style="position:absolute;top:886px;left:68px;white-space:nowrap" class="ft03">Program State&#160;Change</p>
<p style="position:absolute;top:912px;left:68px;white-space:nowrap" class="ft07">If the segment-not-present&#160;exception occurs as the&#160;result of loading a register&#160;(CS,&#160;DS, SS,&#160;ES, FS, GS, or LDTR),&#160;<br/>a program-state&#160;change&#160;does&#160;accompany the&#160;exception because the&#160;register is&#160;not loaded. Recovery from this&#160;<br/>exception is&#160;possible by simply&#160;loading&#160;the missing&#160;segment&#160;into memory&#160;and setting the present flag&#160;in the&#160;<br/>segment descriptor.<br/>If&#160;the segment-not-present&#160;exception occurs while&#160;accessing&#160;a&#160;gate&#160;descriptor,&#160;a&#160;program-state change&#160;does&#160;not&#160;<br/>accompany the&#160;exception.&#160;Recovery from this&#160;exception&#160;is&#160;possible merely&#160;by setting the&#160;present&#160;flag in&#160;the gate&#160;<br/>descriptor.<br/>If a&#160;segment-not-present exception occurs&#160;during a&#160;task&#160;switch, it&#160;can occur before or&#160;after the&#160;commit-to-new-<br/>task&#160;<a href="o_fe12b1e2a880e0ce-247.html">point (see Section 7.3, “Task Switching”). If&#160;</a>it occurs&#160;before the&#160;commit&#160;point, no&#160;program state change&#160;</p>
</div>
</body>
</html>
