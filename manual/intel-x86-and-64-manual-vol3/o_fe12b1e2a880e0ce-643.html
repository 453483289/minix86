<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 643</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:7px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:8px;line-height:13px;font-family:Times;color:#000000;}
	.ft011{font-size:7px;line-height:9px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page643-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce643.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-7</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:373px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:374px;left:95px;white-space:nowrap" class="ft08"><b>Enable field (lowest 2 bits within each 4-bit control)</b>&#160;— When&#160;bit&#160;0 is&#160;set, performance&#160;counting is&#160;<br/>enabled in&#160;the corresponding fixed-function performance counter&#160;to increment&#160;while&#160;the target condition&#160;<br/>associated&#160;with the architecture&#160;performance&#160;event&#160;occurred at&#160;ring 0.&#160;When&#160;bit 1&#160;is set,&#160;performance&#160;counting&#160;<br/>is&#160;enabled in&#160;the corresponding&#160;fixed-function performance counter&#160;to increment&#160;while&#160;the target condition&#160;<br/>associated&#160;with&#160;the&#160;architecture performance&#160;event occurred&#160;at ring greater than 0. Writing 0 to both bits stops&#160;<br/>the&#160;performance counter.&#160;Writing a&#160;value&#160;of 11B enables&#160;the&#160;counter to&#160;increment irrespective&#160;of privilege&#160;<br/>levels.</p>
<p style="position:absolute;top:495px;left:69px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:495px;left:95px;white-space:nowrap" class="ft08"><b>PMI field (the fourth bit within each&#160;4-bit control)</b>&#160;—&#160;When set,&#160;the logical processor generates&#160;an&#160;<br/>exception through its&#160;local APIC&#160;on&#160;overflow&#160;condition&#160;of the&#160;respective&#160;fixed-function&#160;counter.</p>
<p style="position:absolute;top:536px;left:69px;white-space:nowrap" class="ft08">IA32_PERF_GLOBAL_CTRL&#160;MSR provides single-bit&#160;controls to&#160;enable&#160;counting of each&#160;performance counter.&#160;<br/><a href="o_fe12b1e2a880e0ce-643.html">Figure 18-3</a>&#160;shows the&#160;layout of&#160;IA32_PERF_GLOBAL_CTRL.&#160;Each enable bit in IA32_PERF_GLOBAL_CTRL&#160;is&#160;<br/>AND’ed&#160;with&#160;the enable bits for all&#160;privilege&#160;levels in&#160;the&#160;respective&#160;IA32_PERFEVTSELx&#160;or&#160;<br/>IA32_PERF_FIXED_CTR_CTRL MSRs&#160;to start/stop the&#160;counting of respective&#160;counters. Counting is&#160;enabled if&#160;the&#160;<br/>AND’ed results&#160;is true;&#160;counting is&#160;disabled&#160;when the&#160;result&#160;is false.</p>
<p style="position:absolute;top:924px;left:69px;white-space:nowrap" class="ft08">The fixed-function performance counters supported&#160;by architectural performance version 2 is listed&#160;<a href="o_fe12b1e2a880e0ce-653.html">in Table&#160;18-8,&#160;<br/></a>the pairing between each fixed-function performance counter&#160;to&#160;an architectural&#160;performance&#160;event is also&#160;shown.<br/>IA32_PERF_GLOBAL_STATUS&#160;MSR provides&#160;single-bit&#160;status&#160;for software&#160;to&#160;query the overflow condition&#160;of&#160;each&#160;<br/>performance counter.&#160;IA32_PERF_GLOBAL_STATUS[bit 62] indicates overflow&#160;conditions of the&#160;DS area&#160;data&#160;<br/>buffer.&#160;IA32_PERF_GLOBAL_STATUS[bit 63] provides a&#160;CondChgd&#160;bit to&#160;indicate&#160;changes to&#160;the&#160;state&#160;of perfor-<br/>mance monitoring hardwa<a href="o_fe12b1e2a880e0ce-644.html">re. Figure 18-4 sh</a>ows the layout&#160;of IA32_PERF_GLOBAL_STATUS.&#160;A&#160;value of 1 in bits&#160;0,&#160;<br/>1,&#160;32&#160;through 34&#160;indicates a&#160;counter overflow&#160;condition has&#160;occurred in&#160;the associated&#160;counter.</p>
<p style="position:absolute;top:328px;left:280px;white-space:nowrap" class="ft05">Figure&#160;18-2.&#160;&#160;Layout&#160;of&#160;IA32_FIXED_CTR_CTRL&#160;MSR</p>
<p style="position:absolute;top:878px;left:269px;white-space:nowrap" class="ft05">Figure&#160;18-3. &#160;Layout&#160;of&#160;IA32_PERF_GLOBAL_CTRL&#160;MSR</p>
<p style="position:absolute;top:216px;left:226px;white-space:nowrap" class="ft010">Cntr2&#160;— Controls for IA32_FIXED_CTR2<br/>Cntr1&#160;— Controls for IA32_FIXED_CTR1<br/>PMI —&#160;Enable&#160;PMI&#160;on&#160;overflow<br/>Cntr0&#160;— Controls for IA32_FIXED_CTR0</p>
<p style="position:absolute;top:135px;left:577px;white-space:nowrap" class="ft06">8&#160;7</p>
<p style="position:absolute;top:135px;left:679px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:272px;left:226px;white-space:nowrap" class="ft06">ENABLE&#160;—&#160;0:&#160;disable; 1:&#160;OS;&#160;2:&#160;User;&#160;3:&#160;All ring&#160;levels</p>
<p style="position:absolute;top:158px;left:672px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:155px;left:638px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:164px;left:639px;white-space:nowrap" class="ft011">M<br/>I</p>
<p style="position:absolute;top:135px;left:532px;white-space:nowrap" class="ft06">11</p>
<p style="position:absolute;top:135px;left:637px;white-space:nowrap" class="ft06">3</p>
<p style="position:absolute;top:135px;left:518px;white-space:nowrap" class="ft06">12</p>
<p style="position:absolute;top:135px;left:663px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:295px;left:258px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:135px;left:246px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:135px;left:651px;white-space:nowrap" class="ft06">2</p>
<p style="position:absolute;top:159px;left:622px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:159px;left:571px;white-space:nowrap" class="ft011">E<br/>N</p>
<p style="position:absolute;top:135px;left:628px;white-space:nowrap" class="ft06">4</p>
<p style="position:absolute;top:135px;left:565px;white-space:nowrap" class="ft06">9</p>
<p style="position:absolute;top:135px;left:617px;white-space:nowrap" class="ft06">5</p>
<p style="position:absolute;top:155px;left:588px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:155px;left:535px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:163px;left:587px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:162px;left:534px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:173px;left:591px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:172px;left:536px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:767px;left:216px;white-space:nowrap" class="ft010">IA32_FIXED_CTR2 enable<br/>IA32_FIXED_CTR1 enable<br/>IA32_FIXED_CTR0 enable<br/>IA32_PMC1 enable</p>
<p style="position:absolute;top:686px;left:645px;white-space:nowrap" class="ft06">2&#160;1&#160;0</p>
<p style="position:absolute;top:823px;left:216px;white-space:nowrap" class="ft06">IA32_PMC0 enable</p>
<p style="position:absolute;top:687px;left:425px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:687px;left:413px;white-space:nowrap" class="ft06">32</p>
<p style="position:absolute;top:687px;left:399px;white-space:nowrap" class="ft06">33</p>
<p style="position:absolute;top:687px;left:387px;white-space:nowrap" class="ft06">34</p>
<p style="position:absolute;top:687px;left:374px;white-space:nowrap" class="ft06">35</p>
<p style="position:absolute;top:847px;left:247px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:686px;left:236px;white-space:nowrap" class="ft06">63</p>
</div>
</body>
</html>
