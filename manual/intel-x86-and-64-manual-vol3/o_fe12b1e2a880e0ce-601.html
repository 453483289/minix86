<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 601</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:8px;font-family:Times;color:#000000;}
	.ft08{font-size:12px;font-family:Times;color:#0860a8;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft010{font-size:8px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page601-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce601.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3B&#160;17-27</p>
<p style="position:absolute;top:47px;left:425px;white-space:nowrap" class="ft01">DEBUG, BRANCH&#160;PROFILE, TSC, AND RESOURCE MONITORING FEATURES</p>
<p style="position:absolute;top:97px;left:69px;white-space:nowrap" class="ft02">17.7&#160;</p>
<p style="position:absolute;top:97px;left:148px;white-space:nowrap" class="ft02">LAST&#160;BRANCH, INTERRUPT, AND&#160;EXCEPTION RECORDING FOR&#160;</p>
<p style="position:absolute;top:123px;left:147px;white-space:nowrap" class="ft02">PROCESSORS BASED ON INTEL® MICROARCHITECTURE CODE NAME&#160;</p>
<p style="position:absolute;top:148px;left:147px;white-space:nowrap" class="ft02">NEHALEM</p>
<p style="position:absolute;top:184px;left:69px;white-space:nowrap" class="ft03">The processors based&#160;on&#160;Intel</p>
<p style="position:absolute;top:182px;left:271px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:184px;left:282px;white-space:nowrap" class="ft03">&#160;microarchitecture code name&#160;Nehalem and Intel</p>
<p style="position:absolute;top:182px;left:612px;white-space:nowrap" class="ft04">®</p>
<p style="position:absolute;top:184px;left:623px;white-space:nowrap" class="ft03">&#160;microarchitecture&#160;code&#160;name&#160;</p>
<p style="position:absolute;top:201px;left:69px;white-space:nowrap" class="ft09">Westmere support last&#160;branch interrupt and&#160;exception recording. These capabilities are&#160;similar to&#160;those&#160;found in&#160;<br/>Intel Core&#160;2 processors and adds additional capabilities:</p>
<p style="position:absolute;top:239px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:240px;left:95px;white-space:nowrap" class="ft09"><b>Debug Trace&#160;and Branch&#160;Recording Control —&#160;</b>The&#160;IA32_DEBUGCTL MSR provides bit fields&#160;for&#160;software&#160;to&#160;<br/>configure mechanisms related to&#160;debug&#160;trace, branch recording, branch trace&#160;store,&#160;and performance counter&#160;<br/>operations. Se<a href="o_fe12b1e2a880e0ce-585.html">e&#160;Section&#160;17.4.1 for&#160;</a>a&#160;description of the&#160;flags. See&#160;<a href="o_fe12b1e2a880e0ce-601.html">Figure&#160;17-11 for&#160;</a>the MSR layout.&#160;</p>
<p style="position:absolute;top:295px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:295px;left:95px;white-space:nowrap" class="ft09"><b>Last&#160;branch record (LBR) stack —&#160;</b>There are&#160;16 MSR pairs that store the source and destination addresses&#160;<br/>related to recently executed branches.&#160;See<a href="o_fe12b1e2a880e0ce-602.html">&#160;Section&#160;17.7.1</a>.</p>
<p style="position:absolute;top:334px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:334px;left:95px;white-space:nowrap" class="ft09"><b>Monitoring&#160;and single-stepping&#160;of&#160;branches, exceptions, and interrupts&#160;—&#160;</b>See<a href="o_fe12b1e2a880e0ce-586.html">&#160;Section 17.4.2</a>&#160;and&#160;<br/><a href="o_fe12b1e2a880e0ce-587.html">Section 17.4.3. In&#160;</a>addition, the&#160;ability&#160;to freeze&#160;the LBR stack on&#160;a PMI request is&#160;available.</p>
<p style="position:absolute;top:373px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:373px;left:95px;white-space:nowrap" class="ft09"><b>Branch&#160;trace messages&#160;—&#160;</b>The IA32_DEBUGCTL&#160;MSR provides bit fields&#160;for software&#160;to enable&#160;each&#160;logical&#160;<br/>processor to generate&#160;branch trace&#160;messages.&#160;Se<a href="o_fe12b1e2a880e0ce-587.html">e Section 17.4.4.&#160;</a>However,&#160;not all&#160;BTM messages are&#160;<br/>observable using the&#160;Intel</p>
<p style="position:absolute;top:404px;left:270px;white-space:nowrap" class="ft07"><i>®</i></p>
<p style="position:absolute;top:406px;left:281px;white-space:nowrap" class="ft03">&#160;QPI&#160;link.</p>
<p style="position:absolute;top:428px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:429px;left:95px;white-space:nowrap" class="ft06"><b>Last&#160;exception records —&#160;</b>Se<a href="o_fe12b1e2a880e0ce-609.html">e Section 17.11.3.&#160;</a></p>
<p style="position:absolute;top:451px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:451px;left:95px;white-space:nowrap" class="ft06"><b>Branch&#160;trace store and CPL-qualified&#160;BTS —&#160;</b>S<a href="o_fe12b1e2a880e0ce-588.html">ee&#160;Section&#160;17.4.6 and</a><a href="o_fe12b1e2a880e0ce-587.html">&#160;Section 17.4.5.</a></p>
<p style="position:absolute;top:473px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:474px;left:95px;white-space:nowrap" class="ft06"><b>FREEZE_LBRS_ON_PMI flag (bit&#160;11) —&#160;</b>see<a href="o_fe12b1e2a880e0ce-588.html">&#160;Section 17.4.7&#160;</a>for legacy Freeze_LBRs_On_PMI&#160;operation.&#160;</p>
<p style="position:absolute;top:496px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:496px;left:95px;white-space:nowrap" class="ft09"><b>FREEZE_PERFMON_ON_PMI flag (bit&#160;12) —&#160;</b>see<a href="o_fe12b1e2a880e0ce-588.html">&#160;Section&#160;17.4.7 for&#160;</a>legacy&#160;Freeze_Perfmon_On_PMI&#160;<br/>operation.&#160;</p>
<p style="position:absolute;top:535px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:535px;left:95px;white-space:nowrap" class="ft09"><b>UNCORE_PMI_EN (bit 13)&#160;—&#160;</b>When set.&#160;this logical&#160;processor&#160;is enabled to receive&#160;an counter&#160;overflow&#160;<br/>interrupt form the&#160;uncore.</p>
<p style="position:absolute;top:574px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:574px;left:95px;white-space:nowrap" class="ft09"><b>FREEZE_WHILE_SMM_EN (bit&#160;14) —&#160;</b>FREEZE_WHILE_SMM_EN is&#160;supported&#160;if&#160;<br/>IA32_PERF_CAPABILITIES.FREEZE_WHILE_SMM[Bit&#160;12]&#160;is reporting&#160;1.&#160;See&#160;<a href="o_fe12b1e2a880e0ce-585.html">Section 17.4.1</a>.</p>
<p style="position:absolute;top:615px;left:69px;white-space:nowrap" class="ft03">Processors&#160;based on Intel microarchitecture&#160;code&#160;name&#160;Nehalem provide additional capabilities:</p>
<p style="position:absolute;top:637px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:637px;left:95px;white-space:nowrap" class="ft09"><b>Independent&#160;control of&#160;uncore&#160;PMI&#160;—&#160;</b>The&#160;IA32_DEBUGCTL MSR provides&#160;a bit field (see<a href="o_fe12b1e2a880e0ce-601.html">&#160;Figure 17-11)&#160;</a>for&#160;<br/>software to&#160;enable&#160;each&#160;logical processor to&#160;receive an&#160;uncore&#160;counter overflow interrupt.</p>
<p style="position:absolute;top:676px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:676px;left:95px;white-space:nowrap" class="ft09"><b>LBR filtering&#160;—&#160;</b>Processors based&#160;on Intel&#160;microarchitecture&#160;code name&#160;Nehalem support filtering of LBR&#160;<br/>based on combination&#160;of&#160;CPL and branch&#160;type&#160;conditions.&#160;When&#160;LBR filtering&#160;is enabled, the&#160;LBR&#160;stack only&#160;<br/>captures&#160;the subset of branches that are&#160;specified by&#160;MSR_LBR_SELECT.</p>
<p style="position:absolute;top:1025px;left:259px;white-space:nowrap" class="ft08">Figure&#160;17-11. &#160;IA32_DEBUGCTL&#160;MSR&#160;for Processors based&#160;</p>
<p style="position:absolute;top:1043px;left:296px;white-space:nowrap" class="ft08">on Intel&#160;microarchitecture&#160;code name&#160;Nehalem</p>
<p style="position:absolute;top:779px;left:253px;white-space:nowrap" class="ft04">31</p>
<p style="position:absolute;top:949px;left:257px;white-space:nowrap" class="ft04">TR&#160;—&#160;Trace messages enable</p>
<p style="position:absolute;top:922px;left:257px;white-space:nowrap" class="ft04">BTINT&#160;—&#160;Branch trace interrupt</p>
<p style="position:absolute;top:976px;left:257px;white-space:nowrap" class="ft010">BTF&#160;—&#160;Single-step on branches<br/>LBR&#160;—&#160;Last&#160;branch/interrupt/exception</p>
<p style="position:absolute;top:807px;left:337px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:780px;left:554px;white-space:nowrap" class="ft04">8&#160;7&#160;6&#160;5&#160;4&#160;3&#160;2&#160;1&#160;&#160;&#160;0</p>
<p style="position:absolute;top:936px;left:257px;white-space:nowrap" class="ft04">BTS&#160;—&#160;Branch trace&#160;store</p>
<p style="position:absolute;top:963px;left:257px;white-space:nowrap" class="ft04">Reserved</p>
<p style="position:absolute;top:780px;left:544px;white-space:nowrap" class="ft04">9</p>
<p style="position:absolute;top:780px;left:527px;white-space:nowrap" class="ft04">10</p>
<p style="position:absolute;top:910px;left:257px;white-space:nowrap" class="ft04">BTS_OFF_OS&#160;—&#160;BTS&#160;off&#160;in OS</p>
<p style="position:absolute;top:897px;left:256px;white-space:nowrap" class="ft04">BTS_OFF_USR&#160;—&#160;BTS&#160;off&#160;in&#160;user&#160;code</p>
<p style="position:absolute;top:883px;left:257px;white-space:nowrap" class="ft04">FREEZE_LBRS_ON_PMI</p>
<p style="position:absolute;top:868px;left:256px;white-space:nowrap" class="ft04">FREEZE_PERFMON_ON_PMI</p>
<p style="position:absolute;top:780px;left:515px;white-space:nowrap" class="ft04">11</p>
<p style="position:absolute;top:780px;left:500px;white-space:nowrap" class="ft04">12</p>
<p style="position:absolute;top:780px;left:474px;white-space:nowrap" class="ft04">14</p>
<p style="position:absolute;top:845px;left:255px;white-space:nowrap" class="ft04">FREEZE_WHILE_SMM_EN</p>
<p style="position:absolute;top:856px;left:256px;white-space:nowrap" class="ft04">UNCORE_PMI_EN</p>
<p style="position:absolute;top:780px;left:487px;white-space:nowrap" class="ft04">13</p>
</div>
</body>
</html>
