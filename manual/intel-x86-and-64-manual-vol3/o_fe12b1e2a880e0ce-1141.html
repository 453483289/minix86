<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1141</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1141-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1141.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3C&#160;27-23</p>
<p style="position:absolute;top:47px;left:782px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:102px;left:120px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:100px;left:146px;white-space:nowrap" class="ft07">If&#160;the&#160;VM&#160;exit stored 0 for bit&#160;31 for IDT-vectoring&#160;information&#160;field&#160;(because the VM&#160;exit did not occur&#160;<br/>during&#160;delivery&#160;of&#160;an event through the&#160;IDT;&#160;see<a href="o_fe12b1e2a880e0ce-1129.html">&#160;Section 27.2.3), the&#160;</a>value&#160;saved is&#160;1.</p>
<p style="position:absolute;top:142px;left:120px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:141px;left:146px;white-space:nowrap" class="ft07">If&#160;the VM&#160;exit stored 1&#160;for&#160;bit&#160;31 for IDT-vectoring&#160;information&#160;field&#160;(because&#160;the VM&#160;exit did occur&#160;<br/>during&#160;delivery of an&#160;event through&#160;the IDT), the value&#160;saved&#160;is&#160;the value&#160;that would have&#160;appeared in&#160;<br/>the&#160;saved&#160;RFLAGS&#160;image had&#160;the event&#160;been&#160;delivered&#160;through the&#160;IDT&#160;(see&#160;above).</p>
<p style="position:absolute;top:198px;left:95px;white-space:nowrap" class="ft03">‚Äî&#160;For all&#160;other VM&#160;exits,&#160;the value&#160;saved is&#160;the&#160;value RFLAGS.RF&#160;had&#160;before the&#160;VM&#160;exit&#160;occurred.</p>
<p style="position:absolute;top:248px;left:69px;white-space:nowrap" class="ft04">27.3.4&#160;</p>
<p style="position:absolute;top:248px;left:150px;white-space:nowrap" class="ft04">Saving Non-Register State</p>
<p style="position:absolute;top:279px;left:69px;white-space:nowrap" class="ft03">Information&#160;corresponding to&#160;guest non-register state is&#160;saved as&#160;follows:</p>
<p style="position:absolute;top:301px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:301px;left:95px;white-space:nowrap" class="ft03">The&#160;activity-state field&#160;is saved with the logical processor‚Äôs activity state before&#160;the VM&#160;exit.</p>
<p style="position:absolute;top:299px;left:709px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:301px;left:716px;white-space:nowrap" class="ft03">&#160;S<a href="o_fe12b1e2a880e0ce-1119.html">ee Section 27.1</a>&#160;</p>
<p style="position:absolute;top:318px;left:94px;white-space:nowrap" class="ft03">for details of&#160;how events&#160;leading&#160;to a&#160;VM&#160;exit&#160;may affect&#160;the activity&#160;state.</p>
<p style="position:absolute;top:340px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:340px;left:95px;white-space:nowrap" class="ft08">The&#160;interruptibility-state&#160;field is&#160;saved to&#160;reflect the&#160;logical&#160;processor‚Äôs interruptibility&#160;before the&#160;VM&#160;exit.<br/>‚Äî&#160;See&#160;<a href="o_fe12b1e2a880e0ce-1119.html">Section 27.1&#160;</a>for&#160;details of how&#160;events leading to&#160;a VM&#160;exit may affect this&#160;state.<br/>‚Äî&#160;VM&#160;exits&#160;that end outside system-management&#160;mode (SMM) save&#160;bit 2&#160;(blocking by&#160;SMI)&#160;as 0&#160;regardless&#160;</p>
<p style="position:absolute;top:405px;left:120px;white-space:nowrap" class="ft03">of&#160;the&#160;state&#160;of such blocking before&#160;the VM&#160;exit.</p>
<p style="position:absolute;top:429px;left:95px;white-space:nowrap" class="ft03">‚Äî&#160;Bit&#160;3 (blocking by NMI) is treated&#160;specially&#160;if the&#160;‚Äúvirtual&#160;NMIs‚Äù&#160;VM-execution control is 1. In&#160;this case, the&#160;</p>
<p style="position:absolute;top:445px;left:120px;white-space:nowrap" class="ft03">value saved for this&#160;field does not&#160;indicate the&#160;blocking&#160;of NMIs but rather the&#160;state&#160;of virtual-NMI blocking.</p>
<p style="position:absolute;top:469px;left:95px;white-space:nowrap" class="ft03">‚Äî&#160;Bit&#160;4 (enclave&#160;interruption)&#160;is set to&#160;1 if&#160;the VM&#160;exit&#160;occurred while&#160;the&#160;logical processor was&#160;in&#160;enclave&#160;</p>
<p style="position:absolute;top:486px;left:120px;white-space:nowrap" class="ft09">mode.<br/>Such&#160;VM&#160;exits includes those&#160;caused&#160;by&#160;interrupts, non-maskable interrupts,&#160;system-management&#160;<br/>interrupts,&#160;INIT&#160;signals, and&#160;exceptions occurring in&#160;enclave&#160;mode&#160;as well as&#160;exceptions encountered&#160;<br/>during&#160;the&#160;delivery of such events incident to&#160;enclave&#160;mode.<br/>A VM&#160;exit that is&#160;incident&#160;to delivery&#160;of&#160;an event injected by VM entry&#160;leaves&#160;this bit unmodified.</p>
<p style="position:absolute;top:589px;left:69px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:589px;left:95px;white-space:nowrap" class="ft08">The&#160;pending debug&#160;exceptions field is&#160;saved as clear for all&#160;VM&#160;exits&#160;except&#160;the&#160;following:<br/>‚Äî&#160;A&#160;VM&#160;exit caused by an INIT signal, a&#160;machine-check&#160;exception,&#160;or&#160;a system-management interrupt&#160;(SMI).<br/>‚Äî&#160;A&#160;VM&#160;exit with basic exit&#160;reason ‚ÄúTPR&#160;below&#160;threshold‚Äù,</p>
<p style="position:absolute;top:635px;left:492px;white-space:nowrap" class="ft06">2</p>
<p style="position:absolute;top:637px;left:499px;white-space:nowrap" class="ft03">&#160;‚Äúvirtualized EOI‚Äù,&#160;‚ÄúAPIC write‚Äù, or&#160;‚Äúmonitor&#160;trap&#160;</p>
<p style="position:absolute;top:654px;left:120px;white-space:nowrap" class="ft03">flag.‚Äù</p>
<p style="position:absolute;top:678px;left:95px;white-space:nowrap" class="ft03">‚Äî&#160;VM&#160;exits that&#160;are not caused&#160;by debug&#160;exceptions and&#160;that&#160;occur while&#160;there&#160;is MOV-SS&#160;blocking&#160;of&#160;debug&#160;</p>
<p style="position:absolute;top:694px;left:120px;white-space:nowrap" class="ft03">exceptions.</p>
<p style="position:absolute;top:717px;left:95px;white-space:nowrap" class="ft08">For VM&#160;exits that do not clear the&#160;field, the&#160;value&#160;saved is&#160;determined as&#160;follows:<br/>‚Äî&#160;Each of&#160;bits&#160;3:0&#160;may be&#160;set if&#160;it corresponds to&#160;a matched breakpoint.&#160;This may be true&#160;even&#160;if the&#160;corre-</p>
<p style="position:absolute;top:757px;left:120px;white-space:nowrap" class="ft03">sponding&#160;breakpoint is&#160;not enabled&#160;in DR7.</p>
<p style="position:absolute;top:781px;left:95px;white-space:nowrap" class="ft03">‚Äî&#160;Suppose that a&#160;VM&#160;exit&#160;is due to&#160;an INIT&#160;signal, a&#160;machine-check&#160;exception,&#160;or an SMI;&#160;or that a&#160;VM&#160;exit&#160;</p>
<p style="position:absolute;top:798px;left:120px;white-space:nowrap" class="ft07">has basic exit&#160;reason&#160;‚ÄúTPR below&#160;threshold‚Äù or&#160;‚Äúmonitor trap flag.‚Äù&#160;In&#160;this case,&#160;the value&#160;saved&#160;sets&#160;bits&#160;<br/>corresponding to&#160;the causes&#160;of any&#160;debug exceptions&#160;that&#160;were pending&#160;at the&#160;time of the VM&#160;exit.<br/>If the VM&#160;exit&#160;occurs immediately after VM&#160;entry,&#160;the value&#160;saved&#160;may&#160;match&#160;that which&#160;was loaded&#160;on&#160;<br/>VM&#160;entry (see&#160;<a href="o_fe12b1e2a880e0ce-1114.html">Section 26.6.3).</a>&#160;Otherwise,&#160;the&#160;following&#160;items apply:</p>
<p style="position:absolute;top:880px;left:120px;white-space:nowrap" class="ft02">‚Ä¢</p>
<p style="position:absolute;top:879px;left:146px;white-space:nowrap" class="ft09">Bit&#160;12 (enabled&#160;breakpoint)&#160;is set to&#160;1 in&#160;any of the&#160;following&#160;cases:<br/>‚Äî&#160;If there was&#160;at least one&#160;matched data or&#160;I/O&#160;breakpoint&#160;that was&#160;enabled in&#160;DR7.<br/>‚Äî&#160;If&#160;it had been set on VM&#160;entry,&#160;causing there&#160;to be valid&#160;pending debug&#160;exceptions (see<a href="o_fe12b1e2a880e0ce-1114.html">&#160;Section&#160;</a></p>
<p style="position:absolute;top:943px;left:171px;white-space:nowrap" class="ft03"><a href="o_fe12b1e2a880e0ce-1114.html">26.6.3</a>)&#160;and&#160;the VM&#160;exit occurred&#160;before&#160;those&#160;exceptions were&#160;either delivered&#160;or lost.</p>
<p style="position:absolute;top:967px;left:145px;white-space:nowrap" class="ft03">‚Äî&#160;If the XBEGIN instruction was executed&#160;immediately&#160;before the&#160;VM&#160;exit and&#160;advanced&#160;debugging of&#160;</p>
<p style="position:absolute;top:984px;left:171px;white-space:nowrap" class="ft03">RTM&#160;transactional regions&#160;had&#160;been&#160;enabled (see<a href="˛ˇ">&#160;Section 16.3.7, ‚ÄúRTM-Enabled&#160;Debugger</a>&#160;</p>
<p style="position:absolute;top:1017px;left:69px;white-space:nowrap" class="ft03">1.&#160;If this activity state was an&#160;inactive&#160;state resulting from&#160;execution of&#160;a specific&#160;instruction&#160;(HLT&#160;or&#160;MWAIT),&#160;the&#160;value saved&#160;for&#160;RIP&#160;</p>
<p style="position:absolute;top:1033px;left:91px;white-space:nowrap" class="ft03">by that&#160;VM&#160;exit will reference the following instruction.</p>
<p style="position:absolute;top:1054px;left:69px;white-space:nowrap" class="ft03">2.&#160;This item includes VM&#160;exits that&#160;occur&#160;as a&#160;result of&#160;certain VM&#160;en<a href="o_fe12b1e2a880e0ce-1116.html">tries (Section 26.6.7).</a></p>
</div>
</body>
</html>
