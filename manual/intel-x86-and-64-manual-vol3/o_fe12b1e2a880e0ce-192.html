<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 192</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page192-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce192.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-6&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INTERRUPT&#160;AND EXCEPTION&#160;HANDLING</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft07"><a href="˛ˇ">Architectures,‚Äù in the&#160;<i>Intel¬Æ 64&#160;and&#160;IA-32 Architectures Software&#160;Developer‚Äôs&#160;Manual, Volume&#160;1</i></a>, for more&#160;infor-<br/>mation&#160;about&#160;the&#160;P6&#160;family processors‚Äô&#160;microarchitecture and&#160;its support for out-of-order instruction execution.<br/>Note&#160;that&#160;the Pentium processor and earlier IA-32 processors&#160;also perform varying amounts of prefetching&#160;and&#160;<br/>preliminary decoding. With&#160;these&#160;processors&#160;as well, exceptions and&#160;interrupts are not signaled&#160;until&#160;actual ‚Äúin-<br/>order‚Äù&#160;execution of the instructions.&#160;For a&#160;given code sample,&#160;the signaling of exceptions&#160;occurs uniformly when&#160;<br/>the code&#160;is&#160;executed&#160;on&#160;any family&#160;of&#160;IA-32&#160;processors&#160;(except&#160;where new exceptions&#160;or new opcodes&#160;have&#160;been&#160;<br/>defined).</p>
<p style="position:absolute;top:262px;left:68px;white-space:nowrap" class="ft04">6.7&#160;</p>
<p style="position:absolute;top:262px;left:147px;white-space:nowrap" class="ft04">NONMASKABLE INTERRUPT&#160;(NMI)</p>
<p style="position:absolute;top:298px;left:68px;white-space:nowrap" class="ft02">The nonmaskable interrupt (NMI)&#160;can be generated in&#160;either&#160;of&#160;two&#160;ways:</p>
<p style="position:absolute;top:320px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:321px;left:93px;white-space:nowrap" class="ft02">External hardware asserts&#160;the NMI pin.</p>
<p style="position:absolute;top:343px;left:68px;white-space:nowrap" class="ft05">‚Ä¢</p>
<p style="position:absolute;top:343px;left:93px;white-space:nowrap" class="ft07">The&#160;processor&#160;receives&#160;a message on&#160;the system&#160;bus (Pentium&#160;4,&#160;Intel Core Duo,&#160;Intel&#160;Core 2, Intel Atom, and&#160;<br/>Intel Xeon processors) or&#160;the APIC&#160;serial&#160;bus (P6&#160;family&#160;and Pentium processors) with a&#160;delivery mode&#160;NMI.</p>
<p style="position:absolute;top:384px;left:68px;white-space:nowrap" class="ft07">When&#160;the processor receives a&#160;NMI&#160;from either of these&#160;sources,&#160;the processor handles it&#160;immediately by calling&#160;<br/>the NMI handler pointed to&#160;by&#160;interrupt vector number&#160;2.&#160;The&#160;processor&#160;also invokes certain&#160;hardware&#160;conditions&#160;<br/>to insure&#160;that no other&#160;interrupts, including&#160;NMI&#160;interrupts, are received&#160;until the&#160;NMI&#160;handler has&#160;completed&#160;<br/>ex<a href="o_fe12b1e2a880e0ce-192.html">ecuting (see Section 6.7.1, ‚ÄúHandling Multiple&#160;NMIs‚Äù).<br/></a>Also, when an NMI&#160;is&#160;received&#160;from either&#160;of the above&#160;sources, it&#160;cannot be&#160;masked by&#160;the&#160;IF&#160;flag in the EFLAGS&#160;<br/>register.<br/>It is&#160;possible&#160;to issue&#160;a maskable&#160;hardware interrupt (through the INTR pin)&#160;to vector 2 to&#160;invoke&#160;the&#160;NMI interrupt&#160;<br/>handler; however,&#160;this interrupt will not truly be an&#160;NMI interrupt. A true&#160;NMI&#160;interrupt that&#160;activates the&#160;<br/>processor‚Äôs NMI-handling&#160;hardware can only be delivered&#160;through&#160;one of the&#160;mechanisms listed above.</p>
<p style="position:absolute;top:581px;left:68px;white-space:nowrap" class="ft06">6.7.1&#160;</p>
<p style="position:absolute;top:581px;left:148px;white-space:nowrap" class="ft06">Handling Multiple NMIs</p>
<p style="position:absolute;top:612px;left:68px;white-space:nowrap" class="ft07">While an&#160;NMI interrupt&#160;handler is&#160;executing, the processor blocks delivery&#160;of subsequent NMIs until the next&#160;execu-<br/>tion of the&#160;IRET instruction. This&#160;blocking of&#160;NMIs prevents&#160;nested execution&#160;of&#160;the&#160;NMI handler.&#160;It&#160;is&#160;recommended&#160;<br/>that the&#160;NMI interrupt handler&#160;be&#160;accessed through an interrupt gate to disable&#160;maskable hardware&#160;interrupts&#160;(see&#160;<br/><a href="o_fe12b1e2a880e0ce-192.html">Section 6.8.1,&#160;‚ÄúMasking&#160;Maskable Hardware&#160;Interrupts‚Äù</a>).&#160;<br/>An execution&#160;of the&#160;IRET instruction unblocks NMIs even if&#160;the&#160;instruction causes&#160;a fault. For example,&#160;if the IRET&#160;<br/>instruction executes with EFLAGS.VM&#160;=&#160;1 and&#160;IOPL&#160;of less&#160;than 3,&#160;a general-protection exception is&#160;generated&#160;(see&#160;<br/><a href="o_fe12b1e2a880e0ce-986.html">Section&#160;20.2.7,&#160;‚ÄúSensitive Instructions‚Äù). In&#160;</a>such&#160;a case,&#160;NMIs&#160;are unmasked before the&#160;exception handler&#160;is&#160;<br/>invoked.</p>
<p style="position:absolute;top:790px;left:68px;white-space:nowrap" class="ft04">6.8&#160;</p>
<p style="position:absolute;top:790px;left:147px;white-space:nowrap" class="ft04">ENABLING AND DISABLING INTERRUPTS</p>
<p style="position:absolute;top:826px;left:68px;white-space:nowrap" class="ft07">The processor inhibits the generation of&#160;some&#160;interrupts, depending on the&#160;state of the processor and of the IF&#160;and&#160;<br/>RF&#160;flags in the&#160;EFLAGS&#160;register, as&#160;described in the&#160;following&#160;sections.</p>
<p style="position:absolute;top:893px;left:68px;white-space:nowrap" class="ft06">6.8.1&#160;</p>
<p style="position:absolute;top:893px;left:148px;white-space:nowrap" class="ft06">Masking Maskable Hardware&#160;Interrupts</p>
<p style="position:absolute;top:924px;left:68px;white-space:nowrap" class="ft07">The&#160;IF flag&#160;can disable&#160;the servicing of maskable&#160;hardware interrupts&#160;received&#160;on the&#160;processor‚Äôs INTR pin&#160;or&#160;<br/>through the&#160;local APIC (see<a href="o_fe12b1e2a880e0ce-189.html">&#160;Section 6.3.2,&#160;‚ÄúMaskable&#160;Hardware Interrupts‚Äù)</a>.&#160;When&#160;the&#160;IF flag&#160;is clear,&#160;the&#160;<br/>processor&#160;inhibits interrupts delivered&#160;to&#160;the INTR pin or&#160;through&#160;the local&#160;APIC&#160;from generating an internal&#160;inter-<br/>rupt&#160;request; when the&#160;IF flag&#160;is set, interrupts&#160;delivered to&#160;the INTR or&#160;through the&#160;local APIC&#160;pin&#160;are&#160;processed&#160;<br/>as normal external&#160;interrupts.&#160;<br/>The IF&#160;flag does not&#160;affect&#160;non-maskable interrupts&#160;(NMIs) delivered&#160;to the&#160;NMI pin or delivery&#160;mode&#160;NMI&#160;<br/>messages delivered&#160;through&#160;the&#160;local&#160;APIC, nor does&#160;it&#160;affect processor generated exceptions. As with&#160;the other&#160;<br/>flags in&#160;the EFLAGS register,&#160;the processor clears&#160;the&#160;IF flag&#160;in response to&#160;a hardware reset.</p>
</div>
</body>
</html>
