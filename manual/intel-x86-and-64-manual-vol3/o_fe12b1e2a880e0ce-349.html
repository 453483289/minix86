<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 349</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:14px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page349-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce349.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:767px;white-space:nowrap" class="ft00">Vol. 3A&#160;9-37</p>
<p style="position:absolute;top:47px;left:560px;white-space:nowrap" class="ft01">PROCESSOR&#160;MANAGEMENT&#160;AND INITIALIZATION</p>
<p style="position:absolute;top:283px;left:69px;white-space:nowrap" class="ft02">9.11.7.2 &#160;&#160;Authenticating the Update</p>
<p style="position:absolute;top:311px;left:69px;white-space:nowrap" class="ft07">An update&#160;may be authenticated by the&#160;BIOS using&#160;the signature&#160;primitive,&#160;described above,&#160;and&#160;the algorithm&#160;in&#160;<br/><a href="o_fe12b1e2a880e0ce-349.html">Example&#160;9-10.</a></p>
<p style="position:absolute;top:369px;left:69px;white-space:nowrap" class="ft01">Example 9-10. &#160;Pseudo Code&#160;to&#160;Authenticate the Update</p>
<p style="position:absolute;top:398px;left:69px;white-space:nowrap" class="ft03">Z&#160;</p>
<p style="position:absolute;top:394px;left:85px;white-space:nowrap" class="ft03">←&#160;Obtain&#160;Update Revision&#160;from the&#160;Update Header to&#160;be authenticated;</p>
<p style="position:absolute;top:415px;left:69px;white-space:nowrap" class="ft03">X&#160;</p>
<p style="position:absolute;top:410px;left:85px;white-space:nowrap" class="ft03">←&#160;Obtain&#160;Current&#160;Update Signature&#160;from MSR&#160;8BH;</p>
<p style="position:absolute;top:448px;left:69px;white-space:nowrap" class="ft03">If&#160;(Z &gt; X)</p>
<p style="position:absolute;top:464px;left:69px;white-space:nowrap" class="ft03">{</p>
<p style="position:absolute;top:481px;left:96px;white-space:nowrap" class="ft03">Load Update&#160;that is&#160;to be authenticated;</p>
<p style="position:absolute;top:497px;left:96px;white-space:nowrap" class="ft03">Y&#160;</p>
<p style="position:absolute;top:493px;left:112px;white-space:nowrap" class="ft03">←&#160;Obtain&#160;New Signature from MSR 8BH;</p>
<p style="position:absolute;top:530px;left:96px;white-space:nowrap" class="ft03">If&#160;(Z = Y)</p>
<p style="position:absolute;top:547px;left:123px;white-space:nowrap" class="ft03">Success</p>
<p style="position:absolute;top:563px;left:96px;white-space:nowrap" class="ft03">Else</p>
<p style="position:absolute;top:580px;left:123px;white-space:nowrap" class="ft03">Fail</p>
<p style="position:absolute;top:596px;left:69px;white-space:nowrap" class="ft03">}</p>
<p style="position:absolute;top:613px;left:69px;white-space:nowrap" class="ft03">Else</p>
<p style="position:absolute;top:629px;left:96px;white-space:nowrap" class="ft03">Fail</p>
<p style="position:absolute;top:664px;left:69px;white-space:nowrap" class="ft07"><a href="o_fe12b1e2a880e0ce-349.html">Example&#160;9-10 requires that&#160;</a>the BIOS&#160;only&#160;authenticate&#160;updates that&#160;contain&#160;a numerically larger revision&#160;than&#160;the&#160;<br/>currently&#160;loaded revision, where Current Signature (X)&#160;&lt;<b>&#160;</b>New&#160;Update Revision&#160;(Z).&#160;A processor with no&#160;loaded&#160;<br/>update&#160;is&#160;considered&#160;to have&#160;a&#160;revision&#160;equal&#160;to zero.<br/>This authentication procedure&#160;relies upon the decoding provided by the&#160;processor to verify an update from a poten-<br/>tially hostile&#160;source.&#160;&#160;As an&#160;example,&#160;this mechanism in&#160;conjunction&#160;with other&#160;safeguards&#160;provides&#160;security for&#160;<br/>dynamically incorporating field updates into&#160;the BIOS.</p>
<p style="position:absolute;top:805px;left:69px;white-space:nowrap" class="ft05">9.11.8&#160;</p>
<p style="position:absolute;top:805px;left:150px;white-space:nowrap" class="ft05">Optional Processor Microcode Update Specifications</p>
<p style="position:absolute;top:835px;left:69px;white-space:nowrap" class="ft07">This section an interface&#160;that an OEM-BIOS&#160;may provide to&#160;its client&#160;system software&#160;to manage&#160;processor micro-<br/>code&#160;updates.&#160;System software may choose&#160;to build&#160;its own facility to&#160;manage microcode&#160;updates (e.g.&#160;similar&#160;to&#160;<br/>the&#160;facility described in&#160;Section&#160;9.11.6) or&#160;rely on&#160;a&#160;facility provided by&#160;the BIOS&#160;to perform&#160;microcode updates.<br/>Se<a href="o_fe12b1e2a880e0ce-350.html">ctions 9.11.8.1-9.</a><a href="o_fe12b1e2a880e0ce-360.html">11.8.9 describ</a>es an&#160;extension (Function&#160;0D042H)&#160;to the&#160;real&#160;mode&#160;INT&#160;15H&#160;service.&#160;INT&#160;15H&#160;<br/>0D042H&#160;function is&#160;one of several&#160;alternatives that a&#160;BIOS may&#160;choose to&#160;implement microcode&#160;update&#160;facility and&#160;<br/>offer to&#160;its client application (e.g. an&#160;OS).&#160;Other alternative&#160;microcode&#160;update&#160;facility that&#160;BIOS can&#160;choose are&#160;<br/>dependent on platform-specific capabilities,&#160;including the&#160;Capsule Update mechanism from the&#160;UEFI&#160;specification&#160;<br/>(www.uefi.org). In&#160;this discussion, the&#160;application is&#160;referred&#160;to as&#160;the calling program or caller.<br/>The real&#160;mode INT15&#160;call specification described&#160;here is an&#160;Intel extension to&#160;an OEM BIOS. This extension allows&#160;<br/>an application&#160;to read and modify the contents of the microcode&#160;update data in NVRAM. The update loader, which&#160;<br/>is part of the&#160;system BIOS,&#160;cannot&#160;be updated&#160;by&#160;the interface.&#160;All&#160;of&#160;the functions defined in&#160;the specification must&#160;<br/>be implemented for a system&#160;to be&#160;considered compliant&#160;with&#160;the specification. The INT15&#160;functions&#160;are&#160;accessible&#160;<br/>only from real&#160;mode.</p>
<p style="position:absolute;top:118px;left:316px;white-space:nowrap" class="ft06">Table&#160;9-12. &#160;Microcode Update Signature&#160;</p>
<p style="position:absolute;top:139px;left:73px;white-space:nowrap" class="ft03">Bit</p>
<p style="position:absolute;top:139px;left:136px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:162px;left:73px;white-space:nowrap" class="ft03">63:32</p>
<p style="position:absolute;top:162px;left:136px;white-space:nowrap" class="ft03">Microcode&#160;update&#160;signature.&#160;This&#160;field contains&#160;the signature&#160;of&#160;the&#160;currently loaded&#160;microcode&#160;update&#160;when&#160;read&#160;following&#160;</p>
<p style="position:absolute;top:178px;left:136px;white-space:nowrap" class="ft03">the execution&#160;of&#160;the&#160;CPUID instruction,&#160;function 1. It is required that&#160;this register&#160;field be pre-loaded with zero&#160;prior to&#160;</p>
<p style="position:absolute;top:195px;left:136px;white-space:nowrap" class="ft03">executing&#160;the CPUID,&#160;function&#160;1.&#160;If the field remains equal to&#160;zero, then&#160;there is&#160;no&#160;microcode update loaded. Another&#160;non-</p>
<p style="position:absolute;top:211px;left:136px;white-space:nowrap" class="ft03">zero&#160;value will be the signature.</p>
<p style="position:absolute;top:234px;left:73px;white-space:nowrap" class="ft03">31:0</p>
<p style="position:absolute;top:234px;left:136px;white-space:nowrap" class="ft03">Reserved.</p>
</div>
</body>
</html>
