<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1075</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:21px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#0860a8;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1075-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1075.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:769px;white-space:nowrap" class="ft00">Vol. 3C&#160;25-1</p>
<p style="position:absolute;top:96px;left:699px;white-space:nowrap" class="ft01">CHAPTER 25</p>
<p style="position:absolute;top:120px;left:531px;white-space:nowrap" class="ft01">VMX NON-ROOT&#160;OPERATION</p>
<p style="position:absolute;top:190px;left:68px;white-space:nowrap" class="ft07">In&#160;a virtualized&#160;environment&#160;using VMX,&#160;the guest software&#160;stack&#160;typically runs on&#160;a logical processor in VMX non-<br/>root operation.&#160;This mode of&#160;operation is&#160;similar to&#160;that&#160;of ordinary processor operation&#160;outside of the&#160;virtualized&#160;<br/>environment.&#160;This chapter describes the&#160;differences&#160;between VMX non-root operation and&#160;ordinary processor oper-<br/>ation with special&#160;attention to causes of VM&#160;exits (which&#160;bring a logical processor from VMX non-root&#160;operation to&#160;<br/>root&#160;operation). The differences between VMX&#160;non-root&#160;operation and&#160;ordinary processor operation are&#160;described&#160;<br/>in&#160;the&#160;following sections:</p>
<p style="position:absolute;top:295px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:295px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1075.html">Section 25.1,&#160;“Instructions That&#160;Cause VM&#160;Exits”</a></p>
<p style="position:absolute;top:317px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:318px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1079.html">Section&#160;25.2,&#160;“Other&#160;Causes of&#160;VM&#160;Exits”</a></p>
<p style="position:absolute;top:340px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:340px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1080.html">Section&#160;25.3, “Changes to Instruction&#160;Behavior in&#160;VMX Non-Root Operation”</a></p>
<p style="position:absolute;top:362px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:363px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1084.html">Section&#160;25.4,&#160;“Other&#160;Changes&#160;in VMX Non-Root&#160;Operation”&#160;</a></p>
<p style="position:absolute;top:385px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:385px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1085.html">Section&#160;25.5,&#160;“Features Specific&#160;to VMX&#160;Non-Root Operation”</a></p>
<p style="position:absolute;top:407px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:408px;left:93px;white-space:nowrap" class="ft02"><a href="o_fe12b1e2a880e0ce-1091.html">Section 25.6,&#160;“Unrestricted Guests”</a></p>
<p style="position:absolute;top:432px;left:68px;white-space:nowrap" class="ft07"><a href="o_fe12b1e2a880e0ce-1093.html">Chapter&#160;26, “VM Entries,” describe</a>s&#160;the&#160;data&#160;control&#160;structures that&#160;govern&#160;VMX non-root oper<a href="o_fe12b1e2a880e0ce-1093.html">ation.&#160;Chapter 26,&#160;<br/>“VM Entries,”&#160;</a>describes the operation of VM&#160;entries by which the processor transitions from&#160;VMX root operation to&#160;<br/>VMX non-root oper<a href="o_fe12b1e2a880e0ce-1075.html">ation. Chapter 25, “VMX Non-Root Operation,” describe</a>s&#160;the operation of VM&#160;exits&#160;by which the&#160;<br/>processor&#160;transitions from VMX&#160;non-root&#160;operation&#160;to VMX root operation.<br/><a href="o_fe12b1e2a880e0ce-1149.html">Chapter 28,&#160;“VMX&#160;Support for&#160;Address&#160;Translation,” describ</a>es&#160;two features that support&#160;address translation in&#160;VMX&#160;<br/>non-root oper<a href="o_fe12b1e2a880e0ce-1167.html">ation.&#160;Chapter 29,&#160;“APIC Virtualization and Virtual&#160;Interrupts,” describe</a>s&#160;features&#160;that support virtu-<br/>alization of interrupts and&#160;the Advanced&#160;Programmable&#160;Interrupt Controller (APIC)&#160;in VMX non-root&#160;operation.</p>
<p style="position:absolute;top:594px;left:68px;white-space:nowrap" class="ft04">25.1&#160;</p>
<p style="position:absolute;top:594px;left:147px;white-space:nowrap" class="ft04">INSTRUCTIONS THAT CAUSE VM&#160;EXITS</p>
<p style="position:absolute;top:630px;left:68px;white-space:nowrap" class="ft07">Certain&#160;instructions may&#160;cause VM&#160;exits if&#160;executed&#160;in VMX&#160;non-root operation. Unless&#160;otherwise specified, such&#160;<br/>VM&#160;exits are “fault-like,” meaning that the instruction causing&#160;the VM&#160;exit does not execute and&#160;no processor state&#160;<br/>is updated&#160;by the&#160;<a href="o_fe12b1e2a880e0ce-1119.html">instruction. Section 27.1 details</a>&#160;architectural state&#160;in&#160;the&#160;context of a&#160;VM&#160;exit.<br/><a href="o_fe12b1e2a880e0ce-1075.html">Section&#160;25.1.1 defines the&#160;</a>prioritization&#160;between faults and&#160;VM&#160;exits&#160;for instructions subject&#160;<a href="o_fe12b1e2a880e0ce-1076.html">to both.&#160;Section&#160;<br/>25.1.2 id</a>entifies instructions that cause VM&#160;exits whenever&#160;they are executed in VMX&#160;non-root operation (and thus&#160;<br/>can never be executed&#160;in VMX&#160;non-root&#160;oper<a href="o_fe12b1e2a880e0ce-1076.html">ation). Section 25.1.3&#160;</a>identifies instructions that cause VM&#160;exits&#160;<br/>depending on the&#160;settings of certain&#160;VM-execution control fields (see<a href="o_fe12b1e2a880e0ce-1054.html">&#160;Section 24.6).</a></p>
<p style="position:absolute;top:787px;left:68px;white-space:nowrap" class="ft05">25.1.1&#160;</p>
<p style="position:absolute;top:787px;left:148px;white-space:nowrap" class="ft05">Relative&#160;Priority of&#160;Faults and VM&#160;Exits</p>
<p style="position:absolute;top:817px;left:68px;white-space:nowrap" class="ft02">The&#160;following&#160;principles describe&#160;the&#160;ordering&#160;between&#160;existing faults&#160;and&#160;VM&#160;exits:</p>
<p style="position:absolute;top:839px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:840px;left:93px;white-space:nowrap" class="ft07">Certain&#160;exceptions&#160;have&#160;priority&#160;over VM&#160;exits.&#160;These&#160;include&#160;invalid-opcode exceptions, faults based&#160;on&#160;<br/>privilege&#160;level,</p>
<p style="position:absolute;top:854px;left:192px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:856px;left:198px;white-space:nowrap" class="ft02">&#160;and&#160;general-protection&#160;exceptions that are&#160;based&#160;on&#160;checking I/O&#160;permission bits in&#160;the task-</p>
<p style="position:absolute;top:873px;left:93px;white-space:nowrap" class="ft07">state segment (TSS).&#160;For&#160;example,&#160;execution&#160;of RDMSR&#160;with CPL&#160;=&#160;3 generates a&#160;general-protection&#160;exception&#160;<br/>and not a&#160;VM&#160;exit.</p>
<p style="position:absolute;top:887px;left:217px;white-space:nowrap" class="ft06">2</p>
<p style="position:absolute;top:911px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:912px;left:93px;white-space:nowrap" class="ft07">Faults incurred&#160;while fetching&#160;instruction&#160;operands have&#160;priority&#160;over&#160;VM&#160;exits that are&#160;conditioned based&#160;on&#160;<br/>the&#160;contents of those&#160;operands (see LM<a href="o_fe12b1e2a880e0ce-1076.html">SW in Section&#160;25.1.3).</a></p>
<p style="position:absolute;top:950px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:951px;left:93px;white-space:nowrap" class="ft07">VM&#160;exits caused by&#160;execution&#160;of&#160;the INS&#160;and OUTS&#160;instructions&#160;(resulting&#160;either&#160;because the “unconditional I/O&#160;<br/>exiting”&#160;VM-execution control is 1 or because&#160;the&#160;“use I/O bitmaps control is 1) have&#160;priority&#160;over the following&#160;<br/>faults:&#160;</p>
<p style="position:absolute;top:1017px;left:68px;white-space:nowrap" class="ft02">1.&#160;These include&#160;faults&#160;generated by&#160;attempts&#160;to&#160;execute,&#160;in&#160;virtual-8086 mode,&#160;privileged&#160;instructions&#160;that&#160;are&#160;not recognized&#160;in&#160;that&#160;</p>
<p style="position:absolute;top:1033px;left:89px;white-space:nowrap" class="ft02">mode.</p>
<p style="position:absolute;top:1054px;left:68px;white-space:nowrap" class="ft02">2.&#160;MOV&#160;DR&#160;is an&#160;exception to&#160;this rule; see<a href="o_fe12b1e2a880e0ce-1076.html">&#160;Section 25.1.3</a>.</p>
</div>
</body>
</html>
