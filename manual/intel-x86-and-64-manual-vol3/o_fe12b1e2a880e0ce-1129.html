<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1129</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:8px;font-family:Times;color:#000000;}
	.ft04{font-size:16px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1129-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1129.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:761px;white-space:nowrap" class="ft00">Vol. 3C&#160;27-11</p>
<p style="position:absolute;top:47px;left:782px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:100px;left:120px;white-space:nowrap" class="ft08">(#BR;&#160;generated&#160;by BOUND) and invalid&#160;opcode exceptions (#UD) generated by&#160;UD2 are&#160;hardware&#160;<br/>exceptions.</p>
<p style="position:absolute;top:141px;left:95px;white-space:nowrap" class="ft02">—&#160;Bit&#160;11&#160;is set to 1 if the VM&#160;exit&#160;is&#160;caused by a hardware exception that would have delivered an error code&#160;</p>
<p style="position:absolute;top:157px;left:120px;white-space:nowrap" class="ft08">on the&#160;stack.&#160;This bit is&#160;always&#160;0 if&#160;the VM&#160;exit&#160;occurred while&#160;the&#160;logical processor was&#160;in real-address&#160;<br/>mode (CR0.PE=0).</p>
<p style="position:absolute;top:171px;left:247px;white-space:nowrap" class="ft03">1</p>
<p style="position:absolute;top:174px;left:254px;white-space:nowrap" class="ft02">&#160;If bit&#160;11&#160;is set to 1,&#160;the error&#160;code&#160;is placed&#160;in&#160;the VM-exit&#160;interruption error code&#160;(see&#160;</p>
<p style="position:absolute;top:190px;left:120px;white-space:nowrap" class="ft02">below).</p>
<p style="position:absolute;top:214px;left:95px;white-space:nowrap" class="ft02">—&#160;Bit&#160;12&#160;is&#160;undefined in&#160;any of the&#160;following&#160;cases:</p>
<p style="position:absolute;top:240px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:238px;left:146px;white-space:nowrap" class="ft02">If the&#160;“NMI exiting”&#160;VM-execution control is&#160;1 and the&#160;“virtual NMIs” VM-execution control&#160;is 0.</p>
<p style="position:absolute;top:264px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:262px;left:146px;white-space:nowrap" class="ft02">If the&#160;VM&#160;exit&#160;sets the&#160;valid&#160;bit in&#160;the IDT-vectoring&#160;information field (see<a href="o_fe12b1e2a880e0ce-1129.html">&#160;Section 27.2.3).</a></p>
<p style="position:absolute;top:288px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:286px;left:146px;white-space:nowrap" class="ft02">If&#160;the VM&#160;exit is due to&#160;a double&#160;fault&#160;(the&#160;interruption type is hardware exception&#160;and the vector is&#160;8).</p>
<p style="position:absolute;top:310px;left:120px;white-space:nowrap" class="ft02">Otherwise, bit&#160;12&#160;is&#160;defined as follows:</p>
<p style="position:absolute;top:336px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:334px;left:146px;white-space:nowrap" class="ft08">If the&#160;“virtual NMIs” VM-execution control&#160;is 0, the VM&#160;exit&#160;is due to&#160;a fault on&#160;the IRET&#160;instruction&#160;<br/>(other&#160;than a&#160;debug exception for an instruction&#160;breakpoint),&#160;and blocking&#160;by NMI (see<a href="o_fe12b1e2a880e0ce-1052.html">&#160;Table&#160;24-3)</a>&#160;was&#160;<br/>in effect&#160;before&#160;execution of IRET, bit&#160;12 is&#160;set&#160;to 1.</p>
<p style="position:absolute;top:393px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:391px;left:146px;white-space:nowrap" class="ft08">If the&#160;“virtual NMIs” VM-execution control&#160;is 1, the VM&#160;exit&#160;is due to&#160;a fault on&#160;the IRET&#160;instruction&#160;<br/>(other&#160;than a&#160;debug&#160;exception for an&#160;instruction&#160;breakpoint), and&#160;virtual-NMI blocking was&#160;in&#160;effect&#160;<br/>before&#160;execution&#160;of IRET,&#160;bit&#160;12 is&#160;set to&#160;1.</p>
<p style="position:absolute;top:450px;left:120px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:448px;left:146px;white-space:nowrap" class="ft02">For all&#160;other relevant&#160;VM&#160;exits, bit&#160;12 is&#160;cleared to&#160;0.</p>
<p style="position:absolute;top:446px;left:500px;white-space:nowrap" class="ft03">2</p>
<p style="position:absolute;top:472px;left:95px;white-space:nowrap" class="ft08">—&#160;Bits&#160;30:13&#160;are always set to&#160;0.<br/>—&#160;Bit&#160;31&#160;is always set&#160;to 1.<br/>For other VM&#160;exits (including&#160;those&#160;due&#160;to external&#160;interrupts when the&#160;“acknowledge interrupt on exit”&#160;<br/>VM-exit&#160;control&#160;is 0),&#160;the field&#160;is marked invalid (by clearing bit&#160;31) and&#160;the remainder&#160;of the&#160;field is&#160;undefined.</p>
<p style="position:absolute;top:557px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:558px;left:95px;white-space:nowrap" class="ft09">VM-exit interruption&#160;error code.<br/>—&#160;For&#160;VM&#160;exits that set both bit&#160;31 (valid) and&#160;bit&#160;11 (error code valid)&#160;in&#160;the VM-exit interruption-information&#160;</p>
<p style="position:absolute;top:598px;left:120px;white-space:nowrap" class="ft08">field,&#160;this field receives the error code that&#160;would&#160;have been pushed&#160;on the&#160;stack had&#160;the event causing&#160;the&#160;<br/>VM&#160;exit been delivered&#160;normally through the IDT.&#160;The EXT&#160;bit is set in&#160;this&#160;field exactly when it would be set&#160;<br/>normally.&#160;For exceptions&#160;that&#160;occur during&#160;the delivery&#160;of double fault (if the&#160;IDT-vectoring information&#160;field&#160;<br/>indicates&#160;a double fault),&#160;the EXT bit is&#160;set&#160;to 1,&#160;assuming&#160;that&#160;(1)&#160;that the&#160;exception would produce&#160;an&#160;<br/>error code&#160;normally&#160;(if not incident to double-fault delivery)&#160;and (2)&#160;that&#160;the error&#160;code&#160;uses the&#160;EXT bit&#160;<br/>(not for page&#160;faults, which use&#160;a different&#160;format).</p>
<p style="position:absolute;top:705px;left:94px;white-space:nowrap" class="ft02">—&#160;For other&#160;VM&#160;exits, the&#160;value&#160;of&#160;this field is&#160;undefined.</p>
<p style="position:absolute;top:755px;left:69px;white-space:nowrap" class="ft06">27.2.3&#160;</p>
<p style="position:absolute;top:755px;left:150px;white-space:nowrap" class="ft06">Information&#160;for VM&#160;Exits During Event Delivery</p>
<p style="position:absolute;top:786px;left:69px;white-space:nowrap" class="ft08"><a href="o_fe12b1e2a880e0ce-1068.html">Section&#160;24.9.3&#160;</a>defined fields containing information&#160;for&#160;VM&#160;exits that occur&#160;while&#160;delivering&#160;an event through the&#160;<br/>IDT and as&#160;a result&#160;of&#160;any of the&#160;following&#160;cases:</p>
<p style="position:absolute;top:800px;left:398px;white-space:nowrap" class="ft03">3</p>
<p style="position:absolute;top:824px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:825px;left:95px;white-space:nowrap" class="ft08">A fault occurs during&#160;event delivery&#160;and causes a&#160;VM&#160;exit&#160;(because&#160;the bit associated with the&#160;fault is&#160;set to&#160;1&#160;<br/>in the&#160;exception bitmap).</p>
<p style="position:absolute;top:863px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:864px;left:95px;white-space:nowrap" class="ft08">A&#160;task&#160;switch&#160;is invoked through&#160;a&#160;task gate in&#160;the IDT.&#160;The VM&#160;exit occurs due to&#160;the task&#160;switch&#160;only&#160;after the&#160;<br/>initial checks&#160;of&#160;the task swit<a href="o_fe12b1e2a880e0ce-1084.html">ch pass (see Section 25.4.2).</a></p>
<p style="position:absolute;top:902px;left:69px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:903px;left:95px;white-space:nowrap" class="ft02">Event&#160;delivery causes&#160;an APIC-access VM&#160;exit (see<a href="o_fe12b1e2a880e0ce-1171.html">&#160;Section 29.4</a>).</p>
<p style="position:absolute;top:946px;left:69px;white-space:nowrap" class="ft02">1.&#160;If&#160;the capability MSR&#160;IA32_VMX_CR0_FIXED0 reports that&#160;CR0.PE&#160;must&#160;be&#160;1 in&#160;VMX operation, a logical processor cannot&#160;be&#160;in&#160;real-</p>
<p style="position:absolute;top:963px;left:91px;white-space:nowrap" class="ft02">address mode unless the “unrestricted guest” VM-execution control and bit&#160;31&#160;of&#160;the&#160;primary processor-based&#160;VM-execution&#160;con-</p>
<p style="position:absolute;top:979px;left:91px;white-space:nowrap" class="ft02">trols are both 1.</p>
<p style="position:absolute;top:1000px;left:69px;white-space:nowrap" class="ft02">2.&#160;The conditions&#160;imply that, if&#160;the “NMI exiting”&#160;VM-execution&#160;control is 0&#160;or&#160;the “virtual&#160;NMIs” VM-execution&#160;control is 1,&#160;bit&#160;12&#160;&#160;is&#160;</p>
<p style="position:absolute;top:1017px;left:91px;white-space:nowrap" class="ft02">always&#160;cleared to&#160;0 by&#160;VM&#160;exits&#160;due&#160;to&#160;debug exceptions.</p>
<p style="position:absolute;top:1038px;left:69px;white-space:nowrap" class="ft02">3.&#160;This includes&#160;the&#160;case in&#160;which&#160;a VM&#160;exit&#160;occurs while delivering&#160;a&#160;software&#160;interrupt (INT&#160;<i>n</i>) through the 16-bit IVT&#160;(interrupt&#160;vec-</p>
<p style="position:absolute;top:1054px;left:91px;white-space:nowrap" class="ft02">tor table) that&#160;is used in virtual-8086&#160;mode&#160;with virtual-machine&#160;extensions (if RFLAGS.VM&#160;=&#160;CR4.VME&#160;=&#160;1).</p>
</div>
</body>
</html>
