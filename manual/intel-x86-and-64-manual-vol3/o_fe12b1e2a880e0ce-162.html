<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 162</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page162-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce162.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">5-10&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:97px;left:68px;white-space:nowrap" class="ft02">5.7&#160;</p>
<p style="position:absolute;top:97px;left:147px;white-space:nowrap" class="ft02">PRIVILEGE LEVEL CHECKING WHEN LOADING THE SS REGISTER</p>
<p style="position:absolute;top:133px;left:68px;white-space:nowrap" class="ft07">Privilege level checking&#160;also occurs when&#160;the SS&#160;register&#160;is loaded with the&#160;segment selector for a stack segment.&#160;<br/>Here all&#160;privilege levels&#160;related to&#160;the&#160;stack segment must&#160;match&#160;the CPL; that is, the CPL, the&#160;RPL of the&#160;stack-<br/>segment selector, and the DPL of the stack-segment descriptor&#160;must be&#160;the&#160;same. If the RPL&#160;and&#160;DPL are not&#160;equal&#160;<br/>to the&#160;CPL, a&#160;general-protection&#160;exception&#160;(#GP) is&#160;generated.</p>
<p style="position:absolute;top:238px;left:68px;white-space:nowrap" class="ft02">5.8&#160;</p>
<p style="position:absolute;top:238px;left:147px;white-space:nowrap" class="ft02">PRIVILEGE LEVEL CHECKING WHEN TRANSFERRING PROGRAM CONTROL&#160;</p>
<p style="position:absolute;top:264px;left:146px;white-space:nowrap" class="ft02">BETWEEN CODE SEGMENTS</p>
<p style="position:absolute;top:300px;left:68px;white-space:nowrap" class="ft09">To&#160;transfer&#160;program control from one&#160;code&#160;segment&#160;to&#160;another,&#160;the&#160;segment selector for the&#160;destination&#160;code&#160;<br/>segment must be loaded&#160;into&#160;the&#160;code-segment register&#160;(CS). As part of this&#160;loading&#160;process, the&#160;processor&#160;exam-<br/>ines the&#160;segment descriptor for the&#160;destination&#160;code&#160;segment and performs various limit, type,&#160;and&#160;privilege&#160;<br/>checks.&#160;If these&#160;checks are&#160;successful,&#160;the CS&#160;register is&#160;loaded, program control&#160;is&#160;transferred to&#160;the new code&#160;<br/>segment,&#160;and&#160;program execution&#160;begins&#160;at the&#160;instruction pointed&#160;to&#160;by&#160;the EIP&#160;register.&#160;<br/>Program&#160;control transfers&#160;are&#160;carried&#160;out&#160;with the JMP,&#160;CALL,&#160;RET,&#160;SYSENTER, SYSEXIT,&#160;SYSCALL,&#160;SYSRET, INT&#160;<i>n</i>,&#160;<br/>and IRET instructions, as well as by the&#160;exception&#160;and interrupt mechanisms.&#160;Exceptions,&#160;interrupts,&#160;and the IRET&#160;<br/>instruction&#160;are special cases discussed&#160;<a href="o_fe12b1e2a880e0ce-187.html">in Chapter&#160;6,&#160;“Interrupt and&#160;Exception&#160;Handling.”&#160;</a>This chapter discusses&#160;<br/>only&#160;the JMP,&#160;CALL,&#160;RET,&#160;SYSENTER,&#160;SYSEXIT,&#160;SYSCALL,&#160;and&#160;SYSRET&#160;instructions.<br/>A&#160;JMP or CALL&#160;instruction&#160;can reference&#160;another code segment in&#160;any of four ways:</p>
<p style="position:absolute;top:485px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:486px;left:93px;white-space:nowrap" class="ft03">The&#160;target&#160;operand&#160;contains&#160;the segment selector for the&#160;target&#160;code&#160;segment.</p>
<p style="position:absolute;top:508px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:508px;left:93px;white-space:nowrap" class="ft07">The target operand&#160;points to&#160;a call-gate descriptor,&#160;which&#160;contains&#160;the segment selector for&#160;the&#160;target&#160;code&#160;<br/>segment.</p>
<p style="position:absolute;top:547px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:547px;left:93px;white-space:nowrap" class="ft03">The target operand&#160;points to&#160;a TSS,&#160;which&#160;contains the&#160;segment&#160;selector&#160;for&#160;the target code segment.&#160;</p>
<p style="position:absolute;top:569px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:570px;left:93px;white-space:nowrap" class="ft07">The target&#160;operand points to&#160;a task gate,&#160;which points&#160;to&#160;a TSS,&#160;which&#160;in turn&#160;contains&#160;the segment selector for&#160;<br/>the target code segment.&#160;</p>
<p style="position:absolute;top:610px;left:68px;white-space:nowrap" class="ft07">The following sections describe&#160;first two types of&#160;references. Se<a href="o_fe12b1e2a880e0ce-247.html">e Section 7.3,&#160;“Task Switching,” for information&#160;</a>on&#160;<br/>transferring program control through&#160;a&#160;task gate and/or&#160;TSS.<br/>The SYSENTER&#160;and SYSEXIT instructions are&#160;special&#160;instructions&#160;for making fast calls to and returns from operating&#160;<br/>system or executive&#160;procedures.&#160;These&#160;instructions are&#160;discussed&#160;<a href="o_fe12b1e2a880e0ce-172.html">in Section 5.8.7,&#160;“Performing&#160;Fast Calls to&#160;<br/>System Procedures&#160;with&#160;the&#160;SYSENTER and&#160;SYSEXIT&#160;Instructions.”<br/></a>The SYCALL and&#160;SYSRET instructions are special instructions&#160;for making fast calls to and returns from operating&#160;<br/>system or executive&#160;procedures in&#160;64-bit mode.&#160;These instructions&#160;are discussed&#160;<a href="o_fe12b1e2a880e0ce-174.html">in Section 5.8.8,&#160;“Fast&#160;System&#160;<br/>Calls in 64-Bit Mode.”</a></p>
<p style="position:absolute;top:791px;left:68px;white-space:nowrap" class="ft06">5.8.1&#160;</p>
<p style="position:absolute;top:791px;left:148px;white-space:nowrap" class="ft06">Direct Calls or Jumps to&#160;Code Segments</p>
<p style="position:absolute;top:822px;left:68px;white-space:nowrap" class="ft07">The near&#160;forms&#160;of&#160;the JMP,&#160;CALL, and&#160;RET instructions transfer program control&#160;within the&#160;current code segment,&#160;<br/>so privilege-level&#160;checks are&#160;not performed.&#160;The far&#160;forms&#160;of&#160;the&#160;JMP,&#160;CALL,&#160;and RET instructions transfer&#160;control&#160;<br/>to other&#160;code&#160;segments, so&#160;the processor does&#160;perform&#160;privilege-level&#160;checks.&#160;<br/>When transferring&#160;program control to&#160;another code&#160;segment&#160;without going through a&#160;call gate,&#160;the&#160;processor&#160;<br/>examines&#160;four kinds of&#160;privilege&#160;level and type&#160;information&#160;<a href="o_fe12b1e2a880e0ce-163.html">(see&#160;Figure&#160;5-6)</a>:</p>
<p style="position:absolute;top:917px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:918px;left:93px;white-space:nowrap" class="ft07">The&#160;CPL.&#160;(Here,&#160;the&#160;CPL&#160;is the&#160;privilege&#160;level&#160;of&#160;the calling code&#160;segment; that&#160;is,&#160;the code segment that&#160;<br/>contains the procedure that&#160;is making the&#160;call&#160;or&#160;jump.)</p>
</div>
</body>
</html>
