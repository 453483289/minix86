<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1862</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#000000;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1862-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1862.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">41-52&#160;Vol. 3D</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SGX INSTRUCTION REFERENCES</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">EPA—Add&#160;Version Array&#160;</p>
<p style="position:absolute;top:248px;left:353px;white-space:nowrap" class="ft03">Instruction&#160;Operand&#160;Encoding</p>
<p style="position:absolute;top:333px;left:68px;white-space:nowrap" class="ft01">Description</p>
<p style="position:absolute;top:355px;left:68px;white-space:nowrap" class="ft04">This leaf function&#160;</p>
<p style="position:absolute;top:358px;left:187px;white-space:nowrap" class="ft05">creates an&#160;empty version&#160;array in&#160;the&#160;EPC&#160;page&#160;whose logical address is given by&#160;DS:RCX,&#160;and&#160;</p>
<p style="position:absolute;top:375px;left:68px;white-space:nowrap" class="ft07">sets up EPCM attributes for that&#160;page. At the&#160;time&#160;of execution of&#160;this&#160;instruction,&#160;the&#160;register&#160;RBX&#160;must&#160;be set&#160;to&#160;<br/>PT_VA.</p>
<p style="position:absolute;top:411px;left:68px;white-space:nowrap" class="ft04">The&#160;table&#160;below provides additional information&#160;on&#160;the memory parameter&#160;of&#160;EPA&#160;leaf function.</p>
<p style="position:absolute;top:457px;left:336px;white-space:nowrap" class="ft03">EPA&#160;Memory Parameter Semantics</p>
<p style="position:absolute;top:541px;left:68px;white-space:nowrap" class="ft01">Concurrency Restrictions</p>
<p style="position:absolute;top:847px;left:68px;white-space:nowrap" class="ft01">Operation</p>
<p style="position:absolute;top:888px;left:68px;white-space:nowrap" class="ft04">IF&#160;(RBX&#160;≠&#160;PT_VA or DS:RCX is&#160;not 4KByte Aligned)</p>
<p style="position:absolute;top:906px;left:88px;white-space:nowrap" class="ft04">THEN #GP(0); FI;</p>
<p style="position:absolute;top:942px;left:68px;white-space:nowrap" class="ft04">IF&#160;(DS:RCX does not resolve within an EPC)</p>
<p style="position:absolute;top:960px;left:88px;white-space:nowrap" class="ft04">THEN #PF(DS:RCX); FI;</p>
<p style="position:absolute;top:996px;left:68px;white-space:nowrap" class="ft08">(* Check concurrency with other Intel SGX instructions&#160;*)<br/>IF&#160;(Other&#160;Intel SGX&#160;instructions&#160;accessing&#160;the&#160;page)&#160;</p>
<p style="position:absolute;top:1032px;left:88px;white-space:nowrap" class="ft04">THEN #GP(0); FI;</p>
<p style="position:absolute;top:123px;left:77px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:139px;left:77px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:259px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:123px;left:315px;white-space:nowrap" class="ft04">64/32&#160;</p>
<p style="position:absolute;top:139px;left:315px;white-space:nowrap" class="ft04">bit Mode&#160;</p>
<p style="position:absolute;top:155px;left:315px;white-space:nowrap" class="ft04">Support</p>
<p style="position:absolute;top:123px;left:388px;white-space:nowrap" class="ft04">CPUID&#160;</p>
<p style="position:absolute;top:139px;left:388px;white-space:nowrap" class="ft04">Feature&#160;</p>
<p style="position:absolute;top:155px;left:388px;white-space:nowrap" class="ft04">Flag</p>
<p style="position:absolute;top:123px;left:454px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:175px;left:77px;white-space:nowrap" class="ft04">&#160;EAX = 0AH</p>
<p style="position:absolute;top:175px;left:259px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:175px;left:315px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:175px;left:388px;white-space:nowrap" class="ft04">SGX1</p>
<p style="position:absolute;top:175px;left:454px;white-space:nowrap" class="ft04">This leaf&#160;function adds&#160;a Version&#160;Array to&#160;the&#160;EPC.</p>
<p style="position:absolute;top:195px;left:77px;white-space:nowrap" class="ft04">ENCLS[EPA]</p>
<p style="position:absolute;top:271px;left:96px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:271px;left:255px;white-space:nowrap" class="ft04">EAX</p>
<p style="position:absolute;top:271px;left:477px;white-space:nowrap" class="ft04">RBX</p>
<p style="position:absolute;top:271px;left:708px;white-space:nowrap" class="ft04">RCX</p>
<p style="position:absolute;top:295px;left:108px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:295px;left:245px;white-space:nowrap" class="ft04">EPA (In)</p>
<p style="position:absolute;top:295px;left:431px;white-space:nowrap" class="ft04">PT_VA (In, Constant)</p>
<p style="position:absolute;top:295px;left:612px;white-space:nowrap" class="ft04">Effective&#160;address of&#160;the EPC page (In)</p>
<p style="position:absolute;top:480px;left:426px;white-space:nowrap" class="ft04">EPCPAGE</p>
<p style="position:absolute;top:504px;left:355px;white-space:nowrap" class="ft04">Write access&#160;permitted&#160;by Enclave</p>
<p style="position:absolute;top:579px;left:164px;white-space:nowrap" class="ft03">Table 41-34. &#160;Concurrency Restrictions&#160;of&#160;EPA with&#160;Other&#160;Intel® SGX&#160;Operations&#160;1 of&#160;2</p>
<p style="position:absolute;top:608px;left:87px;white-space:nowrap" class="ft06">Operation</p>
<p style="position:absolute;top:608px;left:187px;white-space:nowrap" class="ft06">EEXIT</p>
<p style="position:absolute;top:608px;left:263px;white-space:nowrap" class="ft06">EADD</p>
<p style="position:absolute;top:608px;left:320px;white-space:nowrap" class="ft06">EBLOCK</p>
<p style="position:absolute;top:602px;left:377px;white-space:nowrap" class="ft06">ECRE</p>
<p style="position:absolute;top:614px;left:380px;white-space:nowrap" class="ft06">ATE</p>
<p style="position:absolute;top:602px;left:418px;white-space:nowrap" class="ft06">EDBGRD/</p>
<p style="position:absolute;top:614px;left:432px;white-space:nowrap" class="ft06">WR</p>
<p style="position:absolute;top:602px;left:494px;white-space:nowrap" class="ft06">EENTER/</p>
<p style="position:absolute;top:614px;left:492px;white-space:nowrap" class="ft06">ERESUME</p>
<p style="position:absolute;top:608px;left:566px;white-space:nowrap" class="ft06">EEXTEND</p>
<p style="position:absolute;top:608px;left:633px;white-space:nowrap" class="ft06">EGETKEY</p>
<p style="position:absolute;top:608px;left:695px;white-space:nowrap" class="ft06">EINIT</p>
<p style="position:absolute;top:608px;left:742px;white-space:nowrap" class="ft06">ELDB/ELDU</p>
<p style="position:absolute;top:608px;left:817px;white-space:nowrap" class="ft06">EPA</p>
<p style="position:absolute;top:634px;left:122px;white-space:nowrap" class="ft06">Param&#160;TCS&#160;SSA&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:634px;left:413px;white-space:nowrap" class="ft06">Targ&#160;SECS&#160;TCS&#160;SSA&#160;SECS&#160;Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS&#160;Targ&#160;VA</p>
<p style="position:absolute;top:634px;left:785px;white-space:nowrap" class="ft06">SECS&#160;VA</p>
<p style="position:absolute;top:653px;left:68px;white-space:nowrap" class="ft06">EPA</p>
<p style="position:absolute;top:653px;left:122px;white-space:nowrap" class="ft06">VA</p>
<p style="position:absolute;top:653px;left:249px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:278px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:312px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:374px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:413px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:475px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:562px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:695px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:730px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:759px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:653px;left:816px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:704px;left:164px;white-space:nowrap" class="ft03">Table 41-35. &#160;Concurrency Restrictions&#160;of&#160;EPA with&#160;Other&#160;Intel® SGX&#160;Operations&#160;2 of&#160;2</p>
<p style="position:absolute;top:727px;left:87px;white-space:nowrap" class="ft06">Operation</p>
<p style="position:absolute;top:727px;left:165px;white-space:nowrap" class="ft06">EREMOVE</p>
<p style="position:absolute;top:727px;left:232px;white-space:nowrap" class="ft06">EREPORT</p>
<p style="position:absolute;top:727px;left:295px;white-space:nowrap" class="ft06">ETRACK</p>
<p style="position:absolute;top:727px;left:369px;white-space:nowrap" class="ft06">EWB</p>
<p style="position:absolute;top:727px;left:439px;white-space:nowrap" class="ft06">EAUG</p>
<p style="position:absolute;top:727px;left:493px;white-space:nowrap" class="ft06">EMODPE</p>
<p style="position:absolute;top:727px;left:553px;white-space:nowrap" class="ft06">EMODPR</p>
<p style="position:absolute;top:727px;left:618px;white-space:nowrap" class="ft06">EMODT</p>
<p style="position:absolute;top:727px;left:689px;white-space:nowrap" class="ft06">EACCEPT</p>
<p style="position:absolute;top:727px;left:764px;white-space:nowrap" class="ft06">EACCEPTCOPY</p>
<p style="position:absolute;top:746px;left:123px;white-space:nowrap" class="ft06">Param&#160;Targ&#160;SECS&#160;Param&#160;SECS&#160;SECS</p>
<p style="position:absolute;top:746px;left:342px;white-space:nowrap" class="ft06">SRC&#160;VA&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECI</p>
<p style="position:absolute;top:758px;left:516px;white-space:nowrap" class="ft06">NFO</p>
<p style="position:absolute;top:746px;left:548px;white-space:nowrap" class="ft06">Targ&#160;SECS&#160;Targ&#160;SECS&#160;Targ&#160;SECI</p>
<p style="position:absolute;top:758px;left:699px;white-space:nowrap" class="ft06">NFO</p>
<p style="position:absolute;top:746px;left:728px;white-space:nowrap" class="ft06">SECS&#160;Targ&#160;SR</p>
<p style="position:absolute;top:758px;left:788px;white-space:nowrap" class="ft06">C</p>
<p style="position:absolute;top:746px;left:814px;white-space:nowrap" class="ft06">SECI</p>
<p style="position:absolute;top:758px;left:814px;white-space:nowrap" class="ft06">NFO</p>
<p style="position:absolute;top:778px;left:68px;white-space:nowrap" class="ft06">EPA</p>
<p style="position:absolute;top:778px;left:123px;white-space:nowrap" class="ft06">VA</p>
<p style="position:absolute;top:778px;left:162px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:294px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:342px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:371px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:426px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:455px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:548px;white-space:nowrap" class="ft06">N</p>
<p style="position:absolute;top:778px;left:609px;white-space:nowrap" class="ft06">N</p>
</div>
</body>
</html>
