<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 319</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#0860a8;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page319-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce319.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:774px;white-space:nowrap" class="ft00">Vol. 3A&#160;9-7</p>
<p style="position:absolute;top:47px;left:560px;white-space:nowrap" class="ft01">PROCESSOR&#160;MANAGEMENT&#160;AND INITIALIZATION</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft06">To&#160;emulate floating-point&#160;instructions, the&#160;EM,&#160;MP, and NE&#160;flag in&#160;control&#160;register CR0&#160;should be set&#160;as shown in&#160;<br/><a href="o_fe12b1e2a880e0ce-319.html">Table 9-4.</a></p>
<p style="position:absolute;top:289px;left:69px;white-space:nowrap" class="ft06">Regardless&#160;of the value of the EM bit,&#160;the&#160;Intel486&#160;SX processor generates a device-not-available exception (#NM)&#160;<br/>upon encountering&#160;any floating-point&#160;instruction.</p>
<p style="position:absolute;top:361px;left:69px;white-space:nowrap" class="ft03">9.3 CACHE&#160;</p>
<p style="position:absolute;top:361px;left:216px;white-space:nowrap" class="ft03">ENABLING</p>
<p style="position:absolute;top:397px;left:69px;white-space:nowrap" class="ft06">IA-32 processors (beginning&#160;with&#160;the Intel486 processor) and&#160;Intel&#160;64&#160;processors contain internal&#160;instruction and&#160;<br/>data&#160;caches.&#160;These&#160;caches&#160;are enabled by clearing&#160;the&#160;CD&#160;and&#160;NW&#160;flags in control&#160;register&#160;CR0. (They are&#160;set&#160;<br/>during&#160;a hardware&#160;reset.) Because all&#160;internal cache&#160;lines&#160;are invalid following reset initialization,&#160;it is&#160;not neces-<br/>sary&#160;to invalidate&#160;the cache&#160;before&#160;enabling&#160;caching. Any external caches&#160;may require initialization and&#160;invalidation&#160;<br/>using&#160;a system-specific initialization&#160;and invalidation code&#160;sequence.<br/>Depending on&#160;the hardware and&#160;operating system&#160;or&#160;executive requirements,&#160;additional&#160;configuration of the&#160;<br/>processor’s&#160;caching facilities will probably be required. Beginning&#160;with the&#160;Intel486&#160;processor,&#160;page-level&#160;caching&#160;<br/>can be&#160;controlled&#160;with&#160;the&#160;PCD&#160;and PWT&#160;flags&#160;in page-directory&#160;and page-table entries.&#160;Beginning&#160;with the&#160;P6&#160;<br/>family&#160;processors, the&#160;memory type range&#160;registers (MTRRs)&#160;control the&#160;caching characteristics of&#160;the regions&#160;of&#160;<br/>physical memory. (For the Intel486 and Pentium&#160;processors,&#160;external hardware&#160;can&#160;be used to control the caching&#160;<br/>characteristics&#160;of regions of physical memory<a href="o_fe12b1e2a880e0ce-413.html">.) See Chapter 11, “Memory Cache Control,” for de</a>tailed information&#160;<br/>on configuration of the&#160;caching&#160;facilities in&#160;the&#160;Pentium 4, Intel Xeon, and&#160;P6&#160;family&#160;processors&#160;and system&#160;<br/>memory.</p>
<p style="position:absolute;top:658px;left:69px;white-space:nowrap" class="ft03">9.4&#160;</p>
<p style="position:absolute;top:658px;left:148px;white-space:nowrap" class="ft03">MODEL-SPECIFIC REGISTERS (MSRS)</p>
<p style="position:absolute;top:694px;left:69px;white-space:nowrap" class="ft07">Most&#160;IA-32 processors (starting from Pentium&#160;processors)&#160;and&#160;Intel 64&#160;processors contain a&#160;model-specific regis-<br/>ters (MSRs). A given MSR may not be&#160;supported across all families and&#160;models for Intel 64&#160;and IA-32 processors.&#160;<br/>Some MSRs&#160;are designated as&#160;architectural&#160;to simplify&#160;software programming; a&#160;feature introduced by&#160;an&#160;architec-<br/>tural MSR&#160;is expected&#160;to be&#160;supported&#160;in future processors.&#160;Non-architectural MSRs are not guaranteed&#160;to be&#160;<br/>supported&#160;or to&#160;have&#160;the&#160;same functions on&#160;future processors.&#160;&#160;&#160;<br/>MSRs&#160;that&#160;provide&#160;control for a&#160;number of hardware and&#160;software-related features, include:</p>
<p style="position:absolute;top:806px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:807px;left:95px;white-space:nowrap" class="ft02">Performance-monitoring&#160;coun<a href="o_fe12b1e2a880e0ce-1043.html">ters (see Chapter&#160;23, “Introduction to&#160;Virtual Machine Extensions”</a>).</p>
<p style="position:absolute;top:829px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:829px;left:95px;white-space:nowrap" class="ft02">Debug&#160;<a href="o_fe12b1e2a880e0ce-1043.html">extensions (see Chapter&#160;23, “Introduction to&#160;Virtual&#160;Machine Extensions.”</a>).</p>
<p style="position:absolute;top:851px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:852px;left:95px;white-space:nowrap" class="ft06">Machine-check&#160;exception capability and its&#160;accompanying machine-check&#160;architecture (see<a href="o_fe12b1e2a880e0ce-507.html">&#160;Chapter&#160;15,&#160;<br/>“Machine-Check&#160;Architecture”).</a></p>
<p style="position:absolute;top:890px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:891px;left:95px;white-space:nowrap" class="ft02">MTRRs&#160;(see<a href="o_fe12b1e2a880e0ce-432.html">&#160;Section 11.11,&#160;“Memory&#160;Type&#160;Range Registers (MTRRs)”).</a></p>
<p style="position:absolute;top:913px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:913px;left:95px;white-space:nowrap" class="ft02">Thermal and&#160;power management.</p>
<p style="position:absolute;top:935px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:936px;left:95px;white-space:nowrap" class="ft02">Instruction-specific support (for example: SYSENTER,&#160;SYSEXIT,&#160;SWAPGS, etc.).</p>
<p style="position:absolute;top:958px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:958px;left:95px;white-space:nowrap" class="ft02">Processor feature/mode&#160;support&#160;(for&#160;example: IA32_EFER, IA32_FEATURE_CONTROL).</p>
<p style="position:absolute;top:982px;left:69px;white-space:nowrap" class="ft06">The&#160;MSRs&#160;can be read and written to&#160;using the RDMSR and&#160;WRMSR instructions,&#160;respectively.<br/>When performing software&#160;initialization of&#160;an IA-32&#160;or Intel 64&#160;processor,&#160;many&#160;of the MSRs will&#160;need to be initial-<br/>ized&#160;to set&#160;up things&#160;like performance-monitoring&#160;events, run-time&#160;machine&#160;checks,&#160;and memory&#160;types for phys-<br/>ical memory.</p>
<p style="position:absolute;top:147px;left:237px;white-space:nowrap" class="ft05">Table&#160;9-4.&#160;&#160;Software&#160;Emulation&#160;Settings&#160;of&#160;EM, MP, and&#160;NE&#160;Flags</p>
<p style="position:absolute;top:172px;left:240px;white-space:nowrap" class="ft02">CR0 Bit</p>
<p style="position:absolute;top:172px;left:628px;white-space:nowrap" class="ft02">Value</p>
<p style="position:absolute;top:196px;left:254px;white-space:nowrap" class="ft02">EM</p>
<p style="position:absolute;top:196px;left:641px;white-space:nowrap" class="ft02">1</p>
<p style="position:absolute;top:220px;left:253px;white-space:nowrap" class="ft02">MP</p>
<p style="position:absolute;top:220px;left:641px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:244px;left:254px;white-space:nowrap" class="ft02">NE</p>
<p style="position:absolute;top:244px;left:641px;white-space:nowrap" class="ft02">1</p>
</div>
</body>
</html>
