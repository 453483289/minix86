<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 645</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:7px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft011{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
	.ft012{font-size:9px;line-height:14px;font-family:Times;color:#000000;}
	.ft013{font-size:7px;line-height:9px;font-family:Times;color:#000000;}
	.ft014{font-size:8px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page645-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce645.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:768px;white-space:nowrap" class="ft00">Vol. 3B&#160;18-9</p>
<p style="position:absolute;top:47px;left:672px;white-space:nowrap" class="ft01">PERFORMANCE MONITORING</p>
<p style="position:absolute;top:382px;left:95px;white-space:nowrap" class="ft09"><b>Bit 21&#160;(AnyThread)</b>&#160;of IA32_PERFEVTSELx is&#160;supported in architectural&#160;performance monitoring&#160;version 3 for&#160;<br/>processor core comprising of&#160;two or more&#160;logical processors.&#160;When set to&#160;1,&#160;it enables counting&#160;the associated&#160;<br/>event&#160;conditions (including matching the&#160;thread’s&#160;CPL with the&#160;OS/USR&#160;setting of IA32_PERFEVTSELx)&#160;<br/>occurring across all logical processors sharing a processor core. When bit 21&#160;is 0,&#160;the counter only increments&#160;<br/>the associated event&#160;conditions (including&#160;matching&#160;the thread’s&#160;CPL with&#160;the OS/USR setting of&#160;<br/>IA32_PERFEVTSELx)&#160;occurring in&#160;the&#160;logical processor&#160;which programmed&#160;the IA32_PERFEVTSELx MSR.<br/>—&#160;Each fixed-function performance&#160;counter IA32_FIXED_CTRx&#160;(starting at&#160;MSR address 309H) is&#160;configured&#160;</p>
<p style="position:absolute;top:505px;left:120px;white-space:nowrap" class="ft08">by&#160;a 4-bit control block&#160;in the&#160;IA32_PERF_FIXED_CTR_CTRL MSR. The control block&#160;also allow thread-<br/>specificity configuration&#160;using an&#160;AnyThread bit.&#160;The layout&#160;of&#160;IA32_PERF_FIXED_CTR_CTRL&#160;MSR is&#160;<br/>shown.&#160;</p>
<p style="position:absolute;top:828px;left:94px;white-space:nowrap" class="ft08">Each control block&#160;for&#160;a fixed-function performance&#160;counter provides a&#160;<b>AnyThread</b>&#160;(bit&#160;position&#160;2 + 4*N,&#160;N=&#160;<br/>0,&#160;1,&#160;etc.) bit.&#160;When&#160;set&#160;to 1,&#160;it&#160;enables counting the associated&#160;event&#160;conditions&#160;(including matching the&#160;<br/>thread’s&#160;CPL with&#160;the ENABLE setting of the&#160;corresponding control&#160;block of&#160;IA32_PERF_FIXED_CTR_CTRL)&#160;<br/>occurring across&#160;all logical processors sharing&#160;a processor&#160;core. When&#160;an&#160;<b>AnyThread&#160;</b>bit&#160;is 0 in&#160;<br/>IA32_PERF_FIXED_CTR_CTRL, the&#160;corresponding fixed&#160;counter only increments&#160;the associated event&#160;<br/>conditions occurring&#160;in&#160;the logical processor which programmed&#160;the IA32_PERF_FIXED_CTR_CTRL&#160;MSR.</p>
<p style="position:absolute;top:933px;left:69px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:933px;left:95px;white-space:nowrap" class="ft08">The&#160;IA32_PERF_GLOBAL_CTRL,&#160;IA32_PERF_GLOBAL_STATUS,&#160;IA32_PERF_GLOBAL_OVF_CTRL MSRs provide&#160;<br/>single-bit controls/status for each&#160;general-purpose and&#160;fixed-function performance&#160;counter.<a href="o_fe12b1e2a880e0ce-646.html">&#160;Figure 18-8&#160;</a>and&#160;<br/><a href="o_fe12b1e2a880e0ce-646.html">Figure&#160;18-9 show the&#160;</a>layout of these&#160;MSRs&#160;for&#160;N general-purpose performance&#160;counters (where&#160;N is&#160;reported&#160;<br/>by&#160;CPUID.0AH:EAX[15:8])&#160;and three fixed-function counters.<br/><b>Note:</b>&#160;The&#160;number&#160;of&#160;general-purpose&#160;performance&#160;monitori<a href="o_fe12b1e2a880e0ce-646.html">ng counters (i.e. N in Figure&#160;18-9)&#160;</a>can&#160;vary across&#160;<br/>processor generations within a processor family, across processor families, or could be different depending on&#160;<br/>the&#160;configuration chosen at&#160;boot&#160;time&#160;in the&#160;BIOS&#160;regarding Intel&#160;Hyper Threading Technology, (e.g.&#160;N=2&#160;for&#160;<br/>45&#160;nm Intel&#160;Atom&#160;processors; N =4&#160;for&#160;processors&#160;based on the&#160;Nehalem&#160;microarchitecture; for processors&#160;</p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft05">Figure&#160;18-6.&#160;&#160;Layout&#160;of&#160;IA32_PERFEVTSELx MSRs&#160;Supporting&#160;Architectural Performance&#160;Monitoring&#160;Version 3</p>
<p style="position:absolute;top:782px;left:113px;white-space:nowrap" class="ft05">Figure&#160;18-7. &#160;IA32_FIXED_CTR_CTRL&#160;MSR&#160;Supporting&#160;Architectural Performance&#160;Monitoring&#160;Version&#160;3</p>
<p style="position:absolute;top:130px;left:309px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:210px;left:226px;white-space:nowrap" class="ft011">INV—Invert counter&#160;mask<br/>EN—Enable counters</p>
<p style="position:absolute;top:251px;left:228px;white-space:nowrap" class="ft011">INT—APIC interrupt enable<br/>PC—Pin control</p>
<p style="position:absolute;top:130px;left:577px;white-space:nowrap" class="ft06">8&#160;7</p>
<p style="position:absolute;top:130px;left:677px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:160px;left:607px;white-space:nowrap" class="ft06">Event Select</p>
<p style="position:absolute;top:279px;left:228px;white-space:nowrap" class="ft011">E—Edge detect<br/>OS—Operating system mode<br/>USR—User&#160;Mode</p>
<p style="position:absolute;top:153px;left:316px;white-space:nowrap" class="ft06">Counter Mask&#160;</p>
<p style="position:absolute;top:160px;left:451px;white-space:nowrap" class="ft07">E</p>
<p style="position:absolute;top:157px;left:400px;white-space:nowrap" class="ft013">E<br/>N</p>
<p style="position:absolute;top:151px;left:427px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:160px;left:426px;white-space:nowrap" class="ft013">N<br/>T</p>
<p style="position:absolute;top:130px;left:435px;white-space:nowrap" class="ft06">19</p>
<p style="position:absolute;top:130px;left:473px;white-space:nowrap" class="ft06">16</p>
<p style="position:absolute;top:130px;left:447px;white-space:nowrap" class="ft06">18</p>
<p style="position:absolute;top:130px;left:485px;white-space:nowrap" class="ft06">15</p>
<p style="position:absolute;top:130px;left:460px;white-space:nowrap" class="ft06">17</p>
<p style="position:absolute;top:130px;left:423px;white-space:nowrap" class="ft06">20</p>
<p style="position:absolute;top:130px;left:410px;white-space:nowrap" class="ft06">21</p>
<p style="position:absolute;top:130px;left:397px;white-space:nowrap" class="ft06">22</p>
<p style="position:absolute;top:130px;left:384px;white-space:nowrap" class="ft06">23</p>
<p style="position:absolute;top:130px;left:372px;white-space:nowrap" class="ft06">24</p>
<p style="position:absolute;top:290px;left:610px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:151px;left:389px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:160px;left:388px;white-space:nowrap" class="ft013">N<br/>V</p>
<p style="position:absolute;top:157px;left:438px;white-space:nowrap" class="ft013">P<br/>C</p>
<p style="position:absolute;top:151px;left:476px;white-space:nowrap" class="ft013">U<br/>S<br/>R</p>
<p style="position:absolute;top:157px;left:463px;white-space:nowrap" class="ft07">O</p>
<p style="position:absolute;top:166px;left:463px;white-space:nowrap" class="ft07">S</p>
<p style="position:absolute;top:160px;left:490px;white-space:nowrap" class="ft06">Unit&#160;Mask&#160;(UMASK)</p>
<p style="position:absolute;top:164px;left:325px;white-space:nowrap" class="ft06">(CMASK)</p>
<p style="position:absolute;top:129px;left:246px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:237px;left:227px;white-space:nowrap" class="ft00">ANY—Any&#160;Thread</p>
<p style="position:absolute;top:150px;left:412px;white-space:nowrap" class="ft07">A</p>
<p style="position:absolute;top:159px;left:412px;white-space:nowrap" class="ft013">N<br/>Y</p>
<p style="position:absolute;top:680px;left:219px;white-space:nowrap" class="ft014">Cntr2 — Controls for&#160;IA32_FIXED_CTR2<br/>Cntr1 — Controls for&#160;IA32_FIXED_CTR1</p>
<p style="position:absolute;top:708px;left:220px;white-space:nowrap" class="ft06">PMI&#160;—&#160;Enable&#160;PMI on overflow&#160;on IA32_FIXED_CTR0</p>
<p style="position:absolute;top:722px;left:219px;white-space:nowrap" class="ft06">AnyThread — AnyThread for&#160;IA32_FIXED_CTR0</p>
<p style="position:absolute;top:599px;left:570px;white-space:nowrap" class="ft06">8&#160;7</p>
<p style="position:absolute;top:599px;left:672px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:736px;left:219px;white-space:nowrap" class="ft06">ENABLE — IA32_FIXED_CTR0. 0:&#160;disable;&#160;1: OS; 2:&#160;User; 3:&#160;All ring levels</p>
<p style="position:absolute;top:622px;left:665px;white-space:nowrap" class="ft013">E<br/>N</p>
<p style="position:absolute;top:619px;left:631px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:628px;left:632px;white-space:nowrap" class="ft013">M<br/>I</p>
<p style="position:absolute;top:599px;left:525px;white-space:nowrap" class="ft06">11</p>
<p style="position:absolute;top:599px;left:630px;white-space:nowrap" class="ft06">3</p>
<p style="position:absolute;top:599px;left:511px;white-space:nowrap" class="ft06">12</p>
<p style="position:absolute;top:599px;left:656px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:753px;left:252px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:598px;left:239px;white-space:nowrap" class="ft06">63</p>
<p style="position:absolute;top:599px;left:644px;white-space:nowrap" class="ft06">2</p>
<p style="position:absolute;top:623px;left:615px;white-space:nowrap" class="ft013">E<br/>N</p>
<p style="position:absolute;top:623px;left:564px;white-space:nowrap" class="ft013">E<br/>N</p>
<p style="position:absolute;top:599px;left:621px;white-space:nowrap" class="ft06">4</p>
<p style="position:absolute;top:599px;left:558px;white-space:nowrap" class="ft06">9</p>
<p style="position:absolute;top:599px;left:610px;white-space:nowrap" class="ft06">5</p>
<p style="position:absolute;top:618px;left:581px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:618px;left:527px;white-space:nowrap" class="ft07">P</p>
<p style="position:absolute;top:627px;left:580px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:626px;left:527px;white-space:nowrap" class="ft07">M</p>
<p style="position:absolute;top:636px;left:584px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:635px;left:529px;white-space:nowrap" class="ft07">I</p>
<p style="position:absolute;top:616px;left:542px;white-space:nowrap" class="ft013">A<br/>N</p>
<p style="position:absolute;top:636px;left:542px;white-space:nowrap" class="ft07">Y</p>
<p style="position:absolute;top:618px;left:595px;white-space:nowrap" class="ft013">A<br/>N<br/>Y</p>
<p style="position:absolute;top:619px;left:644px;white-space:nowrap" class="ft013">A<br/>N<br/>Y</p>
</div>
</body>
</html>
