<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 378</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:16px;font-family:Times;color:#0860a8;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:3px;font-family:Times;color:#000000;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:9px;line-height:12px;font-family:Times;color:#000000;}
	.ft011{font-size:9px;line-height:13px;font-family:Times;color:#000000;}
	.ft012{font-size:9px;line-height:14px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page378-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce378.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">10-16&#160;Vol. 3A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">ADVANCED PROGRAMMABLE INTERRUPT CONTROLLER&#160;(APIC)</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft07">The ESR is a write/read register. Before&#160;attempt to read from&#160;the&#160;ESR, software should first write to it. (The value&#160;<br/>written does not affect the values read&#160;subsequently; only&#160;zero may&#160;be written in x2APIC mode.) This write clears&#160;<br/>any previously&#160;logged&#160;errors&#160;and updates&#160;the ESR&#160;with&#160;any&#160;errors detected since&#160;the last&#160;write to&#160;the ESR. This&#160;<br/>write&#160;also rearms&#160;the APIC&#160;error&#160;interrupt triggering&#160;mechanism.<br/>The LVT&#160;Error Register<a href="o_fe12b1e2a880e0ce-374.html">&#160;(see Section 10.5.1) all</a>ows specification of the vector of the interrupt to be&#160;delivered to&#160;the&#160;<br/>processor&#160;core&#160;when&#160;APIC error is&#160;detected. The&#160;register&#160;also provides&#160;a means of masking&#160;an APIC-error interrupt.&#160;<br/>This&#160;masking only prevents&#160;delivery&#160;of APIC-error&#160;interrupts;&#160;the APIC continues to&#160;record&#160;errors in&#160;the ESR.</p>
<p style="position:absolute;top:257px;left:68px;white-space:nowrap" class="ft03">10.5.4 APIC&#160;</p>
<p style="position:absolute;top:257px;left:190px;white-space:nowrap" class="ft03">Timer</p>
<p style="position:absolute;top:288px;left:68px;white-space:nowrap" class="ft07">The local APIC unit contains&#160;a 32-bit programmable&#160;timer that&#160;is&#160;available&#160;to software to&#160;time events&#160;or operations.&#160;<br/>This timer&#160;is set up by programming four registers: the&#160;divide&#160;configuration register&#160;(see<a href="o_fe12b1e2a880e0ce-378.html">&#160;Figure&#160;10-10</a>), the initial-<br/>count and current-count registers&#160;<a href="o_fe12b1e2a880e0ce-378.html">(see&#160;Figure&#160;10-11)</a>, and the&#160;LVT timer&#160;<a href="o_fe12b1e2a880e0ce-375.html">register (see Figure&#160;10-8).&#160;<br/></a>If CPUID.06H:EAX.ARAT[bit&#160;2] = 1,&#160;the&#160;processor’s APIC&#160;timer runs at&#160;a constant rate&#160;regardless&#160;of&#160;P-state&#160;transi-<br/>tions and&#160;it continues&#160;to run at&#160;the&#160;same&#160;rate&#160;in deep&#160;C-states.<br/>If CPUID.06H:EAX.ARAT[bit 2] = 0&#160;or&#160;if CPUID&#160;06H is not&#160;supported,&#160;the APIC timer may temporarily stop while&#160;the&#160;<br/>processor&#160;is in&#160;deep&#160;C-states&#160;or&#160;during transitions caused by&#160;Enhanced&#160;Intel SpeedStep® Technology.</p>
<p style="position:absolute;top:903px;left:68px;white-space:nowrap" class="ft07">The&#160;APIC timer frequency will be the&#160;processor’s bus&#160;clock&#160;or core&#160;crystal clock frequency&#160;(when&#160;TSC/core&#160;crystal&#160;<br/>clock ratio&#160;is enumerated&#160;in CPUID&#160;leaf 0x15) divided by&#160;the&#160;value&#160;specified in the&#160;divide&#160;configuration register.<br/>The timer&#160;can be configured&#160;through the&#160;timer LVT&#160;entry&#160;for&#160;one-shot or&#160;periodic operation.&#160;In one-shot&#160;mode,&#160;the&#160;<br/>timer is&#160;started by programming its&#160;initial-count&#160;register.&#160;The&#160;initial count value&#160;is then&#160;copied into the&#160;current-<br/>count&#160;register and count-down begins.&#160;After the&#160;timer reaches&#160;zero, an timer&#160;interrupt is&#160;generated&#160;and the timer&#160;<br/>remains at&#160;its 0&#160;value until&#160;reprogrammed.&#160;<br/>In periodic&#160;mode,&#160;the current-count register&#160;is automatically&#160;reloaded from the&#160;initial-count&#160;register when the&#160;<br/>count reaches 0 and&#160;a timer&#160;interrupt is&#160;generated,&#160;and&#160;the count-down&#160;is repeated. If during the&#160;count-down&#160;</p>
<p style="position:absolute;top:634px;left:304px;white-space:nowrap" class="ft04">Figure&#160;10-10. &#160;Divide&#160;Configuration Register</p>
<p style="position:absolute;top:703px;left:171px;white-space:nowrap" class="ft05">&#160;</p>
<p style="position:absolute;top:857px;left:265px;white-space:nowrap" class="ft04">Figure&#160;10-11. &#160;Initial Count and&#160;Current&#160;Count&#160;Registers</p>
<p style="position:absolute;top:493px;left:238px;white-space:nowrap" class="ft010">Address: FEE0 03E0H<br/>Value after reset: 0H</p>
<p style="position:absolute;top:458px;left:631px;white-space:nowrap" class="ft00">0</p>
<p style="position:absolute;top:501px;left:438px;white-space:nowrap" class="ft00">Divide&#160;Value (bits 0,&#160;1 and 3)</p>
<p style="position:absolute;top:514px;left:439px;white-space:nowrap" class="ft012">000: Divide&#160;by 2<br/>001: Divide&#160;by 4<br/>010: Divide&#160;by 8<br/>011: Divide by&#160;16</p>
<p style="position:absolute;top:569px;left:438px;white-space:nowrap" class="ft010">100: Divide by 32<br/>101: Divide by 64<br/>110: Divide by 128<br/>111:&#160;Divide by 1</p>
<p style="position:absolute;top:440px;left:238px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:440px;left:658px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:459px;left:358px;white-space:nowrap" class="ft00">Reserved</p>
<p style="position:absolute;top:440px;left:645px;white-space:nowrap" class="ft06">1</p>
<p style="position:absolute;top:440px;left:631px;white-space:nowrap" class="ft06">2</p>
<p style="position:absolute;top:440px;left:619px;white-space:nowrap" class="ft06">3</p>
<p style="position:absolute;top:440px;left:603px;white-space:nowrap" class="ft06">4</p>
<p style="position:absolute;top:714px;left:251px;white-space:nowrap" class="ft06">31</p>
<p style="position:absolute;top:714px;left:646px;white-space:nowrap" class="ft06">0</p>
<p style="position:absolute;top:738px;left:422px;white-space:nowrap" class="ft00">Initial Count</p>
<p style="position:absolute;top:798px;left:265px;white-space:nowrap" class="ft00">Address: Initial Count</p>
<p style="position:absolute;top:826px;left:265px;white-space:nowrap" class="ft00">Value&#160;after reset: 0H</p>
<p style="position:absolute;top:770px;left:416px;white-space:nowrap" class="ft00">Current Count</p>
<p style="position:absolute;top:812px;left:316px;white-space:nowrap" class="ft00">Current Count&#160;FEE0 0390H</p>
<p style="position:absolute;top:799px;left:395px;white-space:nowrap" class="ft00">FEE0 0380H</p>
</div>
</body>
</html>
