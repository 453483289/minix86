<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 159</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:9px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page159-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce159.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:774px;white-space:nowrap" class="ft00">Vol. 3A&#160;5-7</p>
<p style="position:absolute;top:47px;left:763px;white-space:nowrap" class="ft01">PROTECTION</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft07">The center&#160;(reserved for the most privileged code, data, and&#160;stacks) is used for the segments containing&#160;the critical&#160;<br/>software,&#160;usually&#160;the kernel of an&#160;operating system. Outer rings are&#160;used&#160;for&#160;less&#160;critical software. (Systems&#160;that&#160;<br/>use only 2&#160;of the&#160;4 possible&#160;privilege&#160;levels&#160;should use&#160;levels 0&#160;and&#160;3.)&#160;</p>
<p style="position:absolute;top:478px;left:69px;white-space:nowrap" class="ft07">The processor uses privilege levels to prevent a program or&#160;task operating at a lesser privilege level from accessing&#160;<br/>a segment with a greater privilege, except under&#160;controlled situations. When&#160;the&#160;processor detects a privilege level&#160;<br/>violation,&#160;it&#160;generates&#160;a general-protection exception (#GP).<br/>To&#160;carry out privilege-level&#160;checks between code segments and&#160;data&#160;segments, the&#160;processor&#160;recognizes&#160;the&#160;<br/>following three&#160;types of&#160;privilege&#160;levels:&#160;</p>
<p style="position:absolute;top:573px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:574px;left:95px;white-space:nowrap" class="ft07"><b>Current&#160;privilege level (CPL)</b>&#160;— The&#160;CPL is&#160;the&#160;privilege level of the&#160;currently executing&#160;program or&#160;task.&#160;It&#160;<br/>is stored&#160;in bits 0 and 1&#160;of the CS and&#160;SS&#160;segment registers.&#160;Normally,&#160;the CPL is equal to the&#160;privilege&#160;level of&#160;<br/>the code segment from which&#160;instructions&#160;are&#160;being&#160;fetched. The processor changes&#160;the CPL when program&#160;<br/>control&#160;is transferred&#160;to&#160;a code segment with&#160;a&#160;different&#160;privilege level. The&#160;CPL&#160;is treated&#160;slightly differently&#160;<br/>when&#160;accessing conforming code&#160;segments.&#160;Conforming&#160;code segments can&#160;be&#160;accessed from&#160;any&#160;privilege&#160;<br/>level&#160;that&#160;is equal to&#160;or numerically greater (less privileged) than the&#160;DPL of&#160;the&#160;conforming code&#160;segment.&#160;<br/>Also, the&#160;CPL&#160;is not changed&#160;when the&#160;processor accesses&#160;a conforming code segment that has&#160;a different&#160;<br/>privilege&#160;level&#160;than the&#160;CPL.</p>
<p style="position:absolute;top:711px;left:69px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:712px;left:95px;white-space:nowrap" class="ft09"><b>Descriptor&#160;privilege level (DPL)</b>&#160;—&#160;The DPL is the privilege level of&#160;a segment or gate.<b>&#160;</b>It is stored in the DPL&#160;<br/>field of the&#160;segment&#160;or gate descriptor for&#160;the segment or gate. When&#160;the currently executing code segment&#160;<br/>attempts to access a&#160;segment&#160;or gate,&#160;the DPL of the&#160;segment&#160;or gate&#160;is&#160;compared&#160;to&#160;the CPL and&#160;RPL of the&#160;<br/>segment or gate&#160;selector&#160;(as described later in this&#160;section). The DPL&#160;is&#160;interpreted differently, depending on&#160;<br/>the type of segment or&#160;gate&#160;being&#160;accessed:<br/>—&#160;<b>Data&#160;segment</b>&#160;— The&#160;DPL&#160;indicates&#160;the numerically highest privilege level&#160;that a&#160;program&#160;or task can&#160;have&#160;</p>
<p style="position:absolute;top:818px;left:120px;white-space:nowrap" class="ft07">to&#160;be&#160;allowed to&#160;access the segment. For example, if&#160;the DPL&#160;of&#160;a data&#160;segment&#160;is 1, only programs running&#160;<br/>at&#160;a CPL of 0&#160;or 1&#160;can access the&#160;segment.&#160;</p>
<p style="position:absolute;top:859px;left:95px;white-space:nowrap" class="ft02">—&#160;<b>Nonconforming&#160;code segment&#160;(without using a call gate)</b>&#160;— The DPL indicates the&#160;privilege&#160;level&#160;that&#160;</p>
<p style="position:absolute;top:875px;left:120px;white-space:nowrap" class="ft07">a program&#160;or&#160;task must be at&#160;to access the&#160;segment.&#160;For&#160;example,&#160;if the&#160;DPL&#160;of a&#160;nonconforming code&#160;<br/>segment is&#160;0, only programs running&#160;at&#160;a CPL of 0&#160;can access the&#160;segment.&#160;</p>
<p style="position:absolute;top:916px;left:94px;white-space:nowrap" class="ft02">—&#160;<b>Call gate</b>&#160;— The DPL indicates&#160;the numerically&#160;highest&#160;privilege level that&#160;the&#160;currently executing program&#160;</p>
<p style="position:absolute;top:932px;left:120px;white-space:nowrap" class="ft07">or&#160;task can be at&#160;and&#160;still be able to&#160;access&#160;the call&#160;gate.&#160;(This is&#160;the same&#160;access&#160;rule as&#160;for a data&#160;<br/>segment.)</p>
<p style="position:absolute;top:973px;left:94px;white-space:nowrap" class="ft02">—&#160;<b>Conforming&#160;code segment and nonconforming&#160;code segment accessed through a call&#160;gate</b>&#160;— The&#160;</p>
<p style="position:absolute;top:989px;left:120px;white-space:nowrap" class="ft07">DPL indicates&#160;the numerically&#160;lowest&#160;privilege&#160;level that&#160;a program or task can have&#160;to be allowed to&#160;access&#160;<br/>the segment. For example, if the DPL of a conforming&#160;code segment&#160;is 2, programs running&#160;at&#160;a&#160;CPL of 0&#160;or&#160;<br/>1&#160;cannot access the&#160;segment.&#160;</p>
<p style="position:absolute;top:432px;left:357px;white-space:nowrap" class="ft05">Figure&#160;5-3. &#160;Protection&#160;Rings</p>
<p style="position:absolute;top:313px;left:490px;white-space:nowrap" class="ft00">Level 0</p>
<p style="position:absolute;top:353px;left:490px;white-space:nowrap" class="ft00">Level 1</p>
<p style="position:absolute;top:378px;left:490px;white-space:nowrap" class="ft00">Level 2</p>
<p style="position:absolute;top:400px;left:490px;white-space:nowrap" class="ft00">Level 3</p>
<p style="position:absolute;top:198px;left:464px;white-space:nowrap" class="ft06"><b>Protection&#160;Rings</b></p>
<p style="position:absolute;top:286px;left:336px;white-space:nowrap" class="ft00">Operating</p>
<p style="position:absolute;top:337px;left:294px;white-space:nowrap" class="ft00">Operating System</p>
<p style="position:absolute;top:351px;left:344px;white-space:nowrap" class="ft00">Services</p>
<p style="position:absolute;top:300px;left:348px;white-space:nowrap" class="ft00">System</p>
<p style="position:absolute;top:314px;left:353px;white-space:nowrap" class="ft00">Kernel</p>
<p style="position:absolute;top:397px;left:325px;white-space:nowrap" class="ft00">Applications</p>
</div>
</body>
</html>
