<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1786</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:18px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1786-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1786.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">38-16&#160;Vol. 3D</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">ENCLAVE ACCESS&#160;CONTROL&#160;AND DATA STRUCTURES</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">38.17.1&#160;&#160;KEY REQUEST KeyNames</p>
<p style="position:absolute;top:358px;left:68px;white-space:nowrap" class="ft02">38.17.2&#160;&#160;Key Request Policy Structure</p>
<p style="position:absolute;top:555px;left:68px;white-space:nowrap" class="ft03">38.18&#160;&#160;VERSION ARRAY (VA)</p>
<p style="position:absolute;top:589px;left:68px;white-space:nowrap" class="ft06">In order to securely store&#160;the versions&#160;of&#160;evicted EPC pages,&#160;Intel&#160;SGX defines a&#160;special EPC page type called&#160;a&#160;<br/>Version Array (VA).&#160;Each&#160;VA&#160;page contains 512&#160;slots,&#160;each of which can&#160;contain&#160;an 8-byte&#160;version&#160;number for a&#160;<br/>page&#160;evicted from the&#160;EPC.&#160;When&#160;an EPC page&#160;is evicted,&#160;software&#160;chooses&#160;an empty&#160;slot in&#160;a VA&#160;page;&#160;this&#160;slot&#160;<br/>receives the&#160;unique&#160;version&#160;number of the page&#160;being evicted.&#160;When&#160;the EPC page&#160;is&#160;reloaded,&#160;there must be a VA&#160;<br/>slot that must&#160;hold the version&#160;of the page. If the page is&#160;successfully reloaded, the&#160;version in the VA&#160;slot is cleared.<br/>VA&#160;pages can&#160;be&#160;evicted,&#160;just like any&#160;other EPC page.&#160;When&#160;evicting&#160;a VA&#160;page, a&#160;version&#160;slot in&#160;some&#160;other VA&#160;<br/>page must be used to&#160;hold&#160;the&#160;version&#160;for&#160;the VA&#160;being&#160;evicted. A Version&#160;Array&#160;Page must be 4K-Bytes&#160;aligned.</p>
<p style="position:absolute;top:907px;left:68px;white-space:nowrap" class="ft03">38.19&#160;&#160;ENCLAVE PAGE CACHE MAP (EPCM)</p>
<p style="position:absolute;top:942px;left:68px;white-space:nowrap" class="ft06">EPCM is&#160;a secure&#160;structure used&#160;by&#160;the&#160;processor to&#160;track the&#160;contents&#160;of the&#160;EPC. The EPCM holds&#160;exactly one&#160;<br/>entry for each&#160;page&#160;that&#160;is currently loaded&#160;into&#160;the EPC. EPCM&#160;is not&#160;accessible by software, and&#160;the layout&#160;of&#160;<br/>EPCM&#160;fields&#160;is&#160;implementation specific.</p>
<p style="position:absolute;top:146px;left:312px;white-space:nowrap" class="ft05">Table 38-24. &#160;Supported KEYName&#160;Values</p>
<p style="position:absolute;top:168px;left:112px;white-space:nowrap" class="ft04">Key&#160;Name</p>
<p style="position:absolute;top:168px;left:240px;white-space:nowrap" class="ft04">Value</p>
<p style="position:absolute;top:168px;left:533px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:190px;left:75px;white-space:nowrap" class="ft04">EINITOKEN_KEY</p>
<p style="position:absolute;top:190px;left:219px;white-space:nowrap" class="ft04">0</p>
<p style="position:absolute;top:190px;left:305px;white-space:nowrap" class="ft04">EINIT_TOKEN&#160;key</p>
<p style="position:absolute;top:213px;left:75px;white-space:nowrap" class="ft04">PROVISION_KEY</p>
<p style="position:absolute;top:213px;left:219px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:213px;left:305px;white-space:nowrap" class="ft04">Provisioning Key</p>
<p style="position:absolute;top:235px;left:75px;white-space:nowrap" class="ft04">PROVISION_SEAL_KEY&#160;2</p>
<p style="position:absolute;top:235px;left:305px;white-space:nowrap" class="ft04">Provisioning Seal Key</p>
<p style="position:absolute;top:258px;left:75px;white-space:nowrap" class="ft04">REPORT_KEY</p>
<p style="position:absolute;top:258px;left:219px;white-space:nowrap" class="ft04">3</p>
<p style="position:absolute;top:258px;left:304px;white-space:nowrap" class="ft04">Report Key</p>
<p style="position:absolute;top:280px;left:75px;white-space:nowrap" class="ft04">SEAL_KEY</p>
<p style="position:absolute;top:280px;left:219px;white-space:nowrap" class="ft04">4</p>
<p style="position:absolute;top:280px;left:305px;white-space:nowrap" class="ft04">Seal Key</p>
<p style="position:absolute;top:303px;left:219px;white-space:nowrap" class="ft04">All other</p>
<p style="position:absolute;top:303px;left:305px;white-space:nowrap" class="ft04">Reserved</p>
<p style="position:absolute;top:406px;left:317px;white-space:nowrap" class="ft05">Table&#160;38-25.&#160;&#160;Layout&#160;of&#160;KEYPOLICY&#160;Field</p>
<p style="position:absolute;top:427px;left:113px;white-space:nowrap" class="ft04">Field</p>
<p style="position:absolute;top:427px;left:195px;white-space:nowrap" class="ft04">Bit Position</p>
<p style="position:absolute;top:427px;left:520px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:450px;left:73px;white-space:nowrap" class="ft04">MRENCLAVE</p>
<p style="position:absolute;top:450px;left:192px;white-space:nowrap" class="ft04">0</p>
<p style="position:absolute;top:450px;left:277px;white-space:nowrap" class="ft04">If 1,&#160;derive&#160;key using&#160;the&#160;enclave's MRENCLAVE measurement register.</p>
<p style="position:absolute;top:472px;left:73px;white-space:nowrap" class="ft04">MRSIGNER</p>
<p style="position:absolute;top:472px;left:192px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:472px;left:277px;white-space:nowrap" class="ft04">If&#160;1,&#160;derive&#160;key using the enclave's MRSIGNER&#160;measurement&#160;register.</p>
<p style="position:absolute;top:495px;left:73px;white-space:nowrap" class="ft04">RESERVED</p>
<p style="position:absolute;top:495px;left:192px;white-space:nowrap" class="ft04">15:2</p>
<p style="position:absolute;top:495px;left:277px;white-space:nowrap" class="ft04">Must be&#160;zero.</p>
<p style="position:absolute;top:736px;left:275px;white-space:nowrap" class="ft05">Table 38-26.&#160;&#160;Layout of&#160;Version Array Data Structure</p>
<p style="position:absolute;top:757px;left:110px;white-space:nowrap" class="ft04">Field</p>
<p style="position:absolute;top:757px;left:189px;white-space:nowrap" class="ft04">OFFSET (Bytes)&#160;Size (Bytes)</p>
<p style="position:absolute;top:757px;left:573px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:780px;left:74px;white-space:nowrap" class="ft04">Slot&#160;0</p>
<p style="position:absolute;top:780px;left:185px;white-space:nowrap" class="ft04">0</p>
<p style="position:absolute;top:780px;left:296px;white-space:nowrap" class="ft04">08</p>
<p style="position:absolute;top:780px;left:385px;white-space:nowrap" class="ft04">Version Slot&#160;0</p>
<p style="position:absolute;top:802px;left:74px;white-space:nowrap" class="ft04">Slot&#160;1</p>
<p style="position:absolute;top:802px;left:185px;white-space:nowrap" class="ft04">8</p>
<p style="position:absolute;top:802px;left:296px;white-space:nowrap" class="ft04">08</p>
<p style="position:absolute;top:802px;left:385px;white-space:nowrap" class="ft04">Version Slot&#160;1</p>
<p style="position:absolute;top:825px;left:74px;white-space:nowrap" class="ft07">...<br/>Slot&#160;511</p>
<p style="position:absolute;top:847px;left:185px;white-space:nowrap" class="ft04">4088</p>
<p style="position:absolute;top:847px;left:296px;white-space:nowrap" class="ft04">08</p>
<p style="position:absolute;top:847px;left:385px;white-space:nowrap" class="ft04">Version&#160;Slot&#160;511</p>
</div>
</body>
</html>
