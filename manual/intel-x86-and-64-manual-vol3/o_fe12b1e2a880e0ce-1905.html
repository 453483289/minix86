<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1905</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1905-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1905.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:760px;white-space:nowrap" class="ft00">Vol. 3D&#160;41-95</p>
<p style="position:absolute;top:47px;left:654px;white-space:nowrap" class="ft01">SGX INSTRUCTION REFERENCES</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">EREPORTâ€”Create&#160;a Cryptographic Report of&#160;the Enclave&#160;</p>
<p style="position:absolute;top:248px;left:354px;white-space:nowrap" class="ft03">Instruction Operand&#160;Encoding</p>
<p style="position:absolute;top:349px;left:69px;white-space:nowrap" class="ft01">Description</p>
<p style="position:absolute;top:372px;left:69px;white-space:nowrap" class="ft05">This leaf&#160;function creates a&#160;cryptographic REPORT&#160;that&#160;describes the&#160;contents of the&#160;enclave.&#160;This instruction&#160;leaf&#160;<br/>can only be&#160;executed&#160;when inside the&#160;enclave.&#160;The cryptographic&#160;report&#160;can be&#160;used&#160;by other&#160;enclaves&#160;to deter-<br/>mine&#160;that the enclave is&#160;running&#160;on&#160;the&#160;same&#160;platform.<br/>RBX contains the&#160;effective address&#160;of&#160;the MRENCLAVE value of&#160;the enclave&#160;that will authenticate&#160;the REPORT&#160;<br/>output, using the&#160;REPORT&#160;key delivered&#160;by EGETKEY command&#160;for that enclave.&#160;RCX contains&#160;the effective address&#160;<br/>of a&#160;64-byte&#160;REPORTDATA&#160;structure, which allows the&#160;caller of the&#160;instruction&#160;to associate data&#160;with&#160;the enclave&#160;<br/>from which the&#160;instruction is called. RDX contains the address where the REPORT&#160;will be output by the instruction.</p>
<p style="position:absolute;top:523px;left:319px;white-space:nowrap" class="ft03">EREPORT&#160;Memory Parameter Semantics</p>
<p style="position:absolute;top:607px;left:69px;white-space:nowrap" class="ft08">This instruction leaf perform the&#160;following:&#160;<br/>1.&#160;Validate the&#160;3&#160;operands&#160;(RBX,&#160;RCX,&#160;RDX) are inside the&#160;enclave.<br/>2.&#160;Compute a&#160;report&#160;key for the&#160;target enclave,&#160;as&#160;indicated by the&#160;value located in&#160;RBX(TARGETINFO).<br/>3.&#160;Assemble the enclave SECS data to complete the REPORT&#160;structure (including&#160;the data&#160;provided using the&#160;RCX&#160;</p>
<p style="position:absolute;top:696px;left:94px;white-space:nowrap" class="ft04">(REPORTDATA) operand).</p>
<p style="position:absolute;top:720px;left:69px;white-space:nowrap" class="ft05">4.&#160;Computes a&#160;crytpographic hash over&#160;REPORT&#160;structure.<br/>5.&#160;Add&#160;the computed&#160;hash to&#160;the REPORT&#160;structure.<br/>6.&#160;Output the completed REPORT&#160;structure to&#160;the address&#160;in RDX (OUTPUTDATA).&#160;<br/>The instruction fails&#160;if&#160;the operands are not properly aligned.<br/>CR_REPORT_KEYID,&#160;used to&#160;provide key&#160;wearout&#160;protection, is populated&#160;with&#160;a statistically unique value on&#160;boot&#160;<br/>of the&#160;platform&#160;by a&#160;trusted&#160;entity within the&#160;SGX TCB.</p>
<p style="position:absolute;top:874px;left:69px;white-space:nowrap" class="ft04">The instruction faults if&#160;any&#160;of the&#160;following:&#160;</p>
<p style="position:absolute;top:123px;left:78px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:139px;left:78px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:260px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:123px;left:316px;white-space:nowrap" class="ft04">64/32&#160;</p>
<p style="position:absolute;top:139px;left:316px;white-space:nowrap" class="ft04">bit Mode&#160;</p>
<p style="position:absolute;top:155px;left:316px;white-space:nowrap" class="ft04">Support</p>
<p style="position:absolute;top:123px;left:389px;white-space:nowrap" class="ft04">CPUID&#160;</p>
<p style="position:absolute;top:139px;left:389px;white-space:nowrap" class="ft04">Feature&#160;</p>
<p style="position:absolute;top:155px;left:389px;white-space:nowrap" class="ft04">Flag</p>
<p style="position:absolute;top:123px;left:456px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:175px;left:78px;white-space:nowrap" class="ft04">&#160;EAX = 00H</p>
<p style="position:absolute;top:175px;left:260px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:175px;left:316px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:175px;left:389px;white-space:nowrap" class="ft04">SGX1</p>
<p style="position:absolute;top:175px;left:456px;white-space:nowrap" class="ft04">This leaf&#160;function creates&#160;a cryptographic report&#160;of&#160;the enclave.</p>
<p style="position:absolute;top:195px;left:78px;white-space:nowrap" class="ft04">ENCLU[EREPORT]</p>
<p style="position:absolute;top:271px;left:97px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:271px;left:223px;white-space:nowrap" class="ft04">EAX</p>
<p style="position:absolute;top:271px;left:378px;white-space:nowrap" class="ft04">RBX</p>
<p style="position:absolute;top:271px;left:537px;white-space:nowrap" class="ft04">RCX</p>
<p style="position:absolute;top:271px;left:719px;white-space:nowrap" class="ft04">RDX</p>
<p style="position:absolute;top:303px;left:109px;white-space:nowrap" class="ft04">IR</p>
<p style="position:absolute;top:303px;left:197px;white-space:nowrap" class="ft04">EREPORT (In)</p>
<p style="position:absolute;top:295px;left:321px;white-space:nowrap" class="ft04">Address of&#160;TARGETINFO&#160;</p>
<p style="position:absolute;top:312px;left:381px;white-space:nowrap" class="ft04">(In)</p>
<p style="position:absolute;top:295px;left:478px;white-space:nowrap" class="ft04">Address of&#160;REPORTDATA&#160;</p>
<p style="position:absolute;top:312px;left:540px;white-space:nowrap" class="ft04">(In)</p>
<p style="position:absolute;top:295px;left:646px;white-space:nowrap" class="ft04">Address where the REPORT&#160;is&#160;</p>
<p style="position:absolute;top:312px;left:635px;white-space:nowrap" class="ft04">written&#160;to&#160;in&#160;an&#160;OUTPUTDATA&#160;(In)</p>
<p style="position:absolute;top:546px;left:163px;white-space:nowrap" class="ft04">TARGETINFO</p>
<p style="position:absolute;top:546px;left:418px;white-space:nowrap" class="ft04">REPORTDATA</p>
<p style="position:absolute;top:546px;left:669px;white-space:nowrap" class="ft04">OUTPUTDATA</p>
<p style="position:absolute;top:570px;left:135px;white-space:nowrap" class="ft04">Read access&#160;by Enclave&#160;</p>
<p style="position:absolute;top:570px;left:392px;white-space:nowrap" class="ft04">Read access by&#160;Enclave&#160;</p>
<p style="position:absolute;top:570px;left:626px;white-space:nowrap" class="ft04">Read/Write access&#160;by Enclave&#160;</p>
</div>
</body>
</html>
