<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1128</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:18px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:22px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1128-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_fe12b1e2a880e0ce1128.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">27-10&#160;Vol. 3C</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">VM&#160;EXITS</p>
<p style="position:absolute;top:488px;left:93px;white-space:nowrap" class="ft02">—&#160;VM&#160;exits due&#160;to EPT violations that set bit&#160;7&#160;of&#160;the&#160;exit&#160;qualification (see<a href="o_fe12b1e2a880e0ce-1127.html">&#160;Table&#160;27-7;&#160;</a>these are&#160;all&#160;EPT&#160;</p>
<p style="position:absolute;top:504px;left:119px;white-space:nowrap" class="ft07">violations except&#160;those resulting from&#160;an attempt&#160;to load the&#160;PDPTEs as&#160;of execution&#160;of&#160;the MOV&#160;CR&#160;<br/>instruction).&#160;The linear address&#160;may translate to&#160;the&#160;guest-physical&#160;address whose access caused the&#160;EPT&#160;<br/>violation. Alternatively,&#160;translation&#160;of&#160;the linear&#160;address may reference a&#160;paging-structure entry whose&#160;<br/>access caused&#160;the&#160;EPT&#160;violation. Bits&#160;63:32&#160;are&#160;cleared&#160;if&#160;the logical processor was&#160;not in 64-bit&#160;mode&#160;<br/>before the&#160;VM&#160;exit.<br/>If the EPT violation&#160;occurred during execution of&#160;an instruction&#160;in enclave mode (and not during&#160;delivery&#160;of&#160;<br/>an&#160;event incident&#160;to enclave&#160;mode),&#160;bits&#160;11:0 of this&#160;field&#160;are cleared.</p>
<p style="position:absolute;top:635px;left:93px;white-space:nowrap" class="ft02">—&#160;For all&#160;other VM&#160;exits,&#160;the&#160;field is&#160;undefined.</p>
<p style="position:absolute;top:657px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:658px;left:93px;white-space:nowrap" class="ft07"><b>Guest-physical address.</b>&#160;For a VM&#160;exit due to an&#160;EPT&#160;violation or an&#160;EPT&#160;misconfiguration,&#160;this field receives&#160;<br/>the&#160;guest-physical address&#160;that caused&#160;the&#160;EPT violation or&#160;EPT misconfiguration. For&#160;all other VM&#160;exits, the&#160;<br/>field is&#160;undefined.<br/>If&#160;the&#160;EPT violation&#160;or&#160;EPT misconfiguration occurred during execution of an instruction in&#160;enclave&#160;mode&#160;(and&#160;<br/>not during&#160;delivery&#160;of&#160;an event incident to enclave mode),&#160;bits&#160;11:0&#160;of this&#160;field&#160;are cleared.</p>
<p style="position:absolute;top:780px;left:68px;white-space:nowrap" class="ft05">27.2.2&#160;</p>
<p style="position:absolute;top:780px;left:148px;white-space:nowrap" class="ft05">Information for VM&#160;Exits Due to&#160;Vectored Events</p>
<p style="position:absolute;top:811px;left:68px;white-space:nowrap" class="ft08"><a href="o_fe12b1e2a880e0ce-1068.html">Section&#160;24.9.2 defines fields containin</a>g&#160;information for VM&#160;exits due&#160;to the following&#160;events: exceptions (including&#160;<br/>those generated by&#160;the instructions INT3,&#160;INTO, BOUND,&#160;and UD2); external&#160;interrupts that&#160;occur while the&#160;<br/>“acknowledge interrupt on exit” VM-exit control is&#160;1;&#160;and non-maskable&#160;interrupts (NMIs).&#160;Such VM&#160;exits include&#160;<br/>those that occur&#160;on&#160;an attempt&#160;at a task&#160;switch that&#160;causes an exception&#160;before generating&#160;the VM&#160;exit due to the&#160;<br/>task switch that causes&#160;the&#160;VM&#160;exit.<br/>The following items&#160;detail&#160;the use&#160;of these&#160;fields:</p>
<p style="position:absolute;top:922px;left:68px;white-space:nowrap" class="ft03">•</p>
<p style="position:absolute;top:923px;left:93px;white-space:nowrap" class="ft08"><b>VM-exit&#160;interruption&#160;information</b>&#160;(format give<a href="o_fe12b1e2a880e0ce-1068.html">n in Table&#160;24-15).&#160;</a>The&#160;following items detail how this field is&#160;<br/>established for&#160;VM&#160;exits due to&#160;these&#160;events:<br/>—&#160;For an&#160;exception,&#160;bits&#160;7:0&#160;receive the&#160;exception vector (at&#160;most 31).&#160;For&#160;an&#160;NMI,&#160;bits&#160;7:0 are&#160;set&#160;to 2.&#160;For&#160;</p>
<p style="position:absolute;top:980px;left:119px;white-space:nowrap" class="ft02">an&#160;external&#160;interrupt, bits&#160;7:0 receive&#160;the&#160;vector.</p>
<p style="position:absolute;top:1004px;left:93px;white-space:nowrap" class="ft02">—&#160;Bits&#160;10:8&#160;are set&#160;to 0 (external&#160;interrupt),&#160;2&#160;(non-maskable interrupt),&#160;3 (hardware exception), or 6&#160;</p>
<p style="position:absolute;top:1021px;left:119px;white-space:nowrap" class="ft07">(software exception).&#160;Hardware exceptions&#160;comprise&#160;all exceptions&#160;except breakpoint exceptions&#160;(#BP;&#160;<br/>generated by INT3) and overflow exceptions (#OF; generated&#160;by INTO); these&#160;are software&#160;exceptions.&#160;(A&#160;<br/>#BP that occurs in&#160;enclave mode is considered&#160;a hardware exception.) BOUND-range exceeded&#160;exceptions&#160;</p>
<p style="position:absolute;top:162px;left:79px;white-space:nowrap" class="ft02">8</p>
<p style="position:absolute;top:162px;left:189px;white-space:nowrap" class="ft010">If&#160;&#160;bit&#160;7&#160;&#160;is&#160;&#160;1:<br/>•&#160;Set&#160;if&#160;the access causing the&#160;EPT&#160;violation&#160;is to&#160;a guest-physical address that&#160;is&#160;the translation&#160;of&#160;a linear&#160;</p>
<p style="position:absolute;top:197px;left:205px;white-space:nowrap" class="ft02">address.</p>
<p style="position:absolute;top:213px;left:189px;white-space:nowrap" class="ft02">•&#160;Clear&#160;if the access&#160;causing the&#160;EPT&#160;violation is&#160;to&#160;a&#160;paging-structure&#160;entry as&#160;part of&#160;a page walk or the&#160;</p>
<p style="position:absolute;top:227px;left:205px;white-space:nowrap" class="ft02">update of&#160;an accessed or dirty bit.</p>
<p style="position:absolute;top:247px;left:189px;white-space:nowrap" class="ft02">Reserved if bit&#160;7&#160;is 0 (cleared to&#160;0).</p>
<p style="position:absolute;top:276px;left:79px;white-space:nowrap" class="ft02">11:9</p>
<p style="position:absolute;top:276px;left:189px;white-space:nowrap" class="ft02">Reserved&#160;(cleared&#160;to&#160;0).</p>
<p style="position:absolute;top:304px;left:79px;white-space:nowrap" class="ft02">12</p>
<p style="position:absolute;top:304px;left:189px;white-space:nowrap" class="ft02">NMI unblocking due&#160;to&#160;IRET</p>
<p style="position:absolute;top:332px;left:79px;white-space:nowrap" class="ft02">63:13</p>
<p style="position:absolute;top:332px;left:189px;white-space:nowrap" class="ft02">Reserved&#160;(cleared&#160;to&#160;0).</p>
<p style="position:absolute;top:362px;left:71px;white-space:nowrap" class="ft01">NOTES:</p>
<p style="position:absolute;top:381px;left:70px;white-space:nowrap" class="ft02">1. If accessed and&#160;dirty flags for EPT are&#160;enabled,&#160;processor accesses&#160;to&#160;guest paging-structure&#160;entries are treated as&#160;writes&#160;with&#160;</p>
<p style="position:absolute;top:398px;left:84px;white-space:nowrap" class="ft02">regard&#160;to&#160;EPT&#160;violations&#160;(see<a href="o_fe12b1e2a880e0ce-1156.html">&#160;Section 28.2.3.2). If such an access</a>&#160;causes&#160;an&#160;EPT violation,&#160;the&#160;processor sets&#160;both bit 0 and&#160;bit&#160;1 of&#160;</p>
<p style="position:absolute;top:414px;left:84px;white-space:nowrap" class="ft02">the exit&#160;qualification.</p>
<p style="position:absolute;top:434px;left:70px;white-space:nowrap" class="ft02">2.&#160;Bits&#160;5:3 are&#160;cleared&#160;to 0 if&#160;any of&#160;EPT paging-structure&#160;entries used&#160;to&#160;translate the&#160;guest-physical address of&#160;the&#160;access&#160;causing&#160;the&#160;</p>
<p style="position:absolute;top:450px;left:84px;white-space:nowrap" class="ft02">EPT violation&#160;is not present (see<a href="o_fe12b1e2a880e0ce-1151.html">&#160;Section&#160;28.2.2).</a></p>
<p style="position:absolute;top:100px;left:263px;white-space:nowrap" class="ft06">Table 27-7.&#160; Exit Qualification for&#160;EPT Violations (Contd.)</p>
<p style="position:absolute;top:133px;left:79px;white-space:nowrap" class="ft02">Bit&#160;Position(s)</p>
<p style="position:absolute;top:133px;left:190px;white-space:nowrap" class="ft02">Contents</p>
</div>
</body>
</html>
