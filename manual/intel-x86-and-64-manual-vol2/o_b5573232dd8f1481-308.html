<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 308</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
	.ft011{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
	.ft012{font-size:11px;line-height:19px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page308-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481308.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:659px;white-space:nowrap" class="ft00">CMPXCHG—Compare and Exchange</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INSTRUCTION SET REFERENCE, A-L</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">3-180&#160;Vol. 2A</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">CMPXCHG—Compare and Exchange</p>
<p style="position:absolute;top:476px;left:353px;white-space:nowrap" class="ft03">Instruction&#160;Operand&#160;Encoding</p>
<p style="position:absolute;top:560px;left:68px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:585px;left:68px;white-space:nowrap" class="ft07">Compares&#160;the&#160;value&#160;in&#160;the&#160;AL,&#160;AX,&#160;EAX,&#160;or&#160;RAX&#160;register&#160;with&#160;the&#160;first operand&#160;(destination&#160;operand). If&#160;the two&#160;<br/>values&#160;are&#160;equal,&#160;the&#160;second&#160;operand (source&#160;operand)&#160;is&#160;loaded&#160;into&#160;the&#160;destination operand. Otherwise,&#160;the&#160;<br/>destination&#160;operand is&#160;loaded into the&#160;AL,&#160;AX,&#160;EAX&#160;or RAX&#160;register.&#160;RAX&#160;register&#160;is&#160;available only in&#160;64-bit mode.<br/>This&#160;instruction can be used with a&#160;LOCK&#160;prefix&#160;to allow&#160;the instruction to&#160;be&#160;executed&#160;atomically.&#160;To&#160;simplify&#160;the&#160;<br/>interface to&#160;the&#160;processor’s bus,&#160;the destination operand receives&#160;a write cycle&#160;without regard&#160;to the&#160;result of the&#160;<br/>comparison.&#160;The&#160;destination operand&#160;is written back if&#160;the&#160;comparison fails; otherwise, the&#160;source operand&#160;is&#160;<br/>written into the&#160;destination. (The processor never produces a&#160;locked read without&#160;also producing a&#160;locked write.)<br/>In 64-bit&#160;mode,&#160;the instruction’s&#160;default operation size&#160;is&#160;32 bits.&#160;Use&#160;of the&#160;REX.R prefix&#160;permits access to&#160;addi-<br/>tional registers&#160;(R8-R15).&#160;Use&#160;of the&#160;REX.W prefix&#160;promotes&#160;operation to 64 bits.&#160;See the&#160;summary chart&#160;at the&#160;<br/>beginning of this&#160;section for encoding data and&#160;limits.</p>
<p style="position:absolute;top:782px;left:68px;white-space:nowrap" class="ft03">IA-32 Architecture&#160;Compatibility</p>
<p style="position:absolute;top:807px;left:68px;white-space:nowrap" class="ft04">This&#160;instruction is&#160;not&#160;supported on Intel processors earlier than the&#160;Intel486 processors.</p>
<p style="position:absolute;top:840px;left:68px;white-space:nowrap" class="ft03">Operation</p>
<p style="position:absolute;top:871px;left:68px;white-space:nowrap" class="ft04">(* Accumulator&#160;</p>
<p style="position:absolute;top:869px;left:156px;white-space:nowrap" class="ft05">=</p>
<p style="position:absolute;top:871px;left:165px;white-space:nowrap" class="ft04">&#160;AL, AX, EAX,&#160;or&#160;RAX&#160;depending&#160;on&#160;whether a&#160;byte, word,&#160;doubleword, or&#160;quadword&#160;comparison&#160;is&#160;being performed&#160;*)</p>
<p style="position:absolute;top:889px;left:68px;white-space:nowrap" class="ft04">TEMP&#160;←&#160;DEST</p>
<p style="position:absolute;top:907px;left:68px;white-space:nowrap" class="ft04">IF accumulator&#160;</p>
<p style="position:absolute;top:905px;left:154px;white-space:nowrap" class="ft05">=</p>
<p style="position:absolute;top:907px;left:163px;white-space:nowrap" class="ft04">&#160;TEMP</p>
<p style="position:absolute;top:925px;left:88px;white-space:nowrap" class="ft04">THEN</p>
<p style="position:absolute;top:943px;left:115px;white-space:nowrap" class="ft04">ZF&#160;←&#160;1;</p>
<p style="position:absolute;top:961px;left:115px;white-space:nowrap" class="ft04">DEST&#160;←&#160;SRC;</p>
<p style="position:absolute;top:979px;left:88px;white-space:nowrap" class="ft04">ELSE</p>
<p style="position:absolute;top:997px;left:115px;white-space:nowrap" class="ft04">ZF&#160;←&#160;0;</p>
<p style="position:absolute;top:1015px;left:115px;white-space:nowrap" class="ft04">accumulator&#160;←&#160;TEMP;</p>
<p style="position:absolute;top:1033px;left:115px;white-space:nowrap" class="ft04">DEST&#160;←&#160;TEMP;</p>
<p style="position:absolute;top:1051px;left:68px;white-space:nowrap" class="ft04">FI;</p>
<p style="position:absolute;top:128px;left:73px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:143px;left:73px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:128px;left:296px;white-space:nowrap" class="ft04">Op/&#160;</p>
<p style="position:absolute;top:143px;left:296px;white-space:nowrap" class="ft04">En</p>
<p style="position:absolute;top:128px;left:333px;white-space:nowrap" class="ft04">64-Bit&#160;</p>
<p style="position:absolute;top:143px;left:333px;white-space:nowrap" class="ft04">Mode</p>
<p style="position:absolute;top:128px;left:405px;white-space:nowrap" class="ft04">Compat/</p>
<p style="position:absolute;top:143px;left:405px;white-space:nowrap" class="ft04">Leg Mode</p>
<p style="position:absolute;top:128px;left:475px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:166px;left:73px;white-space:nowrap" class="ft010">0F&#160;B0/<i>r<br/></i>CMPXCHG&#160;<i>r/m8, r8</i></p>
<p style="position:absolute;top:166px;left:296px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:166px;left:333px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:166px;left:405px;white-space:nowrap" class="ft04">Valid*</p>
<p style="position:absolute;top:166px;left:475px;white-space:nowrap" class="ft04">Compare AL&#160;with&#160;<i>r/m8</i>. If equal, ZF is&#160;set and&#160;<i>r8</i>&#160;is loaded into&#160;</p>
<p style="position:absolute;top:182px;left:475px;white-space:nowrap" class="ft06"><i>r/m8</i>.&#160;Else, clear&#160;ZF&#160;and load&#160;<i>r/m8</i>&#160;into AL.</p>
<p style="position:absolute;top:209px;left:73px;white-space:nowrap" class="ft011">REX + 0F B0/<i>r<br/></i>CMPXCHG&#160;<i>r/m8**,r8</i></p>
<p style="position:absolute;top:209px;left:296px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:209px;left:333px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:209px;left:405px;white-space:nowrap" class="ft04">N.E.</p>
<p style="position:absolute;top:209px;left:475px;white-space:nowrap" class="ft04">Compare AL&#160;with&#160;<i>r/m8</i>. If equal, ZF is&#160;set and&#160;<i>r8</i>&#160;is loaded into&#160;</p>
<p style="position:absolute;top:226px;left:475px;white-space:nowrap" class="ft06"><i>r/m8</i>.&#160;Else, clear&#160;ZF&#160;and load&#160;<i>r/m8</i>&#160;into AL.</p>
<p style="position:absolute;top:253px;left:73px;white-space:nowrap" class="ft010">0F&#160;B1/<i>r<br/></i>CMPXCHG&#160;<i>r/m16,&#160;r16</i></p>
<p style="position:absolute;top:253px;left:296px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:253px;left:333px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:253px;left:405px;white-space:nowrap" class="ft04">Valid*</p>
<p style="position:absolute;top:253px;left:475px;white-space:nowrap" class="ft04">Compare AX&#160;with&#160;<i>r/m16</i>. If equal, ZF is set and&#160;<i>r16</i>&#160;is loaded&#160;</p>
<p style="position:absolute;top:269px;left:475px;white-space:nowrap" class="ft04">into&#160;<i>r/m16</i>. Else,&#160;clear ZF and load&#160;<i>r/m16</i>&#160;into&#160;AX.</p>
<p style="position:absolute;top:296px;left:73px;white-space:nowrap" class="ft010">0F&#160;B1/<i>r<br/></i>CMPXCHG&#160;<i>r/m32,&#160;r32</i></p>
<p style="position:absolute;top:296px;left:296px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:296px;left:333px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:296px;left:405px;white-space:nowrap" class="ft04">Valid*</p>
<p style="position:absolute;top:296px;left:475px;white-space:nowrap" class="ft04">Compare&#160;EAX with&#160;<i>r/m32</i>. If equal, ZF is set and&#160;<i>r32</i>&#160;is loaded&#160;</p>
<p style="position:absolute;top:313px;left:475px;white-space:nowrap" class="ft04">into&#160;<i>r/m32</i>. Else,&#160;clear ZF and load&#160;<i>r/m32</i>&#160;into&#160;EAX.</p>
<p style="position:absolute;top:340px;left:73px;white-space:nowrap" class="ft011">REX.W + 0F B1/<i>r<br/></i>CMPXCHG&#160;<i>r/m64,&#160;r64</i></p>
<p style="position:absolute;top:340px;left:296px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:340px;left:333px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:340px;left:405px;white-space:nowrap" class="ft04">N.E.</p>
<p style="position:absolute;top:340px;left:475px;white-space:nowrap" class="ft04">Compare RAX with&#160;<i>r/m64</i>. If equal, ZF is set and&#160;<i>r64</i>&#160;is loaded&#160;</p>
<p style="position:absolute;top:357px;left:475px;white-space:nowrap" class="ft04">into&#160;<i>r/m64</i>. Else,&#160;clear ZF and load&#160;<i>r/m64</i>&#160;into RAX.</p>
<p style="position:absolute;top:384px;left:73px;white-space:nowrap" class="ft01">NOTES:</p>
<p style="position:absolute;top:403px;left:73px;white-space:nowrap" class="ft012">*&#160;See&#160;the IA-32&#160;Architecture&#160;Compatibility section below.&#160;<br/>**&#160;In&#160;64-bit mode,<i>&#160;r/m8</i>&#160;can&#160;not be&#160;encoded to access&#160;the following&#160;byte&#160;registers&#160;if&#160;a REX&#160;prefix&#160;is&#160;used: AH,&#160;BH,&#160;CH, DH.&#160;</p>
<p style="position:absolute;top:499px;left:85px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:499px;left:202px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:499px;left:386px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:499px;left:557px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:499px;left:723px;white-space:nowrap" class="ft04">Operand&#160;4</p>
<p style="position:absolute;top:523px;left:93px;white-space:nowrap" class="ft04">MR</p>
<p style="position:absolute;top:523px;left:183px;white-space:nowrap" class="ft04">ModRM:r/m&#160;(r, w)</p>
<p style="position:absolute;top:523px;left:376px;white-space:nowrap" class="ft04">ModRM:reg&#160;(r)</p>
<p style="position:absolute;top:523px;left:578px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:523px;left:744px;white-space:nowrap" class="ft04">NA</p>
</div>
</body>
</html>
