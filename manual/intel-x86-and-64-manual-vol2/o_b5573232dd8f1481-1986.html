<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1986</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1986-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811986.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:534px;white-space:nowrap" class="ft00">GETSEC[ENTERACCS] - Execute Authenticated Chipset Code</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-12&#160;Vol. 2D</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft04">A&#160;summary of the&#160;register state&#160;initialization after&#160;successful&#160;completion of GETSEC[ENTERACCS] is&#160;given for the&#160;<br/>processor in&#160;<a href="o_b5573232dd8f1481-1986.html">Table&#160;6-4. The paging</a>&#160;is disabled&#160;upon entry&#160;into authenticated code execution&#160;mode. The&#160;authenti-<br/>cated code&#160;module&#160;is loaded&#160;and initially executed&#160;using physical addresses.&#160;It is&#160;up&#160;to&#160;the system&#160;software&#160;after&#160;<br/>execution&#160;of GETSEC[ENTERACCS] to&#160;establish&#160;a new (or&#160;restore&#160;its&#160;previous) paging environment&#160;with&#160;an appro-<br/>priate mapping to meet new protection requirements.&#160;EBP&#160;is initialized to&#160;the authenticated code module&#160;base&#160;<br/>physical&#160;address for initial&#160;execution in&#160;the authenticated environment. As a&#160;result,&#160;the authenticated code can&#160;<br/>reference&#160;EBP for relative&#160;address based&#160;references, given&#160;that&#160;the authenticated code module must be position&#160;<br/>independent.</p>
<p style="position:absolute;top:894px;left:68px;white-space:nowrap" class="ft04">The segmentation&#160;related processor state that&#160;has&#160;not&#160;been initialized by GETSEC[ENTERACCS] requires&#160;appro-<br/>priate&#160;initialization before&#160;use. Since&#160;a&#160;new&#160;GDT context&#160;has&#160;been&#160;established,&#160;the previous&#160;state&#160;of&#160;the segment&#160;<br/>selector&#160;values&#160;held in ES, SS,&#160;FS,&#160;GS, TR, and LDTR might&#160;not&#160;be&#160;valid.&#160;<br/>The MSR IA32_EFER is also unconditionally cleared as part&#160;of the processor state initialized&#160;by ENTERACCS.&#160;Since&#160;<br/>paging&#160;is disabled upon entering authenticated code execution mode, a&#160;new&#160;paging environment&#160;will&#160;have&#160;to&#160;be&#160;<br/>reestablished&#160;in order to establish&#160;IA-32e&#160;mode while&#160;operating in authenticated code execution mode.<br/>Debug exception and trap related&#160;signaling&#160;is also&#160;disabled&#160;as part of GETSEC[ENTERACCS].&#160;This&#160;is achieved&#160;by&#160;<br/>resetting&#160;DR7,&#160;TF in EFLAGs,&#160;and the MSR&#160;IA32_DEBUGCTL.&#160;These debug functions are&#160;free&#160;to be&#160;re-enabled&#160;once&#160;<br/>supporting exception&#160;handler(s), descriptor&#160;tables, and&#160;debug&#160;registers have&#160;been properly initialized following&#160;</p>
<p style="position:absolute;top:255px;left:229px;white-space:nowrap" class="ft03">Table 6-4.&#160;&#160;Register&#160;State Initialization after GETSEC[ENTERACCS]&#160;</p>
<p style="position:absolute;top:289px;left:78px;white-space:nowrap" class="ft02">Register State</p>
<p style="position:absolute;top:289px;left:212px;white-space:nowrap" class="ft02">Initialization&#160;Status</p>
<p style="position:absolute;top:289px;left:539px;white-space:nowrap" class="ft02">Comment</p>
<p style="position:absolute;top:317px;left:78px;white-space:nowrap" class="ft02">CR0</p>
<p style="position:absolute;top:317px;left:212px;white-space:nowrap" class="ft02">PG←0, AM←0, WP←0: Others&#160;unchanged</p>
<p style="position:absolute;top:317px;left:539px;white-space:nowrap" class="ft02">Paging,&#160;Alignment Check,&#160;Write-protection&#160;are&#160;</p>
<p style="position:absolute;top:333px;left:539px;white-space:nowrap" class="ft02">disabled.</p>
<p style="position:absolute;top:361px;left:78px;white-space:nowrap" class="ft02">CR4</p>
<p style="position:absolute;top:361px;left:212px;white-space:nowrap" class="ft02">MCE←0: Others unchanged</p>
<p style="position:absolute;top:361px;left:539px;white-space:nowrap" class="ft02">Machine&#160;Check&#160;Exceptions&#160;disabled.</p>
<p style="position:absolute;top:390px;left:78px;white-space:nowrap" class="ft02">EFLAGS</p>
<p style="position:absolute;top:390px;left:212px;white-space:nowrap" class="ft02">00000002H</p>
<p style="position:absolute;top:418px;left:78px;white-space:nowrap" class="ft02">IA32_EFER</p>
<p style="position:absolute;top:418px;left:212px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:418px;left:539px;white-space:nowrap" class="ft02">IA-32e mode&#160;disabled.</p>
<p style="position:absolute;top:447px;left:78px;white-space:nowrap" class="ft02">EIP</p>
<p style="position:absolute;top:447px;left:212px;white-space:nowrap" class="ft02">AC.base&#160;+ EntryPoint</p>
<p style="position:absolute;top:447px;left:539px;white-space:nowrap" class="ft02">AC.base is&#160;in&#160;EBX as&#160;input&#160;to&#160;GETSEC[ENTERACCS].</p>
<p style="position:absolute;top:475px;left:78px;white-space:nowrap" class="ft02">[E|R]BX</p>
<p style="position:absolute;top:475px;left:212px;white-space:nowrap" class="ft02">Pre-ENTERACCS state:&#160;Next [E|R]IP prior to&#160;</p>
<p style="position:absolute;top:492px;left:212px;white-space:nowrap" class="ft02">GETSEC[ENTERACCS]</p>
<p style="position:absolute;top:475px;left:539px;white-space:nowrap" class="ft02">Carry forward&#160;64-bit&#160;processor state&#160;across&#160;</p>
<p style="position:absolute;top:490px;left:539px;white-space:nowrap" class="ft02">GETSEC[ENTERACCS].</p>
<p style="position:absolute;top:520px;left:78px;white-space:nowrap" class="ft02">ECX</p>
<p style="position:absolute;top:520px;left:212px;white-space:nowrap" class="ft02">Pre-ENTERACCS state:&#160;[31:16]=GDTR.limit;&#160;</p>
<p style="position:absolute;top:537px;left:212px;white-space:nowrap" class="ft02">[15:0]=CS.sel</p>
<p style="position:absolute;top:520px;left:539px;white-space:nowrap" class="ft02">Carry forward&#160;processor state across&#160;</p>
<p style="position:absolute;top:535px;left:539px;white-space:nowrap" class="ft02">GETSEC[ENTERACCS].</p>
<p style="position:absolute;top:565px;left:78px;white-space:nowrap" class="ft02">[E|R]DX</p>
<p style="position:absolute;top:565px;left:212px;white-space:nowrap" class="ft02">Pre-ENTERACCS state:&#160;</p>
<p style="position:absolute;top:582px;left:212px;white-space:nowrap" class="ft02">GDTR base</p>
<p style="position:absolute;top:565px;left:539px;white-space:nowrap" class="ft02">Carry forward&#160;64-bit&#160;processor state&#160;across&#160;</p>
<p style="position:absolute;top:580px;left:539px;white-space:nowrap" class="ft02">GETSEC[ENTERACCS].</p>
<p style="position:absolute;top:610px;left:78px;white-space:nowrap" class="ft02">EBP</p>
<p style="position:absolute;top:610px;left:212px;white-space:nowrap" class="ft02">AC.base</p>
<p style="position:absolute;top:639px;left:78px;white-space:nowrap" class="ft02">CS</p>
<p style="position:absolute;top:639px;left:212px;white-space:nowrap" class="ft02">Sel=[SegSel], base=0, limit=FFFFFh, G=1, D=1,&#160;</p>
<p style="position:absolute;top:655px;left:212px;white-space:nowrap" class="ft02">AR=9BH</p>
<p style="position:absolute;top:684px;left:78px;white-space:nowrap" class="ft02">DS</p>
<p style="position:absolute;top:684px;left:212px;white-space:nowrap" class="ft02">Sel=[SegSel] +8, base=0,&#160;limit=FFFFFh, G=1, D=1,&#160;</p>
<p style="position:absolute;top:700px;left:212px;white-space:nowrap" class="ft02">AR=93H</p>
<p style="position:absolute;top:729px;left:78px;white-space:nowrap" class="ft02">GDTR</p>
<p style="position:absolute;top:729px;left:212px;white-space:nowrap" class="ft02">Base= AC.base (EBX) + [GDTBasePtr],&#160;</p>
<p style="position:absolute;top:745px;left:212px;white-space:nowrap" class="ft02">Limit=[GDTLimit]</p>
<p style="position:absolute;top:774px;left:78px;white-space:nowrap" class="ft02">DR7</p>
<p style="position:absolute;top:774px;left:212px;white-space:nowrap" class="ft02">00000400H</p>
<p style="position:absolute;top:802px;left:78px;white-space:nowrap" class="ft02">IA32_DEBUGCTL</p>
<p style="position:absolute;top:802px;left:212px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:831px;left:78px;white-space:nowrap" class="ft02">IA32_MISC_ENABLE</p>
<p style="position:absolute;top:831px;left:212px;white-space:nowrap" class="ft02">See&#160;<a href="o_b5573232dd8f1481-1987.html">Table&#160;6-5&#160;</a>for&#160;example.</p>
<p style="position:absolute;top:831px;left:539px;white-space:nowrap" class="ft02">The&#160;number&#160;of&#160;initialized&#160;fields&#160;may change&#160;due&#160;to&#160;</p>
<p style="position:absolute;top:847px;left:539px;white-space:nowrap" class="ft02">processor&#160;implementation.</p>
</div>
</body>
</html>
