<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1977</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:11px;font-family:Times;color:#0860a8;}
	.ft01{font-size:9px;font-family:Times;color:#000000;}
	.ft02{font-size:3px;font-family:Times;color:#000000;}
	.ft03{font-size:14px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:12px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1977-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811977.png" alt="background image"/>
<p style="position:absolute;top:47px;left:615px;white-space:nowrap" class="ft00">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:777px;white-space:nowrap" class="ft01">Vol. 2D&#160;6-3</p>
<p style="position:absolute;top:105px;left:69px;white-space:nowrap" class="ft02">.</p>
<p style="position:absolute;top:409px;left:69px;white-space:nowrap" class="ft03">6.2.2.2&#160;&#160;</p>
<p style="position:absolute;top:409px;left:153px;white-space:nowrap" class="ft03">GETSEC[ENTERACCS]</p>
<p style="position:absolute;top:437px;left:69px;white-space:nowrap" class="ft06">The GETSEC[ENTERACCS] leaf&#160;enables&#160;authenticated&#160;code&#160;execution mode. The ENTERACCS leaf function&#160;<br/>performs&#160;an authenticated code&#160;module load using the chipset public key as the&#160;signature&#160;verification. ENTERACCS&#160;<br/>requires&#160;the existence&#160;of an Intel®&#160;Trusted Execution&#160;Technology&#160;capable chipset since it&#160;unlocks&#160;the chipset&#160;<br/>private configuration&#160;register&#160;space&#160;after successful&#160;authentication of&#160;the loaded module.&#160;The physical base&#160;<br/>address and&#160;size of&#160;the&#160;authenticated code&#160;module&#160;are specified as&#160;input register values&#160;in EBX&#160;and ECX, respec-<br/>tively.&#160;<br/>While&#160;in&#160;the authenticated code&#160;execution mode, certain&#160;processor state&#160;properties change.&#160;For&#160;this&#160;reason, the&#160;<br/>time&#160;in which&#160;the processor operates in authenticated code&#160;execution&#160;mode&#160;should be limited to&#160;minimize&#160;impact&#160;<br/>on&#160;external system&#160;events.&#160;<br/>Upon entry into , the previous paging&#160;context is&#160;disabled&#160;(since&#160;the&#160;authenticated&#160;code&#160;module image&#160;is&#160;specified&#160;<br/>with&#160;physical&#160;addresses and can no&#160;longer rely&#160;upon&#160;external memory-based page-table structures).<br/>Prior&#160;to executing the&#160;GETSEC[ENTERACCS] leaf,&#160;system&#160;software&#160;must&#160;ensure&#160;the&#160;logical processor issuing&#160;<br/>GETSEC[ENTERACCS]&#160;is the&#160;boot-strap&#160;processor (BSP),&#160;as indicated&#160;by&#160;IA32_APIC_BASE.BSP = 1. System&#160;soft-<br/>ware must ensure&#160;other logical processors are&#160;in&#160;a suitable&#160;idle state and&#160;not marked as&#160;BSP.<br/>The GETSEC[ENTERACCS] leaf&#160;may&#160;be&#160;used&#160;by&#160;different agents to&#160;load different authenticated code modules&#160;to&#160;<br/>perform&#160;functions related&#160;to different&#160;aspects of&#160;a&#160;measured&#160;environment,&#160;for example&#160;system software&#160;and&#160;<br/>Intel® TXT&#160;enabled BIOS may&#160;use more&#160;than&#160;one authenticated code modules.</p>
<p style="position:absolute;top:775px;left:69px;white-space:nowrap" class="ft03">6.2.2.3&#160;&#160;</p>
<p style="position:absolute;top:775px;left:153px;white-space:nowrap" class="ft03">GETSEC[EXITAC]</p>
<p style="position:absolute;top:804px;left:69px;white-space:nowrap" class="ft06">GETSEC[EXITAC] takes the&#160;processor&#160;out of . When&#160;this instruction leaf&#160;is executed, the&#160;contents of the&#160;authenti-<br/>cated&#160;code&#160;execution&#160;area are&#160;scrubbed&#160;and control is&#160;transferred to&#160;the non-authenticated context defined&#160;by&#160;a&#160;<br/>near pointer passed&#160;with&#160;the&#160;GETSEC[EXITAC] instruction.&#160;<br/>The authenticated code execution&#160;area&#160;is no&#160;longer accessible&#160;after completion of&#160;GETSEC[EXITAC].&#160;RBX&#160;(or EBX)&#160;<br/>holds the&#160;address of&#160;the&#160;near&#160;absolute indirect target to&#160;be&#160;taken.&#160;</p>
<p style="position:absolute;top:922px;left:69px;white-space:nowrap" class="ft03">6.2.2.4&#160;&#160;</p>
<p style="position:absolute;top:922px;left:153px;white-space:nowrap" class="ft03">GETSEC[SENTER]</p>
<p style="position:absolute;top:950px;left:69px;white-space:nowrap" class="ft07">The GETSEC[SENTER]&#160;leaf&#160;function&#160;is used by&#160;the initiating logical processor (ILP) to&#160;launch&#160;an MLE.&#160;<br/>GETSEC[SENTER]&#160;can be considered&#160;a&#160;superset&#160;of the&#160;ENTERACCS&#160;leaf, because&#160;it enters &#160;as part of&#160;the measured&#160;<br/>environment launch.&#160;<br/>Measured environment&#160;startup consists&#160;of&#160;the following&#160;steps:</p>
<p style="position:absolute;top:105px;left:335px;white-space:nowrap" class="ft05">Table 6-2. &#160;GETSEC&#160;Leaf Functions&#160;</p>
<p style="position:absolute;top:130px;left:77px;white-space:nowrap" class="ft04">Index (EAX)</p>
<p style="position:absolute;top:130px;left:177px;white-space:nowrap" class="ft04">Leaf&#160;function</p>
<p style="position:absolute;top:130px;left:365px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:154px;left:77px;white-space:nowrap" class="ft04">0</p>
<p style="position:absolute;top:154px;left:177px;white-space:nowrap" class="ft04">CAPABILITIES</p>
<p style="position:absolute;top:154px;left:365px;white-space:nowrap" class="ft04">Returns&#160;the&#160;available leaf&#160;functions of&#160;the&#160;GETSEC instruction.</p>
<p style="position:absolute;top:178px;left:77px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:178px;left:177px;white-space:nowrap" class="ft04">Undefined</p>
<p style="position:absolute;top:178px;left:365px;white-space:nowrap" class="ft04">Reserved</p>
<p style="position:absolute;top:202px;left:77px;white-space:nowrap" class="ft04">2</p>
<p style="position:absolute;top:202px;left:177px;white-space:nowrap" class="ft04">ENTERACCS</p>
<p style="position:absolute;top:202px;left:365px;white-space:nowrap" class="ft04">Enter&#160;</p>
<p style="position:absolute;top:226px;left:77px;white-space:nowrap" class="ft04">3</p>
<p style="position:absolute;top:226px;left:177px;white-space:nowrap" class="ft04">EXITAC</p>
<p style="position:absolute;top:226px;left:365px;white-space:nowrap" class="ft04">Exit&#160;</p>
<p style="position:absolute;top:250px;left:77px;white-space:nowrap" class="ft04">4</p>
<p style="position:absolute;top:250px;left:177px;white-space:nowrap" class="ft04">SENTER</p>
<p style="position:absolute;top:250px;left:365px;white-space:nowrap" class="ft04">Launch&#160;an&#160;MLE.</p>
<p style="position:absolute;top:274px;left:77px;white-space:nowrap" class="ft04">5</p>
<p style="position:absolute;top:274px;left:177px;white-space:nowrap" class="ft04">SEXIT</p>
<p style="position:absolute;top:274px;left:365px;white-space:nowrap" class="ft04">Exit the&#160;MLE.</p>
<p style="position:absolute;top:298px;left:77px;white-space:nowrap" class="ft04">6</p>
<p style="position:absolute;top:298px;left:177px;white-space:nowrap" class="ft04">PARAMETERS</p>
<p style="position:absolute;top:298px;left:365px;white-space:nowrap" class="ft04">Return&#160;SMX related&#160;parameter&#160;information.</p>
<p style="position:absolute;top:322px;left:77px;white-space:nowrap" class="ft04">7</p>
<p style="position:absolute;top:322px;left:177px;white-space:nowrap" class="ft04">SMCTRL</p>
<p style="position:absolute;top:322px;left:365px;white-space:nowrap" class="ft04">SMX&#160;&#160;mode&#160;&#160;control.</p>
<p style="position:absolute;top:346px;left:77px;white-space:nowrap" class="ft04">8</p>
<p style="position:absolute;top:346px;left:177px;white-space:nowrap" class="ft04">WAKEUP</p>
<p style="position:absolute;top:346px;left:365px;white-space:nowrap" class="ft04">Wake up sleeping processors&#160;in safer mode.</p>
<p style="position:absolute;top:370px;left:77px;white-space:nowrap" class="ft04">9 - (4G-1)</p>
<p style="position:absolute;top:370px;left:177px;white-space:nowrap" class="ft04">Undefined</p>
<p style="position:absolute;top:370px;left:365px;white-space:nowrap" class="ft04">Reserved</p>
</div>
</body>
</html>
