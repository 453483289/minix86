<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 297</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:12px;font-family:Times;color:#0860a8;}
	.ft05{font-size:14px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page297-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481297.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">CMPS/CMPSB/CMPSW/CMPSD/CMPSQ‚ÄîCompare String Operands</p>
<p style="position:absolute;top:47px;left:638px;white-space:nowrap" class="ft01">INSTRUCTION&#160;SET&#160;REFERENCE,&#160;A-L</p>
<p style="position:absolute;top:1103px;left:763px;white-space:nowrap" class="ft00">Vol. 2A&#160;3-169</p>
<p style="position:absolute;top:100px;left:69px;white-space:nowrap" class="ft06">tion.&#160;Locations of the&#160;source&#160;operands are&#160;always&#160;specified by&#160;the&#160;DS:(E)SI&#160;(or RSI) and&#160;ES:(E)DI&#160;(or RDI) regis-<br/>ters,&#160;which&#160;must be loaded&#160;correctly before&#160;the compare&#160;string&#160;instruction&#160;is executed.<br/>The no-operands form provides ‚Äúshort forms‚Äù&#160;of&#160;the byte,&#160;word,&#160;and&#160;doubleword&#160;versions of the&#160;CMPS instructions.&#160;<br/>Here also&#160;the DS:(E)SI (or RSI)&#160;and ES:(E)DI (or RDI)&#160;registers&#160;are assumed by the&#160;processor&#160;to specify the&#160;loca-<br/>tion of&#160;the&#160;source&#160;operands. The&#160;size&#160;of the&#160;source&#160;operands&#160;is selected with&#160;the mnemonic: CMPSB (byte compar-<br/>ison), CMPSW (word&#160;comparison), CMPSD (doubleword comparison),&#160;or&#160;CMPSQ (quadword&#160;comparison using&#160;<br/>REX.W).<br/>After&#160;the comparison, the&#160;(E/R)SI and (E/R)DI&#160;registers&#160;increment&#160;or decrement automatically according to&#160;the&#160;<br/>setting of the&#160;DF flag&#160;in the EFLAGS register. (If&#160;the DF&#160;flag is 0, the (E/R)SI and (E/R)DI register&#160;increment; if the&#160;<br/>DF&#160;flag&#160;is 1,&#160;the registers decrement.) The registers&#160;increment or decrement by&#160;1 for byte&#160;operations, by 2&#160;for word&#160;<br/>operations,&#160;4 for doubleword&#160;operations. If operand&#160;size&#160;is&#160;64,&#160;RSI&#160;and RDI registers increment by&#160;8&#160;for quadword&#160;<br/>operations.<br/>The CMPS, CMPSB,&#160;CMPSW,&#160;CMPSD,&#160;and CMPSQ instructions&#160;can&#160;be&#160;preceded&#160;by the&#160;REP&#160;prefix for block&#160;compar-<br/>isons. More often,&#160;however,&#160;these instructions will be used&#160;in a LOOP construct&#160;that takes&#160;some action based on&#160;the&#160;<br/>setting of the&#160;status&#160;flags before&#160;the&#160;next&#160;comparison is&#160;made. See&#160;‚ÄúREP/REPE/REPZ&#160;/REPNE/REPNZ‚ÄîRepeat&#160;<br/>String Operation Prefix‚Äù&#160;<a href="˛ˇ">in Chapter&#160;4&#160;of the&#160;<i>Intel¬Æ 64 and&#160;IA-32 Architectures Software&#160;Developer‚Äôs&#160;Manual,&#160;<br/>Volume 2B</i>, for a&#160;</a>description of the&#160;REP prefix.<br/>In&#160;64-bit mode, the&#160;instruction‚Äôs default&#160;address size&#160;is&#160;64&#160;bits,&#160;32&#160;bit address&#160;size&#160;is&#160;supported&#160;using&#160;the prefix&#160;<br/>67H.&#160;Use&#160;of the&#160;REX.W prefix&#160;promotes doubleword operation to&#160;64&#160;bits (see&#160;CMPSQ</p>
<p style="position:absolute;top:430px;left:640px;white-space:nowrap" class="ft00">)</p>
<p style="position:absolute;top:427px;left:644px;white-space:nowrap" class="ft02">. See&#160;the summary&#160;chart at&#160;</p>
<p style="position:absolute;top:444px;left:69px;white-space:nowrap" class="ft02">the&#160;beginning of&#160;this&#160;section for encoding data and&#160;limits.</p>
<p style="position:absolute;top:478px;left:69px;white-space:nowrap" class="ft04">Operation</p>
<p style="position:absolute;top:508px;left:69px;white-space:nowrap" class="ft02">temp&#160;‚Üê&#160;SRC1&#160;- SRC2;</p>
<p style="position:absolute;top:526px;left:69px;white-space:nowrap" class="ft02">SetStatusFlags(temp);</p>
<p style="position:absolute;top:556px;left:69px;white-space:nowrap" class="ft02">IF&#160;(64-Bit Mode)</p>
<p style="position:absolute;top:573px;left:89px;white-space:nowrap" class="ft02">THEN</p>
<p style="position:absolute;top:589px;left:116px;white-space:nowrap" class="ft09">IF (Byte comparison)<br/>THEN&#160;IF DF&#160;</p>
<p style="position:absolute;top:605px;left:184px;white-space:nowrap" class="ft05">=&#160;</p>
<p style="position:absolute;top:607px;left:198px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:625px;left:143px;white-space:nowrap" class="ft02">THEN&#160;</p>
<p style="position:absolute;top:643px;left:170px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI&#160;+&#160;1;&#160;</p>
<p style="position:absolute;top:661px;left:170px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI&#160;+&#160;1;&#160;</p>
<p style="position:absolute;top:679px;left:143px;white-space:nowrap" class="ft02">ELSE&#160;</p>
<p style="position:absolute;top:697px;left:170px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI ‚Äì&#160;1;&#160;</p>
<p style="position:absolute;top:715px;left:170px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI ‚Äì 1;&#160;</p>
<p style="position:absolute;top:733px;left:143px;white-space:nowrap" class="ft02">FI;</p>
<p style="position:absolute;top:751px;left:116px;white-space:nowrap" class="ft02">ELSE&#160;IF&#160;(Word comparison)</p>
<p style="position:absolute;top:769px;left:143px;white-space:nowrap" class="ft02">THEN&#160;IF DF&#160;</p>
<p style="position:absolute;top:767px;left:211px;white-space:nowrap" class="ft05">=</p>
<p style="position:absolute;top:769px;left:220px;white-space:nowrap" class="ft02">&#160;0</p>
<p style="position:absolute;top:787px;left:170px;white-space:nowrap" class="ft02">THEN&#160;</p>
<p style="position:absolute;top:805px;left:197px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI&#160;+&#160;2;&#160;</p>
<p style="position:absolute;top:823px;left:197px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI&#160;+&#160;2;&#160;</p>
<p style="position:absolute;top:841px;left:170px;white-space:nowrap" class="ft02">ELSE&#160;</p>
<p style="position:absolute;top:859px;left:197px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI ‚Äì&#160;2;&#160;</p>
<p style="position:absolute;top:877px;left:197px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI ‚Äì 2;&#160;</p>
<p style="position:absolute;top:895px;left:170px;white-space:nowrap" class="ft02">FI;</p>
<p style="position:absolute;top:913px;left:116px;white-space:nowrap" class="ft02">ELSE IF&#160;(Doubleword comparison)</p>
<p style="position:absolute;top:931px;left:143px;white-space:nowrap" class="ft02">THEN&#160;IF DF&#160;</p>
<p style="position:absolute;top:929px;left:211px;white-space:nowrap" class="ft05">=&#160;</p>
<p style="position:absolute;top:931px;left:225px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:949px;left:170px;white-space:nowrap" class="ft02">THEN&#160;</p>
<p style="position:absolute;top:967px;left:197px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI&#160;+&#160;4;&#160;</p>
<p style="position:absolute;top:985px;left:197px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI&#160;+&#160;4;&#160;</p>
<p style="position:absolute;top:1003px;left:170px;white-space:nowrap" class="ft02">ELSE&#160;</p>
<p style="position:absolute;top:1021px;left:197px;white-space:nowrap" class="ft02">(R|E)SI&#160;‚Üê&#160;(R|E)SI ‚Äì&#160;4;&#160;</p>
<p style="position:absolute;top:1039px;left:197px;white-space:nowrap" class="ft02">(R|E)DI&#160;‚Üê&#160;(R|E)DI ‚Äì 4;&#160;</p>
<p style="position:absolute;top:1057px;left:170px;white-space:nowrap" class="ft02">FI;</p>
</div>
</body>
</html>
