<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1996</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:11px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1996-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811996.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:583px;white-space:nowrap" class="ft00">GETSEC[SENTER]â€”Enter a Measured Environment</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-22&#160;Vol. 2D</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft03">Establish and&#160;check the&#160;location and&#160;size of the&#160;authenticated code module to be executed&#160;by the&#160;ILP.&#160;</p>
<p style="position:absolute;top:122px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:123px;left:93px;white-space:nowrap" class="ft03">Check&#160;for&#160;the existence of an&#160;Intel</p>
<p style="position:absolute;top:120px;left:325px;white-space:nowrap" class="ft04">Â®</p>
<p style="position:absolute;top:123px;left:336px;white-space:nowrap" class="ft03">&#160;TXT-capable chipset.&#160;</p>
<p style="position:absolute;top:145px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:145px;left:93px;white-space:nowrap" class="ft03">Verify&#160;the&#160;current power&#160;management configuration&#160;is acceptable.&#160;</p>
<p style="position:absolute;top:167px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:168px;left:93px;white-space:nowrap" class="ft03">Broadcast&#160;a message to&#160;enable protection&#160;of memory&#160;and&#160;I/O&#160;from&#160;activities&#160;from&#160;other processor agents.&#160;</p>
<p style="position:absolute;top:190px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:190px;left:93px;white-space:nowrap" class="ft03">Load the&#160;designated&#160;AC module&#160;into authenticated code execution&#160;area.&#160;</p>
<p style="position:absolute;top:212px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:213px;left:93px;white-space:nowrap" class="ft03">Isolate the&#160;content of authenticated code execution&#160;area&#160;from further state modification by&#160;external agents.</p>
<p style="position:absolute;top:235px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:235px;left:93px;white-space:nowrap" class="ft03">Authenticate the&#160;AC module.</p>
<p style="position:absolute;top:257px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:258px;left:93px;white-space:nowrap" class="ft03">Updated the&#160;Trusted Platform Module&#160;(TPM)&#160;with&#160;the authenticated code module's hash.&#160;</p>
<p style="position:absolute;top:280px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:280px;left:93px;white-space:nowrap" class="ft03">Initialize processor state based&#160;on&#160;the authenticated code module&#160;header information.&#160;</p>
<p style="position:absolute;top:302px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:303px;left:93px;white-space:nowrap" class="ft03">Unlock the&#160;Intel</p>
<p style="position:absolute;top:300px;left:200px;white-space:nowrap" class="ft04">Â®</p>
<p style="position:absolute;top:303px;left:211px;white-space:nowrap" class="ft03">&#160;TXT-capable chipset private&#160;configuration register&#160;space&#160;and TPM&#160;locality 3&#160;space.&#160;</p>
<p style="position:absolute;top:325px;left:68px;white-space:nowrap" class="ft02">â€¢</p>
<p style="position:absolute;top:325px;left:93px;white-space:nowrap" class="ft03">Begin&#160;execution in&#160;the authenticated code&#160;module&#160;at the&#160;defined entry&#160;point.</p>
<p style="position:absolute;top:349px;left:68px;white-space:nowrap" class="ft07">As&#160;an integrity check for proper&#160;processor&#160;hardware operation, execution&#160;of&#160;GETSEC[SENTER] will also&#160;check the&#160;<br/>contents of all&#160;the&#160;machine&#160;check status&#160;registers&#160;(as reported&#160;by the&#160;MSRs&#160;IA32_MCi_STATUS)&#160;for any&#160;valid&#160;<br/>uncorrectable&#160;error condition.&#160;In&#160;addition, the&#160;global&#160;machine&#160;check status&#160;register IA32_MCG_STATUS&#160;MCIP&#160;bit&#160;<br/>must be&#160;cleared&#160;and&#160;the IERR&#160;processor&#160;package&#160;pin&#160;(or&#160;its equivalent) must be not asserted, indicating that&#160;no&#160;<br/>machine&#160;check exception&#160;processing is&#160;currently&#160;in-progress.&#160;These checks are performed twice:&#160;once by the&#160;ILP&#160;<br/>prior to the broadcast of the rendezvous message to RLPs,&#160;and later in response to RLPs acknowledging the rendez-<br/>vous message. Any outstanding&#160;valid uncorrectable machine check error&#160;condition present&#160;in&#160;the machine&#160;check&#160;<br/>status registers&#160;at the&#160;first check point&#160;will result&#160;in&#160;the ILP signaling a&#160;general protection violation.&#160;If&#160;an&#160;<br/>outstanding valid uncorrectable&#160;machine check&#160;error condition&#160;is present at&#160;the second check&#160;point,&#160;then this&#160;will&#160;<br/>result in the&#160;corresponding logical processor signaling the more severe&#160;TXT-shutdown&#160;condition with&#160;an&#160;error code&#160;<br/>of 12.<br/>Before loading and&#160;authentication of the&#160;target&#160;code&#160;module is&#160;performed, the&#160;processor also&#160;checks&#160;that the&#160;<br/>current voltage and&#160;bus ratio&#160;encodings correspond to&#160;known&#160;good values supportable by&#160;the processor.&#160;The&#160;MSR&#160;<br/>IA32_PERF_STATUS&#160;values are&#160;compared&#160;against either&#160;the processor supported&#160;maximum operating&#160;target&#160;<br/>setting,&#160;system reset setting,&#160;or the&#160;thermal monitor&#160;operating target. If the&#160;current settings do&#160;not meet&#160;any of&#160;<br/>these criteria then&#160;the SENTER&#160;function&#160;will&#160;attempt to&#160;change&#160;the&#160;voltage&#160;and&#160;bus ratio select controls&#160;in&#160;a&#160;<br/>processor-specific manner.&#160;This adjustment&#160;may be to&#160;the&#160;thermal monitor,&#160;minimum&#160;(if&#160;different), or maximum&#160;<br/>operating target depending on&#160;the&#160;processor.<br/>This implies that&#160;some thermal&#160;operating target parameters&#160;configured&#160;by&#160;BIOS&#160;may&#160;be overridden by SENTER.&#160;<br/>The&#160;measured&#160;environment software may need&#160;to&#160;take&#160;responsibility for restoring&#160;such settings that are&#160;deemed&#160;<br/>to&#160;be safe, but not necessarily recognized&#160;by SENTER. If an&#160;adjustment&#160;is not&#160;possible when&#160;an out of&#160;range setting&#160;<br/>is&#160;discovered, then&#160;the processor will abort the&#160;measured&#160;launch. This&#160;may&#160;be&#160;the case for chipset controlled&#160;<br/>settings&#160;of these values or if the controllability is not enabled&#160;on the processor.&#160;In this&#160;case it is&#160;the&#160;responsibility of&#160;<br/>the external&#160;software to&#160;program&#160;the chipset&#160;voltage&#160;ID&#160;and/or bus ratio&#160;select&#160;settings to known&#160;good&#160;values&#160;<br/>recognized&#160;by the&#160;processor,&#160;prior&#160;to executing&#160;SENTER.</p>
<p style="position:absolute;top:795px;left:432px;white-space:nowrap" class="ft05">NOTE</p>
<p style="position:absolute;top:820px;left:120px;white-space:nowrap" class="ft07">For a&#160;mobile&#160;processor,&#160;an&#160;adjustment can be&#160;made&#160;according to&#160;the thermal&#160;monitor operating&#160;<br/>target. For&#160;a quad-core&#160;processor the&#160;SENTER&#160;adjustment mechanism may result in&#160;a&#160;more conser-<br/>vative&#160;but non-uniform&#160;voltage&#160;setting, depending&#160;on&#160;the pre-SENTER settings per core.</p>
<p style="position:absolute;top:901px;left:68px;white-space:nowrap" class="ft07">The ILP&#160;and RLPs&#160;mask the&#160;response to&#160;the assertion&#160;of&#160;the&#160;external signals INIT#, A20M,&#160;NMI#, and SMI#. The&#160;<br/>purpose&#160;of this masking control is to prevent exposure to&#160;existing&#160;external event handlers until a protected handler&#160;<br/>has&#160;been put&#160;in place&#160;to directly handle these events. Masked&#160;external pin&#160;events may be&#160;unmasked&#160;conditionally&#160;<br/>or unconditionally via the&#160;GETSEC[EXITAC], GETSEC[SEXIT], GETSEC[SMCTRL]&#160;or for&#160;specific VMX related opera-<br/>tions such as a VM&#160;entry or the&#160;VMXOFF instruction (see respective&#160;<a href="þÿ">GETSEC leaves and&#160;<i>IntelÂ® 64 and IA-32 Archi-<br/>tectures&#160;Software Developerâ€™s Manual, Volume&#160;3C</i>&#160;for more&#160;</a>details).&#160;The state&#160;of the&#160;A20M&#160;pin is&#160;masked&#160;and&#160;<br/>forced&#160;internally&#160;to a&#160;de-asserted state so that&#160;external assertion is&#160;not&#160;recognized. A20M&#160;masking as&#160;set&#160;by&#160;<br/>GETSEC[SENTER] is&#160;undone only after&#160;taking&#160;down the&#160;measured environment&#160;with&#160;the GETSEC[SEXIT] instruc-<br/>tion or processor reset.&#160;INTR&#160;is masked by simply clearing&#160;the&#160;EFLAGS.IF bit.&#160;It is&#160;the responsibility of system&#160;soft-<br/>ware to&#160;control&#160;the processor response to&#160;INTR through appropriate management&#160;of&#160;EFLAGS.</p>
</div>
</body>
</html>
