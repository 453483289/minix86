<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1978</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:11px;font-family:Times;color:#0860a8;}
	.ft01{font-size:9px;font-family:Times;color:#000000;}
	.ft02{font-size:18px;font-family:Times;color:#000000;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:14px;font-family:Times;color:#0860a8;}
	.ft06{font-size:16px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1978-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811978.png" alt="background image"/>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft00">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft01">6-4&#160;Vol. 2D</p>
<p style="position:absolute;top:100px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:100px;left:93px;white-space:nowrap" class="ft07">the ILP&#160;rendezvous&#160;the responding logical processors (RLPs) in the platform into&#160;a controlled&#160;state&#160;(At the&#160;<br/>completion of this&#160;handshake,&#160;all&#160;the RLPs&#160;except for the&#160;ILP initiating&#160;the measured environment&#160;launch&#160;are&#160;<br/>placed&#160;in a newly defined&#160;SENTER sleep&#160;state).</p>
<p style="position:absolute;top:155px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:156px;left:93px;white-space:nowrap" class="ft07">Load and authenticate&#160;the authenticated code module&#160;required&#160;by the&#160;measured&#160;environment,&#160;and&#160;enter&#160;<br/>authenticated code execution&#160;mode.</p>
<p style="position:absolute;top:194px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:195px;left:93px;white-space:nowrap" class="ft03">Verify&#160;and lock certain system configuration&#160;parameters.</p>
<p style="position:absolute;top:217px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:217px;left:93px;white-space:nowrap" class="ft03">Measure the&#160;dynamic root of trust&#160;and store into the&#160;PCRs in&#160;TPM.&#160;</p>
<p style="position:absolute;top:239px;left:68px;white-space:nowrap" class="ft02">•</p>
<p style="position:absolute;top:240px;left:93px;white-space:nowrap" class="ft03">Transfer control&#160;to the&#160;MLE with interrupts disabled.</p>
<p style="position:absolute;top:264px;left:68px;white-space:nowrap" class="ft07">Prior to executing the&#160;GETSEC[SENTER] leaf, system software must ensure the platform’s&#160;TPM is ready for access&#160;<br/>and&#160;the&#160;ILP&#160;is the&#160;boot-strap&#160;processor (BSP),&#160;as indicated by&#160;IA32_APIC_BASE.BSP. System software&#160;must&#160;ensure&#160;<br/>other logical processors (RLPs)&#160;are in&#160;a suitable&#160;idle state&#160;and&#160;not marked as&#160;BSP.<br/>System software&#160;launching a measurement&#160;environment is&#160;responsible for providing a&#160;proper&#160;authenticate&#160;code&#160;<br/>module address when executing GETSEC[SENTER].&#160;The AC&#160;module&#160;responsible for the launch of&#160;a measured&#160;envi-<br/>ronment and loaded by&#160;GETSEC[SENTER] is&#160;referred&#160;to as&#160;SINIT.&#160;See&#160;<i>Intel®&#160;Trusted&#160;Execution&#160;Technology&#160;<br/>Measured Launched&#160;Environment Programming Guide&#160;</i>for additional information on system software requirements&#160;<br/>prior to executing GETSEC[SENTER].</p>
<p style="position:absolute;top:431px;left:68px;white-space:nowrap" class="ft05">6.2.2.5&#160;&#160;</p>
<p style="position:absolute;top:431px;left:152px;white-space:nowrap" class="ft05">GETSEC[SEXIT]</p>
<p style="position:absolute;top:460px;left:68px;white-space:nowrap" class="ft07">System software&#160;exits the&#160;measured&#160;environment by executing the&#160;instruction&#160;GETSEC[SEXIT] on the&#160;ILP.&#160;This&#160;<br/>instruction&#160;rendezvous the&#160;responding logical processors&#160;in the&#160;platform for exiting&#160;from&#160;the measured environ-<br/>ment. External events (if left&#160;masked) are unmasked and&#160;Intel® TXT-capable&#160;chipset’s private&#160;configuration space&#160;<br/>is re-locked.&#160;</p>
<p style="position:absolute;top:553px;left:68px;white-space:nowrap" class="ft05">6.2.2.6&#160;&#160;</p>
<p style="position:absolute;top:553px;left:152px;white-space:nowrap" class="ft05">GETSEC[PARAMETERS]</p>
<p style="position:absolute;top:582px;left:68px;white-space:nowrap" class="ft07">The&#160;GETSEC[PARAMETERS] leaf&#160;function is&#160;used&#160;to report&#160;attributes,&#160;options and&#160;limitations of SMX operation.&#160;<br/>Software uses&#160;this leaf&#160;to identify&#160;operating limits&#160;or additional options.&#160;<br/>The information reported by&#160;GETSEC[PARAMETERS]&#160;may&#160;require executing&#160;the leaf multiple&#160;times&#160;using EBX as an&#160;<br/>index.&#160;If&#160;the GETSEC[PARAMETERS] instruction leaf or if a&#160;specific parameter field is not available, then&#160;SMX oper-<br/>ation should&#160;be interpreted to&#160;use the default&#160;limits of&#160;respective&#160;GETSEC leaves&#160;or&#160;parameter fields defined in the&#160;<br/>GETSEC[PARAMETERS]&#160;leaf.</p>
<p style="position:absolute;top:716px;left:68px;white-space:nowrap" class="ft05">6.2.2.7 &#160;</p>
<p style="position:absolute;top:716px;left:152px;white-space:nowrap" class="ft05">GETSEC[SMCTRL]</p>
<p style="position:absolute;top:745px;left:68px;white-space:nowrap" class="ft07">The GETSEC[SMCTRL]&#160;leaf function&#160;is used for&#160;providing additional control&#160;over&#160;specific&#160;conditions associated with&#160;<br/>the SMX architecture.&#160;An input&#160;register is&#160;supported for&#160;selecting&#160;the&#160;control operation&#160;to be performed.&#160;See the&#160;<br/>specific leaf&#160;description for details&#160;on&#160;the type of control&#160;provided.</p>
<p style="position:absolute;top:822px;left:68px;white-space:nowrap" class="ft05">6.2.2.8&#160;&#160;</p>
<p style="position:absolute;top:822px;left:152px;white-space:nowrap" class="ft05">GETSEC[WAKEUP]</p>
<p style="position:absolute;top:850px;left:68px;white-space:nowrap" class="ft07">Responding logical processors (RLPs)&#160;are placed&#160;in the&#160;SENTER sleep&#160;state&#160;after the&#160;initiating logical processor&#160;<br/>executes&#160;GETSEC[SENTER].&#160;The&#160;ILP&#160;can wake&#160;up&#160;RLPs to&#160;join&#160;the&#160;measured&#160;environment by&#160;using&#160;<br/>GETSEC[WAKEUP].&#160;When the&#160;RLPs&#160;in SENTER sleep&#160;state wake&#160;up,&#160;these logical processors begin execution at the&#160;<br/>entry&#160;point defined in&#160;a data structure&#160;held in&#160;system memory (pointed&#160;to&#160;by an chipset&#160;register LT.MLE.JOIN) in&#160;<br/>TXT configuration&#160;space.</p>
<p style="position:absolute;top:967px;left:68px;white-space:nowrap" class="ft06">6.2.3&#160;</p>
<p style="position:absolute;top:967px;left:148px;white-space:nowrap" class="ft06">Measured Environment and SMX</p>
<p style="position:absolute;top:997px;left:68px;white-space:nowrap" class="ft07">This section gives&#160;a simplified view of a&#160;representative&#160;life cycle&#160;of&#160;a measured&#160;environment&#160;that&#160;is launched&#160;by a&#160;<br/>system&#160;executive using SMX&#160;leaf&#160;functions.&#160;<i>Intel® Trusted Execution&#160;Technology Measured Launched&#160;Environment&#160;<br/>Programming Guide&#160;</i>provides&#160;more detailed examples&#160;of using SMX&#160;and&#160;chipset&#160;resources (including&#160;chipset regis-<br/>ters, Trusted&#160;Platform&#160;Module) to launch an&#160;MVMM.</p>
</div>
</body>
</html>
