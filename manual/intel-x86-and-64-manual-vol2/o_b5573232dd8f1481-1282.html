<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1282</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:8px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1282-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811282.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:555px;white-space:nowrap" class="ft00">SHA1RNDS4—Perform&#160;Four Rounds of SHA1 Operation</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INSTRUCTION SET REFERENCE, M-U</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">4-602&#160;Vol. 2B</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">SHA1RNDS4—Perform Four Rounds of&#160;SHA1 Operation</p>
<p style="position:absolute;top:278px;left:353px;white-space:nowrap" class="ft03">Instruction&#160;Operand&#160;Encoding</p>
<p style="position:absolute;top:362px;left:68px;white-space:nowrap" class="ft01">Description</p>
<p style="position:absolute;top:385px;left:68px;white-space:nowrap" class="ft06">The&#160;SHA1RNDS4&#160;instruction performs four&#160;rounds of&#160;SHA1 operation using an&#160;initial SHA1 state&#160;(A,B,C,D) from&#160;the&#160;<br/>first operand&#160;(which is&#160;a source&#160;operand and&#160;the destination operand)&#160;and some&#160;pre-computed&#160;sum of the&#160;next 4&#160;<br/>round message&#160;dwords, and state variable&#160;E from the second&#160;operand (a source operand). The updated&#160;SHA1 state&#160;<br/>(A,B,C,D)&#160;after four rounds of processing&#160;is stored&#160;in&#160;the&#160;destination operand.</p>
<p style="position:absolute;top:469px;left:68px;white-space:nowrap" class="ft01">Operation</p>
<p style="position:absolute;top:492px;left:68px;white-space:nowrap" class="ft07">SHA1RNDS4&#160;<br/>The&#160;function&#160;f() and&#160;Constant K are dependent on the value of&#160;the&#160;immediate.</p>
<p style="position:absolute;top:546px;left:68px;white-space:nowrap" class="ft04">IF (&#160;imm8[1:0] = 0 )</p>
<p style="position:absolute;top:564px;left:88px;white-space:nowrap" class="ft04">THEN f()&#160;&#160;f0(), K&#160;&#160;K</p>
<p style="position:absolute;top:570px;left:219px;white-space:nowrap" class="ft05">0</p>
<p style="position:absolute;top:564px;left:225px;white-space:nowrap" class="ft04">;&#160;</p>
<p style="position:absolute;top:582px;left:68px;white-space:nowrap" class="ft04">ELSE&#160;IF&#160;( imm8[1:0] = 1 )&#160;</p>
<p style="position:absolute;top:600px;left:88px;white-space:nowrap" class="ft04">THEN f()&#160;&#160;f1(), K&#160;&#160;K</p>
<p style="position:absolute;top:606px;left:219px;white-space:nowrap" class="ft05">1</p>
<p style="position:absolute;top:600px;left:225px;white-space:nowrap" class="ft04">;&#160;</p>
<p style="position:absolute;top:618px;left:68px;white-space:nowrap" class="ft04">ELSE&#160;IF&#160;( imm8[1:0] = 2 )&#160;</p>
<p style="position:absolute;top:636px;left:88px;white-space:nowrap" class="ft04">THEN f()&#160;&#160;f2(), K&#160;&#160;K</p>
<p style="position:absolute;top:642px;left:219px;white-space:nowrap" class="ft05">2</p>
<p style="position:absolute;top:636px;left:225px;white-space:nowrap" class="ft04">;&#160;</p>
<p style="position:absolute;top:654px;left:68px;white-space:nowrap" class="ft04">ELSE&#160;IF&#160;( imm8[1:0] = 3 )&#160;</p>
<p style="position:absolute;top:672px;left:88px;white-space:nowrap" class="ft04">THEN f()&#160;&#160;f3(), K&#160;&#160;K3;&#160;</p>
<p style="position:absolute;top:690px;left:68px;white-space:nowrap" class="ft04">FI;</p>
<p style="position:absolute;top:726px;left:68px;white-space:nowrap" class="ft07">A&#160;&#160;SRC1[127:96];&#160;<br/>B&#160;&#160;SRC1[95:64];&#160;<br/>C&#160;&#160;SRC1[63:32];&#160;<br/>D&#160;&#160;SRC1[31:0];&#160;<br/>W</p>
<p style="position:absolute;top:804px;left:79px;white-space:nowrap" class="ft05">0</p>
<p style="position:absolute;top:798px;left:85px;white-space:nowrap" class="ft04">E&#160;&#160;SRC2[127:96];&#160;</p>
<p style="position:absolute;top:816px;left:68px;white-space:nowrap" class="ft04">W</p>
<p style="position:absolute;top:822px;left:79px;white-space:nowrap" class="ft05">1</p>
<p style="position:absolute;top:816px;left:85px;white-space:nowrap" class="ft04">&#160;&#160;SRC2[95:64];&#160;</p>
<p style="position:absolute;top:834px;left:68px;white-space:nowrap" class="ft04">W</p>
<p style="position:absolute;top:840px;left:79px;white-space:nowrap" class="ft05">2</p>
<p style="position:absolute;top:834px;left:85px;white-space:nowrap" class="ft04">&#160;&#160;SRC2[63:32];&#160;</p>
<p style="position:absolute;top:852px;left:68px;white-space:nowrap" class="ft04">W</p>
<p style="position:absolute;top:858px;left:79px;white-space:nowrap" class="ft05">3</p>
<p style="position:absolute;top:852px;left:85px;white-space:nowrap" class="ft04">&#160;&#160;SRC2[31:0];&#160;</p>
<p style="position:absolute;top:888px;left:68px;white-space:nowrap" class="ft07">Round i&#160;= 0&#160;operation:<br/>A_1&#160;&#160;f (B,&#160;C, D) + (A&#160;ROL 5)&#160;+W</p>
<p style="position:absolute;top:912px;left:253px;white-space:nowrap" class="ft05">0</p>
<p style="position:absolute;top:906px;left:259px;white-space:nowrap" class="ft04">E +K;&#160;</p>
<p style="position:absolute;top:924px;left:68px;white-space:nowrap" class="ft07">B_1&#160;&#160;A;&#160;<br/>C_1&#160;&#160;B ROL 30;&#160;<br/>D_1&#160;&#160;C;&#160;<br/>E_1&#160;&#160;D;&#160;</p>
<p style="position:absolute;top:1014px;left:68px;white-space:nowrap" class="ft04">FOR i&#160;= 1&#160;to 3</p>
<p style="position:absolute;top:1032px;left:88px;white-space:nowrap" class="ft04">A_(i +1)&#160;&#160;f (B_i, C_i, D_i) + (A_i ROL 5) +W</p>
<p style="position:absolute;top:1038px;left:334px;white-space:nowrap" class="ft05">i</p>
<p style="position:absolute;top:1032px;left:336px;white-space:nowrap" class="ft04">+ E_i +K;&#160;</p>
<p style="position:absolute;top:1050px;left:88px;white-space:nowrap" class="ft04">B_(i +1)&#160;&#160;A_i;&#160;</p>
<p style="position:absolute;top:123px;left:77px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:139px;left:77px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:261px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:123px;left:317px;white-space:nowrap" class="ft04">64/32&#160;</p>
<p style="position:absolute;top:139px;left:317px;white-space:nowrap" class="ft04">bit Mode&#160;</p>
<p style="position:absolute;top:155px;left:317px;white-space:nowrap" class="ft04">Support</p>
<p style="position:absolute;top:123px;left:390px;white-space:nowrap" class="ft04">CPUID&#160;</p>
<p style="position:absolute;top:139px;left:390px;white-space:nowrap" class="ft04">Feature&#160;</p>
<p style="position:absolute;top:155px;left:390px;white-space:nowrap" class="ft04">Flag</p>
<p style="position:absolute;top:123px;left:457px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:175px;left:77px;white-space:nowrap" class="ft04">0F&#160;3A&#160;CC&#160;/r&#160;ib</p>
<p style="position:absolute;top:175px;left:261px;white-space:nowrap" class="ft04">RMI</p>
<p style="position:absolute;top:175px;left:317px;white-space:nowrap" class="ft04">V/V</p>
<p style="position:absolute;top:175px;left:390px;white-space:nowrap" class="ft04">SHA</p>
<p style="position:absolute;top:175px;left:457px;white-space:nowrap" class="ft04">Performs four&#160;rounds&#160;of&#160;SHA1&#160;operation&#160;operating&#160;on&#160;SHA1&#160;state&#160;</p>
<p style="position:absolute;top:191px;left:457px;white-space:nowrap" class="ft04">(A,B,C,D) from&#160;xmm1,&#160;with&#160;a pre-computed sum of&#160;the next&#160;4&#160;</p>
<p style="position:absolute;top:208px;left:457px;white-space:nowrap" class="ft04">round message dwords and&#160;state variable E&#160;from&#160;xmm2/m128.&#160;</p>
<p style="position:absolute;top:225px;left:457px;white-space:nowrap" class="ft04">The&#160;immediate byte controls&#160;logic functions&#160;and round constants.</p>
<p style="position:absolute;top:195px;left:77px;white-space:nowrap" class="ft04">SHA1RNDS4 xmm1,&#160;</p>
<p style="position:absolute;top:211px;left:77px;white-space:nowrap" class="ft04">xmm2/m128, imm8</p>
<p style="position:absolute;top:301px;left:102px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:301px;left:252px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:301px;left:477px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:301px;left:697px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:325px;left:108px;white-space:nowrap" class="ft04">RMI</p>
<p style="position:absolute;top:325px;left:234px;white-space:nowrap" class="ft04">ModRM:reg&#160;(r, w)</p>
<p style="position:absolute;top:325px;left:466px;white-space:nowrap" class="ft04">ModRM:r/m (r)</p>
<p style="position:absolute;top:325px;left:711px;white-space:nowrap" class="ft04">Imm8</p>
</div>
</body>
</html>
