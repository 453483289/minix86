<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 72</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:14px;font-family:Times;color:#0860a8;}
	.ft03{font-size:11px;font-family:Times;color:#000000;}
	.ft04{font-size:18px;font-family:Times;color:#000000;}
	.ft05{font-size:16px;font-family:Times;color:#0860a8;}
	.ft06{font-size:12px;font-family:Times;color:#0860a8;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page72-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481072.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">2-12&#160;Vol. 2A</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INSTRUCTION FORMAT</p>
<p style="position:absolute;top:99px;left:68px;white-space:nowrap" class="ft02">2.2.1.6&#160;&#160;</p>
<p style="position:absolute;top:99px;left:152px;white-space:nowrap" class="ft02">RIP-Relative&#160;Addressing</p>
<p style="position:absolute;top:124px;left:68px;white-space:nowrap" class="ft07">A new addressing&#160;form, RIP-relative&#160;(relative instruction-pointer) addressing,&#160;is implemented in&#160;64-bit mode. An&#160;<br/>effective address&#160;is formed&#160;by adding&#160;displacement to the 64-bit RIP of the next instruction.<br/>In IA-32&#160;architecture and compatibility&#160;mode, addressing&#160;relative to&#160;the instruction pointer&#160;is available only with&#160;<br/>control-transfer instructions.&#160;In&#160;64-bit&#160;mode,&#160;instructions that use&#160;ModR/M addressing can&#160;use&#160;RIP-relative&#160;<br/>addressing. Without RIP-relative&#160;addressing,&#160;all&#160;ModR/M modes&#160;address memory relative to&#160;zero.&#160;<br/>RIP-relative&#160;addressing allows specific ModR/M modes to&#160;address memory relative to the 64-bit RIP using a signed&#160;<br/>32-bit displacement.&#160;This&#160;provides&#160;an offset range of&#160;±2GB&#160;from&#160;the RIP.<a href="o_b5573232dd8f1481-72.html">&#160;Table 2-7 shows the</a>&#160;ModR/M and&#160;SIB&#160;<br/>encodings&#160;for RIP-relative addressing. Redundant forms of&#160;32-bit&#160;displacement-addressing exist in the&#160;current&#160;<br/>ModR/M&#160;and&#160;SIB&#160;encodings.&#160;There is&#160;one ModR/M&#160;encoding&#160;and there are&#160;several&#160;SIB encodings. RIP-relative&#160;<br/>addressing is&#160;encoded using a redundant form.&#160;<br/>In&#160;64-bit mode, the&#160;ModR/M Disp32 (32-bit&#160;displacement) encoding&#160;is re-defined&#160;to be&#160;RIP+Disp32&#160;rather&#160;than&#160;<br/>displacement-only.&#160;S<a href="o_b5573232dd8f1481-72.html">ee&#160;Table&#160;2-7</a>.</p>
<p style="position:absolute;top:537px;left:68px;white-space:nowrap" class="ft07">The&#160;ModR/M&#160;encoding&#160;for&#160;RIP-relative&#160;addressing&#160;does&#160;not&#160;depend on&#160;using a prefix. Specifically, the&#160;r/m bit field&#160;<br/>encoding&#160;of 101B (used to&#160;select&#160;RIP-relative&#160;addressing)&#160;is not&#160;affected&#160;by&#160;the&#160;REX prefix.&#160;For example,&#160;selecting&#160;<br/>R13&#160;(REX.B = 1, r/m = 101B) with mod = 00B still&#160;results in&#160;RIP-relative addressing. The 4-bit r/m field of REX.B&#160;<br/>combined&#160;with&#160;ModR/M&#160;is&#160;not&#160;fully&#160;decoded.&#160;In&#160;order&#160;to&#160;address R13 with no displacement, software&#160;must encode&#160;<br/>R13 + 0 using&#160;a 1-byte displacement&#160;of&#160;zero.&#160;<br/>RIP-relative&#160;addressing&#160;is enabled&#160;by 64-bit&#160;mode,&#160;not by&#160;a&#160;64-bit address-size. The use&#160;of&#160;the address-size&#160;prefix&#160;<br/>does not&#160;disable RIP-relative addressing.&#160;The effect&#160;of the&#160;address-size&#160;prefix is&#160;to truncate and&#160;zero-extend&#160;the&#160;<br/>computed&#160;effective address&#160;to 32&#160;bits.&#160;</p>
<p style="position:absolute;top:701px;left:68px;white-space:nowrap" class="ft02">2.2.1.7 &#160;</p>
<p style="position:absolute;top:701px;left:152px;white-space:nowrap" class="ft02">Default 64-Bit&#160;Operand&#160;Size</p>
<p style="position:absolute;top:727px;left:68px;white-space:nowrap" class="ft07">In 64-bit mode, two groups of instructions&#160;have a default operand size of 64 bits (do not need&#160;a REX prefix for this&#160;<br/>operand&#160;size).&#160;These&#160;are:</p>
<p style="position:absolute;top:765px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:766px;left:93px;white-space:nowrap" class="ft03">Near branches.</p>
<p style="position:absolute;top:787px;left:68px;white-space:nowrap" class="ft04">•</p>
<p style="position:absolute;top:788px;left:93px;white-space:nowrap" class="ft03">All instructions,&#160;except far&#160;branches, that implicitly reference&#160;the&#160;RSP.</p>
<p style="position:absolute;top:839px;left:68px;white-space:nowrap" class="ft05">2.2.2&#160;</p>
<p style="position:absolute;top:839px;left:148px;white-space:nowrap" class="ft05">Additional Encodings for Control and Debug Registers</p>
<p style="position:absolute;top:866px;left:68px;white-space:nowrap" class="ft07">In 64-bit mode,&#160;more&#160;encodings for control and debug registers are available.&#160;The REX.R bit is&#160;used&#160;to modify the&#160;<br/>ModR/M&#160;reg&#160;field&#160;when&#160;that field&#160;encodes&#160;a control or&#160;debug&#160;register (see<a href="o_b5573232dd8f1481-69.html">&#160;Table&#160;2-4).</a>&#160;These encodings enable the&#160;<br/>processor to address&#160;CR8-CR15&#160;and DR8- DR15. An&#160;additional&#160;control register&#160;(CR8) is defined&#160;in 64-bit mode. CR8&#160;<br/>becomes the Task&#160;Priority&#160;Register&#160;(TPR).&#160;<br/>In&#160;the first&#160;implementation of&#160;IA-32e&#160;mode, CR9-CR15&#160;and&#160;DR8-DR15 are not implemented. Any&#160;attempt to&#160;access&#160;<br/>unimplemented registers&#160;results in&#160;an invalid-opcode exception (#UD).</p>
<p style="position:absolute;top:350px;left:335px;white-space:nowrap" class="ft06">Table 2-7.&#160;&#160;RIP-Relative&#160;Addressing</p>
<p style="position:absolute;top:373px;left:76px;white-space:nowrap" class="ft03">ModR/M&#160;and SIB Sub-field&#160;Encodings&#160;Compatibility&#160;Mode&#160;</p>
<p style="position:absolute;top:388px;left:309px;white-space:nowrap" class="ft03">Operation</p>
<p style="position:absolute;top:373px;left:438px;white-space:nowrap" class="ft03">64-bit Mode&#160;</p>
<p style="position:absolute;top:388px;left:438px;white-space:nowrap" class="ft03">Operation</p>
<p style="position:absolute;top:373px;left:541px;white-space:nowrap" class="ft03">Additional Implications in&#160;64-bit mode</p>
<p style="position:absolute;top:412px;left:76px;white-space:nowrap" class="ft03">ModR/M Byte&#160;mod = 00</p>
<p style="position:absolute;top:412px;left:309px;white-space:nowrap" class="ft03">Disp32</p>
<p style="position:absolute;top:412px;left:438px;white-space:nowrap" class="ft03">RIP&#160;+ Disp32</p>
<p style="position:absolute;top:412px;left:541px;white-space:nowrap" class="ft03">Must&#160;use SIB form&#160;with&#160;normal (zero-based)&#160;</p>
<p style="position:absolute;top:429px;left:541px;white-space:nowrap" class="ft03">displacement&#160;addressing&#160;</p>
<p style="position:absolute;top:436px;left:168px;white-space:nowrap" class="ft03">r/m = 101 (none)</p>
<p style="position:absolute;top:460px;left:76px;white-space:nowrap" class="ft03">SIB&#160;Byte</p>
<p style="position:absolute;top:460px;left:168px;white-space:nowrap" class="ft03">base&#160;= 101&#160;(none)</p>
<p style="position:absolute;top:460px;left:309px;white-space:nowrap" class="ft03">if&#160;mod&#160;= 00, Disp32&#160;Same&#160;as legacy&#160;None</p>
<p style="position:absolute;top:484px;left:168px;white-space:nowrap" class="ft010">index =&#160;100 (none)<br/>scale = 0, 1, 2, 4</p>
</div>
</body>
</html>
