<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 603</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:18px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page603-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481603.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">IRET/IRETD‚ÄîInterrupt&#160;Return</p>
<p style="position:absolute;top:47px;left:638px;white-space:nowrap" class="ft01">INSTRUCTION&#160;SET&#160;REFERENCE,&#160;A-L</p>
<p style="position:absolute;top:1103px;left:763px;white-space:nowrap" class="ft00">Vol. 2A&#160;3-475</p>
<p style="position:absolute;top:98px;left:69px;white-space:nowrap" class="ft02">IRET/IRETD‚ÄîInterrupt&#160;Return</p>
<p style="position:absolute;top:262px;left:354px;white-space:nowrap" class="ft03">Instruction Operand&#160;Encoding</p>
<p style="position:absolute;top:345px;left:69px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:370px;left:69px;white-space:nowrap" class="ft07">Returns program&#160;control from&#160;an&#160;exception&#160;or interrupt&#160;handler to&#160;a program or procedure&#160;that was&#160;interrupted by&#160;<br/>an exception, an&#160;external interrupt,&#160;or a&#160;software-generated&#160;interrupt.&#160;These instructions&#160;are also used to&#160;perform&#160;<br/>a&#160;return&#160;from a nested task. (A nested task is created when&#160;a CALL instruction is&#160;used&#160;to&#160;initiate&#160;a task&#160;switch&#160;or&#160;<br/>when an&#160;interrupt or&#160;exception causes a task switch&#160;to&#160;an&#160;interrupt&#160;or&#160;exception&#160;handler.)&#160;See&#160;the section&#160;titled&#160;<br/>‚ÄúTask Linkin<a href="˛ˇ">g‚Äù in&#160;Chapter 7 of the&#160;<i>Intel¬Æ&#160;64&#160;and IA-32&#160;Architectures&#160;Software Developer‚Äôs Manual,&#160;Volume&#160;3A</i>.<br/></a>IRET&#160;and&#160;IRETD&#160;are mnemonics for the&#160;same opcode. The IRETD mnemonic (interrupt&#160;return double) is&#160;intended&#160;<br/>for use&#160;when&#160;returning from&#160;an&#160;interrupt when using&#160;the&#160;32-bit operand&#160;size; however,&#160;most assemblers use&#160;the&#160;<br/>IRET mnemonic interchangeably for both&#160;operand sizes.<br/>In&#160;Real-Address Mode, the IRET&#160;instruction preforms&#160;a far&#160;return&#160;to the interrupted program&#160;or procedure. During&#160;<br/>this operation, the processor pops the return&#160;instruction&#160;pointer,&#160;return code&#160;segment selector, and EFLAGS&#160;image&#160;<br/>from&#160;the stack to&#160;the EIP,&#160;CS, and&#160;EFLAGS&#160;registers, respectively,&#160;and then&#160;resumes execution of the&#160;interrupted&#160;<br/>program&#160;or&#160;procedure.<br/>In Protected&#160;Mode, the&#160;action of the&#160;IRET&#160;instruction&#160;depends on&#160;the settings of the&#160;NT (nested&#160;task)&#160;and VM&#160;flags&#160;<br/>in&#160;the EFLAGS register and&#160;the VM&#160;flag&#160;in the EFLAGS&#160;image stored on&#160;the current stack.&#160;Depending on&#160;the setting&#160;<br/>of these flags, the processor&#160;performs&#160;the following types of&#160;interrupt returns:</p>
<p style="position:absolute;top:646px;left:69px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:646px;left:95px;white-space:nowrap" class="ft04">Return from&#160;virtual-8086 mode.</p>
<p style="position:absolute;top:668px;left:69px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:669px;left:95px;white-space:nowrap" class="ft04">Return to virtual-8086&#160;mode.</p>
<p style="position:absolute;top:691px;left:69px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:691px;left:95px;white-space:nowrap" class="ft04">Intra-privilege level&#160;return.</p>
<p style="position:absolute;top:713px;left:69px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:714px;left:95px;white-space:nowrap" class="ft04">Inter-privilege&#160;level&#160;return.</p>
<p style="position:absolute;top:736px;left:69px;white-space:nowrap" class="ft06">‚Ä¢</p>
<p style="position:absolute;top:736px;left:95px;white-space:nowrap" class="ft04">Return from&#160;nested task (task&#160;switch).</p>
<p style="position:absolute;top:760px;left:69px;white-space:nowrap" class="ft010">If&#160;the NT flag (EFLAGS register) is&#160;cleared,&#160;the IRET&#160;instruction performs&#160;a far return&#160;from&#160;the interrupt procedure,&#160;<br/>without a&#160;task switch.&#160;The code segment being&#160;returned&#160;to&#160;must be&#160;equally&#160;or less privileged&#160;than the&#160;interrupt&#160;<br/>handler&#160;routine&#160;(as indicated&#160;by&#160;the RPL&#160;field&#160;of&#160;the code segment selector popped&#160;from the&#160;stack).&#160;<br/>As&#160;with&#160;a real-address mode interrupt&#160;return, the&#160;IRET instruction&#160;pops the&#160;return&#160;instruction&#160;pointer,&#160;return&#160;code&#160;<br/>segment&#160;selector, and&#160;EFLAGS image from the&#160;stack to the&#160;EIP,&#160;CS, and&#160;EFLAGS registers, respectively,&#160;and then&#160;<br/>resumes execution of the&#160;interrupted&#160;program or procedure.&#160;If&#160;the return is&#160;to another&#160;privilege&#160;level, the&#160;IRET&#160;<br/>instruction&#160;also pops the&#160;stack pointer&#160;and SS&#160;from the stack,&#160;before&#160;resuming program execution. If&#160;the&#160;return&#160;is&#160;<br/>to virtual-8086 mode,&#160;the&#160;processor also&#160;pops&#160;the data segment registers&#160;from the&#160;stack.<br/>If the&#160;NT flag is&#160;set,&#160;the IRET instruction performs a&#160;task switch (return) from a&#160;nested task (a&#160;task&#160;called with a&#160;<br/>CALL instruction,&#160;an interrupt, or&#160;an&#160;exception) back&#160;to&#160;the calling or&#160;interrupted&#160;task. The&#160;updated state&#160;of the&#160;<br/>task&#160;executing the&#160;IRET&#160;instruction is saved in its TSS.&#160;If the task is re-entered later,&#160;the&#160;code that&#160;follows&#160;the&#160;IRET&#160;<br/>instruction is&#160;executed.<br/>If the&#160;NT flag&#160;is&#160;set and&#160;the&#160;processor is&#160;in IA-32e&#160;mode,&#160;the IRET&#160;instruction causes&#160;a general&#160;protection&#160;excep-<br/>tion.<br/>If nonmaskable interrupts&#160;(NMIs)&#160;are&#160;blocked&#160;(see<a href="˛ˇ">&#160;Section 6.7.1, ‚ÄúHandling&#160;Multiple NMIs‚Äù&#160;</a>in the&#160;<a href="˛ˇ"><i>Intel¬Æ 64 and&#160;<br/>IA-32&#160;Architectures&#160;Software Developer‚Äôs Manual, Volume&#160;3A</i></a>),&#160;execution of the&#160;IRET instruction unblocks&#160;NMIs.&#160;</p>
<p style="position:absolute;top:123px;left:74px;white-space:nowrap" class="ft04">Opcode</p>
<p style="position:absolute;top:123px;left:221px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:389px;white-space:nowrap" class="ft04">Op/&#160;</p>
<p style="position:absolute;top:137px;left:389px;white-space:nowrap" class="ft04">En</p>
<p style="position:absolute;top:123px;left:426px;white-space:nowrap" class="ft04">64-Bit&#160;</p>
<p style="position:absolute;top:137px;left:426px;white-space:nowrap" class="ft04">Mode</p>
<p style="position:absolute;top:123px;left:498px;white-space:nowrap" class="ft04">Compat/</p>
<p style="position:absolute;top:137px;left:498px;white-space:nowrap" class="ft04">Leg Mode</p>
<p style="position:absolute;top:123px;left:568px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:160px;left:74px;white-space:nowrap" class="ft04">CF</p>
<p style="position:absolute;top:160px;left:221px;white-space:nowrap" class="ft04">IRET</p>
<p style="position:absolute;top:160px;left:389px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:160px;left:426px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:160px;left:498px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:160px;left:568px;white-space:nowrap" class="ft04">Interrupt return (16-bit operand size).</p>
<p style="position:absolute;top:182px;left:74px;white-space:nowrap" class="ft04">CF</p>
<p style="position:absolute;top:182px;left:221px;white-space:nowrap" class="ft04">IRETD</p>
<p style="position:absolute;top:182px;left:389px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:182px;left:426px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:182px;left:498px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:182px;left:568px;white-space:nowrap" class="ft04">Interrupt return&#160;(32-bit operand size).</p>
<p style="position:absolute;top:205px;left:74px;white-space:nowrap" class="ft04">REX.W +&#160;CF</p>
<p style="position:absolute;top:205px;left:221px;white-space:nowrap" class="ft04">IRETQ</p>
<p style="position:absolute;top:205px;left:389px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:205px;left:426px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:205px;left:498px;white-space:nowrap" class="ft04">N.E.</p>
<p style="position:absolute;top:205px;left:568px;white-space:nowrap" class="ft04">Interrupt return (64-bit operand size).</p>
<p style="position:absolute;top:285px;left:83px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:285px;left:186px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:285px;left:358px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:285px;left:535px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:285px;left:715px;white-space:nowrap" class="ft04">Operand&#160;4</p>
<p style="position:absolute;top:308px;left:92px;white-space:nowrap" class="ft04">NP</p>
<p style="position:absolute;top:308px;left:207px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:308px;left:379px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:308px;left:556px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:308px;left:736px;white-space:nowrap" class="ft04">NA</p>
</div>
</body>
</html>
