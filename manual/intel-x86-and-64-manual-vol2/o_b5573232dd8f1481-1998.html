<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1998</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:11px;font-family:Times;color:#000000;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:8px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1998-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811998.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:583px;white-space:nowrap" class="ft00">GETSEC[SENTER]—Enter a Measured Environment</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-24&#160;Vol. 2D</p>
<p style="position:absolute;top:782px;left:68px;white-space:nowrap" class="ft06">Segmentation related processor state that&#160;has&#160;not been&#160;initialized by GETSEC[SENTER] requires&#160;appropriate&#160;<br/>initialization before use.&#160;Since&#160;a new GDT context has&#160;been established,&#160;the&#160;previous&#160;state of&#160;the segment selector&#160;<br/>values&#160;held&#160;in&#160;FS, GS, TR, and LDTR&#160;may no&#160;longer be&#160;valid.&#160;The IDTR will&#160;also&#160;require&#160;reloading with a&#160;new&#160;IDT&#160;<br/>context after launching&#160;the measured environment before&#160;exceptions or the&#160;external&#160;interrupts INTR and NMI&#160;can&#160;<br/>be&#160;handled.&#160;In&#160;the meantime, the programmer must take&#160;care&#160;in not executing an&#160;INT n&#160;instruction&#160;or any&#160;other&#160;<br/>condition&#160;that would result&#160;in an&#160;exception&#160;or trap signaling.<br/>Debug exception and trap related&#160;signaling&#160;is also&#160;disabled&#160;as part of execution&#160;of GETSEC[SENTER]. This&#160;is&#160;<br/>achieved&#160;by&#160;clearing&#160;DR7,&#160;TF&#160;in&#160;EFLAGs,&#160;and&#160;the&#160;MSR&#160;IA32_DEBUGCTL&#160;as defined in<a href="o_b5573232dd8f1481-1998.html">&#160;Table&#160;6-6</a>.&#160;These&#160;can be&#160;re-<br/>enabled&#160;once supporting&#160;exception handler(s), descriptor&#160;tables, and&#160;debug registers have&#160;been&#160;properly re-initial-<br/>ized following SENTER. Also,&#160;any pending&#160;single-step trap condition&#160;will&#160;be&#160;cleared at&#160;the completion of SENTER for&#160;<br/>both the ILP and&#160;RLP(s).<br/>Performance&#160;related&#160;counters and counter control registers are&#160;cleared&#160;as part of&#160;execution of SENTER on both the&#160;<br/>ILP and&#160;RLP.&#160;This implies any&#160;active&#160;performance&#160;counters&#160;at the&#160;time&#160;of&#160;SENTER execution will be&#160;disabled.&#160;To&#160;<br/>reactive&#160;the processor performance&#160;counters,&#160;this state must be re-initialized and&#160;re-enabled.<br/>Since&#160;MCE along&#160;with&#160;all&#160;other state&#160;bits (with the&#160;exception&#160;of SMXE)&#160;are cleared in CR4 upon execution of SENTER&#160;<br/>processing, any&#160;enabled machine check&#160;error condition&#160;that&#160;occurs will result in the&#160;processor performing the&#160;TXT-</p>
<p style="position:absolute;top:100px;left:169px;white-space:nowrap" class="ft03">Table 6-6. &#160;Register State&#160;Initialization&#160;after&#160;GETSEC[SENTER]&#160;and&#160;GETSEC[WAKEUP]</p>
<p style="position:absolute;top:133px;left:79px;white-space:nowrap" class="ft02">Register State</p>
<p style="position:absolute;top:133px;left:222px;white-space:nowrap" class="ft02">ILP after&#160;GETSEC[SENTER]</p>
<p style="position:absolute;top:133px;left:526px;white-space:nowrap" class="ft02">RLP after GETSEC[WAKEUP]</p>
<p style="position:absolute;top:162px;left:79px;white-space:nowrap" class="ft02">CR0</p>
<p style="position:absolute;top:162px;left:222px;white-space:nowrap" class="ft02">PG←0, AM←0, WP←0; Others unchanged</p>
<p style="position:absolute;top:162px;left:526px;white-space:nowrap" class="ft02">PG←0, CD←0, NW←0, AM←0, WP←0; PE←1,&#160;NE←1</p>
<p style="position:absolute;top:190px;left:79px;white-space:nowrap" class="ft02">CR4</p>
<p style="position:absolute;top:190px;left:223px;white-space:nowrap" class="ft02">00004000H</p>
<p style="position:absolute;top:190px;left:526px;white-space:nowrap" class="ft02">00004000H</p>
<p style="position:absolute;top:218px;left:79px;white-space:nowrap" class="ft02">EFLAGS</p>
<p style="position:absolute;top:218px;left:222px;white-space:nowrap" class="ft02">00000002H</p>
<p style="position:absolute;top:218px;left:526px;white-space:nowrap" class="ft02">00000002H</p>
<p style="position:absolute;top:247px;left:79px;white-space:nowrap" class="ft02">IA32_EFER</p>
<p style="position:absolute;top:247px;left:223px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:247px;left:526px;white-space:nowrap" class="ft02">0</p>
<p style="position:absolute;top:276px;left:79px;white-space:nowrap" class="ft02">EIP</p>
<p style="position:absolute;top:276px;left:222px;white-space:nowrap" class="ft02">[EntryPoint&#160;from&#160;MLE header</p>
<p style="position:absolute;top:273px;left:387px;white-space:nowrap" class="ft04">1</p>
<p style="position:absolute;top:276px;left:394px;white-space:nowrap" class="ft02">]</p>
<p style="position:absolute;top:276px;left:526px;white-space:nowrap" class="ft02">[LT.MLE.JOIN&#160;&#160;+&#160;&#160;12]</p>
<p style="position:absolute;top:304px;left:79px;white-space:nowrap" class="ft02">EBX</p>
<p style="position:absolute;top:304px;left:222px;white-space:nowrap" class="ft02">Unchanged&#160;[SINIT.BASE]</p>
<p style="position:absolute;top:304px;left:526px;white-space:nowrap" class="ft02">Unchanged</p>
<p style="position:absolute;top:333px;left:79px;white-space:nowrap" class="ft02">EDX</p>
<p style="position:absolute;top:333px;left:222px;white-space:nowrap" class="ft02">SENTER&#160;control&#160;flags</p>
<p style="position:absolute;top:333px;left:526px;white-space:nowrap" class="ft02">Unchanged</p>
<p style="position:absolute;top:361px;left:79px;white-space:nowrap" class="ft02">EBP</p>
<p style="position:absolute;top:361px;left:222px;white-space:nowrap" class="ft02">SINIT.BASE</p>
<p style="position:absolute;top:361px;left:526px;white-space:nowrap" class="ft02">Unchanged</p>
<p style="position:absolute;top:390px;left:79px;white-space:nowrap" class="ft02">CS</p>
<p style="position:absolute;top:390px;left:222px;white-space:nowrap" class="ft02">Sel=[SINIT SegSel], base=0, limit=FFFFFh, G=1,&#160;</p>
<p style="position:absolute;top:406px;left:222px;white-space:nowrap" class="ft02">D=1, AR=9BH</p>
<p style="position:absolute;top:390px;left:526px;white-space:nowrap" class="ft02">Sel = [LT.MLE.JOIN + 8], base = 0, limit = FFFFFH,&#160;G =&#160;</p>
<p style="position:absolute;top:405px;left:526px;white-space:nowrap" class="ft02">1, D = 1, AR = 9BH</p>
<p style="position:absolute;top:435px;left:79px;white-space:nowrap" class="ft02">DS, ES, SS</p>
<p style="position:absolute;top:435px;left:223px;white-space:nowrap" class="ft02">Sel=[SINIT&#160;SegSel]&#160;+8, base=0, limit=FFFFFh, G=1,&#160;</p>
<p style="position:absolute;top:451px;left:222px;white-space:nowrap" class="ft02">D=1, AR=93H</p>
<p style="position:absolute;top:435px;left:526px;white-space:nowrap" class="ft02">Sel = [LT.MLE.JOIN + 8] +8, base&#160;= 0,&#160;limit = FFFFFH,&#160;</p>
<p style="position:absolute;top:450px;left:526px;white-space:nowrap" class="ft02">G =&#160;1,&#160;D = 1, AR&#160;= 93H</p>
<p style="position:absolute;top:480px;left:79px;white-space:nowrap" class="ft02">GDTR</p>
<p style="position:absolute;top:480px;left:222px;white-space:nowrap" class="ft02">Base= SINIT.base (EBX) + [SINIT.GDTBasePtr],&#160;</p>
<p style="position:absolute;top:496px;left:222px;white-space:nowrap" class="ft02">Limit=[SINIT.GDTLimit]</p>
<p style="position:absolute;top:480px;left:526px;white-space:nowrap" class="ft02">Base = [LT.MLE.JOIN +&#160;4],&#160;Limit = [LT.MLE.JOIN]</p>
<p style="position:absolute;top:525px;left:79px;white-space:nowrap" class="ft02">DR7</p>
<p style="position:absolute;top:525px;left:222px;white-space:nowrap" class="ft02">00000400H</p>
<p style="position:absolute;top:525px;left:526px;white-space:nowrap" class="ft02">00000400H</p>
<p style="position:absolute;top:553px;left:79px;white-space:nowrap" class="ft02">IA32_DEBUGCTL</p>
<p style="position:absolute;top:553px;left:223px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:553px;left:526px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:582px;left:79px;white-space:nowrap" class="ft02">Performance&#160;</p>
<p style="position:absolute;top:598px;left:79px;white-space:nowrap" class="ft02">counters and counter&#160;</p>
<p style="position:absolute;top:615px;left:79px;white-space:nowrap" class="ft02">control&#160;registers</p>
<p style="position:absolute;top:582px;left:222px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:582px;left:526px;white-space:nowrap" class="ft02">0H</p>
<p style="position:absolute;top:643px;left:79px;white-space:nowrap" class="ft02">IA32_MISC_ENABLE</p>
<p style="position:absolute;top:643px;left:222px;white-space:nowrap" class="ft02">See<a href="o_b5573232dd8f1481-1987.html">&#160;Table&#160;6-5</a></p>
<p style="position:absolute;top:643px;left:526px;white-space:nowrap" class="ft02">See&#160;<a href="o_b5573232dd8f1481-1987.html">Table&#160;6-5</a></p>
<p style="position:absolute;top:672px;left:79px;white-space:nowrap" class="ft02">IA32_SMM_MONITOR</p>
<p style="position:absolute;top:688px;left:79px;white-space:nowrap" class="ft02">_CTL</p>
<p style="position:absolute;top:672px;left:222px;white-space:nowrap" class="ft02">Bit 2←0</p>
<p style="position:absolute;top:672px;left:526px;white-space:nowrap" class="ft02">Bit 2←0</p>
<p style="position:absolute;top:718px;left:71px;white-space:nowrap" class="ft01">NOTES:</p>
<p style="position:absolute;top:737px;left:70px;white-space:nowrap" class="ft02">1. See&#160;<i>Intel® Trusted Execution Technology Measured Launched Environment Programming Guide&#160;</i>for MLE&#160;header&#160;</p>
<p style="position:absolute;top:754px;left:85px;white-space:nowrap" class="ft02">format.</p>
</div>
</body>
</html>
