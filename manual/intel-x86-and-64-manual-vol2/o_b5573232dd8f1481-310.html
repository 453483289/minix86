<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 310</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:20px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page310-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f1481310.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:536px;white-space:nowrap" class="ft00">CMPXCHG8B/CMPXCHG16B—Compare and Exchange Bytes</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">INSTRUCTION SET REFERENCE, A-L</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">3-182&#160;Vol. 2A</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">CMPXCHG8B/CMPXCHG16B—Compare and Exchange Bytes</p>
<p style="position:absolute;top:332px;left:353px;white-space:nowrap" class="ft03">Instruction&#160;Operand&#160;Encoding</p>
<p style="position:absolute;top:416px;left:68px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:441px;left:68px;white-space:nowrap" class="ft06">Compares&#160;the&#160;64-bit value in&#160;EDX:EAX (or 128-bit value in&#160;RDX:RAX if&#160;operand&#160;size&#160;is 128 bits) with the&#160;operand&#160;<br/>(destination operand). If the values are equal,&#160;the 64-bit&#160;value in ECX:EBX&#160;(or 128-bit&#160;value in RCX:RBX)&#160;is stored&#160;<br/>in the&#160;destination operand. Otherwise,&#160;the&#160;value in the&#160;destination operand is loaded&#160;into EDX:EAX (or RDX:RAX).&#160;<br/>The&#160;destination operand&#160;is an 8-byte&#160;memory&#160;location (or 16-byte memory&#160;location&#160;if operand size&#160;is 128 bits).&#160;For&#160;<br/>the EDX:EAX&#160;and ECX:EBX register&#160;pairs, EDX and ECX contain the&#160;high-order&#160;32&#160;bits and EAX and&#160;EBX contain the&#160;<br/>low-order 32 bits of a&#160;64-bit value.&#160;For&#160;the RDX:RAX&#160;and RCX:RBX register&#160;pairs, RDX and&#160;RCX contain&#160;the high-<br/>order 64 bits and&#160;RAX and RBX&#160;contain the&#160;low-order&#160;64bits of a&#160;128-bit value.&#160;<br/>This&#160;instruction can be used with a&#160;LOCK&#160;prefix&#160;to allow&#160;the instruction to&#160;be&#160;executed&#160;atomically.&#160;To&#160;simplify&#160;the&#160;<br/>interface to&#160;the&#160;processor’s bus,&#160;the destination operand receives&#160;a write cycle&#160;without regard&#160;to the&#160;result of the&#160;<br/>comparison.&#160;The&#160;destination operand&#160;is written back if&#160;the&#160;comparison fails; otherwise, the&#160;source operand&#160;is&#160;<br/>written into the&#160;destination. (The processor never produces a&#160;locked read without&#160;also producing a&#160;locked write.)<br/>In 64-bit&#160;mode, default operation size&#160;is&#160;64&#160;bits.&#160;Use&#160;of&#160;the&#160;REX.W prefix promotes operation to&#160;128 bits.&#160;Note&#160;that&#160;<br/>CMPXCHG16B&#160;requires that the destination (memory) operand be&#160;16-byte&#160;aligned.&#160;See the summary&#160;chart at&#160;the&#160;<br/>beginning of this&#160;section for encoding data and&#160;limits.&#160;For&#160;information on the&#160;CPUID flag that indicates&#160;<br/>CMPXCHG16B, see page&#160;<a href="o_b5573232dd8f1481-333.html">3-205</a></p>
<p style="position:absolute;top:690px;left:276px;white-space:nowrap" class="ft00">.</p>
<p style="position:absolute;top:721px;left:68px;white-space:nowrap" class="ft03">IA-32 Architecture&#160;Compatibility</p>
<p style="position:absolute;top:745px;left:68px;white-space:nowrap" class="ft04">This&#160;instruction encoding is&#160;not&#160;supported on&#160;Intel processors earlier than&#160;the&#160;Pentium&#160;processors.</p>
<p style="position:absolute;top:123px;left:73px;white-space:nowrap" class="ft04">Opcode/</p>
<p style="position:absolute;top:137px;left:73px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:123px;left:300px;white-space:nowrap" class="ft04">Op/&#160;</p>
<p style="position:absolute;top:137px;left:300px;white-space:nowrap" class="ft04">En</p>
<p style="position:absolute;top:123px;left:337px;white-space:nowrap" class="ft04">64-Bit&#160;</p>
<p style="position:absolute;top:137px;left:337px;white-space:nowrap" class="ft04">Mode</p>
<p style="position:absolute;top:123px;left:409px;white-space:nowrap" class="ft04">Compat/</p>
<p style="position:absolute;top:137px;left:409px;white-space:nowrap" class="ft04">Leg Mode</p>
<p style="position:absolute;top:123px;left:480px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:160px;left:73px;white-space:nowrap" class="ft08">0F C7&#160;/<i>1 m64<br/></i>CMPXCHG8B&#160;<i>m64</i></p>
<p style="position:absolute;top:160px;left:300px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:160px;left:337px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:160px;left:409px;white-space:nowrap" class="ft04">Valid*</p>
<p style="position:absolute;top:160px;left:479px;white-space:nowrap" class="ft04">Compare EDX:EAX with&#160;<i>m64</i>. If equal, set ZF and load&#160;</p>
<p style="position:absolute;top:177px;left:480px;white-space:nowrap" class="ft04">ECX:EBX&#160;into<i>&#160;m64</i>. Else,&#160;clear ZF and load&#160;<i>m64</i>&#160;into EDX:EAX.</p>
<p style="position:absolute;top:204px;left:73px;white-space:nowrap" class="ft09">REX.W +&#160;0F&#160;C7&#160;/<i>1 m128<br/></i>CMPXCHG16B&#160;<i>m128</i></p>
<p style="position:absolute;top:204px;left:300px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:204px;left:337px;white-space:nowrap" class="ft04">Valid</p>
<p style="position:absolute;top:204px;left:409px;white-space:nowrap" class="ft04">N.E.</p>
<p style="position:absolute;top:204px;left:480px;white-space:nowrap" class="ft04">Compare RDX:RAX with&#160;<i>m128</i>. If equal, set ZF and load&#160;</p>
<p style="position:absolute;top:220px;left:480px;white-space:nowrap" class="ft04">RCX:RBX into<i>&#160;m128</i>. Else,&#160;clear ZF and load&#160;<i>m128</i>&#160;into&#160;</p>
<p style="position:absolute;top:236px;left:480px;white-space:nowrap" class="ft04">RDX:RAX.</p>
<p style="position:absolute;top:259px;left:73px;white-space:nowrap" class="ft01">NOTES:</p>
<p style="position:absolute;top:276px;left:73px;white-space:nowrap" class="ft04">*See&#160;IA-32&#160;Architecture&#160;Compatibility section below.</p>
<p style="position:absolute;top:355px;left:84px;white-space:nowrap" class="ft04">Op/En</p>
<p style="position:absolute;top:355px;left:194px;white-space:nowrap" class="ft04">Operand&#160;1</p>
<p style="position:absolute;top:355px;left:370px;white-space:nowrap" class="ft04">Operand&#160;2</p>
<p style="position:absolute;top:355px;left:539px;white-space:nowrap" class="ft04">Operand&#160;3</p>
<p style="position:absolute;top:355px;left:714px;white-space:nowrap" class="ft04">Operand&#160;4</p>
<p style="position:absolute;top:379px;left:96px;white-space:nowrap" class="ft04">M</p>
<p style="position:absolute;top:379px;left:175px;white-space:nowrap" class="ft04">ModRM:r/m (r,&#160;w)</p>
<p style="position:absolute;top:379px;left:391px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:379px;left:561px;white-space:nowrap" class="ft04">NA</p>
<p style="position:absolute;top:379px;left:735px;white-space:nowrap" class="ft04">NA</p>
</div>
</body>
</html>
