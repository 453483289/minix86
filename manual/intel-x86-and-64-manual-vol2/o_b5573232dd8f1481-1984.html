<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 1984</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:11px;font-family:Times;color:#0860a8;}
	.ft02{font-size:16px;font-family:Times;color:#0860a8;}
	.ft03{font-size:12px;font-family:Times;color:#0860a8;}
	.ft04{font-size:11px;font-family:Times;color:#000000;}
	.ft05{font-size:18px;font-family:Times;color:#000000;}
	.ft06{font-size:8px;font-family:Times;color:#000000;}
	.ft07{font-size:11px;line-height:16px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:23px;font-family:Times;color:#000000;}
	.ft09{font-size:11px;line-height:24px;font-family:Times;color:#000000;}
	.ft010{font-size:11px;line-height:21px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page1984-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="o_b5573232dd8f14811984.png" alt="background image"/>
<p style="position:absolute;top:1103px;left:534px;white-space:nowrap" class="ft00">GETSEC[ENTERACCS] - Execute Authenticated Chipset Code</p>
<p style="position:absolute;top:47px;left:68px;white-space:nowrap" class="ft01">SAFER&#160;MODE&#160;EXTENSIONS&#160;REFERENCE</p>
<p style="position:absolute;top:1103px;left:68px;white-space:nowrap" class="ft00">6-10&#160;Vol. 2D</p>
<p style="position:absolute;top:98px;left:68px;white-space:nowrap" class="ft02">GETSEC[ENTERACCS] - Execute Authenticated Chipset Code</p>
<p style="position:absolute;top:251px;left:68px;white-space:nowrap" class="ft03">Description</p>
<p style="position:absolute;top:277px;left:68px;white-space:nowrap" class="ft08">The GETSEC[ENTERACCS] function&#160;loads,&#160;authenticates and&#160;executes&#160;an authenticated code module&#160;using an&#160;<br/>Intel®&#160;TXT platform&#160;chipset's public key.&#160;The ENTERACCS leaf&#160;of GETSEC is&#160;selected with EAX set to 2 at&#160;entry.<br/>There&#160;are&#160;certain&#160;restrictions enforced by the processor&#160;for&#160;the execution of the&#160;GETSEC[ENTERACCS] instruction:&#160;</p>
<p style="position:absolute;top:340px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:340px;left:93px;white-space:nowrap" class="ft07">Execution is&#160;not&#160;allowed&#160;unless the&#160;processor&#160;is in protected mode&#160;or IA-32e&#160;mode&#160;with CPL&#160;=&#160;0 and&#160;<br/>EFLAGS.VM =&#160;0.&#160;</p>
<p style="position:absolute;top:379px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:379px;left:93px;white-space:nowrap" class="ft04">Processor&#160;cache must be&#160;available and&#160;not disabled,&#160;that&#160;is,&#160;CR0.CD&#160;and&#160;CR0.NW&#160;bits&#160;must&#160;be&#160;0.&#160;</p>
<p style="position:absolute;top:401px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:402px;left:93px;white-space:nowrap" class="ft07">For processor packages&#160;containing&#160;more&#160;than one&#160;logical processor,&#160;CR0.CD is&#160;checked to&#160;ensure consistency&#160;<br/>between&#160;enabled logical processors.&#160;</p>
<p style="position:absolute;top:440px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:441px;left:93px;white-space:nowrap" class="ft07">For&#160;enforcing&#160;consistency of operation with numeric exception&#160;reporting&#160;using Interrupt 16,&#160;CR0.NE must be&#160;<br/>set.&#160;</p>
<p style="position:absolute;top:479px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:480px;left:93px;white-space:nowrap" class="ft07">An&#160;Intel TXT-capable&#160;chipset&#160;must&#160;be present as&#160;communicated to&#160;the processor by&#160;sampling of&#160;the&#160;power-on&#160;<br/>configuration&#160;capability field after&#160;reset.&#160;</p>
<p style="position:absolute;top:518px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:519px;left:93px;white-space:nowrap" class="ft07">The&#160;processor can not&#160;already be&#160;in&#160;authenticated&#160;code&#160;execution mode&#160;as&#160;launched&#160;by a&#160;previous&#160;<br/>GETSEC[ENTERACCS] or&#160;GETSEC[SENTER] instruction without&#160;a subsequent exiting&#160;using GETSEC[EXITAC]).&#160;</p>
<p style="position:absolute;top:557px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:558px;left:93px;white-space:nowrap" class="ft07">To&#160;avoid potential operability conflicts between modes, the processor&#160;is not allowed to execute this instruction&#160;<br/>if&#160;it currently&#160;is in SMM&#160;or VMX operation.&#160;</p>
<p style="position:absolute;top:596px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:597px;left:93px;white-space:nowrap" class="ft07">To&#160;insure&#160;consistent handling&#160;of&#160;SIPI messages, the&#160;processor executing the GETSEC[ENTERACCS]&#160;instruction&#160;<br/>must&#160;also be designated the&#160;BSP&#160;(boot-strap processor) as&#160;defined&#160;by IA32_APIC_BASE.BSP (Bit&#160;8).&#160;</p>
<p style="position:absolute;top:637px;left:68px;white-space:nowrap" class="ft08">Failure to&#160;conform to&#160;the above&#160;conditions results&#160;in&#160;the processor signaling a&#160;general&#160;protection&#160;exception.<br/>Prior&#160;to&#160;execution of&#160;the&#160;ENTERACCS leaf, other&#160;logical&#160;processors,&#160;i.e., RLPs, in&#160;the platform must&#160;be:</p>
<p style="position:absolute;top:683px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:684px;left:93px;white-space:nowrap" class="ft07">Idle in&#160;a wait-for-SIPI state&#160;(as&#160;initiated&#160;by&#160;an INIT assertion&#160;or through reset for non-BSP&#160;designated&#160;<br/>processors), or&#160;</p>
<p style="position:absolute;top:722px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:723px;left:93px;white-space:nowrap" class="ft04">In&#160;the&#160;SENTER&#160;sleep state&#160;as&#160;initiated by a&#160;GETSEC[SENTER] from the&#160;initiating logical processor (ILP).&#160;</p>
<p style="position:absolute;top:747px;left:68px;white-space:nowrap" class="ft07">If other&#160;logical processor(s) in&#160;the same&#160;package&#160;are&#160;not idle&#160;in&#160;one&#160;of these&#160;states, execution of ENTERACCS&#160;<br/>signals a&#160;general protection exception.&#160;The same&#160;requirement and action applies if&#160;the&#160;other logical processor(s) of&#160;<br/>the same&#160;package&#160;do&#160;not have&#160;CR0.CD&#160;=&#160;0.&#160;<br/>A successful&#160;execution of ENTERACCS&#160;results in&#160;the ILP entering&#160;an authenticated code execution&#160;mode. Prior&#160;to&#160;<br/>reaching this&#160;point,&#160;the processor performs&#160;several checks. These include:&#160;</p>
<p style="position:absolute;top:842px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:843px;left:93px;white-space:nowrap" class="ft07">Establish and&#160;check the&#160;location and&#160;size of the&#160;specified authenticated code module&#160;to be executed by&#160;the&#160;<br/>processor.</p>
<p style="position:absolute;top:881px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:882px;left:93px;white-space:nowrap" class="ft04">Inhibit&#160;the ILP’s&#160;response to the external&#160;events:&#160;INIT, A20M, NMI and&#160;SMI.</p>
<p style="position:absolute;top:904px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:904px;left:93px;white-space:nowrap" class="ft04">Broadcast&#160;a message to&#160;enable protection&#160;of&#160;memory and&#160;I/O&#160;from&#160;other&#160;processor&#160;agents.</p>
<p style="position:absolute;top:926px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:927px;left:93px;white-space:nowrap" class="ft04">Load the&#160;designated&#160;code&#160;module into&#160;an authenticated code execution&#160;area.</p>
<p style="position:absolute;top:949px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:949px;left:93px;white-space:nowrap" class="ft07">Isolate the&#160;contents of the&#160;authenticated&#160;code&#160;execution area from&#160;further state&#160;modification by external&#160;<br/>agents.</p>
<p style="position:absolute;top:988px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:988px;left:93px;white-space:nowrap" class="ft04">Authenticate&#160;the authenticated code module.</p>
<p style="position:absolute;top:1010px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:1011px;left:93px;white-space:nowrap" class="ft07">Initialize&#160;the&#160;initiating logical processor state based&#160;on&#160;information contained in&#160;the authenticated&#160;code module&#160;<br/>header.</p>
<p style="position:absolute;top:1049px;left:68px;white-space:nowrap" class="ft05">•</p>
<p style="position:absolute;top:1050px;left:93px;white-space:nowrap" class="ft04">Unlock the&#160;Intel</p>
<p style="position:absolute;top:1047px;left:200px;white-space:nowrap" class="ft06">®</p>
<p style="position:absolute;top:1050px;left:211px;white-space:nowrap" class="ft04">&#160;TXT-capable chipset private&#160;configuration space and TPM locality&#160;3&#160;space.</p>
<p style="position:absolute;top:137px;left:72px;white-space:nowrap" class="ft04">Opcode</p>
<p style="position:absolute;top:137px;left:163px;white-space:nowrap" class="ft04">Instruction</p>
<p style="position:absolute;top:137px;left:293px;white-space:nowrap" class="ft04">Description</p>
<p style="position:absolute;top:160px;left:72px;white-space:nowrap" class="ft010">0F&#160;37&#160;<br/>(EAX = 2)</p>
<p style="position:absolute;top:160px;left:163px;white-space:nowrap" class="ft04">GETSEC[ENTERACCS]&#160;Enter&#160;authenticated code execution mode.</p>
<p style="position:absolute;top:181px;left:293px;white-space:nowrap" class="ft04">EBX holds the&#160;authenticated code&#160;module&#160;physical base&#160;address. ECX holds the authenticated&#160;</p>
<p style="position:absolute;top:198px;left:293px;white-space:nowrap" class="ft04">code&#160;module&#160;size&#160;(bytes).</p>
</div>
</body>
</html>
